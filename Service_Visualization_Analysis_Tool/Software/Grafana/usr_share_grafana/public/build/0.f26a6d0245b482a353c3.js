webpackJsonp([0],Array(796).concat([function(t,e,n){var r,i;r=[n(887),n(1033),n(817),n(893),n(903),n(854),n(1034),n(1040),n(1042),n(1049)],void 0!==(i=function(){}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(804),i=n(918),a=n(819),o=n(920),s=n(809);n.d(e,"PanelCtrl",function(){return r.a}),n.d(e,"MetricsPanelCtrl",function(){return i.a}),n.d(e,"QueryCtrl",function(){return a.QueryCtrl}),n.d(e,"alertTab",function(){return o.a}),n.d(e,"loadPluginCss",function(){return s.loadPluginCss})},function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t[t.length-1],r=t[0]||"",i=1;i<t.length-1;i++)r+=" "+t[i]||"";return n=a.a.regexEscape(n),null!==new RegExp("\\$("+n+")(?:\\W|$)|\\[\\[("+n+")\\]\\]","g").exec(r)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"variableTypes",function(){return s}),e.containsVariable=r;var i=n(109),a=n.n(i),o=n(290);n.d(e,"assignModelProperties",function(){return o.assignModelProperties});var s={}},function(t,e,n){"use strict";function r(t){var e=new u.b({type:t.type,defaultParams:[]});return new u.a(t,e)}function i(t){switch(t){case"ok":return{text:"OK",iconClass:"icon-gf icon-gf-online",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"icon-gf icon-gf-critical",stateClass:"alert-state-critical"};case"no_data":return{text:"NO DATA",iconClass:"fa fa-question",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"fa fa-pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"fa fa-exclamation",stateClass:"alert-state-warning"}}throw{message:"Unknown alert state"}}function a(t,e){return l.a.reduce(t,function(t,e){return void 0!==e.metric&&void 0!==e.value&&t.push(e.metric+"="+e.value),void 0!==e.Metric&&void 0!==e.Value&&t.push(e.Metric+"="+e.Value),t},[]).join(e)}function o(t){return l.a.isArray(t.data)?a(t.data,", "):l.a.isArray(t.data.evalMatches)?a(t.data.evalMatches,", "):t.data.error?"Error: "+t.data.error:t.data.noData||t.data.no_data?"No Data":""}var s=n(4),l=n.n(s),u=n(800),c=new u.b({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["1s","10s","1m","5m","10m","15m","1h","24h","48h"]},{name:"to",type:"string",options:["now"]}],defaultParams:["#A","15m","now","avg"]}),h=[{text:"Query",value:"query"}],f={alerting:1,no_data:2,pending:3,ok:4,paused:5},d=[{text:"IS ABOVE",value:"gt"},{text:"IS BELOW",value:"lt"},{text:"IS OUTSIDE RANGE",value:"outside_range"},{text:"IS WITHIN RANGE",value:"within_range"},{text:"HAS NO VALUE",value:"no_value"}],p=[{text:"OR",value:"or"},{text:"AND",value:"and"}],m=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"percent_diff()",value:"percent_diff"},{text:"count_non_null()",value:"count_non_null"}],g=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],v=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];e.a={alertQueryDef:c,getStateDisplayModel:i,conditionTypes:h,evalFunctions:d,evalOperators:p,noDataModes:g,executionErrorModes:v,reducerTypes:m,createReducerPart:r,getAlertAnnotationInfo:o,alertStateSortScore:f}},function(t,e,n){"use strict";function r(t,e){var n=t.def.type+"(",r=o.a.map(t.params,function(e,n){var r=t.def.params[n];return"time"===r.type&&"auto"===e&&(e="$__interval"),"single"===r.quote?"'"+e+"'":"double"===r.quote?'"'+e+'"':e});return e&&r.unshift(e),n+r.join(", ")+")"}function i(t,e){return e+" "+t.params[0]}n.d(e,"b",function(){return s}),n.d(e,"a",function(){return l}),e.c=r,e.d=i;var a=n(4),o=n.n(a),s=function(){function t(t){this.type=t.type,this.params=t.params,this.defaultParams=t.defaultParams,this.renderer=t.renderer,this.category=t.category,this.addStrategy=t.addStrategy}return t}(),l=function(){function t(t,e){if(this.part=t,this.def=e,!this.def)throw{message:"Could not find query part "+t.type};t.params=t.params||o.a.clone(this.def.defaultParams),this.params=t.params,this.updateText()}return t.prototype.render=function(t){return this.def.renderer(this,t)},t.prototype.hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(this.def.params[e+1]&&this.def.params[e+1].optional)},t.prototype.updateParam=function(t,e){var n=this;if(this.hasMultipleParamsInString(t,e))return void o.a.each(t.split(","),function(t,e){n.updateParam(t.trim(),e)});""===t&&this.def.params[e].optional?this.params.splice(e,1):this.params[e]=t,this.part.params=this.params,this.updateText()},t.prototype.updateText=function(){if(0===this.params.length)return void(this.text=this.def.type+"()");var t=this.def.type+"(";t+=this.params.join(", "),t+=")",this.text=t},t}()},function(t,e,n){"use strict";function r(t,e){if(!t)return!1;if("/"===t[0]){var n=o.a.stringToJsRegex(t);return null!=e.match(n)}return t===e}function i(t){return 0===t?.001:t/10}Object.defineProperty(e,"__esModule",{value:!0});var a=n(109),o=n.n(a),s=n(4),l=n.n(s),u=function(){function t(t){this.datapoints=t.datapoints,this.label=t.alias,this.id=t.alias,this.alias=t.alias,this.color=t.color,this.valueFormater=o.a.valueFormats.none,this.stats={},this.legend=!0,this.unit=t.unit,this.hasMsResolution=this.isMsResolutionNeeded()}return t.prototype.applySeriesOverrides=function(t){this.lines={},this.dashes={dashLength:[]},this.points={},this.bars={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack;for(var e=0;e<t.length;e++){var n=t[e];r(n.alias,this.alias)&&(void 0!==n.lines&&(this.lines.show=n.lines),void 0!==n.dashes&&(this.dashes.show=n.dashes,this.lines.lineWidth=0),void 0!==n.points&&(this.points.show=n.points),void 0!==n.bars&&(this.bars.show=n.bars),void 0!==n.fill&&(this.lines.fill=i(n.fill)),void 0!==n.stack&&(this.stack=n.stack),void 0!==n.linewidth&&(this.lines.lineWidth=this.dashes.show?0:n.linewidth,this.dashes.lineWidth=n.linewidth),void 0!==n.dashLength&&(this.dashes.dashLength[0]=n.dashLength),void 0!==n.spaceLength&&(this.dashes.dashLength[1]=n.spaceLength),void 0!==n.nullPointMode&&(this.nullPointMode=n.nullPointMode),void 0!==n.pointradius&&(this.points.radius=n.pointradius),void 0!==n.steppedLine&&(this.lines.steps=n.steppedLine),void 0!==n.zindex&&(this.zindex=n.zindex),void 0!==n.fillBelowTo&&(this.fillBelowTo=n.fillBelowTo),void 0!==n.color&&(this.color=n.color),void 0!==n.transform&&(this.transform=n.transform),void 0!==n.legend&&(this.legend=n.legend),void 0!==n.yaxis&&(this.yaxis=n.yaxis))}},t.prototype.getFlotPairs=function(t){var e=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;for(var n,r,i,a="connected"===t,o="null as zero"===t,s=0,u=0,c=!0,h=0;h<this.datapoints.length;h++){if(r=this.datapoints[h][0],n=this.datapoints[h][1],void 0!==i){var f=n-i;f<this.stats.timeStep&&(this.stats.timeStep=f)}if(i=n,null===r){if(a)continue;o&&(r=0)}null!==r&&(l.a.isNumber(r)&&(this.stats.total+=r,this.allIsNull=!1,s++),r>this.stats.max&&(this.stats.max=r),r<this.stats.min&&(this.stats.min=r),null===this.stats.first?this.stats.first=r:u>r?(c=!1,h===this.datapoints.length-1&&(this.stats.delta+=r)):(this.stats.delta+=c?r-u:r,c=!0),u=r,r<this.stats.logmin&&r>0&&(this.stats.logmin=r),0!==r&&(this.allIsZero=!1)),e.push([n,r])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),e.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/s,this.stats.current=e[e.length-1][1],null===this.stats.current&&e.length>1&&(this.stats.current=e[e.length-2][1])),null!==this.stats.max&&null!==this.stats.min&&(this.stats.range=this.stats.max-this.stats.min),null!==this.stats.current&&null!==this.stats.first&&(this.stats.diff=this.stats.current-this.stats.first),this.stats.count=e.length,e},t.prototype.updateLegendValues=function(t,e,n){this.valueFormater=t,this.decimals=e,this.scaledDecimals=n},t.prototype.formatValue=function(t){return l.a.isFinite(t)||(t=null),this.valueFormater(t,this.decimals,this.scaledDecimals)},t.prototype.isMsResolutionNeeded=function(){for(var t=0;t<this.datapoints.length;t++)if(null!==this.datapoints[t][1]){var e=this.datapoints[t][1].toString();if(13===e.length&&e%1e3!=0)return!0}return!1},t.prototype.hideFromLegend=function(t){return!(!t.hideEmpty||!this.allIsNull)||(!this.legend||!(!t.hideZero||!this.allIsZero))},t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.columns=[],this.columnMap={},this.rows=[],this.type="table"}return t.prototype.sort=function(t){null===t.col||this.columns.length<=t.col||(this.rows.sort(function(e,n){return e=e[t.col],n=n[t.col],e<n?-1:e>n?1:0}),this.columns[t.col].sort=!0,t.desc?(this.rows.reverse(),this.columns[t.col].desc=!0):this.columns[t.col].desc=!1)},t.prototype.addColumn=function(t){this.columnMap[t.text]||(this.columns.push(t),this.columnMap[t.text]=t)},t}();e.default=r},function(t,e,n){"use strict";function r(t){return d.a.filter(p,function(e){return!e.minVersion||e.minVersion<=t})}function i(t){return a(t.type)?w[t.type]:[]}function a(t){if(t){var e=w[t];return null!==e&&void 0!==e}return!1}function o(t){var e=[];return d.a.each(t.metrics,function(t){a(t.type)||e.push({text:c(t),value:t.id})}),e}function s(t,e){var n=[];return e?(d.a.each(S[t],function(t){t.isCheckbox||n.push(t)}),n):S[t]}function l(t){var e=[];return d.a.each(t.metrics,function(t){"count"!==t.type&&e.push({text:c(t),value:t.id})}),g.concat(e)}function u(t){return d.a.find(v,{value:t}).text}function c(t){return d.a.find(p,{value:t.type}).text+" "+t.field}function h(t,e){var n=d.a.find(g,{value:t});if(n)return n.text;var r=d.a.find(e.metrics,{id:t});return r?c(r):"metric not found"}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"metricAggTypes",function(){return p}),n.d(e,"bucketAggTypes",function(){return m}),n.d(e,"orderByOptions",function(){return g}),n.d(e,"orderOptions",function(){return v}),n.d(e,"sizeOptions",function(){return y}),n.d(e,"extendedStats",function(){return b}),n.d(e,"intervalOptions",function(){return x}),n.d(e,"movingAvgModelOptions",function(){return _}),n.d(e,"pipelineOptions",function(){return w}),n.d(e,"movingAvgModelSettings",function(){return S}),e.getMetricAggTypes=r,e.getPipelineOptions=i,e.isPipelineAgg=a,e.getPipelineAggOptions=o,e.getMovingAvgSettings=s,e.getOrderByOptions=l,e.describeOrder=u,e.describeMetric=c,e.describeOrderBy=h;var f=n(4),d=n.n(f),p=[{text:"Count",value:"count",requiresField:!1},{text:"Average",value:"avg",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Sum",value:"sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Max",value:"max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Min",value:"min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Extended Stats",value:"extended_stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Percentiles",value:"percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Unique Count",value:"cardinality",requiresField:!0,supportsMissing:!0},{text:"Moving Average",value:"moving_avg",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Derivative",value:"derivative",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Raw Document",value:"raw_document",requiresField:!1}],m=[{text:"Terms",value:"terms",requiresField:!0},{text:"Filters",value:"filters"},{text:"Geo Hash Grid",value:"geohash_grid",requiresField:!0},{text:"Date Histogram",value:"date_histogram",requiresField:!0},{text:"Histogram",value:"histogram",requiresField:!0}],g=[{text:"Doc Count",value:"_count"},{text:"Term value",value:"_term"}],v=[{text:"Top",value:"desc"},{text:"Bottom",value:"asc"}],y=[{text:"No limit",value:"0"},{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"5",value:"5"},{text:"10",value:"10"},{text:"15",value:"15"},{text:"20",value:"20"}],b=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Sum",value:"sum"},{text:"Count",value:"count"},{text:"Std Dev",value:"std_deviation"},{text:"Std Dev Upper",value:"std_deviation_bounds_upper"},{text:"Std Dev Lower",value:"std_deviation_bounds_lower"}],x=[{text:"auto",value:"auto"},{text:"10s",value:"10s"},{text:"1m",value:"1m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"20m",value:"20m"},{text:"1h",value:"1h"},{text:"1d",value:"1d"}],_=[{text:"Simple",value:"simple"},{text:"Linear",value:"linear"},{text:"Exponentially Weighted",value:"ewma"},{text:"Holt Linear",value:"holt"},{text:"Holt Winters",value:"holt_winters"}],w={moving_avg:[{text:"window",default:5},{text:"model",default:"simple"},{text:"predict",default:void 0},{text:"minimize",default:!1}],derivative:[{text:"unit",default:void 0}]},S={simple:[],linear:[],ewma:[{text:"Alpha",value:"alpha",default:void 0}],holt:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0}],holt_winters:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0},{text:"Gamma",value:"gamma",default:void 0},{text:"Period",value:"period",default:void 0},{text:"Pad",value:"pad",default:void 0,isCheckbox:!0}]}},function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(21),i=n.n(r),a=n(4),o=n.n(a),s=n(10),l=n.n(s),u=n(299),c=n(294),h=n.n(c),f=n(290),d=function(){function t(t,e){var n=this;this.$injector=e,this.$scope=t,this.$timeout=e.get("$timeout"),this.editorTabIndex=0,this.events=new f.Emitter,this.timing={};var r=i.a.panels[this.panel.type];r&&(this.pluginId=r.id,this.pluginName=r.name),t.$on("refresh",function(){return n.refresh()}),t.$on("render",function(){return n.render()}),t.$on("$destroy",function(){n.events.emit("panel-teardown"),n.events.removeAllListeners()}),this.panel.isNew&&delete this.panel.isNew}return t.prototype.init=function(){this.calculatePanelHeight(),this.publishAppEvent("panel-initialized",{scope:this.$scope}),this.events.emit("panel-initialized")},t.prototype.renderingCompleted=function(){u.a.renderingCompleted(this.panel.id,this.timing)},t.prototype.refresh=function(){this.events.emit("refresh",null)},t.prototype.publishAppEvent=function(t,e){this.$scope.$root.appEvent(t,e)},t.prototype.changeView=function(t,e){this.publishAppEvent("panel-change-view",{fullscreen:t,edit:e,panelId:this.panel.id})},t.prototype.viewPanel=function(){this.changeView(!0,!1)},t.prototype.editPanel=function(){this.changeView(!0,!0)},t.prototype.exitFullscreen=function(){this.changeView(!1,!1)},t.prototype.initEditMode=function(){var t=this;this.editorTabs=[],this.addEditorTab("General","public/app/partials/panelgeneral.html"),this.editModeInitiated=!0,this.events.emit("init-edit-mode",null);var e=(this.$injector.get("$routeParams").tab||"").toLowerCase();e&&this.editorTabs.forEach(function(n,r){n.title.toLowerCase()===e&&(t.editorTabIndex=r)})},t.prototype.changeTab=function(t){this.editorTabIndex=t;var e=this.$injector.get("$route");e.current.params.tab=this.editorTabs[t].title.toLowerCase(),e.updateParams()},t.prototype.addEditorTab=function(t,e,n){var r={title:t,directiveFn:e};o.a.isString(e)&&(r.directiveFn=function(){return{templateUrl:e}}),n?this.editorTabs.splice(n,0,r):this.editorTabs.push(r)},t.prototype.getMenu=function(){var t=[];return t.push({text:"View",click:"ctrl.viewPanel(); dismiss();"}),t.push({text:"Edit",click:"ctrl.editPanel(); dismiss();",role:"Editor"}),this.fullscreen||t.push({text:"Duplicate",click:"ctrl.duplicate()",role:"Editor"}),t.push({text:"Share",click:"ctrl.sharePanel(); dismiss();"}),t},t.prototype.getExtendedMenu=function(){var t=[{text:"Panel JSON",click:"ctrl.editPanelJson(); dismiss();"}];return this.events.emit("init-panel-actions",t),t},t.prototype.otherPanelInFullscreenMode=function(){return this.dashboard.meta.fullscreen&&!this.fullscreen},t.prototype.calculatePanelHeight=function(){if(this.fullscreen){var t=l()(window).height(),e=Math.floor(.4*t),n=Math.floor(.8*t);this.containerHeight=this.editMode?e:n}else this.containerHeight=this.panel.height||this.row.height,o.a.isString(this.containerHeight)&&(this.containerHeight=parseInt(this.containerHeight.replace("px",""),10));this.height=this.containerHeight-(7+(this.panel.title?25:9))},t.prototype.render=function(t){this.otherPanelInFullscreenMode()||(this.calculatePanelHeight(),this.timing.renderStart=(new Date).getTime(),this.events.emit("render",t))},t.prototype.duplicate=function(){var t=this;this.dashboard.duplicatePanel(this.panel,this.row),this.$timeout(function(){t.$scope.$root.$broadcast("render")})},t.prototype.updateColumnSpan=function(t){var e=this;this.panel.span=Math.min(Math.max(Math.floor(this.panel.span+t),1),12),this.row.panelSpanChanged(),this.$timeout(function(){e.render()})},t.prototype.removePanel=function(){this.row.removePanel(this.panel)},t.prototype.editPanelJson=function(){this.publishAppEvent("show-json-editor",{object:this.panel,updateHandler:this.replacePanel.bind(this)})},t.prototype.replacePanel=function(t,e){var n=this,r=o.a.indexOf(this.row.panels,e);this.row.panels.splice(r,1),this.$timeout(function(){t.id=e.id,t.span=e.span,n.row.panels.splice(r,0,t)})},t.prototype.sharePanel=function(){var t=this.$scope.$new();t.panel=this.panel,t.dashboard=this.dashboard,this.publishAppEvent("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:t})},t.prototype.getInfoMode=function(){return this.error?"error":this.panel.description?"info":this.panel.links&&this.panel.links.length?"links":""},t.prototype.getInfoContent=function(t){var e=this.panel.description;"tooltip"===t.mode&&(e=this.error||this.panel.description);var n=this.$injector.get("linkSrv"),r=this.$injector.get("templateSrv"),i=r.replace(e,this.panel.scopedVars),a='<div class="markdown-html">';if(a+=(new h.a).render(i),this.panel.links&&this.panel.links.length>0){a+="<ul>";for(var o=0,s=this.panel.links;o<s.length;o++){var l=s[o],u=n.getPanelLinkAnchorInfo(l,this.panel.scopedVars);a+='<li><a class="panel-menu-link" href="'+u.href+'" target="'+u.target+'">'+u.title+"</a></li>"}a+="</ul>"}return a+"</div>"},t.prototype.openInspector=function(){var t=this.$scope.$new();t.panel=this.panel,t.dashboard=this.dashboard,t.panelInfoHtml=this.getInfoContent({mode:"inspector"}),t.inspector=l.a.extend(!0,{},this.inspector),this.publishAppEvent("show-modal",{src:"public/app/features/dashboard/partials/inspector.html",scope:t})},t}()},function(t,e,n){"use strict";function r(t,e,n){var r=Math.sqrt(50),i=Math.sqrt(10),a=Math.sqrt(2),o=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),l=o/s;return l>=r?s*=10:l>=i?s*=5:l>=a&&(s*=2),e<t?-s:s}function i(t,e){return t-Math.floor(Math.log(e)/Math.LN10)}function a(t,e,n,r){var i,a=(e-t)/n,o=-Math.floor(Math.log(a)/Math.LN10),s=r,l=Math.pow(10,-o),u=a/l;return u<1.5?i=1:u<3?(i=2,u>2.25&&(null==s||o+1<=s)&&(i=2.5,++o)):i=u<7.5?5:10,i*=l}Object.defineProperty(e,"__esModule",{value:!0}),e.tickStep=r,e.getScaledDecimals=i,e.getFlotTickSize=a},function(t,e){!function(t){t.color={},t.color.make=function(e,n,r,i){var a={};return a.r=e||0,a.g=n||0,a.b=r||0,a.a=null!=i?i:1,a.add=function(t,e){for(var n=0;n<t.length;++n)a[t.charAt(n)]+=e;return a.normalize()},a.scale=function(t,e){for(var n=0;n<t.length;++n)a[t.charAt(n)]*=e;return a.normalize()},a.toString=function(){return a.a>=1?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")"},a.normalize=function(){function t(t,e,n){return e<t?t:e>n?n:e}return a.r=t(0,parseInt(a.r),255),a.g=t(0,parseInt(a.g),255),a.b=t(0,parseInt(a.b),255),a.a=t(0,a.a,1),a},a.clone=function(){return t.color.make(a.r,a.b,a.g,a.a)},a.normalize()},t.color.extract=function(e,n){var r;do{if(""!=(r=e.css(n).toLowerCase())&&"transparent"!=r)break;e=e.parent()}while(e.length&&!t.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==r&&(r="transparent"),t.color.parse(r)},t.color.parse=function(n){var r,i=t.color.make;if(r=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10));if(r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseFloat(r[4]));if(r=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return i(2.55*parseFloat(r[1]),2.55*parseFloat(r[2]),2.55*parseFloat(r[3]));if(r=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return i(2.55*parseFloat(r[1]),2.55*parseFloat(r[2]),2.55*parseFloat(r[3]),parseFloat(r[4]));if(r=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return i(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16));if(r=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return i(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16));var a=t.trim(n).toLowerCase();return"transparent"==a?i(255,255,255,0):(r=e[a]||[0,0,0],i(r[0],r[1],r[2]))};var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(t){function e(e,n){var r=n.children("."+e)[0];if(null==r&&(r=document.createElement("canvas"),r.className=e,t(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n),!r.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");r=window.G_vmlCanvasManager.initElement(r)}this.element=r;var i=this.context=r.getContext("2d"),a=window.devicePixelRatio||1,o=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;this.pixelRatio=a/o,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}function n(n,i,a,o){function s(t,e){e=[ft].concat(e);for(var n=0;n<t.length;++n)t[n].apply(this,e)}function l(t){Z=u(t),m(),g()}function u(e){for(var n=[],r=0;r<e.length;++r){var i=t.extend(!0,{},tt.series);null!=e[r].data?(i.data=e[r].data,delete e[r].data,t.extend(!0,i,e[r]),e[r].data=i.data):i.data=e[r],n.push(i)}return n}function c(t,e){var n=t[e+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function h(){return t.grep(ot.concat(st),function(t){return t})}function f(t){var e,n,r={};for(e=0;e<ot.length;++e)(n=ot[e])&&n.used&&(r["x"+n.n]=n.c2p(t.left));for(e=0;e<st.length;++e)(n=st[e])&&n.used&&(r["y"+n.n]=n.c2p(t.top));return void 0!==r.x1&&(r.x=r.x1),void 0!==r.y1&&(r.y=r.y1),r}function d(t){var e,n,r,i={};for(e=0;e<ot.length;++e)if((n=ot[e])&&n.used&&(r="x"+n.n,null==t[r]&&1==n.n&&(r="x"),null!=t[r])){i.left=n.p2c(t[r]);break}for(e=0;e<st.length;++e)if((n=st[e])&&n.used&&(r="y"+n.n,null==t[r]&&1==n.n&&(r="y"),null!=t[r])){i.top=n.p2c(t[r]);break}return i}function p(e,n){return e[n-1]||(e[n-1]={n:n,direction:e==ot?"x":"y",options:t.extend(!0,{},e==ot?tt.xaxis:tt.yaxis)}),e[n-1]}function m(){var e,n=Z.length,r=-1;for(e=0;e<Z.length;++e){var i=Z[e].color;null!=i&&(n--,"number"==typeof i&&i>r&&(r=i))}n<=r&&(n=r+1);var a,o=[],s=tt.colors,l=s.length,u=0;for(e=0;e<n;e++)a=t.color.parse(s[e%l]||"#666"),e%l==0&&e&&(u=u>=0?u<.5?-u-.2:0:-u),o[e]=a.scale("rgb",1+u);var h,f=0;for(e=0;e<Z.length;++e){if(h=Z[e],null==h.color?(h.color=o[f].toString(),++f):"number"==typeof h.color&&(h.color=o[h.color].toString()),null==h.lines.show){var d,m=!0;for(d in h)if(h[d]&&h[d].show){m=!1;break}m&&(h.lines.show=!0)}null==h.lines.zero&&(h.lines.zero=!!h.lines.fill),h.xaxis=p(ot,c(h,"x")),h.yaxis=p(st,c(h,"y"))}}function g(){function e(t,e,n){e<t.datamin&&e!=-y&&(t.datamin=e),n>t.datamax&&n!=y&&(t.datamax=n)}var n,r,i,a,o,l,u,c,f,d,p,m,g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,y=Number.MAX_VALUE;for(t.each(h(),function(t,e){e.datamin=g,e.datamax=v,e.used=!1}),n=0;n<Z.length;++n)o=Z[n],o.datapoints={points:[]},s(ht.processRawData,[o,o.data,o.datapoints]);for(n=0;n<Z.length;++n){if(o=Z[n],p=o.data,!(m=o.datapoints.format)){if(m=[],m.push({x:!0,number:!0,required:!0}),m.push({y:!0,number:!0,required:!0}),o.bars.show||o.lines.show&&o.lines.fill){var b=!!(o.bars.show&&o.bars.zero||o.lines.show&&o.lines.zero);m.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:b}),o.bars.horizontal&&(delete m[m.length-1].y,m[m.length-1].x=!0)}o.datapoints.format=m}if(null==o.datapoints.pointsize){o.datapoints.pointsize=m.length,u=o.datapoints.pointsize,l=o.datapoints.points;var x=o.lines.show&&o.lines.steps;for(o.xaxis.used=o.yaxis.used=!0,r=i=0;r<p.length;++r,i+=u){d=p[r];var _=null==d;if(!_)for(a=0;a<u;++a)c=d[a],f=m[a],f&&(f.number&&null!=c&&(c=+c,isNaN(c)?c=null:c==1/0?c=y:c==-1/0&&(c=-y)),null==c&&(f.required&&(_=!0),null!=f.defaultValue&&(c=f.defaultValue))),l[i+a]=c;if(_)for(a=0;a<u;++a)c=l[i+a],null!=c&&(f=m[a],!1!==f.autoscale&&(f.x&&e(o.xaxis,c,c),f.y&&e(o.yaxis,c,c))),l[i+a]=null;if(x&&i>0&&(!_||null!=l[i-u])){for(a=0;a<u;++a)l[i+u+a]=l[i+a];l[i+1]=l[i-u+1]||0,_&&(l[i]=d[0]),i+=u}}}}for(n=0;n<Z.length;++n){if(o=Z[n],l=o.datapoints.points,u=o.datapoints.pointsize,"negative-Y"===o.transform)for(r=0;r<l.length;r+=u)null!=l[r]&&(c=l[r+1],l[r+1]=-c);s(ht.processDatapoints,[o,o.datapoints])}for(n=0;n<Z.length;++n){o=Z[n],l=o.datapoints.points,u=o.datapoints.pointsize,m=o.datapoints.format;var w=g,S=g,k=v,M=v;for(r=0;r<l.length;r+=u)if(null!=l[r])for(a=0;a<u;++a)c=l[r+a],(f=m[a])&&!1!==f.autoscale&&c!=y&&c!=-y&&(f.x&&(c<w&&(w=c),c>k&&(k=c)),f.y&&(c<S&&(S=c),c>M&&(M=c)));if(o.bars.show){var T;switch(o.bars.align){case"left":T=0;break;case"right":T=-o.bars.barWidth;break;default:T=-o.bars.barWidth/2}o.bars.horizontal?(S+=T,M+=T+o.bars.barWidth):(w+=T,k+=T+o.bars.barWidth)}e(o.xaxis,w,k),e(o.yaxis,S,M)}t.each(h(),function(t,e){e.datamin==g&&(e.datamin=null),e.datamax==v&&(e.datamax=null)})}function v(){pt&&clearTimeout(pt),rt.unbind("mousemove",U),rt.unbind("mouseleave",z),rt.unbind("click",V),s(ht.shutdown,[rt])}function y(t){function e(t){return t}var n,r,i=t.options.transform||e,a=t.options.inverseTransform;"x"==t.direction?(n=t.scale=ut/Math.abs(i(t.max)-i(t.min)),r=Math.min(i(t.max),i(t.min))):(n=t.scale=ct/Math.abs(i(t.max)-i(t.min)),n=-n,r=Math.max(i(t.max),i(t.min))),t.p2c=i==e?function(t){return(t-r)*n}:function(t){return(i(t)-r)*n},t.c2p=a?function(t){return a(r+t/n)}:function(t){return r+t/n}}function b(t){for(var e=t.options,n=t.ticks||[],r=e.labelWidth||0,i=e.labelHeight||0,a=r||("x"==t.direction?Math.floor(et.width/(n.length||1)):null),o=t.direction+"Axis "+t.direction+t.n+"Axis",s="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+o,l=e.font||"flot-tick-label tickLabel",u=0;u<n.length;++u){var c=n[u];if(c.label){var h=et.getTextInfo(s,c.label,l,null,a);r=Math.max(r,h.width+1),i=Math.max(i,h.height)}}t.labelWidth=e.labelWidth||r,t.labelHeight=e.labelHeight||i}function x(e){var n=e.labelWidth,r=e.labelHeight,i=e.options.position,a="x"===e.direction,o=e.options.tickLength,s=tt.grid.axisMargin,l=tt.grid.labelMargin,u=tt.grid.eventSectionHeight,c=!0,h=!0,f=!0,d=!1;t.each(a?ot:st,function(t,n){n&&(n.show||n.reserveSpace)&&(n===e?d=!0:n.options.position===i&&(d?h=!1:c=!1),d||(f=!1))}),h&&(s=0),null==o&&(o=f?"full":5),isNaN(+o)||(l+=+o),a?(r+=l,r+=u,"bottom"==i?(lt.bottom+=r+s,e.box={top:et.height-lt.bottom,height:r}):(e.box={top:lt.top+s,height:r},lt.top+=r+s)):(n+=l,"left"==i?(e.box={left:lt.left+s,width:n},lt.left+=n+s):(lt.right+=n+s,e.box={left:et.width-lt.right,width:n})),e.position=i,e.tickLength=o,e.box.padding=l,e.box.eventSectionPadding=u,e.innermost=c}function _(t){"x"==t.direction?(t.box.left=lt.left-t.labelWidth/2,t.box.width=et.width-lt.left-lt.right+t.labelWidth):(t.box.top=lt.top-t.labelHeight/2,t.box.height=et.height-lt.bottom-lt.top+t.labelHeight)}function w(){var e,n=tt.grid.minBorderMargin;if(null==n)for(n=0,e=0;e<Z.length;++e)n=Math.max(n,2*(Z[e].points.radius+Z[e].points.lineWidth/2));var r={left:n,right:n,top:n,bottom:n};t.each(h(),function(t,e){e.reserveSpace&&e.ticks&&e.ticks.length&&("x"===e.direction?(r.left=Math.max(r.left,e.labelWidth/2),r.right=Math.max(r.right,e.labelWidth/2)):(r.bottom=Math.max(r.bottom,e.labelHeight/2),r.top=Math.max(r.top,e.labelHeight/2)))}),lt.left=Math.ceil(Math.max(r.left,lt.left)),lt.right=Math.ceil(Math.max(r.right,lt.right)),lt.top=Math.ceil(Math.max(r.top,lt.top)),lt.bottom=Math.ceil(Math.max(r.bottom,lt.bottom))}function S(){var e,n=h(),r=tt.grid.show;for(var i in lt){var a=tt.grid.margin||0;lt[i]="number"==typeof a?a:a[i]||0}s(ht.processOffset,[lt]);for(var i in lt)"object"==typeof tt.grid.borderWidth?lt[i]+=r?tt.grid.borderWidth[i]:0:lt[i]+=r?tt.grid.borderWidth:0;if(t.each(n,function(t,e){var n=e.options;e.show=null==n.show?e.used:n.show,e.reserveSpace=null==n.reserveSpace?e.show:n.reserveSpace,k(e)}),r){var o=t.grep(n,function(t){return t.show||t.reserveSpace});for(t.each(o,function(t,e){M(e),T(e),C(e,e.ticks),b(e)}),e=o.length-1;e>=0;--e)x(o[e]);w(),t.each(o,function(t,e){_(e)})}ut=et.width-lt.left-lt.right,ct=et.height-lt.bottom-lt.top,t.each(n,function(t,e){y(e)}),r&&D(),j()}function k(t){var e=t.options,n=+(null!=e.min?e.min:t.datamin),r=+(null!=e.max?e.max:t.datamax),i=r-n;if(0==i){var a=Math.abs(0==r?1:.25*r);null==e.min&&(n-=a),null!=e.max&&null==e.min||(r+=a)}else{var o=e.autoscaleMargin;null!=o&&(null==e.min&&(n-=i*o)<0&&null!=t.datamin&&t.datamin>=0&&(n=0),null==e.max&&(r+=i*o)>0&&null!=t.datamax&&t.datamax<=0&&(r=0))}t.min=n,t.max=r}function M(e){var n,i=e.options;n="number"==typeof i.ticks&&i.ticks>0?i.ticks:.3*Math.sqrt("x"==e.direction?et.width:et.height);var a=(e.max-e.min)/n,o=-Math.floor(Math.log(a)/Math.LN10),s=i.tickDecimals;null!=s&&o>s&&(o=s);var l,u=Math.pow(10,-o),c=a/u;if(c<1.5?l=1:c<3?(l=2,c>2.25&&(null==s||o+1<=s)&&(l=2.5,++o)):l=c<7.5?5:10,l*=u,null!=i.minTickSize&&l<i.minTickSize&&(l=i.minTickSize),e.delta=a,e.tickDecimals=Math.max(0,null!=s?s:o),e.tickSize=i.tickSize||l,e.scaledDecimals=e.tickDecimals-Math.floor(Math.log(e.tickSize)/Math.LN10),"time"==i.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(e.tickGenerator||(e.tickGenerator=function(t){var e,n=[],i=r(t.min,t.tickSize),a=0,o=Number.NaN;do{e=o,o=i+a*t.tickSize,n.push(o),++a}while(o<t.max&&o!=e);return n},e.tickFormatter=function(t,e){var n=e.tickDecimals?Math.pow(10,e.tickDecimals):1,r=""+Math.round(t*n)/n;if(null!=e.tickDecimals){var i=r.indexOf("."),a=-1==i?0:r.length-i-1;if(a<e.tickDecimals)return(a?r:r+".")+(""+n).substr(1,e.tickDecimals-a)}return r}),t.isFunction(i.tickFormatter)&&(e.tickFormatter=function(t,e){return""+i.tickFormatter(t,e)}),null!=i.alignTicksWithAxis){var h=("x"==e.direction?ot:st)[i.alignTicksWithAxis-1];if(h&&h.used&&h!=e){var f=e.tickGenerator(e);if(f.length>0&&(null==i.min&&(e.min=Math.min(e.min,f[0])),null==i.max&&f.length>1&&(e.max=Math.max(e.max,f[f.length-1]))),e.tickGenerator=function(t){var e,n,r=[];for(n=0;n<h.ticks.length;++n)e=(h.ticks[n].v-h.min)/(h.max-h.min),e=t.min+e*(t.max-t.min),r.push(e);return r},!e.mode&&null==i.tickDecimals){var d=Math.max(0,1-Math.floor(Math.log(e.delta)/Math.LN10)),p=e.tickGenerator(e);p.length>1&&/\..*0$/.test((p[1]-p[0]).toFixed(d))||(e.tickDecimals=d)}}}}function T(e){var n=e.options.ticks,r=[];null==n||"number"==typeof n&&n>0?r=e.tickGenerator(e):n&&(r=t.isFunction(n)?n(e):n);var i,a;for(e.ticks=[],i=0;i<r.length;++i){var o=null,s=r[i];"object"==typeof s?(a=+s[0],s.length>1&&(o=s[1])):a=+s,null==o&&(o=e.tickFormatter(a,e)),isNaN(a)||e.ticks.push({v:a,label:o})}}function C(t,e){t.options.autoscaleMargin&&e.length>0&&(null==t.options.min&&(t.min=Math.min(t.min,e[0].v)),null==t.options.max&&e.length>1&&(t.max=Math.max(t.max,e[e.length-1].v)))}function A(){et.clear(),s(ht.drawBackground,[it]);var t=tt.grid;t.show&&t.backgroundColor&&E(),t.show&&!t.aboveData&&O();for(var e=0;e<Z.length;++e)s(ht.drawSeries,[it,Z[e]]),$(Z[e]);s(ht.draw,[it]),t.show&&t.aboveData&&O(),et.render(),Y()}function P(t,e){for(var n,r,i,a,o=h(),s=0;s<o.length;++s)if(n=o[s],n.direction==e&&(a=e+n.n+"axis",t[a]||1!=n.n||(a=e+"axis"),t[a])){r=t[a].from,i=t[a].to;break}if(t[a]||(n="x"==e?ot[0]:st[0],r=t[e+"1"],i=t[e+"2"]),null!=r&&null!=i&&r>i){var l=r;r=i,i=l}return{from:r,to:i,axis:n}}function E(){it.save(),it.translate(lt.left,lt.top),it.fillStyle=J(tt.grid.backgroundColor,ct,0,"rgba(255, 255, 255, 0)"),it.fillRect(0,0,ut,ct),it.restore()}function O(){var e,n,r,i;it.save(),it.translate(lt.left,lt.top);var a=tt.grid.markings;if(a)for(t.isFunction(a)&&(n=ft.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,a=a(n)),e=0;e<a.length;++e){var o=a[e],s=P(o,"x"),l=P(o,"y");if(null==s.from&&(s.from=s.axis.min),null==s.to&&(s.to=s.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),!(s.to<s.axis.min||s.from>s.axis.max||l.to<l.axis.min||l.from>l.axis.max)){s.from=Math.max(s.from,s.axis.min),s.to=Math.min(s.to,s.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max);var u=s.from===s.to,c=l.from===l.to;if(!u||!c)if(s.from=Math.floor(s.axis.p2c(s.from)),s.to=Math.floor(s.axis.p2c(s.to)),l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),u||c){var f=o.lineWidth||tt.grid.markingsLineWidth,d=f%2?.5:0;it.beginPath(),it.strokeStyle=o.color||tt.grid.markingsColor,it.lineWidth=f,u?(it.moveTo(s.to+d,l.from),it.lineTo(s.to+d,l.to)):(it.moveTo(s.from,l.to+d),it.lineTo(s.to,l.to+d)),it.stroke()}else it.fillStyle=o.color||tt.grid.markingsColor,it.fillRect(s.from,l.to,s.to-s.from,l.from-l.to)}}n=h(),r=tt.grid.borderWidth;for(var p=0;p<n.length;++p){var m,g,v,y,b=n[p],x=b.box,_=b.tickLength;if(b.show&&0!=b.ticks.length){for(it.lineWidth=1,"x"==b.direction?(m=0,g="full"==_?"top"==b.position?0:ct:x.top-lt.top+("top"==b.position?x.height:0)):(g=0,m="full"==_?"left"==b.position?0:ut:x.left-lt.left+("left"==b.position?x.width:0)),b.innermost||(it.strokeStyle=b.options.color,it.beginPath(),v=y=0,"x"==b.direction?v=ut+1:y=ct+1,1==it.lineWidth&&("x"==b.direction?g=Math.floor(g)+.5:m=Math.floor(m)+.5),it.moveTo(m,g),it.lineTo(m+v,g+y),it.stroke()),it.strokeStyle=b.options.tickColor,it.beginPath(),e=0;e<b.ticks.length;++e){var w=b.ticks[e].v;v=y=0,isNaN(w)||w<b.min||w>b.max||"full"==_&&("object"==typeof r&&r[b.position]>0||r>0)&&(w==b.min||w==b.max)||("x"==b.direction?(m=b.p2c(w),y="full"==_?-ct:_,"top"==b.position&&(y=-y)):(g=b.p2c(w),v="full"==_?-ut:_,"left"==b.position&&(v=-v)),1==it.lineWidth&&("x"==b.direction?m=Math.floor(m)+.5:g=Math.floor(g)+.5),it.moveTo(m,g),it.lineTo(m+v,g+y))}it.stroke()}}r&&(i=tt.grid.borderColor,"object"==typeof r||"object"==typeof i?("object"!=typeof r&&(r={top:r,right:r,bottom:r,left:r}),"object"!=typeof i&&(i={top:i,right:i,bottom:i,left:i}),r.top>0&&(it.strokeStyle=i.top,it.lineWidth=r.top,it.beginPath(),it.moveTo(0-r.left,0-r.top/2),it.lineTo(ut,0-r.top/2),it.stroke()),r.right>0&&(it.strokeStyle=i.right,it.lineWidth=r.right,it.beginPath(),it.moveTo(ut+r.right/2,0-r.top),it.lineTo(ut+r.right/2,ct),it.stroke()),r.bottom>0&&(it.strokeStyle=i.bottom,it.lineWidth=r.bottom,it.beginPath(),it.moveTo(ut+r.right,ct+r.bottom/2),it.lineTo(0,ct+r.bottom/2),it.stroke()),r.left>0&&(it.strokeStyle=i.left,it.lineWidth=r.left,it.beginPath(),it.moveTo(0-r.left/2,ct+r.bottom),it.lineTo(0-r.left/2,0),it.stroke())):(it.lineWidth=r,it.strokeStyle=tt.grid.borderColor,it.strokeRect(-r/2,-r/2,ut+r,ct+r))),it.restore()}function D(){t.each(h(),function(t,e){var n,r,i,a,o,s=e.box,l=e.direction+"Axis "+e.direction+e.n+"Axis",u="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+l,c=e.options.font||"flot-tick-label tickLabel";if(et.removeText(u),e.show&&0!=e.ticks.length)for(var h=0;h<e.ticks.length;++h)n=e.ticks[h],!n.label||n.v<e.min||n.v>e.max||("x"==e.direction?(a="center",r=lt.left+e.p2c(n.v),"bottom"==e.position?i=s.top+s.padding+s.eventSectionPadding:(i=s.top+s.height-s.padding,o="bottom")):(o="middle",i=lt.top+e.p2c(n.v),"left"==e.position?(r=s.left+s.width-s.padding,a="right"):r=s.left+s.padding),et.addText(u,r,i,n.label,c,null,null,a,o))})}function $(t){t.lines.show&&I(t),t.bars.show&&N(t),t.points.show&&R(t)}function I(t){function e(t,e,n,r,i){var a=t.points,o=t.pointsize,s=null,l=null;it.beginPath();for(var u=o;u<a.length;u+=o){var c=a[u-o],h=a[u-o+1],f=a[u],d=a[u+1];if(null!=c&&null!=f){if(h<=d&&h<i.min){if(d<i.min)continue;c=(i.min-h)/(d-h)*(f-c)+c,h=i.min}else if(d<=h&&d<i.min){if(h<i.min)continue;f=(i.min-h)/(d-h)*(f-c)+c,d=i.min}if(h>=d&&h>i.max){if(d>i.max)continue;c=(i.max-h)/(d-h)*(f-c)+c,h=i.max}else if(d>=h&&d>i.max){if(h>i.max)continue;f=(i.max-h)/(d-h)*(f-c)+c,d=i.max}if(c<=f&&c<r.min){if(f<r.min)continue;h=(r.min-c)/(f-c)*(d-h)+h,c=r.min}else if(f<=c&&f<r.min){if(c<r.min)continue;d=(r.min-c)/(f-c)*(d-h)+h,f=r.min}if(c>=f&&c>r.max){if(f>r.max)continue;h=(r.max-c)/(f-c)*(d-h)+h,c=r.max}else if(f>=c&&f>r.max){if(c>r.max)continue;d=(r.max-c)/(f-c)*(d-h)+h,f=r.max}c==s&&h==l||it.moveTo(r.p2c(c)+e,i.p2c(h)+n),s=f,l=d,it.lineTo(r.p2c(f)+e,i.p2c(d)+n)}}it.stroke()}it.save(),it.translate(lt.left,lt.top),it.lineJoin="round";var n=t.lines.lineWidth,r=t.shadowSize;if(n>0&&r>0){it.lineWidth=r,it.strokeStyle="rgba(0,0,0,0.1)";var i=Math.PI/18;e(t.datapoints,Math.sin(i)*(n/2+r/2),Math.cos(i)*(n/2+r/2),t.xaxis,t.yaxis),it.lineWidth=r/2,e(t.datapoints,Math.sin(i)*(n/2+r/4),Math.cos(i)*(n/2+r/4),t.xaxis,t.yaxis)}it.lineWidth=n,it.strokeStyle=t.color;var a=q(t.lines,t.color,0,ct);a&&(it.fillStyle=a,function(t,e,n){for(var r=t.points,i=t.pointsize,a=Math.min(Math.max(0,n.min),n.max),o=0,s=!1,l=1,u=0,c=0;!(i>0&&o>r.length+i);){o+=i;var h=r[o-i],f=r[o-i+l],d=r[o],p=r[o+l];if(s){if(i>0&&null!=h&&null==d){c=o,i=-i,l=2;continue}if(i<0&&o==u+i){it.fill(),s=!1,i=-i,l=1,o=u=c+i;continue}}if(null!=h&&null!=d){if(h<=d&&h<e.min){if(d<e.min)continue;f=(e.min-h)/(d-h)*(p-f)+f,h=e.min}else if(d<=h&&d<e.min){if(h<e.min)continue;p=(e.min-h)/(d-h)*(p-f)+f,d=e.min}if(h>=d&&h>e.max){if(d>e.max)continue;f=(e.max-h)/(d-h)*(p-f)+f,h=e.max}else if(d>=h&&d>e.max){if(h>e.max)continue;p=(e.max-h)/(d-h)*(p-f)+f,d=e.max}if(s||(it.beginPath(),it.moveTo(e.p2c(h),n.p2c(a)),s=!0),f>=n.max&&p>=n.max)it.lineTo(e.p2c(h),n.p2c(n.max)),it.lineTo(e.p2c(d),n.p2c(n.max));else if(f<=n.min&&p<=n.min)it.lineTo(e.p2c(h),n.p2c(n.min)),it.lineTo(e.p2c(d),n.p2c(n.min));else{var m=h,g=d;f<=p&&f<n.min&&p>=n.min?(h=(n.min-f)/(p-f)*(d-h)+h,f=n.min):p<=f&&p<n.min&&f>=n.min&&(d=(n.min-f)/(p-f)*(d-h)+h,p=n.min),f>=p&&f>n.max&&p<=n.max?(h=(n.max-f)/(p-f)*(d-h)+h,f=n.max):p>=f&&p>n.max&&f<=n.max&&(d=(n.max-f)/(p-f)*(d-h)+h,p=n.max),h!=m&&it.lineTo(e.p2c(m),n.p2c(f)),it.lineTo(e.p2c(h),n.p2c(f)),it.lineTo(e.p2c(d),n.p2c(p)),d!=g&&(it.lineTo(e.p2c(d),n.p2c(p)),it.lineTo(e.p2c(g),n.p2c(p)))}}}}(t.datapoints,t.xaxis,t.yaxis)),n>0&&e(t.datapoints,0,0,t.xaxis,t.yaxis),it.restore()}function R(t){function e(t,e,n,r,i,a,o,s){for(var l=t.points,u=t.pointsize,c=0;c<l.length;c+=u){var h=l[c],f=l[c+1];null==h||h<a.min||h>a.max||f<o.min||f>o.max||(it.beginPath(),h=a.p2c(h),f=o.p2c(f)+r,"circle"==s?it.arc(h,f,e,0,i?Math.PI:2*Math.PI,!1):s(it,h,f,e,i),it.closePath(),n&&(it.fillStyle=n,it.fill()),it.stroke())}}it.save(),it.translate(lt.left,lt.top);var n=t.points.lineWidth,r=t.shadowSize,i=t.points.radius,a=t.points.symbol;if(0==n&&(n=1e-4),n>0&&r>0){var o=r/2;it.lineWidth=o,it.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,i,null,o+o/2,!0,t.xaxis,t.yaxis,a),it.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,i,null,o/2,!0,t.xaxis,t.yaxis,a)}it.lineWidth=n,it.strokeStyle=t.color,e(t.datapoints,i,q(t.points,t.color),0,!1,t.xaxis,t.yaxis,a),it.restore()}function F(t,e,n,r,i,a,o,s,l,u,c){var h,f,d,p,m,g,v,y,b;u?(y=g=v=!0,m=!1,h=n,f=t,p=e+r,d=e+i,f<h&&(b=f,f=h,h=b,m=!0,g=!1)):(m=g=v=!0,y=!1,h=t+r,f=t+i,d=n,(p=e)<d&&(b=p,p=d,d=b,y=!0,v=!1)),f<o.min||h>o.max||p<s.min||d>s.max||(h<o.min&&(h=o.min,m=!1),f>o.max&&(f=o.max,g=!1),d<s.min&&(d=s.min,y=!1),p>s.max&&(p=s.max,v=!1),h=o.p2c(h),d=s.p2c(d),f=o.p2c(f),p=s.p2c(p),a&&(l.fillStyle=a(d,p),l.fillRect(h,p,f-h,d-p)),c>0&&(m||g||v||y)&&(l.beginPath(),l.moveTo(h,d),m?l.lineTo(h,p):l.moveTo(h,p),v?l.lineTo(f,p):l.moveTo(f,p),g?l.lineTo(f,d):l.moveTo(f,d),y?l.lineTo(h,d):l.moveTo(h,d),l.stroke()))}function N(t){it.save(),it.translate(lt.left,lt.top),it.lineWidth=t.bars.lineWidth,it.strokeStyle=t.color;var e;switch(t.bars.align){case"left":e=0;break;case"right":e=-t.bars.barWidth;break;default:e=-t.bars.barWidth/2}var n=t.bars.fill?function(e,n){return q(t.bars,t.color,e,n)}:null;!function(e,n,r,i,a,o){for(var s=e.points,l=e.pointsize,u=0;u<s.length;u+=l)null!=s[u]&&F(s[u],s[u+1],s[u+2],n,r,i,a,o,it,t.bars.horizontal,t.bars.lineWidth)}(t.datapoints,e,e+t.bars.barWidth,n,t.xaxis,t.yaxis),it.restore()}function q(e,n,r,i){var a=e.fill;if(!a)return null;if(e.fillColor)return J(e.fillColor,r,i,n);var o=t.color.parse(n);return o.a="number"==typeof a?a:.4,o.normalize(),o.toString()}function j(){if(null!=tt.legend.container?t(tt.legend.container).html(""):n.find(".legend").remove(),tt.legend.show){for(var e,r,i=[],a=[],o=!1,s=tt.legend.labelFormatter,l=0;l<Z.length;++l)e=Z[l],e.label&&(r=s?s(e.label,e):e.label)&&a.push({label:r,color:e.color});if(tt.legend.sorted)if(t.isFunction(tt.legend.sorted))a.sort(tt.legend.sorted);else if("reverse"==tt.legend.sorted)a.reverse();else{var u="descending"!=tt.legend.sorted;a.sort(function(t,e){return t.label==e.label?0:t.label<e.label!=u?1:-1})}for(var l=0;l<a.length;++l){var c=a[l];l%tt.legend.noColumns==0&&(o&&i.push("</tr>"),i.push("<tr>"),o=!0),i.push('<td class="legendColorBox"><div style="border:1px solid '+tt.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+c.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+c.label+"</td>")}if(o&&i.push("</tr>"),0!=i.length){var h='<table style="font-size:smaller;color:'+tt.grid.color+'">'+i.join("")+"</table>";if(null!=tt.legend.container)t(tt.legend.container).html(h);else{var f="",d=tt.legend.position,p=tt.legend.margin;null==p[0]&&(p=[p,p]),"n"==d.charAt(0)?f+="top:"+(p[1]+lt.top)+"px;":"s"==d.charAt(0)&&(f+="bottom:"+(p[1]+lt.bottom)+"px;"),"e"==d.charAt(1)?f+="right:"+(p[0]+lt.right)+"px;":"w"==d.charAt(1)&&(f+="left:"+(p[0]+lt.left)+"px;");var m=t('<div class="legend">'+h.replace('style="','style="position:absolute;'+f+";")+"</div>").appendTo(n);if(0!=tt.legend.backgroundOpacity){var g=tt.legend.backgroundColor;null==g&&(g=tt.grid.backgroundColor,g=g&&"string"==typeof g?t.color.parse(g):t.color.extract(m,"background-color"),g.a=1,g=g.toString());var v=m.children();t('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+f+"background-color:"+g+';"> </div>').prependTo(m).css("opacity",tt.legend.backgroundOpacity)}}}}}function L(t,e,n){var r,i,a,o=tt.grid.mouseActiveRadius,s=o*o+1,l=null;for(r=Z.length-1;r>=0;--r)if(n(Z[r])){var u=Z[r],c=u.xaxis,h=u.yaxis,f=u.datapoints.points,d=c.c2p(t),p=h.c2p(e),m=o/c.scale,g=o/h.scale;if(a=u.datapoints.pointsize,c.options.inverseTransform&&(m=Number.MAX_VALUE),h.options.inverseTransform&&(g=Number.MAX_VALUE),u.lines.show||u.points.show)for(i=0;i<f.length;i+=a){var v=f[i],y=f[i+1];if(null!=v&&!(v-d>m||v-d<-m||y-p>g||y-p<-g)){var b=Math.abs(c.p2c(v)-t),x=Math.abs(h.p2c(y)-e),_=b*b+x*x;_<s&&(s=_,l=[r,i/a])}}if(u.bars.show&&!l){var w,S;switch(u.bars.align){case"left":w=0;break;case"right":w=-u.bars.barWidth;break;default:w=-u.bars.barWidth/2}for(S=w+u.bars.barWidth,i=0;i<f.length;i+=a){var v=f[i],y=f[i+1],k=f[i+2];null!=v&&((Z[r].bars.horizontal?d<=Math.max(k,v)&&d>=Math.min(k,v)&&p>=y+w&&p<=y+S:d>=v+w&&d<=v+S&&p>=Math.min(k,y)&&p<=Math.max(k,y))&&(l=[r,i/a]))}}}return l?(r=l[0],i=l[1],a=Z[r].datapoints.pointsize,{datapoint:Z[r].datapoints.points.slice(i*a,(i+1)*a),dataIndex:i,series:Z[r],seriesIndex:r}):null}function U(t){tt.grid.hoverable&&B("plothover",t,function(t){return 0!=t.hoverable})}function z(t){tt.grid.hoverable&&B("plothover",t,function(t){return!1})}function V(t){B("plotclick",t,function(t){return 0!=t.clickable})}function B(t,e,r){var i=rt.offset(),a=e.pageX-i.left-lt.left,o=e.pageY-i.top-lt.top,s=f({left:a,top:o});s.pageX=e.pageX,s.pageY=e.pageY,s.ctrlKey=e.ctrlKey,s.metaKey=e.metaKey;var l=L(a,o,r);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+i.left+lt.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+i.top+lt.top,10)),tt.grid.autoHighlight){for(var u=0;u<dt.length;++u){var c=dt[u];c.auto!=t||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||W(c.series,c.point)}l&&Q(l.series,l.datapoint,t)}n.trigger(t,[s,l])}function Y(){var t=tt.interaction.redrawOverlayInterval;if(-1==t)return void H();pt||(pt=setTimeout(H,t))}function H(){pt=null,at.save(),nt.clear(),at.translate(lt.left,lt.top);var t,e;for(t=0;t<dt.length;++t)e=dt[t],e.series.bars.show?X(e.series,e.point):K(e.series,e.point);at.restore(),s(ht.drawOverlay,[at])}function Q(t,e,n){if("number"==typeof t&&(t=Z[t]),"number"==typeof e){var r=t.datapoints.pointsize;e=t.datapoints.points.slice(r*e,r*(e+1))}var i=G(t,e);-1==i?(dt.push({series:t,point:e,auto:n}),Y()):n||(dt[i].auto=!1)}function W(t,e){if(null==t&&null==e)return dt=[],void Y();if("number"==typeof t&&(t=Z[t]),"number"==typeof e){var n=t.datapoints.pointsize;e=t.datapoints.points.slice(n*e,n*(e+1))}var r=G(t,e);-1!=r&&(dt.splice(r,1),Y())}function G(t,e){for(var n=0;n<dt.length;++n){var r=dt[n];if(r.series==t&&r.point[0]==e[0]&&r.point[1]==e[1])return n}return-1}function K(e,n){var r=n[0],i=n[1],a=e.xaxis,o=e.yaxis,s="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString();if(!(r<a.min||r>a.max||i<o.min||i>o.max)){var l=e.points.radius+e.points.lineWidth/2;at.lineWidth=l,at.strokeStyle=s;var u=1.5*l;r=a.p2c(r),i=o.p2c(i),at.beginPath(),"circle"==e.points.symbol?at.arc(r,i,u,0,2*Math.PI,!1):e.points.symbol(at,r,i,u,!1),at.closePath(),at.stroke()}}function X(e,n){var r,i="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString(),a=i;switch(e.bars.align){case"left":r=0;break;case"right":r=-e.bars.barWidth;break;default:r=-e.bars.barWidth/2}at.lineWidth=e.bars.lineWidth,at.strokeStyle=i,F(n[0],n[1],n[2]||0,r,r+e.bars.barWidth,function(){return a},e.xaxis,e.yaxis,at,e.bars.horizontal,e.bars.lineWidth)}function J(e,n,r,i){if("string"==typeof e)return e;for(var a=it.createLinearGradient(0,r,0,n),o=0,s=e.colors.length;o<s;++o){var l=e.colors[o];if("string"!=typeof l){var u=t.color.parse(i);null!=l.brightness&&(u=u.scale("rgb",l.brightness)),null!=l.opacity&&(u.a*=l.opacity),l=u.toString()}a.addColorStop(o/(s-1),l)}return a}var Z=[],tt={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},et=null,nt=null,rt=null,it=null,at=null,ot=[],st=[],lt={left:0,right:0,top:0,bottom:0},ut=0,ct=0,ht={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},ft=this;ft.setData=l,ft.setupGrid=S,ft.draw=A,ft.getPlaceholder=function(){return n},ft.getCanvas=function(){return et.element},ft.getPlotOffset=function(){return lt},ft.width=function(){return ut},ft.height=function(){return ct},ft.offset=function(){var t=rt.offset();return t.left+=lt.left,t.top+=lt.top,t},ft.getData=function(){return Z},ft.getAxes=function(){var e={};return t.each(ot.concat(st),function(t,n){n&&(e[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),e},ft.getXAxes=function(){return ot},ft.getYAxes=function(){return st},ft.c2p=f,ft.p2c=d,ft.getOptions=function(){return tt},ft.highlight=Q,ft.unhighlight=W,ft.triggerRedrawOverlay=Y,ft.pointOffset=function(t){return{left:parseInt(ot[c(t,"x")-1].p2c(+t.x)+lt.left,10),top:parseInt(st[c(t,"y")-1].p2c(+t.y)+lt.top,10)}},ft.shutdown=v,ft.destroy=function(){v(),n.removeData("plot").empty(),Z=[],tt=null,et=null,nt=null,rt=null,it=null,at=null,ot=[],st=[],ht=null,dt=[],ft=null},ft.resize=function(){var t=n.width(),e=n.height();et.resize(t,e),nt.resize(t,e)},ft.hooks=ht,function(){for(var n={Canvas:e},r=0;r<o.length;++r){var i=o[r];i.init(ft,n),i.options&&t.extend(!0,tt,i.options)}}(),function(e){t.extend(!0,tt,e),e&&e.colors&&(tt.colors=e.colors),null==tt.xaxis.color&&(tt.xaxis.color=t.color.parse(tt.grid.color).scale("a",.22).toString()),null==tt.yaxis.color&&(tt.yaxis.color=t.color.parse(tt.grid.color).scale("a",.22).toString()),null==tt.xaxis.tickColor&&(tt.xaxis.tickColor=tt.grid.tickColor||tt.xaxis.color),null==tt.yaxis.tickColor&&(tt.yaxis.tickColor=tt.grid.tickColor||tt.yaxis.color),null==tt.grid.borderColor&&(tt.grid.borderColor=tt.grid.color),null==tt.grid.tickColor&&(tt.grid.tickColor=t.color.parse(tt.grid.color).scale("a",.22).toString());var r,i,a,o=n.css("font-size"),l=o?+o.replace("px",""):13,u={style:n.css("font-style"),size:Math.round(.8*l),variant:n.css("font-variant"),weight:n.css("font-weight"),family:n.css("font-family")};for(a=tt.xaxes.length||1,r=0;r<a;++r)i=tt.xaxes[r],i&&!i.tickColor&&(i.tickColor=i.color),i=t.extend(!0,{},tt.xaxis,i),tt.xaxes[r]=i,i.font&&(i.font=t.extend({},u,i.font),i.font.color||(i.font.color=i.color),i.font.lineHeight||(i.font.lineHeight=Math.round(1.15*i.font.size)));for(a=tt.yaxes.length||1,r=0;r<a;++r)i=tt.yaxes[r],i&&!i.tickColor&&(i.tickColor=i.color),i=t.extend(!0,{},tt.yaxis,i),tt.yaxes[r]=i,i.font&&(i.font=t.extend({},u,i.font),i.font.color||(i.font.color=i.color),i.font.lineHeight||(i.font.lineHeight=Math.round(1.15*i.font.size)));for(tt.xaxis.noTicks&&null==tt.xaxis.ticks&&(tt.xaxis.ticks=tt.xaxis.noTicks),tt.yaxis.noTicks&&null==tt.yaxis.ticks&&(tt.yaxis.ticks=tt.yaxis.noTicks),tt.x2axis&&(tt.xaxes[1]=t.extend(!0,{},tt.xaxis,tt.x2axis),tt.xaxes[1].position="top",null==tt.x2axis.min&&(tt.xaxes[1].min=null),null==tt.x2axis.max&&(tt.xaxes[1].max=null)),tt.y2axis&&(tt.yaxes[1]=t.extend(!0,{},tt.yaxis,tt.y2axis),tt.yaxes[1].position="right",null==tt.y2axis.min&&(tt.yaxes[1].min=null),null==tt.y2axis.max&&(tt.yaxes[1].max=null)),tt.grid.coloredAreas&&(tt.grid.markings=tt.grid.coloredAreas),tt.grid.coloredAreasColor&&(tt.grid.markingsColor=tt.grid.coloredAreasColor),tt.lines&&t.extend(!0,tt.series.lines,tt.lines),tt.points&&t.extend(!0,tt.series.points,tt.points),tt.bars&&t.extend(!0,tt.series.bars,tt.bars),null!=tt.shadowSize&&(tt.series.shadowSize=tt.shadowSize),null!=tt.highlightColor&&(tt.series.highlightColor=tt.highlightColor),r=0;r<tt.xaxes.length;++r)p(ot,r+1).options=tt.xaxes[r];for(r=0;r<tt.yaxes.length;++r)p(st,r+1).options=tt.yaxes[r];for(var c in ht)tt.hooks[c]&&tt.hooks[c].length&&(ht[c]=ht[c].concat(tt.hooks[c]));s(ht.processOptions,[tt])}(a),function(){n.find(".flot-temp-elem").remove(),"static"==n.css("position")&&n.css("position","relative"),et=new e("flot-base",n),nt=new e("flot-overlay",n),it=et.context,at=nt.context,rt=t(nt.element).unbind();var r=n.data("plot");r&&(r.shutdown(),nt.clear()),n.data("plot",ft)}(),l(i),S(),A(),function(){tt.grid.hoverable&&(rt.mousemove(U),rt.bind("mouseleave",z)),tt.grid.clickable&&rt.click(V),s(ht.bindEvents,[rt])}();var dt=[],pt=null}function r(t,e){return e*Math.floor(t/e)}var i=Object.prototype.hasOwnProperty;t.fn.detach||(t.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),e.prototype.resize=function(t,e){if(t<=0||e<=0)throw new Error("Invalid dimensions for plot, width = "+t+", height = "+e);var n=this.element,r=this.context,i=this.pixelRatio;this.width!=t&&(n.width=t*i,n.style.width=t+"px",this.width=t),this.height!=e&&(n.height=e*i,n.style.height=e+"px",this.height=e),r.restore(),r.save(),r.scale(i,i)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var t=this._textCache;for(var e in t)if(i.call(t,e)){var n=this.getTextLayer(e),r=t[e];n.hide();for(var a in r)if(i.call(r,a)){var o=r[a];for(var s in o)if(i.call(o,s)){for(var l,u=o[s].positions,c=0;l=u[c];c++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(u.splice(c--,1),l.rendered&&l.element.detach());0==u.length&&delete o[s]}}n.show()}},e.prototype.getTextLayer=function(e){var n=this.text[e];return null==n&&(null==this.textContainer&&(this.textContainer=t("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[e]=t("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},e.prototype.getTextInfo=function(e,n,r,i,a){var o,s,l,u;if(n=""+n,o="object"==typeof r?r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:r,s=this._textCache[e],null==s&&(s=this._textCache[e]={}),l=s[o],null==l&&(l=s[o]={}),null==(u=l[n])){var c=t("<div></div>").html(n).css({position:"absolute","max-width":a,top:-9999}).appendTo(this.getTextLayer(e));"object"==typeof r?c.css({font:o,color:r.color}):"string"==typeof r&&c.addClass(r),u=l[n]={element:c,positions:[]};var h=this._textSizeCache[n];h?(u.width=h.width,u.height=h.height):(u.width=c.outerWidth(!0),u.height=c.outerHeight(!0),this._textSizeCache[n]={width:u.width,height:u.height}),c.detach()}return u},e.prototype.addText=function(t,e,n,r,i,a,o,s,l){var u=this.getTextInfo(t,r,i,a,o),c=u.positions;"center"==s?e-=u.width/2:"right"==s&&(e-=u.width),"middle"==l?n-=u.height/2:"bottom"==l&&(n-=u.height);for(var h,f=0;h=c[f];f++)if(h.x==e&&h.y==n)return void(h.active=!0);h={active:!0,rendered:!1,element:c.length?u.element.clone():u.element,x:e,y:n},c.push(h),h.element.css({top:Math.round(n),left:Math.round(e),"text-align":s})},e.prototype.removeText=function(t,e,n,r,a,o){if(null==r){var s=this._textCache[t];if(null!=s)for(var l in s)if(i.call(s,l)){var u=s[l];for(var c in u)if(i.call(u,c))for(var h,f=u[c].positions,d=0;h=f[d];d++)h.active=!1}}else for(var h,f=this.getTextInfo(t,r,a,o).positions,d=0;h=f[d];d++)h.x==e&&h.y==n&&(h.active=!1)},t.plot=function(e,r,i){return new n(t(e),r,i,t.plot.plugins)},t.plot.version="0.8.3",t.plot.plugins=[],t.fn.plot=function(e,n){return this.each(function(){t.plot(this,e,n)})}}(jQuery)},function(t,e,n){var r=Object.assign({},n(833),n(990));t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ImpressionsStore",function(){return u}),n.d(e,"impressions",function(){return c});var r=n(115),i=n.n(r),a=n(4),o=n.n(a),s=n(21),l=n.n(s),u=function(){function t(){}return t.prototype.addDashboardImpression=function(t){var e=this.impressionKey(l.a),n=[];i.a.exists(e)&&(n=JSON.parse(i.a.get(e)),o.a.isArray(n)||(n=[])),n=n.filter(function(e){return t!==e}),n.unshift(t),n.length>50&&n.pop(),i.a.set(e,JSON.stringify(n))},t.prototype.getDashboardOpened=function(){var t=i.a.get(this.impressionKey(l.a))||"[]";return t=JSON.parse(t),t=o.a.filter(t,function(t){return o.a.isNumber(t)})},t.prototype.impressionKey=function(t){return"dashboard_impressions-"+t.bootData.user.orgId},t}(),c=new u},function(t,e,n){"use strict";function r(t,e){s.a.registerDynamic(t,[],!0,function(t,n,r){r.exports=e})}function i(t){var e=A.a[t];return e?Promise.resolve(e):s.a.import(t)}function a(t){x.a.bootData.user.lightTheme?s.a.import(t.light+"!css"):s.a.import(t.dark+"!css")}Object.defineProperty(e,"__esModule",{value:!0}),e.importPluginModule=i,e.loadPluginCss=a;var o=n(911),s=n.n(o),l=n(4),u=n.n(l),c=n(797),h=n(109),f=n.n(h),d=n(1),p=n.n(d),m=n(8),g=n.n(m),v=n(10),y=n.n(v),b=n(21),x=n.n(b),_=n(801),w=n(802),S=n(290),k=n(292),M=n(815),T=n(820),C=n(805),A=n(922),P=n(807),E=n.n(P),O=n(291),D=(n.n(O),n(1008)),$=(n.n(D),n(1011)),I=(n.n($),n(1013)),R=(n.n(I),n(1022)),F=(n.n(R),n(1024)),N=(n.n(F),n(806)),q=(n.n(N),n(826)),j=(n.n(q),n(827)),L=(n.n(j),n(828)),U=(n.n(L),n(1030)),z=(n.n(U),n(829)),V=(n.n(z),n(830)),B=(n.n(V),n(831)),Y=(n.n(B),n(832));n.n(Y);s.a.config({baseURL:"public",defaultExtension:"js",packages:{plugins:{defaultExtension:"js"}},map:{text:"vendor/plugin-text/text.js",css:"vendor/plugin-css/css.js"}});var H=s.a.locate;s.a.cacheBust="?bust="+Date.now(),s.a.locate=function(t){var e=this;return Promise.resolve(H.call(this,t)).then(function(t){return t+e.cacheBust})},r("lodash",u.a),r("moment",p.a),r("jquery",y.a),r("angular",g.a),r("rxjs/Subject",D.Subject),r("rxjs/Observable",O.Observable),r("d3",E.a),r("app/plugins/sdk",c),r("app/core/utils/datemath",k),r("app/core/utils/file_export",M),r("app/core/utils/flatten",T),r("app/core/utils/kbn",f.a),r("app/core/utils/ticks",C),r("app/core/config",x.a),r("app/core/time_series",_.default),r("app/core/time_series2",_.default),r("app/core/table_model",w.default),r("app/core/app_events",S.appEvents),r("app/core/core_module",S.coreModule),r("app/core/core",{coreModule:S.coreModule,appEvents:S.appEvents,contextSrv:S.contextSrv,__esModule:!0});for(var Q=["jquery.flot","jquery.flot.pie","jquery.flot.time","jquery.flot.fillbelow","jquery.flot.crosshair","jquery.flot.stack","jquery.flot.selection","jquery.flot.stackpercent","jquery.flot.events"],W=0,G=Q;W<G.length;W++){r(G[W],{fakeDep:1})}},function(t,e,n){"use strict";function r(t){for(var e={},n=0,r=t;n<r.length;n++){var i=r[n],a=Number(i.alias);if(isNaN(a))return e;for(var o=0,s=i.datapoints;o<s.length;o++){var l=s[o],u=l[w],c=l[S];if(_.a.isNumber(u)){var h=e[c];h||(h=e[c]={x:c,buckets:{}}),h.buckets[a]={y:a,count:u,values:[],points:[]}}}}return e}function i(t){var e=0,n=0,r=[];return _.a.forEach(t,function(t){_.a.forEach(t.buckets,function(i){var a={x:t.x,y:i.y,yBounds:i.bounds,values:i.values,count:i.count};r.push(a),1===r.length&&(e=i.count,n=i.count),e=i.count<e?i.count:e,n=i.count>n?i.count:n})}),{cards:r,cardStats:{min:e,max:n}}}function a(t,e){return _.a.forEach(t,function(t){var n=t.buckets,r={bounds:{bottom:0,top:0},values:[],points:[],count:0},i=n[0]||r,a=n[e]||r,o={y:0,bounds:{bottom:e,top:a.bounds.top||e},values:[],points:[],count:0};o.points=i.points.concat(a.points),o.values=i.values.concat(a.values),o.count=o.values.length,0!==o.count&&(delete n[e],n[0]=o)}),t}function o(t,e,n,r){void 0===r&&(r=1);for(var i={},a=0,o=t;a<o.length;a++){var l=o[a];!function(t){var e=t.datapoints,r=t.label;_.a.forEach(e,function(t){var e=h(t[S],n);s(i,t,e,r)})}(l)}return _.a.forEach(i,function(t){t.buckets=1!==r?m(t,e,r):f(t,e)}),i}function s(t,e,n,r){var i=e[w];if(null!==i&&void 0!==i&&!isNaN(i)){var a=_.a.concat(e,r);t[n]&&t[n].values?(t[n].values.push(i),t[n].points.push(a)):t[n]={x:n,values:[i],points:[a]}}}function l(t,e,n,r,i){var a=1;r.length>3&&(a=parseInt(r[2])),t[e]?(t[e].values.push(n),t[e].points.push(r),t[e].count+=a):t[e]={y:e,bounds:i,values:[n],points:[r],count:a}}function u(t,e,n){return 1===n?h(t,e):p(t,e,n)}function c(t,e){var n,r;return n=Math.floor(t/e)*e,r=(Math.floor(t/e)+1)*e,{bottom:n,top:r}}function h(t,e){return c(t,e).bottom}function f(t,e){var n=t.values,r=t.points,i={};return _.a.forEach(n,function(t,n){var a=c(t,e),o=a.bottom;l(i,o,t,r[n],a)}),i}function d(t,e,n){var r,i;if(0===t)return{bottom:0,top:0};var a,o,s=v(t,n);if(1!==e&&e){var l=1/e,u=s-Math.floor(s);u=Math.floor(u/l)*l,a=Math.floor(s)+u,o=a+l}else a=Math.floor(s),o=a+1;return i=Math.pow(n,a),r=Math.pow(n,o),{bottom:i,top:r}}function p(t,e,n){return d(t,e,n).bottom}function m(t,e,n){var r=t.values,i=t.points,a={};return _.a.forEach(r,function(t,r){var o=d(t,e,n),s=o.bottom;l(a,s,t,i[r],o)}),a}function g(t){var e=_.a.compact(_.a.map(t.datapoints,function(t){return t[0]}));return _.a.min(e)}function v(t,e){return Math.log(t)/Math.log(e)}function y(t,e){void 0===e&&(e=1);var n=1/0;if(0===t.length)return 0;if(1===t.length)return t[0];t=_.a.sortBy(t);for(var r=1;r<t.length;r++){var i=b(t[r],t[r-1],e);n=i<n?i:n}return n}function b(t,e,n){return void 0===n&&(n=1),1===n?Math.abs(e-t):v(Math.max(t,e)/Math.min(t,e),n)}n.d(e,"c",function(){return o}),n.d(e,"d",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"g",function(){return a}),n.d(e,"e",function(){return g}),n.d(e,"f",function(){return u}),n.d(e,"a",function(){return y});var x=n(4),_=n.n(x),w=0,S=1},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(291),a=function(t){function e(e){t.call(this),this.scheduler=e}return r(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(i.Observable);e.EmptyObservable=a},function(t,e,n){"use strict";function r(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var n=t.Set;if(n&&"function"==typeof(new n)["@@iterator"])return"@@iterator";var r=t.Map;if(r)for(var i=Object.getOwnPropertyNames(r.prototype),a=0;a<i.length;++a){var o=i[a];if("entries"!==o&&"size"!==o&&r.prototype[o]===r.prototype.entries)return o}return"@@iterator"}var i=n(77);e.symbolIteratorPonyfill=r,e.iterator=r(i.root),e.$$iterator=e.iterator},,function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4),i=n.n(r),a=n(290),o=function(){function t(t){this.model=t,this.defaults={title:"Dashboard Row",panels:[],showTitle:!1,titleSize:"h6",height:250,isNew:!1,repeat:null,repeatRowId:null,repeatIteration:null,collapse:!1},Object(a.assignModelProperties)(this,t,this.defaults),this.events=new a.Emitter,this.updateRowSpan()}return t.prototype.getSaveModel=function(){return this.model={},Object(a.assignModelProperties)(this.model,this,this.defaults),delete this.model.isNew,this.model},t.prototype.updateRowSpan=function(){this.span=0;for(var t=0,e=this.panels;t<e.length;t++){var n=e[t];this.span+=n.span}},t.prototype.panelSpanChanged=function(t){var e=this.span;this.updateRowSpan(),(t||e!==this.span)&&this.events.emit("span-changed")},t.prototype.addPanel=function(t){var e=this.span,n=this.panels.length;12-e-t.span<=0&&(1===n?(this.panels[0].span=6,t.span=6):2===n?(this.panels[0].span=4,this.panels[1].span=4,t.span=4):3===n&&(this.panels[0].span=3,this.panels[1].span=3,this.panels[2].span=3,t.span=3)),this.panels.push(t),this.events.emit("panel-added",t),this.panelSpanChanged()},t.prototype.removePanel=function(t,e){var n=this;if(!1!==e){var r,o;return t.alert&&(r="Panel includes an alert rule, removing panel will also remove alert rule",o="YES"),void a.appEvents.emit("confirm-modal",{title:"Remove Panel",text:"Are you sure you want to remove this panel?",text2:r,icon:"fa-trash",confirmText:o,yesText:"Remove",onConfirm:function(){n.removePanel(t,!1)}})}var s=i.a.indexOf(this.panels,t);this.panels.splice(s,1),this.events.emit("panel-removed",t),this.panelSpanChanged()},t.prototype.movePanel=function(t,e){this.panels.splice(e,0,this.panels.splice(t,1)[0])},t.prototype.destroy=function(){this.events.removeAllListeners()},t.prototype.copyPropertiesFromRowSource=function(t){this.height=t.height,this.title=t.title,this.showTitle=t.showTitle,this.titleSize=t.titleSize},t.prototype.toggleCollapse=function(){this.collapse=!this.collapse},t}()},function(t,e,n){"use strict";function r(t,e,n){void 0===e&&(e=f),void 0===n&&(n=!1);var r=(n?"sep=;\n":"")+"Series;Time;Value\n";l.a.each(t,function(t){l.a.each(t.datapoints,function(n){r+=t.alias+";"+c()(n[1]).format(e)+";"+n[0]+"\n"})}),o(r,"grafana_data_export.csv")}function i(t,e,n){void 0===e&&(e=f),void 0===n&&(n=!1);var r=(n?"sep=;\n":"")+"Time;";l.a.each(t,function(t){r+=t.alias+";"}),r=r.substring(0,r.length-1),r+="\n";var i=[[]],a=1;l.a.each(t,function(t){var n=0;i.push([]),l.a.each(t.datapoints,function(t){i[0][n]=c()(t[1]).format(e),i[a][n]=t[0],n++}),a++});for(var s=0;s<i[0].length;s++){r+=i[0][s]+";";for(var u=1;u<i.length;u++)r+=i[u][s]+";";r=r.substring(0,r.length-1),r+="\n"}o(r,"grafana_data_export.csv")}function a(t,e){void 0===e&&(e=!1);var n=e?"sep=;\n":"";l.a.each(t.columns,function(t){n+=(t.title||t.text)+";"}),n+="\n",l.a.each(t.rows,function(t){l.a.each(t,function(t){n+=t+";"}),n+="\n"}),o(n,"grafana_data_export.csv")}function o(t,e){var n=new Blob([t],{type:"text/csv;charset=utf-8"});Object(h.saveAs)(n,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.exportSeriesListToCsv=r,e.exportSeriesListToCsvColumns=i,e.exportTableDataToCsv=a,e.saveSaveBlob=o;var s=n(4),l=n.n(s),u=n(1),c=n.n(u),h=n(112),f=(n.n(h),"YYYY-MM-DDTHH:mm:ssZ")},function(t,e,n){var r,i;r=[n(8),n(4),n(109)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.services").service("linkSrv",["templateSrv","timeSrv",function(t,r){this.getLinkUrl=function(e){var n=t.replace(e.url||""),i={};if(e.keepTime){var a=r.timeRangeForUrl();i.from=a.from,i.to=a.to}return e.includeVars&&t.fillVariableValuesForUrl(i),this.addParamsToUrl(n,i)},this.addParamsToUrl=function(t,n){var r=[];return e.each(n,function(t,n){null!==t&&(!0===t?r.push(n):e.isArray(t)?e.each(t,function(t){r.push(n+"="+encodeURIComponent(t))}):r.push(n+"="+encodeURIComponent(t)))}),0===r.length?t:this.appendToQueryString(t,r.join("&"))},this.appendToQueryString=function(t,n){if(!e.isUndefined(n)&&null!==n&&""!==n){var r=t.indexOf("?");-1!==r?t.length-r>1&&(t+="&"):t+="?",t+=n}return t},this.getAnchorInfo=function(e){var n={};return n.href=this.getLinkUrl(e),n.title=t.replace(e.title||""),n},this.getPanelLinkAnchorInfo=function(e,i){var a={};if("absolute"===e.type)a.target=e.targetBlank?"_blank":"_self",a.href=t.replace(e.url||"",i),a.title=t.replace(e.title||"",i);else if(e.dashUri)a.href="dashboard/"+e.dashUri+"?",a.title=t.replace(e.title||"",i),a.target=e.targetBlank?"_blank":"";else{a.title=t.replace(e.title||"",i);var o=n.slugifyForUrl(e.dashboard||"");a.href="dashboard/db/"+o+"?"}var s={};if(e.keepTime){var l=r.timeRangeForUrl();s.from=l.from,s.to=l.to}return e.includeVars&&t.fillVariableValuesForUrl(s,i),a.href=this.addParamsToUrl(a.href,s),e.params&&(a.href=this.appendToQueryString(a.href,t.replace(e.params,i))),a}}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(888),i=n(890),a=n(891),o=n(818),s=n(892);n.d(e,"AnnotationsSrv",function(){return r.a}),n.d(e,"eventEditor",function(){return i.a}),n.d(e,"EventManager",function(){return a.a}),n.d(e,"AnnotationEvent",function(){return o.a}),n.d(e,"annotationTooltipDirective",function(){return s.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(){}return t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryCtrl",function(){return a});var r=n(4),i=n.n(r),a=function(){function t(t,e){this.$scope=t,this.$injector=e,this.panel=this.panelCtrl.panel,this.isLastQuery=i.a.indexOf(this.panel.targets,this.target)===this.panel.targets.length-1}return t.prototype.refresh=function(){this.panelCtrl.refresh()},t}()},function(t,e,n){"use strict";function r(t,e){function n(t,s){Object.keys(t).forEach(function(l){var u=t[l],c=e.safe&&Array.isArray(u),h=Object.prototype.toString.call(u),f="[object Object]"===h,d=s?s+r+l:l;if(e.maxDepth||(i=a+1),!c&&f&&Object.keys(u).length&&a<i)return++a,n(u,d);o[d]=u})}e=e||{};var r=e.delimiter||".",i=e.maxDepth||3,a=1,o={};return n(t,null),o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){var r,i;r=[n(4),n(10)],void 0!==(i=function(t,e){"use strict";function n(t){t.params=t.params||[],t.defaultParams=t.defaultParams||[],t.category&&t.category.push(t),o[t.name]=t,o[t.shortName||t.name]=t}function r(t,e){this.def=t,this.params=[],e&&e.withDefaultParams&&(this.params=t.defaultParams.slice(0)),this.updateText()}function i(t,e){return a(e,t.version)||!t.version}function a(t,e){return Number(t)>=Number(e)}var o=[],s={Combine:[],Transform:[],Calculate:[],Filter:[],Special:[]},l=[{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0}];return n({name:"scaleToSeconds",category:s.Transform,params:[{name:"seconds",type:"int"}],defaultParams:[1]}),n({name:"perSecond",category:s.Transform,params:[{name:"max value",type:"int",optional:!0}],defaultParams:[]}),n({name:"holtWintersForecast",category:s.Calculate}),n({name:"holtWintersConfidenceBands",category:s.Calculate,params:[{name:"delta",type:"int"}],defaultParams:[3]}),n({name:"holtWintersAberration",category:s.Calculate,params:[{name:"delta",type:"int"}],defaultParams:[3]}),n({name:"nPercentile",category:s.Calculate,params:[{name:"Nth percentile",type:"int"}],defaultParams:[95]}),n({name:"diffSeries",params:l,defaultParams:["#A"],category:s.Calculate}),n({name:"stddevSeries",params:l,defaultParams:[""],category:s.Calculate}),n({name:"divideSeries",params:l,defaultParams:["#A"],category:s.Calculate}),n({name:"multiplySeries",params:l,defaultParams:["#A"],category:s.Calculate}),n({name:"asPercent",params:l,defaultParams:["#A"],category:s.Calculate}),n({name:"group",params:l,defaultParams:["#A","#B"],category:s.Combine}),n({name:"sumSeries",shortName:"sum",category:s.Combine,params:l,defaultParams:[""]}),n({name:"averageSeries",shortName:"avg",category:s.Combine,params:l,defaultParams:[""]}),n({name:"rangeOfSeries",category:s.Combine}),n({name:"percentileOfSeries",category:s.Combine,params:[{name:"n",type:"int"},{name:"interpolate",type:"boolean",options:["true","false"]}],defaultParams:[95,"false"]}),n({name:"sumSeriesWithWildcards",category:s.Combine,params:[{name:"node",type:"int"},{name:"node",type:"int",optional:!0},{name:"node",type:"int",optional:!0},{name:"node",type:"int",optional:!0}],defaultParams:[3]}),n({name:"maxSeries",shortName:"max",category:s.Combine}),n({name:"minSeries",shortName:"min",category:s.Combine}),n({name:"averageSeriesWithWildcards",category:s.Combine,params:[{name:"node",type:"int"},{name:"node",type:"int",optional:!0}],defaultParams:[3]}),n({name:"alias",category:s.Special,params:[{name:"alias",type:"string"}],defaultParams:["alias"]}),n({name:"aliasSub",category:s.Special,params:[{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:["","\\1"]}),n({name:"stacked",category:s.Special,params:[{name:"stack",type:"string"}],defaultParams:["stacked"]}),n({name:"consolidateBy",category:s.Special,params:[{name:"function",type:"string",options:["sum","average","min","max"]}],defaultParams:["max"]}),n({name:"cumulative",category:s.Special,params:[],defaultParams:[]}),n({name:"groupByNode",category:s.Special,params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"function",type:"string",options:["sum","avg","maxSeries"]}],defaultParams:[3,"sum"]}),n({name:"aliasByNode",category:s.Special,params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:[3]}),n({name:"substr",category:s.Special,params:[{name:"start",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]},{name:"stop",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:[0,0]}),n({name:"sortByName",category:s.Special,params:[{name:"natural",type:"boolean",options:["true","false"],optional:!0}],defaultParams:["false"]}),n({name:"sortByMaxima",category:s.Special}),n({name:"sortByMinima",category:s.Special}),n({name:"sortByTotal",category:s.Special}),n({name:"aliasByMetric",category:s.Special}),n({name:"randomWalk",fake:!0,category:s.Special,params:[{name:"name",type:"string"}],defaultParams:["randomWalk"]}),n({name:"countSeries",category:s.Special}),n({name:"constantLine",category:s.Special,params:[{name:"value",type:"int"}],defaultParams:[10]}),n({name:"cactiStyle",category:s.Special}),n({name:"keepLastValue",category:s.Special,params:[{name:"n",type:"int"}],defaultParams:[100]}),n({name:"changed",category:s.Special,params:[],defaultParams:[]}),n({name:"scale",category:s.Transform,params:[{name:"factor",type:"int"}],defaultParams:[1]}),n({name:"offset",category:s.Transform,params:[{name:"amount",type:"int"}],defaultParams:[10]}),n({name:"transformNull",category:s.Transform,params:[{name:"amount",type:"int"}],defaultParams:[0]}),n({name:"integral",category:s.Transform}),n({name:"derivative",category:s.Transform}),n({name:"nonNegativeDerivative",category:s.Transform,params:[{name:"max value or 0",type:"int",optional:!0}],defaultParams:[""]}),n({name:"timeShift",category:s.Transform,params:[{name:"amount",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"]}),n({name:"timeStack",category:s.Transform,params:[{name:"timeShiftUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]},{name:"timeShiftStart",type:"int"},{name:"timeShiftEnd",type:"int"}],defaultParams:["1d",0,7]}),n({name:"summarize",category:s.Transform,params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]},{name:"alignToFrom",type:"boolean",optional:!0,options:["false","true"]}],defaultParams:["1h","sum","false"]}),n({name:"smartSummarize",category:s.Transform,params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["1h","sum"]}),n({name:"absolute",category:s.Transform}),n({name:"hitcount",category:s.Transform,params:[{name:"interval",type:"string"}],defaultParams:["10s"]}),n({name:"log",category:s.Transform,params:[{name:"base",type:"int"}],defaultParams:["10"]}),n({name:"averageAbove",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),n({name:"averageBelow",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),n({name:"currentAbove",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),n({name:"currentBelow",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),n({name:"maximumAbove",category:s.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),n({name:"maximumBelow",category:s.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),n({name:"minimumAbove",category:s.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),n({name:"minimumBelow",category:s.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),n({name:"limit",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),n({name:"mostDeviant",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[10]}),n({name:"exclude",category:s.Filter,params:[{name:"exclude",type:"string"}],defaultParams:["exclude"]}),n({name:"highestCurrent",category:s.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),n({name:"highestMax",category:s.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),n({name:"lowestCurrent",category:s.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),n({name:"movingAverage",category:s.Filter,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10]}),n({name:"movingMedian",category:s.Filter,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:["5"]}),n({name:"stdev",category:s.Filter,params:[{name:"n",type:"int"},{name:"tolerance",type:"int"}],defaultParams:[5,.1]}),n({name:"highestAverage",category:s.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),n({name:"lowestAverage",category:s.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),n({name:"removeAbovePercentile",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),n({name:"removeAboveValue",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),n({name:"removeBelowPercentile",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),n({name:"removeBelowValue",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),n({name:"useSeriesAbove",category:s.Filter,params:[{name:"value",type:"int"},{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:[0,"search","replace"]}),n({name:"aggregateLine",category:s.Combine,params:[{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["avg"],version:"1.0"}),n({name:"averageOutsidePercentile",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),n({name:"delay",category:s.Transform,params:[{name:"steps",type:"int"}],defaultParams:[1],version:"1.0"}),n({name:"exponentialMovingAverage",category:s.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),n({name:"fallbackSeries",category:s.Special,params:[{name:"fallback",type:"string"}],defaultParams:["constantLine(0)"],version:"1.0"}),n({name:"grep",category:s.Filter,params:[{name:"grep",type:"string"}],defaultParams:["grep"],version:"1.0"}),n({name:"groupByNodes",category:s.Special,params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:["sum",3],version:"1.0"}),n({name:"integralByInterval",category:s.Transform,params:[{name:"intervalUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"],version:"1.0"}),n({name:"interpolate",category:s.Transform,params:[{name:"limit",type:"int",optional:!0}],defaultParams:[],version:"1.0"}),n({name:"invert",category:s.Transform,version:"1.0"}),n({name:"isNonNull",category:s.Combine,version:"1.0"}),n({name:"linearRegression",category:s.Calculate,params:[{name:"startSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0},{name:"endSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:[],version:"1.0"}),n({name:"mapSeries",shortName:"map",params:[{name:"node",type:"int"}],defaultParams:[3],category:s.Combine,version:"1.0"}),n({name:"movingMin",category:s.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),n({name:"movingMax",category:s.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),n({name:"movingSum",category:s.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),n({name:"multiplySeriesWithWildcards",category:s.Calculate,params:[{name:"position",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:[2],version:"1.0"}),n({name:"offsetToZero",category:s.Transform,version:"1.0"}),n({name:"pow",category:s.Transform,params:[{name:"factor",type:"int"}],defaultParams:[10],version:"1.0"}),n({name:"powSeries",category:s.Transform,params:l,defaultParams:[""],version:"1.0"}),n({name:"reduceSeries",shortName:"reduce",params:[{name:"function",type:"string",options:["asPercent","diffSeries","divideSeries"]},{name:"reduceNode",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]},{name:"reduceMatchers",type:"string"},{name:"reduceMatchers",type:"string"}],defaultParams:["asPercent",2,"used_bytes","total_bytes"],category:s.Combine,version:"1.0"}),n({name:"removeBetweenPercentile",category:s.Filter,params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),n({name:"removeEmptySeries",category:s.Filter,version:"1.0"}),n({name:"squareRoot",category:s.Transform,version:"1.0"}),n({name:"timeSlice",category:s.Transform,params:[{name:"startSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"]},{name:"endSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:["-1h"],version:"1.0"}),n({name:"weightedAverage",category:s.Filter,params:[{name:"other",type:"value_or_series",optional:!0},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:["#A",4],version:"1.0"}),n({name:"seriesByTag",category:s.Special,params:[{name:"tagExpression",type:"string"},{name:"tagExpression",type:"string",optional:!0},{name:"tagExpression",type:"string",optional:!0},{name:"tagExpression",type:"string",optional:!0}],version:"1.1"}),n({name:"groupByTags",category:s.Special,params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"tag",type:"string"},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0}],defaultParams:["sum","tag"],version:"1.1"}),n({name:"aliasByTags",category:s.Special,params:[{name:"tag",type:"string"},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0}],defaultParams:["tag"],version:"1.1"}),t.each(s,function(e,n){s[n]=t.sortBy(e,"name")}),r.prototype.render=function(n){var r=this.def.name+"(",i=t.map(this.params,function(t,n){var r=this.def.params[n].type;return"int"===r||"value_or_series"===r||"boolean"===r?t:"int_or_interval"===r&&e.isNumeric(t)?t:"'"+t+"'"}.bind(this));return n&&i.unshift(n),r+i.join(", ")+")"},r.prototype._hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(this.def.params[e+1]&&this.def.params[e+1].optional)},r.prototype.updateParam=function(e,n){if(this._hasMultipleParamsInString(e,n))return void t.each(e.split(","),function(t,e){this.updateParam(t.trim(),n+e)}.bind(this));""===e&&this.def.params[n].optional?this.params.splice(n,1):this.params[n]=e,this.updateText()},r.prototype.updateText=function(){if(0===this.params.length)return void(this.text=this.def.name+"()");var t=this.def.name+"(";t+=this.params.join(", "),t+=")",this.text=t},{createFuncInstance:function(e,n){if(t.isString(e)){if(!o[e])throw{message:"Method not found "+name};e=o[e]}return new r(e,n)},getFuncDef:function(t){return o[t]},getCategories:function(e){var n={};return t.each(s,function(r,a){var o=t.filter(r,function(t){return i(t,e)});o.length&&(n[a]=o)}),n}}}.apply(e,r))&&(t.exports=i)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4)],void 0!==(i=function(t,e){"use strict";var n=t.module("grafana.controllers");n.directive("cloudwatchQueryParameter",function(){return{templateUrl:"public/app/plugins/datasource/cloudwatch/partials/query.parameter.html",controller:"CloudWatchQueryParameterCtrl",restrict:"E",scope:{target:"=",datasource:"=",onChange:"&"}}}),n.controller("CloudWatchQueryParameterCtrl",["$scope","templateSrv","uiSegmentSrv","datasourceSrv","$q",function(n,r,i,a,o){n.init=function(){var t=n.target;t.namespace=t.namespace||"",t.metricName=t.metricName||"",t.statistics=t.statistics||["Average"],t.dimensions=t.dimensions||{},t.period=t.period||"",t.region=t.region||"",n.regionSegment=i.getSegmentForValue(n.target.region,"select region"),n.namespaceSegment=i.getSegmentForValue(n.target.namespace,"select namespace"),n.metricSegment=i.getSegmentForValue(n.target.metricName,"select metric"),n.dimSegments=e.reduce(n.target.dimensions,function(t,e,n){return t.push(i.newKey(n)),t.push(i.newOperator("=")),t.push(i.newKeyValue(e)),t},[]),n.statSegments=e.map(n.target.statistics,function(t){return i.getSegmentForValue(t)}),n.ensurePlusButton(n.statSegments),n.ensurePlusButton(n.dimSegments),n.removeDimSegment=i.newSegment({fake:!0,value:"-- remove dimension --"}),n.removeStatSegment=i.newSegment({fake:!0,value:"-- remove stat --"}),e.isEmpty(n.target.region)&&(n.target.region=n.datasource.getDefaultRegion()),n.onChange||(n.onChange=function(){})},n.getStatSegments=function(){return o.when(e.flatten([t.copy(n.removeStatSegment),e.map(n.datasource.standardStatistics,function(t){return i.getSegmentForValue(t)}),i.getSegmentForValue("pNN.NN")]))},n.statSegmentChanged=function(t,r){t.value===n.removeStatSegment.value?n.statSegments.splice(r,1):t.type="value",n.target.statistics=e.reduce(n.statSegments,function(t,e){return e.fake||t.push(e.value),t},[]),n.ensurePlusButton(n.statSegments),n.onChange()},n.ensurePlusButton=function(t){var e=t.length,n=t[Math.max(e-1,0)];n&&"plus-button"===n.type||t.push(i.newPlusButton())},n.getDimSegments=function(e,r){if("operator"===e.type)return o.when([]);var i=n.target,a=o.when([]);if("key"===e.type||"plus-button"===e.type)a=n.datasource.getDimensionKeys(n.target.namespace,n.target.region);else if("value"===e.type){var s=n.dimSegments[r-2].value;a=n.datasource.getDimensionValues(i.region,i.namespace,i.metricName,s,i.dimensions)}return a.then(n.transformToSegments(!0)).then(function(r){return"key"===e.type&&r.splice(0,0,t.copy(n.removeDimSegment)),r})},n.dimSegmentChanged=function(t,e){n.dimSegments[e]=t,t.value===n.removeDimSegment.value?n.dimSegments.splice(e,3):"plus-button"===t.type&&(n.dimSegments.push(i.newOperator("=")),n.dimSegments.push(i.newFake("select dimension value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),n.syncDimSegmentsWithModel(),n.ensurePlusButton(n.dimSegments),n.onChange()},n.syncDimSegmentsWithModel=function(){for(var t={},e=n.dimSegments.length,r=0;r<e-2;r+=3){var i=n.dimSegments[r],a=n.dimSegments[r+2];a.fake||(t[i.value]=a.value)}n.target.dimensions=t},n.getRegions=function(){return n.datasource.metricFindQuery("regions()").then(n.transformToSegments(!0))},n.getNamespaces=function(){return n.datasource.metricFindQuery("namespaces()").then(n.transformToSegments(!0))},n.getMetrics=function(){return n.datasource.metricFindQuery("metrics("+n.target.namespace+","+n.target.region+")").then(n.transformToSegments(!0))},n.regionChanged=function(){n.target.region=n.regionSegment.value,n.onChange()},n.namespaceChanged=function(){n.target.namespace=n.namespaceSegment.value,n.onChange()},n.metricChanged=function(){n.target.metricName=n.metricSegment.value,n.onChange()},n.transformToSegments=function(t){return function(n){var a=e.map(n,function(t){return i.newSegment({value:t.text,expandable:t.expandable})});return t&&e.each(r.variables,function(t){a.unshift(i.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),a}},n.init()}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=n(824),o=n(109),s=n.n(o),l=function(){function t(t,e,n){this.target=t,this.templateSrv=e,this.scopedVars=n,t.policy=t.policy||"default",t.dsType="influxdb",t.resultFormat=t.resultFormat||"time_series",t.orderByTime=t.orderByTime||"ASC",t.tags=t.tags||[],t.groupBy=t.groupBy||[{type:"time",params:["$__interval"]},{type:"fill",params:["null"]}],t.select=t.select||[[{type:"field",params:["value"]},{type:"mean",params:[]}]],this.updateProjection()}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.updateProjection=function(){this.selectModels=i.a.map(this.target.select,function(t){return i.a.map(t,a.a.create)}),this.groupByParts=i.a.map(this.target.groupBy,a.a.create)},t.prototype.updatePersistedParts=function(){this.target.select=i.a.map(this.selectModels,function(t){return i.a.map(t,function(t){return{type:t.def.type,params:t.params}})})},t.prototype.hasGroupByTime=function(){return i.a.find(this.target.groupBy,function(t){return"time"===t.type})},t.prototype.hasFill=function(){return i.a.find(this.target.groupBy,function(t){return"fill"===t.type})},t.prototype.addGroupBy=function(t){var e=t.match(/^(\w+)\((.*)\)$/),n=e[1],r=e[2],i=a.a.create({type:n,params:[r]}),o=this.target.groupBy.length;0===o?this.target.groupBy.push(i.part):"time"===n?this.target.groupBy.splice(0,0,i.part):"tag"===n&&"fill"===this.target.groupBy[o-1].type?this.target.groupBy.splice(o-1,0,i.part):this.target.groupBy.push(i.part),this.updateProjection()},t.prototype.removeGroupByPart=function(t,e){var n=a.a.getCategories();"time"===t.def.type&&(this.target.groupBy=i.a.filter(this.target.groupBy,function(t){return"fill"!==t.type}),this.target.select=i.a.map(this.target.select,function(t){return i.a.filter(t,function(t){var e=a.a.create(t);return e.def.category!==n.Aggregations&&e.def.category!==n.Selectors})})),this.target.groupBy.splice(e,1),this.updateProjection()},t.prototype.removeSelect=function(t){this.target.select.splice(t,1),this.updateProjection()},t.prototype.removeSelectPart=function(t,e){if("field"===e.def.type){if(this.selectModels.length>1){var n=i.a.indexOf(this.selectModels,t);this.selectModels.splice(n,1)}}else{var r=i.a.indexOf(t,e);t.splice(r,1)}this.updatePersistedParts()},t.prototype.addSelectPart=function(t,e){var n=a.a.create({type:e});n.def.addStrategy(t,n,this),this.updatePersistedParts()},t.prototype.renderTagCondition=function(t,e,n){var r="",i=t.operator,a=t.value;return e>0&&(r=(t.condition||"AND")+" "),i||(i=/^\/.*\/$/.test(a)?"=~":"="),"=~"!==i&&"!~"!==i?(n&&(a=this.templateSrv.replace(a,this.scopedVars)),">"!==i&&"<"!==i&&(a="'"+a.replace(/\\/g,"\\\\")+"'")):n&&(a=this.templateSrv.replace(a,this.scopedVars,"regex")),r+'"'+t.key+'" '+i+" "+a},t.prototype.getMeasurementAndPolicy=function(t){var e=this.target.policy,n=this.target.measurement||"measurement";return n.match("^/.*/$")?t&&(n=this.templateSrv.replace(n,this.scopedVars,"regex")):n='"'+n+'"',(e="default"!==e?'"'+this.target.policy+'".':"")+n},t.prototype.interpolateQueryStr=function(t,e,n){return e.multi||e.includeAll?"string"==typeof t?s.a.regexEscape(t):"("+i.a.map(t,s.a.regexEscape).join("|")+")":t},t.prototype.render=function(t){var e=this,n=this.target;if(n.rawQuery)return t?this.templateSrv.replace(n.query,this.scopedVars,this.interpolateQueryStr):n.query;var r,a,o="SELECT ";for(r=0;r<this.selectModels.length;r++){var s=this.selectModels[r],l="";for(a=0;a<s.length;a++){l=s[a].render(l)}r>0&&(o+=", "),o+=l}o+=" FROM "+this.getMeasurementAndPolicy(t)+" WHERE ";var u=i.a.map(n.tags,function(n,r){return e.renderTagCondition(n,r,t)});u.length>0&&(o+="("+u.join(" ")+") AND "),o+="$timeFilter";var c="";for(r=0;r<this.groupByParts.length;r++){var h=this.groupByParts[r];r>0&&(c+="fill"===h.def.type?" ":", "),c+=h.render("")}return c.length&&(o+=" GROUP BY "+c),n.fill&&(o+=" fill("+n.fill+")"),"DESC"===n.orderByTime&&(o+=" ORDER BY time DESC"),n.limit&&(o+=" LIMIT "+n.limit),n.slimit&&(o+=" SLIMIT "+n.slimit),o},t.prototype.renderAdhocFilters=function(t){var e=this;return i.a.map(t,function(t,n){return e.renderTagCondition(t,n,!1)}).join(" ")},t}();e.a=l},function(t,e,n){"use strict";function r(t){var e=m[t.type];if(!e)throw{message:"Could not find query part "+t.type};return new p.a(t,e)}function i(t){m[t.type]=new p.b(t),t.category.push(m[t.type])}function a(t,e){return e+' AS "'+t.params[0]+'"'}function o(t,e){return"*"===t.params[0]?"*":'"'+t.params[0]+'"'}function s(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.def.category===g.Aggregations)return void(t[n]=e);if(r.def.category===g.Selectors)return void(t[n]=e)}t.splice(1,0,e)}function l(t,e){var n;for(n=0;n<t.length;n++){var r=t[n];if(r.def.category===g.Math||r.def.category===g.Aliasing)break}t.splice(n,0,e)}function u(t,e){var n=t.length;if(n>0){if("math"===t[n-1].def.type)return void(t[n-1]=e);if(n>1&&"math"===t[n-2].def.type)return void(t[n-2]=e);if("alias"===t[n-1].def.type)return void t.splice(n-1,0,e)}t.push(e)}function c(t,e){var n=t.length;if(n>0&&"alias"===t[n-1].def.type)return void(t[n-1]=e);t.push(e)}function h(t,e,n){var i=d.a.map(t,function(t){return r({type:t.def.type,params:d.a.clone(t.params)})});n.selectModels.push(i)}var f=n(4),d=n.n(f),p=n(800),m=[],g={Aggregations:[],Selectors:[],Transformations:[],Predictors:[],Math:[],Aliasing:[],Fields:[]},v=[];i({type:"field",addStrategy:h,category:g.Fields,params:[{type:"field",dynamicLookup:!0}],defaultParams:["value"],renderer:o}),i({type:"count",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"distinct",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"integral",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"mean",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"median",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"mode",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"sum",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:p.c}),i({type:"derivative",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:p.c}),i({type:"spread",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:p.c}),i({type:"non_negative_derivative",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:p.c}),i({type:"difference",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:p.c}),i({type:"non_negative_difference",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:p.c}),i({type:"moving_average",addStrategy:l,category:g.Transformations,params:[{name:"window",type:"int",options:[5,10,20,30,40]}],defaultParams:[10],renderer:p.c}),i({type:"cumulative_sum",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:p.c}),i({type:"stddev",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:p.c}),i({type:"time",category:v,params:[{name:"interval",type:"time",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["$__interval"],renderer:p.c}),i({type:"fill",category:v,params:[{name:"fill",type:"string",options:["none","null","0","previous","linear"]}],defaultParams:["null"],renderer:p.c}),i({type:"elapsed",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:p.c}),i({type:"holt_winters",addStrategy:l,category:g.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:p.c}),i({type:"holt_winters_with_fit",addStrategy:l,category:g.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:p.c}),i({type:"bottom",addStrategy:s,category:g.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:p.c}),i({type:"first",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:p.c}),i({type:"last",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:p.c}),i({type:"max",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:p.c}),i({type:"min",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:p.c}),i({type:"percentile",addStrategy:s,category:g.Selectors,params:[{name:"nth",type:"int"}],defaultParams:[95],renderer:p.c}),i({type:"top",addStrategy:s,category:g.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:p.c}),i({type:"tag",category:v,params:[{name:"tag",type:"string",dynamicLookup:!0}],defaultParams:["tag"],renderer:o}),i({type:"math",addStrategy:u,category:g.Math,params:[{name:"expr",type:"string"}],defaultParams:[" / 100"],renderer:p.d}),i({type:"alias",addStrategy:c,category:g.Aliasing,params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"],renderMode:"suffix",renderer:a}),e.a={create:r,getCategories:function(){return g}}},function(t,e,n){var r,i;r=[n(4)],void 0!==(i=function(t){"use strict";function e(t,e){this.target=t,this.database=e}function n(t,e){var n="",r=t.operator,i=t.value;return e>0&&(n=(t.condition||"AND")+" "),r||(r=/^\/.*\/$/.test(t.value)?"=~":"="),"=~"!==r&&"!~"!==r&&isNaN(+i)&&(i="'"+i+"'"),n+'"'+t.key+'" '+r+" "+i}var r=e.prototype;return r.build=function(){return this.target.rawQuery?this._modifyRawQuery():this._buildQuery()},r.buildExploreQuery=function(e,r,i){var a,o;if("TAG_KEYS"===e)a="SHOW TAG KEYS",o=this.target.measurement;else if("TAG_VALUES"===e)a="SHOW TAG VALUES",o=this.target.measurement;else if("MEASUREMENTS"===e)a="SHOW MEASUREMENTS",i&&(a+=" WITH MEASUREMENT =~ /"+i+"/");else{if("FIELDS"===e)return this.target.measurement.match("^/.*/")?"SHOW FIELD KEYS FROM "+this.target.measurement:'SHOW FIELD KEYS FROM "'+this.target.measurement+'"';if("RETENTION POLICIES"===e)return a='SHOW RETENTION POLICIES on "'+this.database+'"'}if(o&&(o.match("^/.*/")||o.match(/^merge\(.*\)/)||(o='"'+o+'"'),a+=" FROM "+o),r&&(a+=' WITH KEY = "'+r+'"'),this.target.tags&&this.target.tags.length>0){var s=t.reduce(this.target.tags,function(t,e){return e.key===r?t:(t.push(n(e,t.length)),t)},[]);s.length>0&&(a+=" WHERE "+s.join(" "))}return"MEASUREMENTS"===e&&(a+=" LIMIT 100"),a},e}.apply(e,r))&&(t.exports=i)},function(t,e){!function(t){function e(e){function n(t){p.active&&(u(t),e.getPlaceholder().trigger("plotselecting",[a()]))}function r(e){1==e.which&&(document.body.focus(),void 0!==document.onselectstart&&null==m.onselectstart&&(m.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),void 0!==document.ondrag&&null==m.ondrag&&(m.ondrag=document.ondrag,document.ondrag=function(){return!1}),l(p.first,e),p.active=!0,g=function(t){i(t)},t(document).one("mouseup",g))}function i(t){return g=null,void 0!==document.onselectstart&&(document.onselectstart=m.onselectstart),void 0!==document.ondrag&&(document.ondrag=m.ondrag),p.active=!1,u(t),d()?o(t):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),!1}function a(){if(!d())return null;if(!p.show)return null;var n={},r=p.first,i=p.second,a=e.getAxes();return t.each(a,function(t,e){e.used&&(anyUsed=!1)}),t.each(a,function(t,e){if(e.used,!0){var a=e.c2p(r[e.direction]),o=e.c2p(i[e.direction]);n[t]={from:Math.min(a,o),to:Math.max(a,o)}}}),n}function o(t){var n=a();n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,e.getPlaceholder().trigger("plotselected",[n]),n.xaxis&&n.yaxis&&e.getPlaceholder().trigger("selected",[{x1:n.xaxis.from,y1:n.yaxis.from,x2:n.xaxis.to,y2:n.yaxis.to}])}function s(t,e,n){return e<t?t:e>n?n:e}function l(t,n){var r=e.getOptions(),i=e.getPlaceholder().offset(),a=e.getPlotOffset();t.x=s(0,n.pageX-i.left-a.left,e.width()),t.y=s(0,n.pageY-i.top-a.top,e.height()),"y"==r.selection.mode&&(t.x=t==p.first?0:e.width()),"x"==r.selection.mode&&(t.y=t==p.first?0:e.height())}function u(t){null!=t.pageX&&(l(p.second,t),d()?(p.show=!0,e.triggerRedrawOverlay()):c(!0))}function c(t){p.show&&(p.show=!1,e.triggerRedrawOverlay(),t||e.getPlaceholder().trigger("plotunselected",[]))}function h(t,n){var r,i,a,o,s=e.getAxes();for(var l in s)if(r=s[l],r.direction==n&&(o=n+r.n+"axis",t[o]||1!=r.n||(o=n+"axis"),t[o])){i=t[o].from,a=t[o].to;break}if(t[o]||(r="x"==n?e.getXAxes()[0]:e.getYAxes()[0],i=t[n+"1"],a=t[n+"2"]),null!=i&&null!=a&&i>a){var u=i;i=a,a=u}return{from:i,to:a,axis:r}}function f(t,n){var r,i=e.getOptions();"y"==i.selection.mode?(p.first.x=0,p.second.x=e.width()):(r=h(t,"x"),p.first.x=r.axis.p2c(r.from),p.second.x=r.axis.p2c(r.to)),"x"==i.selection.mode?(p.first.y=0,p.second.y=e.height()):(r=h(t,"y"),p.first.y=r.axis.p2c(r.from),p.second.y=r.axis.p2c(r.to)),p.show=!0,e.triggerRedrawOverlay(),!n&&d()&&o()}function d(){var t=e.getOptions().selection.minSize;return Math.abs(p.second.x-p.first.x)>=t&&Math.abs(p.second.y-p.first.y)>=t}var p={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},m={},g=null;e.clearSelection=c,e.setSelection=f,e.getSelection=a,e.hooks.bindEvents.push(function(t,e){null!=t.getOptions().selection.mode&&(e.mousemove(n),e.mousedown(r))}),e.hooks.drawOverlay.push(function(e,n){if(p.show&&d()){var r=e.getPlotOffset(),i=e.getOptions();n.save(),n.translate(r.left,r.top);var a=t.color.parse(i.selection.color);n.strokeStyle=a.scale("a",.8).toString(),n.lineWidth=1,n.lineJoin=i.selection.shape,n.fillStyle=a.scale("a",.4).toString();var o=Math.min(p.first.x,p.second.x)+.5,s=Math.min(p.first.y,p.second.y)+.5,l=Math.abs(p.second.x-p.first.x)-1,u=Math.abs(p.second.y-p.first.y)-1;n.fillRect(o,s,l,u),n.strokeRect(o,s,l,u),n.restore()}}),e.hooks.shutdown.push(function(e,i){i.unbind("mousemove",n),i.unbind("mousedown",r),g&&t(document).unbind("mouseup",g)})}t.plot.plugins.push({init:e,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})}(jQuery)},function(t,e){!function(t){function e(t,e){return e*Math.floor(t/e)}function n(t,e,n,r){if("function"==typeof t.strftime)return t.strftime(e);var i=function(t,e){return t=""+t,e=""+(null==e?"0":e),1==t.length?e+t:t},a=[],o=!1,s=t.getHours(),l=s<12;null==n&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==r&&(r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var u;u=s>12?s-12:0==s?12:s;for(var c=0;c<e.length;++c){var h=e.charAt(c);if(o){switch(h){case"a":h=""+r[t.getDay()];break;case"b":h=""+n[t.getMonth()];break;case"d":h=i(t.getDate(),"");break;case"e":h=i(t.getDate()," ");break;case"h":case"H":h=i(s);break;case"I":h=i(u);break;case"l":h=i(u," ");break;case"m":h=i(t.getMonth()+1,"");break;case"M":h=i(t.getMinutes());break;case"q":h=""+(Math.floor(t.getMonth()/3)+1);break;case"S":h=i(t.getSeconds());break;case"y":h=i(t.getFullYear()%100);break;case"Y":h=""+t.getFullYear();break;case"p":h=l?"am":"pm";break;case"P":h=l?"AM":"PM";break;case"w":h=""+t.getDay()}a.push(h),o=!1}else"%"==h?o=!0:a.push(h)}return a.join("")}function r(t){function e(t,e,n,r){t[e]=function(){return n[r].apply(n,arguments)}}var n={date:t};void 0!=t.strftime&&e(n,"strftime",t,"strftime"),e(n,"getTime",t,"getTime"),e(n,"setTime",t,"setTime");for(var r=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],i=0;i<r.length;i++)e(n,"get"+r[i],t,"getUTC"+r[i]),e(n,"set"+r[i],t,"setUTC"+r[i]);return n}function i(t,e){if("browser"==e.timezone)return new Date(t);if(e.timezone&&"utc"!=e.timezone){if("undefined"!=typeof timezoneJS&&void 0!==timezoneJS.Date){var n=new timezoneJS.Date;return n.setTimezone(e.timezone),n.setTime(t),n}return r(new Date(t))}return r(new Date(t))}function a(r){r.hooks.processOptions.push(function(r,a){t.each(r.getAxes(),function(t,r){var a=r.options;"time"==a.mode&&(r.tickGenerator=function(t){var n=[],r=i(t.min,a),o=0,l=a.tickSize&&"quarter"===a.tickSize[1]||a.minTickSize&&"quarter"===a.minTickSize[1]?c:u;null!=a.minTickSize&&(o="number"==typeof a.tickSize?a.tickSize:a.minTickSize[0]*s[a.minTickSize[1]]);for(var h=0;h<l.length-1&&!(t.delta<(l[h][0]*s[l[h][1]]+l[h+1][0]*s[l[h+1][1]])/2&&l[h][0]*s[l[h][1]]>=o);++h);var f=l[h][0],d=l[h][1];if("year"==d){if(null!=a.minTickSize&&"year"==a.minTickSize[1])f=Math.floor(a.minTickSize[0]);else{var p=Math.pow(10,Math.floor(Math.log(t.delta/s.year)/Math.LN10)),m=t.delta/s.year/p;f=m<1.5?1:m<3?2:m<7.5?5:10,f*=p}f<1&&(f=1)}t.tickSize=a.tickSize||[f,d];var g=t.tickSize[0];d=t.tickSize[1];var v=g*s[d];"second"==d?r.setSeconds(e(r.getSeconds(),g)):"minute"==d?r.setMinutes(e(r.getMinutes(),g)):"hour"==d?r.setHours(e(r.getHours(),g)):"month"==d?r.setMonth(e(r.getMonth(),g)):"quarter"==d?r.setMonth(3*e(r.getMonth()/3,g)):"year"==d&&r.setFullYear(e(r.getFullYear(),g)),r.setMilliseconds(0),v>=s.minute&&r.setSeconds(0),v>=s.hour&&r.setMinutes(0),v>=s.day&&r.setHours(0),v>=4*s.day&&r.setDate(1),v>=2*s.month&&r.setMonth(e(r.getMonth(),3)),v>=2*s.quarter&&r.setMonth(e(r.getMonth(),6)),v>=s.year&&r.setMonth(0);var y,b=0,x=Number.NaN;do{if(y=x,x=r.getTime(),n.push(x),"month"==d||"quarter"==d)if(g<1){r.setDate(1);var _=r.getTime();r.setMonth(r.getMonth()+("quarter"==d?3:1));var w=r.getTime();r.setTime(x+b*s.hour+(w-_)*g),b=r.getHours(),r.setHours(0)}else r.setMonth(r.getMonth()+g*("quarter"==d?3:1));else"year"==d?r.setFullYear(r.getFullYear()+g):r.setTime(x+v)}while(x<t.max&&x!=y);return n},r.tickFormatter=function(t,e){var r=i(t,e.options);if(null!=a.timeformat)return n(r,a.timeformat,a.monthNames,a.dayNames);var o,l=e.options.tickSize&&"quarter"==e.options.tickSize[1]||e.options.minTickSize&&"quarter"==e.options.minTickSize[1],u=e.tickSize[0]*s[e.tickSize[1]],c=e.max-e.min,h=a.twelveHourClock?" %p":"",f=a.twelveHourClock?"%I":"%H";return o=u<s.minute?f+":%M:%S"+h:u<s.day?c<2*s.day?f+":%M"+h:"%b %d "+f+":%M"+h:u<s.month?"%b %d":l&&u<s.quarter||!l&&u<s.year?c<s.year?"%b":"%b %Y":l&&u<s.year?c<s.year?"Q%q":"Q%q %Y":"%Y",n(r,o,a.monthNames,a.dayNames)})})})}var o={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},s={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},l=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],u=l.concat([[3,"month"],[6,"month"],[1,"year"]]),c=l.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);t.plot.plugins.push({init:a,options:o,name:"time",version:"1.0"}),t.plot.formatDate=n}(jQuery)},function(t,e){!function(t){function e(t){function e(t,e){for(var n=null,r=0;r<e.length&&t!=e[r];++r)e[r].stack==t.stack&&(n=e[r]);return n}function n(t,n,r){if(null!=n.stack&&!1!==n.stack){var i=e(n,t.getData());if(i){for(var a,o,s,l,u,c,h,f,d=r.pointsize,p=r.points,m=i.datapoints.pointsize,g=i.datapoints.points,v=[],y=n.lines.show,b=n.bars.horizontal,x=d>2&&(b?r.format[2].x:r.format[2].y),_=y&&n.lines.steps,w=b?1:0,S=b?0:1,k=0,M=0;;){if(k>=p.length&&M>=g.length)break;if(h=v.length,k<p.length&&null==p[k]){for(f=0;f<d;++f)v.push(p[k+f]);k+=d}else if(k>=p.length){for(f=0;f<d;++f)v.push(g[M+f]);x&&(v[h+2]=g[M+S]),M+=m}else if(M>=g.length){for(f=0;f<d;++f)v.push(p[k+f]);k+=d}else if(M<g.length&&null==g[M])M+=m;else{if(a=p[k+w],o=p[k+S],l=g[M+w],u=g[M+S],c=0,a==l){for(f=0;f<d;++f)v.push(p[k+f]);v[h+S]+=u,c=u,k+=d,M+=m}else if(a>l){if(0==k){for(f=0;f<d;++f)v.push(g[M+f]);c=u}if(k>0&&null!=p[k-d]){for(s=o+(p[k-d+S]-o)*(l-a)/(p[k-d+w]-a),v.push(l),v.push(s+u),f=2;f<d;++f)v.push(p[k+f]);c=u}M+=m}else{for(f=0;f<d;++f)v.push(p[k+f]);M>0&&null!=g[M-m]&&(c=u+(g[M-m+S]-u)*(a-l)/(g[M-m+w]-l)),v[h+S]+=c,k+=d}fromgap=!1,h!=v.length&&x&&(v[h+2]=c)}if(_&&h!=v.length&&h>0&&null!=v[h]&&v[h]!=v[h-d]&&v[h+1]!=v[h-d+1]){for(f=0;f<d;++f)v[h+d+f]=v[h+f];v[h+1]=v[h-d+1]}}r.points=v}}}t.hooks.processDatapoints.push(n)}var n={series:{stack:null}};t.plot.plugins.push({init:e,options:n,name:"stack",version:"1.2"})}(jQuery)},function(t,e){!function(t){function e(t){function e(t,e,r,i){if(a||(a=!0,o=n(t.getData())),1==e.stackpercent){var s=r.length;e.percents=[];var l=0,u=1;e.bars&&e.bars.horizontal&&!0===e.bars.horizontal&&(l=1,u=0);for(var c=0;c<s;c++){var h=o[r[c][l]+""];h>0?e.percents.push(100*r[c][u]/h):e.percents.push(0)}}}function n(t){var e=t.length,n={};if(e>0)for(var r=0;r<e;r++)if(t[r].stackpercent){var i=0,a=1;t[r].bars&&t[r].bars.horizontal&&!0===t[r].bars.horizontal&&(i=1,a=0);for(var o=t[r].data.length,s=0;s<o;s++){var l=0;null!=t[r].data[s][1]&&(l=t[r].data[s][a]),n[t[r].data[s][i]+""]?n[t[r].data[s][i]+""]+=l:n[t[r].data[s][i]+""]=l}}return n}function r(t,e,r){if(e.stackpercent){a||(o=n(t.getData()));var s=[],l=0,u=1;e.bars&&e.bars.horizontal&&!0===e.bars.horizontal&&(l=1,u=0);for(var c=0;c<r.points.length;c+=3)i[r.points[c+l]]||(i[r.points[c+l]]=0),s[c+l]=r.points[c+l],s[c+u]=r.points[c+u]+i[r.points[c+l]],s[c+2]=i[r.points[c+l]],i[r.points[c+l]]+=r.points[c+u],o[s[c+l]+""]>0?(s[c+u]=100*s[c+u]/o[s[c+l]+""],s[c+2]=100*s[c+2]/o[s[c+l]+""]):(s[c+u]=0,s[c+2]=0);r.points=s}}var i={},a=!1,o={};t.hooks.processRawData.push(e),t.hooks.processDatapoints.push(r)}var n={series:{stackpercent:null}};t.plot.plugins.push({init:e,options:n,name:"stackpercent",version:"0.1"})}(jQuery)},function(t,e){!function(t){"use strict";function e(e){function n(t,e){var n;for(n=0;n<e.length;++n)if(e[n].id===t.fillBelowTo)return e[n];return null}function r(t,e,n,r,i,a,o,s){var l,u,c,h,f,d;return l=n-t,u=r-e,c=o-i,h=s-a,f=(-u*(t-i)+l*(e-a))/(-c*u+l*h),d=(c*(e-a)-h*(t-i))/(-c*u+l*h),f>=0&&f<=1&&d>=0&&d<=1?[t+d*l,e+d*u]:null}function i(e,i,a){function o(t,e){i.beginPath(),i.moveTo(a.xaxis.p2c(t)+v.left,a.yaxis.p2c(e)+v.top)}function s(){i.closePath(),i.fill()}function l(t,e){console.assert(e>t,"expects the end index to be greater than the start index");var n,r,i=0===t||null===p[t-1]||null===g[t-1],a=!1;for(n=t;n<e;n++)if(null===p[n*d+1]||null===g[n*d+1])a=!1,i=!0;else if(p[n*d+1]===g[n*m+1])a=!0,i=!1;else{if(p[n*d+1]>g[n*m+1])return i?o(p[n*d],p[n*d+1]):a?o(p[(n-1)*d],p[(n-1)*d+1]):(r=u(n),o(r[0],r[1])),void h(n,e);i=!1,a=!1}}function u(t){console.assert(t>0,"expects the second point in the series line segment");var e,n;for(e=1;e<g.length/m;e++)if(null!==(n=r(p[(t-1)*d],p[(t-1)*d+1],p[t*d],p[t*d+1],g[(e-1)*m],g[(e-1)*m+1],g[e*m],g[e*m+1])))return n;console.error("intersectionPoint() should only be called when an intersection happens")}function c(t,e){console.assert(t>=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var n;for(n=t;n>=e;n--)i.lineTo(f.xaxis.p2c(g[n*m])+v.left,f.yaxis.p2c(g[n*m+1])+v.top);s()}function h(t,e){console.assert(t<=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var n,r;for(n=t;n<e;n++){if(null===p[n*d+1]&&n>t)return c(n-1,t),void l(n,e);if(p[n*d+1]===g[n*m+1])return c(n,t),void l(n,e);if(p[n*d+1]<g[n*m+1])return r=u(n),i.lineTo(a.xaxis.p2c(r[0])+v.left,a.yaxis.p2c(r[1])+v.top),c(n,t),void l(n,e);i.lineTo(a.xaxis.p2c(p[n*d])+v.left,a.yaxis.p2c(p[n*d+1])+v.top)}c(e,t)}if(null!==a.fillBelowTo){var f,d,p,m,g,v,y;f=n(a,e.getData()),f&&(d=a.datapoints.pointsize,p=a.datapoints.points,m=f.datapoints.pointsize,g=f.datapoints.points,v=e.getPlotOffset(),function(){if(p.length/d!=g.length/m)return console.error("Refusing to graph inconsistent number of points"),!1;var t;for(t=0;t<p.length/d;t++)if(null!==p[t*d]&&null!==g[t*m]&&p[t*d]!==g[t*m])return console.error("Refusing to graph points without matching value"),!1;return!0}()&&(y=t.color.parse(a.color),y.a=.4,y.normalize(),i.fillStyle=y.toString(),l(0,p.length/d)))}}e.hooks.drawSeries.push(i)}var n={series:{fillBelowTo:null}};t.plot.plugins.push({init:e,options:n,name:"fillbelow",version:"0.1.0"})}(jQuery)},function(t,e){!function(t){function e(t){function e(e){r.locked||-1!=r.x&&(r.x=-1,t.triggerRedrawOverlay())}function n(e){if(!r.locked){if(t.getSelection&&t.getSelection())return void(r.x=-1);var n=t.offset();r.x=Math.max(0,Math.min(e.pageX-n.left,t.width())),r.y=Math.max(0,Math.min(e.pageY-n.top,t.height())),t.triggerRedrawOverlay()}}var r={x:-1,y:-1,locked:!1};t.setCrosshair=function(e){if(e){var n=t.p2c(e);r.x=Math.max(0,Math.min(n.left,t.width())),r.y=Math.max(0,Math.min(n.top,t.height()))}else r.x=-1;t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(e){e&&t.setCrosshair(e),r.locked=!0},t.unlockCrosshair=function(){r.locked=!1},t.hooks.bindEvents.push(function(t,r){t.getOptions().crosshair.mode&&(r.mouseout(e),r.mousemove(n))}),t.hooks.drawOverlay.push(function(t,e){var n=t.getOptions().crosshair;if(n.mode){var i=t.getPlotOffset();if(e.save(),e.translate(i.left,i.top),-1!=r.x){var a=t.getOptions().crosshair.lineWidth%2?.5:0;if(e.strokeStyle=n.color,e.lineWidth=n.lineWidth,e.lineJoin="round",e.beginPath(),-1!=n.mode.indexOf("x")){var o=Math.floor(r.x)+a;e.moveTo(o,0),e.lineTo(o,t.height())}if(-1!=n.mode.indexOf("y")){var s=Math.floor(r.y)+a;e.moveTo(0,s),e.lineTo(t.width(),s)}e.stroke()}e.restore()}}),t.hooks.shutdown.push(function(t,r){r.unbind("mouseout",e),r.unbind("mousemove",n)})}var n={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};t.plot.plugins.push({init:e,options:n,name:"crosshair",version:"1.0"})}(jQuery)},function(t,e){!function(t){function e(t){t.hooks.processDatapoints.push(function(t,e,n){e.dashes.show&&t.hooks.draw.push(function(t,r){function i(t,i){var a,l,u=n.points,c=n.pointsize,h=null,f=null,d=0,p=!0;e.dashes.dashLength[0]?(a=e.dashes.dashLength[0],l=e.dashes.dashLength[1]?e.dashes.dashLength[1]:a):l=a=e.dashes.dashLength,r.beginPath();for(var m=c;m<u.length;m+=c){var g=u[m-c],v=u[m-c+1],y=u[m],b=u[m+1];if(null!=g&&null!=y){if(v<=b&&v<s.min){if(b<s.min)continue;g=(s.min-v)/(b-v)*(y-g)+g,v=s.min}else if(b<=v&&b<s.min){if(v<s.min)continue;y=(s.min-v)/(b-v)*(y-g)+g,b=s.min}if(v>=b&&v>s.max){if(b>s.max)continue;g=(s.max-v)/(b-v)*(y-g)+g,v=s.max}else if(b>=v&&b>s.max){if(v>s.max)continue;y=(s.max-v)/(b-v)*(y-g)+g,b=s.max}if(g<=y&&g<o.min){if(y<o.min)continue;v=(o.min-g)/(y-g)*(b-v)+v,g=o.min}else if(y<=g&&y<o.min){if(g<o.min)continue;b=(o.min-g)/(y-g)*(b-v)+v,y=o.min}if(g>=y&&g>o.max){if(y>o.max)continue;v=(o.max-g)/(y-g)*(b-v)+v,g=o.max}else if(y>=g&&y>o.max){if(g>o.max)continue;b=(o.max-g)/(y-g)*(b-v)+v,y=o.max}g==h&&v==f||r.moveTo(o.p2c(g)+t,s.p2c(v)+i);var x,_=o.p2c(g)+t,w=s.p2c(v)+i,S=o.p2c(y)+t,k=s.p2c(b)+i;do{x=function(t){var e=Math.sqrt(Math.pow(S-_,2)+Math.pow(k-w,2));if(e<=t)return{deltaX:S-_,deltaY:k-w,distance:e,remainder:t-e};var n=S>_?1:-1,r=k>w?1:-1;return{deltaX:n*Math.sqrt(Math.pow(t,2)/(1+Math.pow((k-w)/(S-_),2))),deltaY:r*Math.sqrt(Math.pow(t,2)-Math.pow(t,2)/(1+Math.pow((k-w)/(S-_),2))),distance:t,remainder:0}}(d>0?d:p?a:l),0==x.deltaX&&0==x.deltaY||(p?r.lineTo(_+x.deltaX,w+x.deltaY):r.moveTo(_+x.deltaX,w+x.deltaY)),p=!p,d=x.remainder,_+=x.deltaX,w+=x.deltaY}while(x.distance>0);h=y,f=b}}r.stroke()}var a=t.getPlotOffset(),o=e.xaxis,s=e.yaxis;r.save(),r.translate(a.left,a.top),r.lineJoin="round";var l=e.dashes.lineWidth,u=e.shadowSize;if(l>0&&u>0){r.lineWidth=u,r.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;i(Math.sin(c)*(l/2+u/2),Math.cos(c)*(l/2+u/2)),r.lineWidth=u/2,i(Math.sin(c)*(l/2+u/4),Math.cos(c)*(l/2+u/4))}r.lineWidth=l,r.strokeStyle=e.color,l>0&&i(0,0),r.restore()})})}t.plot.plugins.push({init:e,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})}(jQuery)},function(t,e,n){!function(t,n){n(e)}(0,function(t){"use strict";function e(t){return function(e,n){return ku(t(e),n)}}function n(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=Lu?i*=10:a>=Uu?i*=5:a>=zu&&(i*=2),e<t?-i:i}function r(t){return t.length}function i(t,e,n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"}function a(t,e,n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"}function o(t){var e=t.bandwidth()/2;return t.round()&&(e=Math.round(e)),function(n){return t(n)+e}}function s(){return!this.__axis}function l(t,e){function n(n){var d,p=null==l?e.ticks?e.ticks.apply(e,r):e.domain():l,m=null==u?e.tickFormat?e.tickFormat.apply(e,r):lc:u,g=Math.max(c,0)+f,v=t===uc||t===hc?i:a,y=e.range(),b=y[0]+.5,x=y[y.length-1]+.5,_=(e.bandwidth?o:lc)(e.copy()),w=n.selection?n.selection():n,S=w.selectAll(".domain").data([null]),k=w.selectAll(".tick").data(p,e).order(),M=k.exit(),T=k.enter().append("g").attr("class","tick"),C=k.select("line"),A=k.select("text"),P=t===uc||t===fc?-1:1,E=t===fc||t===cc?(d="x","y"):(d="y","x");S=S.merge(S.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),k=k.merge(T),C=C.merge(T.append("line").attr("stroke","#000").attr(d+"2",P*c).attr(E+"1",.5).attr(E+"2",.5)),A=A.merge(T.append("text").attr("fill","#000").attr(d,P*g).attr(E,.5).attr("dy",t===uc?"0em":t===hc?"0.71em":"0.32em")),n!==w&&(S=S.transition(n),k=k.transition(n),C=C.transition(n),A=A.transition(n),M=M.transition(n).attr("opacity",dc).attr("transform",function(t){return v(_,this.parentNode.__axis||_,t)}),T.attr("opacity",dc).attr("transform",function(t){return v(this.parentNode.__axis||_,_,t)})),M.remove(),S.attr("d",t===fc||t==cc?"M"+P*h+","+b+"H0.5V"+x+"H"+P*h:"M"+b+","+P*h+"V0.5H"+x+"V"+P*h),k.attr("opacity",1).attr("transform",function(t){return v(_,_,t)}),C.attr(d+"2",P*c),A.attr(d,P*g).text(m),w.filter(s).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===cc?"start":t===fc?"end":"middle"),w.each(function(){this.__axis=_})}var r=[],l=null,u=null,c=6,h=6,f=3;return n.scale=function(t){return arguments.length?(e=t,n):e},n.ticks=function(){return r=sc.call(arguments),n},n.tickArguments=function(t){return arguments.length?(r=null==t?[]:sc.call(t),n):r.slice()},n.tickValues=function(t){return arguments.length?(l=null==t?null:sc.call(t),n):l&&l.slice()},n.tickFormat=function(t){return arguments.length?(u=t,n):u},n.tickSize=function(t){return arguments.length?(c=h=+t,n):c},n.tickSizeInner=function(t){return arguments.length?(c=+t,n):c},n.tickSizeOuter=function(t){return arguments.length?(h=+t,n):h},n.tickPadding=function(t){return arguments.length?(f=+t,n):f},n}function u(t){return l(uc,t)}function c(t){return l(cc,t)}function h(t){return l(hc,t)}function f(t){return l(fc,t)}function d(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new p(r)}function p(t){this._=t}function m(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function g(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function v(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=pc,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}function y(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===mc&&e.documentElement.namespaceURI===mc?e.createElement(t):e.createElementNS(n,t)}}function b(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function x(){return new _}function _(){this._="@"+(++bc).toString(36)}function w(t,e,n){return t=S(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function S(e,n,r){return function(i){var a=t.event;t.event=i;try{e.call(this,this.__data__,n,r)}finally{t.event=a}}}function k(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function M(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function T(t,e,n){var r=kc.hasOwnProperty(t.type)?w:S;return function(i,a,o){var s,l=this.__on,u=r(e,a,o);if(l)for(var c=0,h=l.length;c<h;++c)if((s=l[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function C(e,n,r,i){var a=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(r,i)}finally{t.event=a}}function A(){}function P(){return[]}function E(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function O(t,e,n,r,i,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new E(t,a[s]);for(;s<l;++s)(o=e[s])&&(i[s]=o)}function D(t,e,n,r,i,a,o){var s,l,u,c={},h=e.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(d[s]=u=Nc+o.call(l,l.__data__,s,e),u in c?i[s]=l:c[u]=l);for(s=0;s<f;++s)u=Nc+o.call(t,a[s],s,a),(l=c[u])?(r[s]=l,l.__data__=a[s],c[u]=null):n[s]=new E(t,a[s]);for(s=0;s<h;++s)(l=e[s])&&c[d[s]]===l&&(i[s]=l)}function $(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function I(t){return function(){this.removeAttribute(t)}}function R(t){return function(){this.removeAttributeNS(t.space,t.local)}}function F(t,e){return function(){this.setAttribute(t,e)}}function N(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function q(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function j(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function L(t){return function(){this.style.removeProperty(t)}}function U(t,e,n){return function(){this.style.setProperty(t,e,n)}}function z(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function V(t){return function(){delete this[t]}}function B(t,e){return function(){this[t]=e}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function H(t){return t.trim().split(/^|\s+/)}function Q(t){return t.classList||new W(t)}function W(t){this._node=t,this._names=H(t.getAttribute("class")||"")}function G(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function K(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function X(t){return function(){G(this,t)}}function J(t){return function(){K(this,t)}}function Z(t,e){return function(){(e.apply(this,arguments)?G:K)(this,t)}}function tt(){this.textContent=""}function et(t){return function(){this.textContent=t}}function nt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function rt(){this.innerHTML=""}function it(t){return function(){this.innerHTML=t}}function at(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ot(){this.nextSibling&&this.parentNode.appendChild(this)}function st(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lt(){return null}function ut(){var t=this.parentNode;t&&t.removeChild(this)}function ct(t,e,n){var r=Kc(t),i=r.CustomEvent;i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ht(t,e){return function(){return ct(this,t,e)}}function ft(t,e){return function(){return ct(this,t,e.apply(this,arguments))}}function dt(t,e){this._groups=t,this._parents=e}function pt(){return new dt([[document.documentElement]],uh)}function mt(){t.event.stopImmediatePropagation()}function gt(t,e){var n=t.document.documentElement,r=ch(t).on("dragstart.drag",null);e&&(r.on("click.drag",ph,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function vt(t,e,n,r,i,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function yt(){return!t.event.button}function bt(){return this.parentNode}function xt(e){return null==e?{x:t.event.x,y:t.event.y}:e}function _t(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function wt(){}function St(t){var e;return t=(t+"").trim().toLowerCase(),(e=Sh.exec(t))?(e=parseInt(e[1],16),new At(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=kh.exec(t))?kt(parseInt(e[1],16)):(e=Mh.exec(t))?new At(e[1],e[2],e[3],1):(e=Th.exec(t))?new At(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ch.exec(t))?Mt(e[1],e[2],e[3],e[4]):(e=Ah.exec(t))?Mt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ph.exec(t))?Pt(e[1],e[2]/100,e[3]/100,1):(e=Eh.exec(t))?Pt(e[1],e[2]/100,e[3]/100,e[4]):Oh.hasOwnProperty(t)?kt(Oh[t]):"transparent"===t?new At(NaN,NaN,NaN,0):null}function kt(t){return new At(t>>16&255,t>>8&255,255&t,1)}function Mt(t,e,n,r){return r<=0&&(t=e=n=NaN),new At(t,e,n,r)}function Tt(t){return t instanceof wt||(t=St(t)),t?(t=t.rgb(),new At(t.r,t.g,t.b,t.opacity)):new At}function Ct(t,e,n,r){return 1===arguments.length?Tt(t):new At(t,e,n,null==r?1:r)}function At(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Pt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Dt(t,e,n,r)}function Et(t){if(t instanceof Dt)return new Dt(t.h,t.s,t.l,t.opacity);if(t instanceof wt||(t=St(t)),!t)return new Dt;if(t instanceof Dt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Dt(o,s,l,t.opacity)}function Ot(t,e,n,r){return 1===arguments.length?Et(t):new Dt(t,e,n,null==r?1:r)}function Dt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function $t(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function It(t){if(t instanceof Ft)return new Ft(t.l,t.a,t.b,t.opacity);if(t instanceof Vt){var e=t.h*Dh;return new Ft(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof At||(t=Tt(t));var n=Lt(t.r),r=Lt(t.g),i=Lt(t.b),a=Nt((.4124564*n+.3575761*r+.1804375*i)/Ih),o=Nt((.2126729*n+.7151522*r+.072175*i)/Rh);return new Ft(116*o-16,500*(a-o),200*(o-Nt((.0193339*n+.119192*r+.9503041*i)/Fh)),t.opacity)}function Rt(t,e,n,r){return 1===arguments.length?It(t):new Ft(t,e,n,null==r?1:r)}function Ft(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Nt(t){return t>Lh?Math.pow(t,1/3):t/jh+Nh}function qt(t){return t>qh?t*t*t:jh*(t-Nh)}function jt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Lt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ut(t){if(t instanceof Vt)return new Vt(t.h,t.c,t.l,t.opacity);t instanceof Ft||(t=It(t));var e=Math.atan2(t.b,t.a)*$h;return new Vt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function zt(t,e,n,r){return 1===arguments.length?Ut(t):new Vt(t,e,n,null==r?1:r)}function Vt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Bt(t){if(t instanceof Ht)return new Ht(t.h,t.s,t.l,t.opacity);t instanceof At||(t=Tt(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Qh*r+Yh*e-Hh*n)/(Qh+Yh-Hh),a=r-i,o=(Bh*(n-i)-zh*a)/Vh,s=Math.sqrt(o*o+a*a)/(Bh*i*(1-i)),l=s?Math.atan2(o,a)*$h-120:NaN;return new Ht(l<0?l+360:l,s,i,t.opacity)}function Yt(t,e,n,r){return 1===arguments.length?Bt(t):new Ht(t,e,n,null==r?1:r)}function Ht(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qt(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function Wt(t,e){return function(n){return t+n*e}}function Gt(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Kt(t,e){var n=e-t;return n?Wt(t,n>180||n<-180?n-360*Math.round(n/360):n):nf(isNaN(t)?e:t)}function Xt(t){return 1==(t=+t)?Jt:function(e,n){return n-e?Gt(e,n,t):nf(isNaN(e)?n:e)}}function Jt(t,e){var n=e-t;return n?Wt(t,n):nf(isNaN(t)?e:t)}function Zt(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ct(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}function te(t){return function(){return t}}function ee(t){return function(e){return t(e)+""}}function ne(t){return"none"===t?vf:(Wh||(Wh=document.createElement("DIV"),Gh=document.documentElement,Kh=document.defaultView),Wh.style.transform=t,t=Kh.getComputedStyle(Gh.appendChild(Wh),null).getPropertyValue("transform"),Gh.removeChild(Wh),t=t.slice(7,-1).split(","),yf(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function re(t){return null==t?vf:(Xh||(Xh=document.createElementNS("http://www.w3.org/2000/svg","g")),Xh.setAttribute("transform",t),(t=Xh.transform.baseVal.consolidate())?(t=t.matrix,yf(t.a,t.b,t.c,t.d,t.e,t.f)):vf)}function ie(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}function a(t,r,i,a,o,s){if(t!==i||r!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:uf(t,i)},{i:l-2,x:uf(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}function o(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:uf(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}function s(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:uf(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}function l(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:uf(t,n)},{i:s-2,x:uf(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}return function(e,n){var r=[],i=[];return e=t(e),n=t(n),a(e.translateX,e.translateY,n.translateX,n.translateY,r,i),o(e.rotate,n.rotate,r,i),s(e.skewX,n.skewX,r,i),l(e.scaleX,e.scaleY,n.scaleX,n.scaleY,r,i),e=n=null,function(t){for(var e,n=-1,a=i.length;++n<a;)r[(e=i[n]).i]=e.x(t);return r.join("")}}}function ae(t){return((t=Math.exp(t))+1/t)/2}function oe(t){return((t=Math.exp(t))-1/t)/2}function se(t){return((t=Math.exp(2*t))-1)/(t+1)}function le(t){return function(e,n){var r=t((e=Ot(e)).h,(n=Ot(n)).h),i=Jt(e.s,n.s),a=Jt(e.l,n.l),o=Jt(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}function ue(t,e){var n=Jt((t=Rt(t)).l,(e=Rt(e)).l),r=Jt(t.a,e.a),i=Jt(t.b,e.b),a=Jt(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function ce(t){return function(e,n){var r=t((e=zt(e)).h,(n=zt(n)).h),i=Jt(e.c,n.c),a=Jt(e.l,n.l),o=Jt(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}function he(t){return function e(n){function r(e,r){var i=t((e=Yt(e)).h,(r=Yt(r)).h),a=Jt(e.s,r.s),o=Jt(e.l,r.l),s=Jt(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}function fe(){return Rf||(qf(de),Rf=Nf.now()+Ff)}function de(){Rf=0}function pe(){this._call=this._time=this._next=null}function me(t,e,n){var r=new pe;return r.restart(t,e,n),r}function ge(){fe(),++Ef;for(var t,e=Jh;e;)(t=Rf-e._time)>=0&&e._call.call(null,t),e=e._next;--Ef}function ve(){Rf=(If=Nf.now())+Ff,Ef=Of=0;try{ge()}finally{Ef=0,be(),Rf=0}}function ye(){var t=Nf.now(),e=t-If;e>$f&&(Ff-=e,If=t)}function be(){for(var t,e,n=Jh,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Jh=e);Zh=t,xe(r)}function xe(t){if(!Ef){Of&&(Of=clearTimeout(Of));var e=t-Rf;e>24?(t<1/0&&(Of=setTimeout(ve,e)),Df&&(Df=clearInterval(Df))):(Df||(If=Rf,Df=setInterval(ye,$f)),Ef=1,qf(ve))}}function _e(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Vf)throw new Error("too late");return n}function we(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Yf)throw new Error("too late");return n}function Se(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}function ke(t,e,n){function r(t){n.state=Bf,n.timer.restart(i,n.delay,n.time),n.delay<=t&&i(t-n.delay)}function i(r){var u,c,h,f;if(n.state!==Bf)return o();for(u in l)if(f=l[u],f.name===n.name){if(f.state===Hf)return jf(i);f.state===Qf?(f.state=Gf,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete l[u]):+u<e&&(f.state=Gf,f.timer.stop(),delete l[u])}if(jf(function(){n.state===Hf&&(n.state=Qf,n.timer.restart(a,n.delay,n.time),a(r))}),n.state=Yf,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Yf){for(n.state=Hf,s=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(s[++c]=f);s.length=c+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(o),n.state=Wf,1),i=-1,a=s.length;++i<a;)s[i].call(null,r);n.state===Wf&&(n.on.call("end",t,t.__data__,n.index,n.group),o())}function o(){n.state=Gf,n.timer.stop(),delete l[e];for(var r in l)return;delete t.__transition}var s,l=t.__transition;l[e]=n,n.timer=me(r,0,n.time)}function Me(t,e){var n,r;return function(){var i=we(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Te(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=we(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function Ce(t,e,n){var r=t._id;return t.each(function(){var t=we(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return Se(t,r).value[e]}}function Ae(t){return function(){this.removeAttribute(t)}}function Pe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ee(t,e,n){var r,i;return function(){var a=this.getAttribute(t);return a===n?null:a===r?i:i=e(r=a,n)}}function Oe(t,e,n){var r,i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===n?null:a===r?i:i=e(r=a,n)}}function De(t,e,n){var r,i,a;return function(){var o,s=n(this);return null==s?void this.removeAttribute(t):(o=this.getAttribute(t),o===s?null:o===r&&s===i?a:a=e(r=o,i=s))}}function $e(t,e,n){var r,i,a;return function(){var o,s=n(this);return null==s?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),o===s?null:o===r&&s===i?a:a=e(r=o,i=s))}}function Ie(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}function Re(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n}function Fe(t,e){return function(){_e(this,t).delay=+e.apply(this,arguments)}}function Ne(t,e){return e=+e,function(){_e(this,t).delay=e}}function qe(t,e){return function(){we(this,t).duration=+e.apply(this,arguments)}}function je(t,e){return e=+e,function(){we(this,t).duration=e}}function Le(t,e){if("function"!=typeof e)throw new Error;return function(){we(this,t).ease=e}}function Ue(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}function ze(t,e,n){var r,i,a=Ue(e)?_e:we;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}function Ve(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Be(t,e){var n,r,i;return function(){var a=Kc(this).getComputedStyle(this,null),o=a.getPropertyValue(t),s=(this.style.removeProperty(t),a.getPropertyValue(t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function Ye(t){return function(){this.style.removeProperty(t)}}function He(t,e,n){var r,i;return function(){var a=Kc(this).getComputedStyle(this,null).getPropertyValue(t);return a===n?null:a===r?i:i=e(r=a,n)}}function Qe(t,e,n){var r,i,a;return function(){var o=Kc(this).getComputedStyle(this,null),s=o.getPropertyValue(t),l=n(this);return null==l&&(this.style.removeProperty(t),l=o.getPropertyValue(t)),s===l?null:s===r&&l===i?a:a=e(r=s,i=l)}}function We(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}function Ge(t){return function(){this.textContent=t}}function Ke(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function Xe(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Je(t){return pt().transition(t)}function Ze(){return++yd}function tn(t){return+t}function en(t){return t*t}function nn(t){return t*(2-t)}function rn(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function an(t){return t*t*t}function on(t){return--t*t*t+1}function sn(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function ln(t){return 1-Math.cos(t*kd)}function un(t){return Math.sin(t*kd)}function cn(t){return(1-Math.cos(Sd*t))/2}function hn(t){return Math.pow(2,10*t-10)}function fn(t){return 1-Math.pow(2,-10*t)}function dn(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function pn(t){return 1-Math.sqrt(1-t*t)}function mn(t){return Math.sqrt(1- --t*t)}function gn(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function vn(t){return 1-yn(1-t)}function yn(t){return(t=+t)<Md?Id*t*t:t<Cd?Id*(t-=Td)*t+Ad:t<Ed?Id*(t-=Pd)*t+Od:Id*(t-=Dd)*t+$d}function bn(t){return((t*=2)<=1?1-yn(1-t):yn(t-1)+1)/2}function xn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Vd.time=fe(),Vd;return n}function _n(){t.event.stopImmediatePropagation()}function wn(t){return{type:t}}function Sn(){return!t.event.button}function kn(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Mn(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Tn(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Cn(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function An(){return En(tp)}function Pn(){return En(ep)}function En(e){function n(t){var n=t.property("__brush",s).selectAll(".overlay").data([wn("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",rp.overlay).merge(n).each(function(){var t=Mn(this).extent;ch(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([wn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",rp.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(e.handles,function(t){return t.type});i.exit().remove(),i.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return rp[t.type]}),t.each(r).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",o)}function r(){var t=ch(this),e=Mn(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-f/2:e[0][0]-f/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-f/2:e[0][1]-f/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+f:f}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+f:f})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function i(t,e){return t.__brush.emitter||new a(t,e)}function a(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function o(){function n(){var t=Ac(k);!F||w||S||(Math.abs(t[0]-q[0])>Math.abs(t[1]-q[1])?S=!0:w=!0),q=t,_=!0,Gd(),a()}function a(){var t;switch(b=q[0]-N[0],x=q[1]-N[1],T){case Xd:case Kd:C&&(b=Math.max(D-h,Math.min(I-m,b)),f=h+b,g=m+b),A&&(x=Math.max($-d,Math.min(R-v,x)),p=d+x,y=v+x);break;case Jd:C<0?(b=Math.max(D-h,Math.min(I-h,b)),f=h+b,g=m):C>0&&(b=Math.max(D-m,Math.min(I-m,b)),f=h,g=m+b),A<0?(x=Math.max($-d,Math.min(R-d,x)),p=d+x,y=v):A>0&&(x=Math.max($-v,Math.min(R-v,x)),p=d,y=v+x);break;case Zd:C&&(f=Math.max(D,Math.min(I,h-b*C)),g=Math.max(D,Math.min(I,m+b*C))),A&&(p=Math.max($,Math.min(R,d-x*A)),y=Math.max($,Math.min(R,v+x*A)))}g<f&&(C*=-1,t=h,h=m,m=t,t=f,f=g,g=t,M in ip&&U.attr("cursor",rp[M=ip[M]])),y<p&&(A*=-1,t=d,d=v,v=t,t=p,p=y,y=t,M in ap&&U.attr("cursor",rp[M=ap[M]])),P.selection&&(O=P.selection),w&&(f=O[0][0],g=O[1][0]),S&&(p=O[0][1],y=O[1][1]),O[0][0]===f&&O[0][1]===p&&O[1][0]===g&&O[1][1]===y||(P.selection=[[f,p],[g,y]],r.call(k),j.brush())}function o(){if(_n(),t.event.touches){if(t.event.touches.length)return;l&&clearTimeout(l),l=setTimeout(function(){l=null},500),L.on("touchmove.brush touchend.brush touchcancel.brush",null)}else gt(t.event.view,_),z.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);L.attr("pointer-events","all"),U.attr("cursor",rp.overlay),P.selection&&(O=P.selection),Tn(O)&&(P.selection=null,r.call(k)),j.end()}function s(){switch(t.event.keyCode){case 16:F=C&&A;break;case 18:T===Jd&&(C&&(m=g-b*C,h=f+b*C),A&&(v=y-x*A,d=p+x*A),T=Zd,a());break;case 32:T!==Jd&&T!==Zd||(C<0?m=g-b:C>0&&(h=f-b),A<0?v=y-x:A>0&&(d=p-x),T=Xd,U.attr("cursor",rp.selection),a());break;default:return}Gd()}function u(){switch(t.event.keyCode){case 16:F&&(w=S=F=!1,a());break;case 18:T===Zd&&(C<0?m=g:C>0&&(h=f),A<0?v=y:A>0&&(d=p),T=Jd,a());break;case 32:T===Xd&&(t.event.altKey?(C&&(m=g-b*C,h=f+b*C),A&&(v=y-x*A,d=p+x*A),T=Zd):(C<0?m=g:C>0&&(h=f),A<0?v=y:A>0&&(d=p),T=Jd),U.attr("cursor",rp[M]),a());break;default:return}Gd()}if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return Gd()}else if(l)return;if(c.apply(this,arguments)){var h,f,d,p,m,g,v,y,b,x,_,w,S,k=this,M=t.event.target.__data__.type,T="selection"===(t.event.metaKey?M="overlay":M)?Kd:t.event.altKey?Zd:Jd,C=e===ep?null:op[M],A=e===tp?null:sp[M],P=Mn(k),E=P.extent,O=P.selection,D=E[0][0],$=E[0][1],I=E[1][0],R=E[1][1],F=C&&A&&t.event.shiftKey,N=Ac(k),q=N,j=i(k,arguments).beforestart();"overlay"===M?P.selection=O=[[h=e===ep?D:N[0],d=e===tp?$:N[1]],[m=e===ep?I:h,v=e===tp?R:d]]:(h=O[0][0],d=O[0][1],m=O[1][0],v=O[1][1]),f=h,p=d,g=m,y=v;var L=ch(k).attr("pointer-events","none"),U=L.selectAll(".overlay").attr("cursor",rp[M]);if(t.event.touches)L.on("touchmove.brush",n,!0).on("touchend.brush touchcancel.brush",o,!0);else{var z=ch(t.event.view).on("keydown.brush",s,!0).on("keyup.brush",u,!0).on("mousemove.brush",n,!0).on("mouseup.brush",o,!0);mh(t.event.view)}_n(),Xf(k),r.call(k),j.start()}}function s(){var t=this.__brush||{selection:null};return t.extent=u.apply(this,arguments),t.dim=e,t}var l,u=kn,c=Sn,h=d(n,"start","brush","end"),f=6;return n.move=function(t,n){t.selection?t.on("start.brush",function(){i(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){i(this,arguments).end()}).tween("brush",function(){function t(t){o.selection=1===t&&Tn(u)?null:c(t),r.call(a),s.brush()}var a=this,o=a.__brush,s=i(a,arguments),l=o.selection,u=e.input("function"==typeof n?n.apply(this,arguments):n,o.extent),c=pf(l,u);return l&&u?t:t(1)}):t.each(function(){var t=this,a=arguments,o=t.__brush,s=e.input("function"==typeof n?n.apply(t,a):n,o.extent),l=i(t,a).beforestart();Xf(t),o.selection=null==s||Tn(s)?null:s,r.call(t),l.start().brush().end()})},a.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){C(new Wd(n,t,e.output(this.state.selection)),h.apply,h,[t,this.that,this.args])}},n.extent=function(t){return arguments.length?(u="function"==typeof t?t:Qd([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),n):u},n.filter=function(t){return arguments.length?(c="function"==typeof t?t:Qd(!!t),n):c},n.handleSize=function(t){return arguments.length?(f=+t,n):f},n.on=function(){var t=h.on.apply(h,arguments);return t===h?n:t},n}function On(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function Dn(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function $n(){return new Dn}function In(t){return t.source}function Rn(t){return t.target}function Fn(t){return t.radius}function Nn(t){return t.startAngle}function qn(t){return t.endAngle}function jn(){}function Ln(t,e){var n=new jn;if(t instanceof jn)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}function Un(){return{}}function zn(t,e,n){t[e]=n}function Vn(){return Ln()}function Bn(t,e,n){t.set(e,n)}function Yn(){}function Hn(t,e){var n=new Yn;if(t instanceof Yn)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}function Qn(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function Wn(t,e){var n=Qn(t);return function(r,i){return e(n(r),i,t)}}function Gn(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function Kn(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,l,u,c,h,f,d=t._root,p={data:r},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o,i=d,!(d=d[h=c<<1|u]))return i[h]=p,t;if(s=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===s&&n===l)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o}while((h=c<<1|u)==(f=(l>=o)<<1|s>=a));return i[f]=d,i[h]=p,t}function Xn(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>h&&(h=i));for(c<l&&(l=this._x0,c=this._x1),h<u&&(u=this._y0,h=this._y1),this.cover(l,u).cover(c,h),n=0;n<a;++n)Kn(this,o[n],s[n],t[n]);return this}function Jn(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Zn(t){return t[0]}function tr(t){return t[1]}function er(t,e,n){var r=new nr(null==e?Zn:e,null==n?tr:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function nr(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function rr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}function ir(t){return t.x+t.vx}function ar(t){return t.y+t.vy}function or(t){return t.index}function sr(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function lr(t){return t.x}function ur(t){return t.y}function cr(t){if(!(e=bm.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],s=e[6]&&+e[6],l=!!e[7],u=e[8]&&+e[8].slice(1),c=e[9]||"";"n"===c?(l=!0,c="g"):ym[c]||(c=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=s,this.comma=l,this.precision=u,this.type=c}function hr(t){return t}function fr(e){return _m=Sm(e),t.format=_m.format,t.formatPrefix=_m.formatPrefix,_m}function dr(){this.reset()}function pr(t,e,n){var r=t.s=e+n,i=r-e,a=r-i;t.t=e-a+(n-i)}function mr(t){return t>1?0:t<-1?sg:Math.acos(t)}function gr(t){return t>1?lg:t<-1?-lg:Math.asin(t)}function vr(t){return(t=_g(t/2))*t}function yr(){}function br(t,e){t&&Tg.hasOwnProperty(t.type)&&Tg[t.type](t,e)}function xr(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function _r(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)xr(t[n],e,1);e.polygonEnd()}function wr(){Eg.point=kr}function Sr(){Mr(Am,Pm)}function kr(t,e){Eg.point=Mr,Am=t,Pm=e,t*=fg,e*=fg,Em=t,Om=gg(e=e/2+ug),Dm=_g(e)}function Mr(t,e){t*=fg,e*=fg,e=e/2+ug;var n=t-Em,r=n>=0?1:-1,i=r*n,a=gg(e),o=_g(e),s=Dm*o,l=Om*a+s*gg(i),u=s*r*_g(i);Ag.add(mg(u,l)),Em=t,Om=a,Dm=o}function Tr(t){return[mg(t[1],t[0]),gr(t[2])]}function Cr(t){var e=t[0],n=t[1],r=gg(n);return[r*gg(e),r*_g(e),_g(n)]}function Ar(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Pr(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Er(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Or(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Dr(t){var e=Sg(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function $r(t,e){Um.push(zm=[$m=t,Rm=t]),e<Im&&(Im=e),e>Fm&&(Fm=e)}function Ir(t,e){var n=Cr([t*fg,e*fg]);if(Lm){var r=Pr(Lm,n),i=[r[1],-r[0],0],a=Pr(i,r);Dr(a),a=Tr(a);var o,s=t-Nm,l=s>0?1:-1,u=a[0]*hg*l,c=dg(s)>180;c^(l*Nm<u&&u<l*t)?(o=a[1]*hg)>Fm&&(Fm=o):(u=(u+360)%360-180,c^(l*Nm<u&&u<l*t)?(o=-a[1]*hg)<Im&&(Im=o):(e<Im&&(Im=e),e>Fm&&(Fm=e))),c?t<Nm?Lr($m,t)>Lr($m,Rm)&&(Rm=t):Lr(t,Rm)>Lr($m,Rm)&&($m=t):Rm>=$m?(t<$m&&($m=t),t>Rm&&(Rm=t)):t>Nm?Lr($m,t)>Lr($m,Rm)&&(Rm=t):Lr(t,Rm)>Lr($m,Rm)&&($m=t)}else $r(t,e);Lm=n,Nm=t}function Rr(){$g.point=Ir}function Fr(){zm[0]=$m,zm[1]=Rm,$g.point=$r,Lm=null}function Nr(t,e){if(Lm){var n=t-Nm;Dg.add(dg(n)>180?n+(n>0?360:-360):n)}else qm=t,jm=e;Eg.point(t,e),Ir(t,e)}function qr(){Eg.lineStart()}function jr(){Nr(qm,jm),Eg.lineEnd(),dg(Dg)>og&&($m=-(Rm=180)),zm[0]=$m,zm[1]=Rm,Lm=null}function Lr(t,e){return(e-=t)<0?e+360:e}function Ur(t,e){return t[0]-e[0]}function zr(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function Vr(t,e){t*=fg,e*=fg;var n=gg(e);Br(n*gg(t),n*_g(t),_g(e))}function Br(t,e,n){++Vm,Ym+=(t-Ym)/Vm,Hm+=(e-Hm)/Vm,Qm+=(n-Qm)/Vm}function Yr(){Rg.point=Hr}function Hr(t,e){t*=fg,e*=fg;var n=gg(e);ng=n*gg(t),rg=n*_g(t),ig=_g(e),Rg.point=Qr,Br(ng,rg,ig)}function Qr(t,e){t*=fg,e*=fg;var n=gg(e),r=n*gg(t),i=n*_g(t),a=_g(e),o=mg(Sg((o=rg*a-ig*i)*o+(o=ig*r-ng*a)*o+(o=ng*i-rg*r)*o),ng*r+rg*i+ig*a);Bm+=o,Wm+=o*(ng+(ng=r)),Gm+=o*(rg+(rg=i)),Km+=o*(ig+(ig=a)),Br(ng,rg,ig)}function Wr(){Rg.point=Vr}function Gr(){Rg.point=Xr}function Kr(){Jr(tg,eg),Rg.point=Vr}function Xr(t,e){tg=t,eg=e,t*=fg,e*=fg,Rg.point=Jr;var n=gg(e);ng=n*gg(t),rg=n*_g(t),ig=_g(e),Br(ng,rg,ig)}function Jr(t,e){t*=fg,e*=fg;var n=gg(e),r=n*gg(t),i=n*_g(t),a=_g(e),o=rg*a-ig*i,s=ig*r-ng*a,l=ng*i-rg*r,u=Sg(o*o+s*s+l*l),c=ng*r+rg*i+ig*a,h=u&&-mr(c)/u,f=mg(u,c);Xm+=h*o,Jm+=h*s,Zm+=h*l,Bm+=f,Wm+=f*(ng+(ng=r)),Gm+=f*(rg+(rg=i)),Km+=f*(ig+(ig=a)),Br(ng,rg,ig)}function Zr(t,e){return[t>sg?t-cg:t<-sg?t+cg:t,e]}function ti(t,e,n){return(t%=cg)?e||n?qg(ni(t),ri(e,n)):ni(t):e||n?ri(e,n):Zr}function ei(t){return function(e,n){return e+=t,[e>sg?e-cg:e<-sg?e+cg:e,n]}}function ni(t){var e=ei(t);return e.invert=ei(-t),e}function ri(t,e){function n(t,e){var n=gg(e),s=gg(t)*n,l=_g(t)*n,u=_g(e),c=u*r+s*i;return[mg(l*a-c*o,s*r-u*i),gr(c*a+l*o)]}var r=gg(t),i=_g(t),a=gg(e),o=_g(e);return n.invert=function(t,e){var n=gg(e),s=gg(t)*n,l=_g(t)*n,u=_g(e),c=u*a-l*o;return[mg(l*a+u*o,s*r+c*i),gr(c*r-s*i)]},n}function ii(t,e,n,r,i,a){if(n){var o=gg(e),s=_g(e),l=r*n;null==i?(i=e+r*cg,a=e-l/2):(i=ai(o,i),a=ai(o,a),(r>0?i<a:i>a)&&(i+=r*cg));for(var u,c=i;r>0?c>a:c<a;c-=l)u=Tr([o,-s*gg(c),-s*_g(c)]),t.point(u[0],u[1])}}function ai(t,e){e=Cr(e),e[0]-=t,Dr(e);var n=mr(-e[1]);return((-e[2]<0?-n:n)+cg-og)%cg}function oi(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function si(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function li(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var c=0,h=0;if(null==i||(c=o(i,s))!==(h=o(a,s))||l(i,a)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return dg(r[0]-t)<og?i>0?0:3:dg(r[0]-n)<og?i>0?2:1:dg(r[1]-e)<og?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){function l(t,e){i(t,e)&&T.point(t,e)}function u(){for(var e=0,n=0,i=g.length;n<i;++n)for(var a,o,s=g[n],l=1,u=s.length,c=s[0],h=c[0],f=c[1];l<u;++l)a=h,o=f,c=s[l],h=c[0],f=c[1],o<=r?f>r&&(h-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(h-a)*(r-o)<(f-o)*(t-a)&&--e;return e}function c(){T=C,m=[],g=[],M=!0}function h(){var t=u(),e=M&&t,n=(m=Ju(m)).length;(e||n)&&(o.polygonStart(),e&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),n&&ev(m,s,t,a,o),o.polygonEnd()),T=o,m=g=v=null}function f(){A.point=p,g&&g.push(v=[]),k=!0,S=!1,_=w=NaN}function d(){m&&(p(y,b),x&&S&&C.rejoin(),m.push(C.result())),A.point=l,S&&T.lineEnd()}function p(a,o){var s=i(a,o);if(g&&v.push([a,o]),k)y=a,b=o,x=s,k=!1,s&&(T.lineStart(),T.point(a,o));else if(s&&S)T.point(a,o);else{var l=[_=Math.max(rv,Math.min(nv,_)),w=Math.max(rv,Math.min(nv,w))],u=[a=Math.max(rv,Math.min(nv,a)),o=Math.max(rv,Math.min(nv,o))];Zg(l,u,t,e,n,r)?(S||(T.lineStart(),T.point(l[0],l[1])),T.point(u[0],u[1]),s||T.lineEnd(),M=!1):s&&(T.lineStart(),T.point(a,o),M=!1)}_=a,w=o,S=s}var m,g,v,y,b,x,_,w,S,k,M,T=o,C=Jg(),A={point:l,lineStart:f,lineEnd:d,polygonStart:c,polygonEnd:h};return A}}function ui(){ov.point=hi,ov.lineEnd=ci}function ci(){ov.point=ov.lineEnd=yr}function hi(t,e){t*=fg,e*=fg,jg=t,Lg=_g(e),Ug=gg(e),ov.point=fi}function fi(t,e){t*=fg,e*=fg;var n=_g(e),r=gg(e),i=dg(t-jg),a=gg(i),o=_g(i),s=r*o,l=Ug*n-Lg*r*a,u=Lg*n+Ug*r*a;av.add(mg(Sg(s*s+l*l),u)),jg=t,Lg=n,Ug=r}function di(t,e,n){var r=ju(t,e-og,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function pi(t,e,n){var r=ju(t,e-og,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function mi(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return ju(vg(a/g)*g,i,g).map(f).concat(ju(vg(u/v)*v,l,v).map(d)).concat(ju(vg(r/p)*p,n,p).filter(function(t){return dg(t%g)>og}).map(c)).concat(ju(vg(s/m)*m,o,m).filter(function(t){return dg(t%v)>og}).map(h))}var n,r,i,a,o,s,l,u,c,h,f,d,p=10,m=p,g=90,v=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(a).concat(d(l).slice(1),f(i).reverse().slice(1),d(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.extentMajor(e).extentMinor(e):t.extentMinor()},t.extentMajor=function(e){return arguments.length?(a=+e[0][0],i=+e[1][0],u=+e[0][1],l=+e[1][1],a>i&&(e=a,a=i,i=e),u>l&&(e=u,u=l,l=e),t.precision(y)):[[a,u],[i,l]]},t.extentMinor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),s>o&&(e=s,s=o,o=e),t.precision(y)):[[r,s],[n,o]]},t.step=function(e){return arguments.length?t.stepMajor(e).stepMinor(e):t.stepMinor()},t.stepMajor=function(e){return arguments.length?(g=+e[0],v=+e[1],t):[g,v]},t.stepMinor=function(e){return arguments.length?(p=+e[0],m=+e[1],t):[p,m]},t.precision=function(e){return arguments.length?(y=+e,c=di(s,o,90),h=pi(r,n,y),f=di(u,l,90),d=pi(a,i,y),t):y},t.extentMajor([[-180,-90+og],[180,90-og]]).extentMinor([[-180,-80-og],[180,80+og]])}function gi(){return mi()()}function vi(){mv.point=yi}function yi(t,e){mv.point=bi,zg=Bg=t,Vg=Yg=e}function bi(t,e){pv.add(Yg*t-Bg*e),Bg=t,Yg=e}function xi(){bi(zg,Vg)}function _i(t,e){t<gv&&(gv=t),t>yv&&(yv=t),e<vv&&(vv=e),e>bv&&(bv=e)}function wi(t,e){_v+=t,wv+=e,++Sv}function Si(){Ev.point=ki}function ki(t,e){Ev.point=Mi,wi(Wg=t,Gg=e)}function Mi(t,e){var n=t-Wg,r=e-Gg,i=Sg(n*n+r*r);kv+=i*(Wg+t)/2,Mv+=i*(Gg+e)/2,Tv+=i,wi(Wg=t,Gg=e)}function Ti(){Ev.point=wi}function Ci(){Ev.point=Pi}function Ai(){Ei(Hg,Qg)}function Pi(t,e){Ev.point=Ei,wi(Hg=Wg=t,Qg=Gg=e)}function Ei(t,e){var n=t-Wg,r=e-Gg,i=Sg(n*n+r*r);kv+=i*(Wg+t)/2,Mv+=i*(Gg+e)/2,Tv+=i,i=Gg*t-Wg*e,Cv+=i*(Wg+t),Av+=i*(Gg+e),Pv+=3*i,wi(Wg=t,Gg=e)}function Oi(t){this._context=t}function Di(){this._string=[]}function $i(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ii(t){return t.length>1}function Ri(t,e){return((t=t.x)[0]<0?t[1]-lg-og:lg-t[1])-((e=e.x)[0]<0?e[1]-lg-og:lg-e[1])}function Fi(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?sg:-sg,l=dg(a-n);dg(l-sg)<og?(t.point(n,r=(r+o)/2>0?lg:-lg),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&l>=sg&&(dg(n-i)<og&&(n-=i*og),dg(a-s)<og&&(a-=s*og),r=Ni(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function Ni(t,e,n,r){var i,a,o=_g(t-n);return dg(o)>og?pg((_g(e)*(a=gg(r))*_g(n)-_g(r)*(i=gg(e))*_g(t))/(i*a*o)):(e+r)/2}function qi(t,e,n,r){var i;if(null==t)i=n*lg,r.point(-sg,i),r.point(0,i),r.point(sg,i),r.point(sg,0),r.point(sg,-i),r.point(0,-i),r.point(-sg,-i),r.point(-sg,0),r.point(-sg,i);else if(dg(t[0]-e[0])>og){var a=t[0]<e[0]?sg:-sg;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}function ji(t){return function(e){var n=new Li;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Li(){}function Ui(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=a&&t.clipExtent(null),Cg(n,t.stream(xv));var o=xv.result(),s=Math.min(r/(o[1][0]-o[0][0]),i/(o[1][1]-o[0][1])),l=+e[0][0]+(r-s*(o[1][0]+o[0][0]))/2,u=+e[0][1]+(i-s*(o[1][1]+o[0][1]))/2;return null!=a&&t.clipExtent(a),t.scale(150*s).translate([l,u])}function zi(t,e,n){return Ui(t,[[0,0],e],n)}function Vi(t){return ji({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function Bi(t,e){function n(r,i,a,o,s,l,u,c,h,f,d,p,m,g){var v=u-r,y=c-i,b=v*v+y*y;if(b>4*e&&m--){var x=o+f,_=s+d,w=l+p,S=Sg(x*x+_*_+w*w),k=gr(w/=S),M=dg(dg(w)-1)<og||dg(a-h)<og?(a+h)/2:mg(_,x),T=t(M,k),C=T[0],A=T[1],P=C-r,E=A-i,O=y*P-v*E;(O*O/b>e||dg((v*P+y*E)/b-.5)>.3||o*f+s*d+l*p<jv)&&(n(r,i,a,o,s,l,C,A,M,x/=S,_/=S,w,m,g),g.point(C,A),n(C,A,M,x,_,w,u,c,h,f,d,p,m,g))}}return function(e){function r(n,r){n=t(n,r),e.point(n[0],n[1])}function i(){v=NaN,w.point=a,e.lineStart()}function a(r,i){var a=Cr([r,i]),o=t(r,i);n(v,y,g,b,x,_,v=o[0],y=o[1],g=r,b=a[0],x=a[1],_=a[2],qv,e),e.point(v,y)}function o(){w.point=r,e.lineEnd()}function s(){i(),w.point=l,w.lineEnd=u}function l(t,e){a(c=t,e),h=v,f=y,d=b,p=x,m=_,w.point=a}function u(){n(v,y,g,b,x,_,h,f,c,d,p,m,qv,e),w.lineEnd=o,o()}var c,h,f,d,p,m,g,v,y,b,x,_,w={point:r,lineStart:i,lineEnd:o,polygonStart:function(){e.polygonStart(),w.lineStart=s},polygonEnd:function(){e.polygonEnd(),w.lineStart=i}};return w}}function Yi(t){return Hi(function(){return t})()}function Hi(t){function e(t){return t=c(t[0]*fg,t[1]*fg),[t[0]*g+s,l-t[1]*g]}function n(t){return(t=c.invert((t[0]-s)/g,(l-t[1])/g))&&[t[0]*hg,t[1]*hg]}function r(t,e){return t=o(t,e),[t[0]*g+s,l-t[1]*g]}function i(){c=qg(u=ti(_,w,S),o);var t=o(b,x);return s=v-t[0]*g,l=y+t[1]*g,a()}function a(){return p=m=null,e}var o,s,l,u,c,h,f,d,p,m,g=150,v=480,y=250,b=0,x=0,_=0,w=0,S=0,k=null,M=Rv,T=null,C=fv,A=.5,P=Lv(r,A);return e.stream=function(t){return p&&m===t?p:p=Uv(M(u,P(C(m=t))))},e.clipAngle=function(t){return arguments.length?(M=+t?Fv(k=t*fg,6*fg):(k=null,Rv),a()):k*hg},e.clipExtent=function(t){return arguments.length?(C=null==t?(T=h=f=d=null,fv):li(T=+t[0][0],h=+t[0][1],f=+t[1][0],d=+t[1][1]),a()):null==T?null:[[T,h],[f,d]]},e.scale=function(t){return arguments.length?(g=+t,i()):g},e.translate=function(t){return arguments.length?(v=+t[0],y=+t[1],i()):[v,y]},e.center=function(t){return arguments.length?(b=t[0]%360*fg,x=t[1]%360*fg,i()):[b*hg,x*hg]},e.rotate=function(t){return arguments.length?(_=t[0]%360*fg,w=t[1]%360*fg,S=t.length>2?t[2]%360*fg:0,i()):[_*hg,w*hg,S*hg]},e.precision=function(t){return arguments.length?(P=Lv(r,A=t*t),a()):Sg(A)},e.fitExtent=function(t,n){return Ui(e,t,n)},e.fitSize=function(t,n){return zi(e,t,n)},function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,i()}}function Qi(t){var e=0,n=sg/3,r=Hi(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*fg,n=t[1]*fg):[e*hg,n*hg]},i}function Wi(t){function e(t,e){return[t*n,_g(e)/n]}var n=gg(t);return e.invert=function(t,e){return[t/n,gr(e*n)]},e}function Gi(t,e){function n(t,e){var n=Sg(a-2*i*_g(e))/i;return[n*_g(t*=i),o-n*gg(t)]}var r=_g(t),i=(r+_g(e))/2;if(dg(i)<og)return Wi(t);var a=1+r*(2*i-r),o=Sg(a)/i;return n.invert=function(t,e){var n=o-e;return[mg(t,dg(n))/i*wg(n),gr((a-(t*t+n*n)*i*i)/(2*i))]},n}function Ki(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function Xi(t){return function(e,n){var r=gg(e),i=gg(n),a=t(r*i);return[a*i*_g(e),a*_g(n)]}}function Ji(t){return function(e,n){var r=Sg(e*e+n*n),i=t(r),a=_g(i),o=gg(i);return[mg(e*a,r*o),gr(r&&n*a/r)]}}function Zi(t,e){return[t,bg(kg((lg+e)/2))]}function ta(t){var e,n=Yi(t),r=n.scale,i=n.translate,a=n.clipExtent;return n.scale=function(t){return arguments.length?(r(t),e&&n.clipExtent(null),n):r()},n.translate=function(t){return arguments.length?(i(t),e&&n.clipExtent(null),n):i()},n.clipExtent=function(t){if(!arguments.length)return e?null:a();if(e=null==t){var o=sg*r(),s=i();t=[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]}return a(t),n},n.clipExtent(null)}function ea(t){return kg((lg+t)/2)}function na(t,e){function n(t,e){a>0?e<-lg+og&&(e=-lg+og):e>lg-og&&(e=lg-og);var n=a/xg(ea(e),i);return[n*_g(i*t),a-n*gg(i*t)]}var r=gg(t),i=t===e?_g(t):bg(r/gg(e))/bg(ea(e)/ea(t)),a=r*xg(ea(t),i)/i;return i?(n.invert=function(t,e){var n=a-e,r=wg(i)*Sg(t*t+n*n);return[mg(t,dg(n))/i*wg(n),2*pg(xg(a/r,1/i))-lg]},n):Zi}function ra(t,e){return[t,e]}function ia(t,e){function n(t,e){var n=a-e,r=i*t;return[n*_g(r),a-n*gg(r)]}var r=gg(t),i=t===e?_g(t):(r-gg(e))/(e-t),a=r/i+t;return dg(i)<og?ra:(n.invert=function(t,e){var n=a-e;return[mg(t,dg(n))/i*wg(n),a-wg(i)*Sg(t*t+n*n)]},n)}function aa(t,e){var n=gg(e),r=gg(t)*n;return[n*_g(t)/r,_g(e)/r]}function oa(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?fv:ji({point:function(i,a){this.stream.point(i*t+n,a*e+r)}})}function sa(t,e){return[gg(e)*_g(t),_g(e)]}function la(t,e){var n=gg(e),r=1+gg(t)*n;return[n*_g(t)/r,_g(e)/r]}function ua(t,e){return[bg(kg((lg+e)/2)),-t]}function ca(t,e){return t.parent===e.parent?1:2}function ha(t){return t.reduce(fa,0)/t.length}function fa(t,e){return t+e.x}function da(t){return 1+t.reduce(pa,0)}function pa(t,e){return Math.max(t,e.y)}function ma(t){for(var e;e=t.children;)t=e[0];return t}function ga(t){for(var e;e=t.children;)t=e[e.length-1];return t}function va(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function ya(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function ba(t,e){var n,r,i,a,o,s=new ka(t),l=+t.value&&(s.value=t.value),u=[s];for(null==e&&(e=_a);n=u.pop();)if(l&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)u.push(r=n.children[a]=new ka(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Sa)}function xa(){return ba(this).eachBefore(wa)}function _a(t){return t.children}function wa(t){t.data=t.data.data}function Sa(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ka(t){this.data=t,this.depth=this.height=0,this.parent=null}function Ma(t){this._=t,this.next=null}function Ta(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r-e.r;return i*i+1e-6>n*n+r*r}function Ca(t,e){var n,r,i,a=null,o=t.head;switch(e.length){case 1:n=Aa(e[0]);break;case 2:n=Pa(e[0],e[1]);break;case 3:n=Ea(e[0],e[1],e[2])}for(;o;)i=o._,r=o.next,n&&Ta(n,i)?a=o:(a?(t.tail=a,a.next=null):t.head=t.tail=null,e.push(i),n=Ca(t,e),e.pop(),t.head?(o.next=t.head,t.head=o):(o.next=null,t.head=t.tail=o),a=t.tail,a.next=r),o=r;return t.tail=a,n}function Aa(t){return{x:t.x,y:t.y,r:t.r}}function Pa(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,l=a-n,u=o-r,c=s-i,h=Math.sqrt(l*l+u*u);return{x:(n+a+l/h*c)/2,y:(r+o+u/h*c)/2,r:(h+i+s)/2}}function Ea(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=2*(r-o),d=2*(i-s),p=2*(l-a),m=r*r+i*i-a*a-o*o-s*s+l*l,g=2*(r-u),v=2*(i-c),y=2*(h-a),b=r*r+i*i-a*a-u*u-c*c+h*h,x=g*d-f*v,_=(d*b-v*m)/x-r,w=(v*p-d*y)/x,S=(g*m-f*b)/x-i,k=(f*y-g*p)/x,M=w*w+k*k-1,T=2*(_*w+S*k+a),C=_*_+S*S-a*a,A=(-T-Math.sqrt(T*T-4*M*C))/(2*M);return{x:_+w*A+r,y:S+k*A+i,r:A}}function Oa(t,e,n){var r=t.x,i=t.y,a=e.r+n.r,o=t.r+n.r,s=e.x-r,l=e.y-i,u=s*s+l*l;if(u){var c=.5+((o*=o)-(a*=a))/(2*u),h=Math.sqrt(Math.max(0,2*a*(o+u)-(o-=u)*o-a*a))/(2*u);n.x=r+c*s+h*l,n.y=i+c*l-h*s}else n.x=r+o,n.y=i}function Da(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return i*i-1e-6>n*n+r*r}function $a(t,e){for(var n=t._.r;t!==e;)n+=2*(t=t.next)._.r;return n-e._.r}function Ia(t,e,n){var r=t.x-e,i=t.y-n;return r*r+i*i}function Ra(t){this._=t,this.next=null,this.previous=null}function Fa(t){if(!(i=t.length))return 0;var e,n,r,i;if(e=t[0],e.x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;Oa(n,e,r=t[2]);var a,o,s,l,u,c,h,f=e.r*e.r,d=n.r*n.r,p=r.r*r.r,m=f+d+p,g=f*e.x+d*n.x+p*r.x,v=f*e.y+d*n.y+p*r.y;e=new Ra(e),n=new Ra(n),r=new Ra(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){Oa(e._,n._,r=t[s]),r=new Ra(r),l=n.next,u=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(Da(l._,r._)){c+e._.r+n._.r>$a(l,n)?e=l:n=l,e.next=n,n.previous=e,--s;continue t}c+=l._.r,l=l.next}else{if(Da(u._,r._)){$a(e,u)>h+e._.r+n._.r?e=u:n=u,e.next=n,n.previous=e,--s;continue t}h+=u._.r,u=u.previous}}while(l!==u.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,m+=p=r._.r*r._.r,g+=p*r._.x,v+=p*r._.y,f=Ia(e._,a=g/m,o=v/m);(r=r.next)!==n;)(p=Ia(r._,a,o))<f&&(e=r,f=p);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=vy(e),s=0;s<i;++s)e=t[s],e.x-=r.x,e.y-=r.y;return r.r}function Na(t){return null==t?null:qa(t)}function qa(t){if("function"!=typeof t)throw new Error;return t}function ja(){return 0}function La(t){return Math.sqrt(t.value)}function Ua(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function za(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=Fa(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function Va(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Ba(t){return t.id}function Ya(t){return t.parentId}function Ha(t,e){return t.parent===e.parent?1:2}function Qa(t){var e=t.children;return e?e[0]:t.t}function Wa(t){var e=t.children;return e?e[e.length-1]:t.t}function Ga(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Ka(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)e=i[a],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function Xa(t,e,n){return t.a.parent===e.parent?t.a:n}function Ja(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Za(t){for(var e,n,r,i,a,o=new Ja(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new Ja(r[i],i)),n.parent=e;return(o.parent=new Ja(null,0)).children=[o],o}function to(t,e,n,r,i,a){for(var o,s,l,u,c,h,f,d,p,m,g,v=[],y=e.children,b=0,x=0,_=y.length,w=e.value;b<_;){l=i-n,u=a-r;do{c=y[x++].value}while(!c&&x<_);for(h=f=c,m=Math.max(u/l,l/u)/(w*t),g=c*c*m,p=Math.max(f/g,g/h);x<_;++x){if(c+=s=y[x].value,s<h&&(h=s),s>f&&(f=s),g=c*c*m,(d=Math.max(f/g,g/h))>p){c-=s;break}p=d}v.push(o={value:c,dice:l<u,children:y.slice(b,x)}),o.dice?wy(o,n,r,i,w?r+=u*c/w:a):Py(o,n,r,w?n+=l*c/w:i,a),w-=c,b=x}return v}function eo(t,e){return t[0]-e[0]||t[1]-e[1]}function no(t){for(var e=t.length,n=[0,1],r=2,i=2;i<e;++i){for(;r>1&&qy(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function ro(t){if(!(t>=1))throw new Error;this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function io(t){if(!t._start)try{ao(t)}catch(e){if(t._tasks[t._ended+t._active-1])so(t,e);else if(!t._data)throw e}}function ao(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,n=t._tasks[e],r=n.length-1,i=n[r];n[r]=oo(t,e),--t._waiting,++t._active,n=i.apply(null,n),t._tasks[e]&&(t._tasks[e]=n||Vy)}}function oo(t,e){return function(n,r){t._tasks[e]&&(--t._active,++t._ended,t._tasks[e]=null,null==t._error&&(null!=n?so(t,n):(t._data[e]=r,t._waiting?io(t):lo(t))))}}function so(t,e){var n,r=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;--r>=0;)if((n=t._tasks[r])&&(t._tasks[r]=null,n.abort))try{n.abort()}catch(t){}t._active=NaN,lo(t)}function lo(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function uo(t){return new ro(arguments.length?+t:1/0)}function co(t){return function(e,n){t(null==e?n:null)}}function ho(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function fo(t,e){return function(n){return t(n.responseText,e)}}function po(t){function e(e){var a=e+"",o=n.get(a);if(!o){if(i!==lb)return i;n.set(a,o=r.push(e))}return t[(o-1)%t.length]}var n=Ln(),r=[],i=lb;return t=null==t?[]:sb.call(t),e.domain=function(t){if(!arguments.length)return r.slice();r=[],n=Ln();for(var i,a,o=-1,s=t.length;++o<s;)n.has(a=(i=t[o])+"")||n.set(a,r.push(i));return e},e.range=function(n){return arguments.length?(t=sb.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(i=t,e):i},e.copy=function(){return po().domain(r).range(t).unknown(i)},e}function mo(){function t(){var t=i().length,r=o[1]<o[0],h=o[r-0],f=o[1-r];e=(f-h)/Math.max(1,t-l+2*u),s&&(e=Math.floor(e)),h+=(f-h-e*(t-l))*c,n=e*(1-l),s&&(h=Math.round(h),n=Math.round(n));var d=ju(t).map(function(t){return h+e*t});return a(r?d.reverse():d)}var e,n,r=po().unknown(void 0),i=r.domain,a=r.range,o=[0,1],s=!1,l=0,u=0,c=.5;return delete r.unknown,r.domain=function(e){return arguments.length?(i(e),t()):i()},r.range=function(e){return arguments.length?(o=[+e[0],+e[1]],t()):o.slice()},r.rangeRound=function(e){return o=[+e[0],+e[1]],s=!0,t()},r.bandwidth=function(){return n},r.step=function(){return e},r.round=function(e){return arguments.length?(s=!!e,t()):s},r.padding=function(e){return arguments.length?(l=u=Math.max(0,Math.min(1,e)),t()):l},r.paddingInner=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},r.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),t()):u},r.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),t()):c},r.copy=function(){return mo().domain(i()).range(o).round(s).paddingInner(l).paddingOuter(u).align(c)},t()}function go(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return go(e())},t}function vo(){return go(mo().paddingInner(1))}function yo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ub(e)}function bo(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}function xo(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}function _o(t,e,n,r){var i=t[0],a=t[1],o=e[0],s=e[1];return a<i?(i=n(a,i),o=r(s,o)):(i=n(i,a),o=r(o,s)),function(t){return o(i(t))}}function wo(t,e,n,r){var i=Math.min(t.length,e.length)-1,a=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)a[s]=n(t[s],t[s+1]),o[s]=r(e[s],e[s+1]);return function(e){var n=Cu(t,e,1,i)-1;return o[n](a[n](e))}}function So(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function ko(t,e){function n(){return i=Math.min(s.length,l.length)>2?wo:_o,a=o=null,r}function r(e){return(a||(a=i(s,l,c?bo(t):t,u)))(+e)}var i,a,o,s=hb,l=hb,u=pf,c=!1;return r.invert=function(t){return(o||(o=i(l,s,yo,c?xo(e):e)))(+t)},r.domain=function(t){return arguments.length?(s=ob.call(t,cb),n()):s.slice()},r.range=function(t){return arguments.length?(l=sb.call(t),n()):l.slice()},r.rangeRound=function(t){return l=sb.call(t),u=mf,n()},r.clamp=function(t){return arguments.length?(c=!!t,n()):c},r.interpolate=function(t){return arguments.length?(u=t,n()):u},n()}function Mo(t){var e=t.domain;return t.ticks=function(t){var n=e();return Vu(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return fb(e(),t,n)},t.nice=function(r){var i=e(),a=i.length-1,o=null==r?10:r,s=i[0],l=i[a],u=n(s,l,o);return u&&(u=n(Math.floor(s/u)*u,Math.ceil(l/u)*u,o),i[0]=Math.floor(s/u)*u,i[a]=Math.ceil(l/u)*u,e(i)),t},t}function To(){var t=ko(yo,uf);return t.copy=function(){return So(t,To())},Mo(t)}function Co(){function t(t){return+t}var e=[0,1];return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=ob.call(n,cb),t):e.slice()},t.copy=function(){return Co().domain(e)},Mo(t)}function Ao(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:ub(e)}function Po(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function Eo(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Oo(t){return 10===t?Eo:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Do(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function $o(t){return function(e){return-t(-e)}}function Io(){function e(){return a=Do(i),o=Oo(i),r()[0]<0&&(a=$o(a),o=$o(o)),n}var n=ko(Ao,Po).domain([1,10]),r=n.domain,i=10,a=Do(10),o=Oo(10);return n.base=function(t){return arguments.length?(i=+t,e()):i},n.domain=function(t){return arguments.length?(r(t),e()):r()},n.ticks=function(t){var e,n=r(),s=n[0],l=n[n.length-1];(e=l<s)&&(f=s,s=l,l=f);var u,c,h,f=a(s),d=a(l),p=null==t?10:+t,m=[];if(!(i%1)&&d-f<p){if(f=Math.round(f)-1,d=Math.round(d)+1,s>0){for(;f<d;++f)for(c=1,u=o(f);c<i;++c)if(!((h=u*c)<s)){if(h>l)break;m.push(h)}}else for(;f<d;++f)for(c=i-1,u=o(f);c>=1;--c)if(!((h=u*c)<s)){if(h>l)break;m.push(h)}}else m=Vu(f,d,Math.min(d-f,p)).map(o);return e?m.reverse():m},n.tickFormat=function(e,r){if(null==r&&(r=10===i?".0e":","),"function"!=typeof r&&(r=t.format(r)),e===1/0)return r;null==e&&(e=10);var s=Math.max(1,i*e/n.ticks().length);return function(t){var e=t/o(Math.round(a(t)));return e*i<i-.5&&(e*=i),e<=s?r(t):""}},n.nice=function(){return r(db(r(),{floor:function(t){return o(Math.floor(a(t)))},ceil:function(t){return o(Math.ceil(a(t)))}}))},n.copy=function(){return So(n,Io().base(i))},n}function Ro(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function Fo(){function t(t,e){return(e=Ro(e,n)-(t=Ro(t,n)))?function(r){return(Ro(r,n)-t)/e}:ub(e)}function e(t,e){return e=Ro(e,n)-(t=Ro(t,n)),function(r){return Ro(t+e*r,1/n)}}var n=1,r=ko(t,e),i=r.domain;return r.exponent=function(t){return arguments.length?(n=+t,i(i())):n},r.copy=function(){return So(r,Fo().exponent(n))},Mo(r)}function No(){return Fo().exponent(.5)}function qo(){function t(){var t=0,a=Math.max(1,r.length);for(i=new Array(a-1);++t<a;)i[t-1]=Hu(n,t/a);return e}function e(t){if(!isNaN(t=+t))return r[Cu(i,t)]}var n=[],r=[],i=[];return e.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},e.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var r,i=0,a=e.length;i<a;++i)null==(r=e[i])||isNaN(r=+r)||n.push(r);return n.sort(ku),t()},e.range=function(e){return arguments.length?(r=sb.call(e),t()):r.slice()},e.quantiles=function(){return i.slice()},e.copy=function(){return qo().domain(n).range(r)},e}function jo(){function t(t){if(t<=t)return o[Cu(a,t,0,i)]}function e(){var e=-1;for(a=new Array(i);++e<i;)a[e]=((e+1)*r-(e-i)*n)/(i+1);return t}var n=0,r=1,i=1,a=[.5],o=[0,1];return t.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],e()):[n,r]},t.range=function(t){return arguments.length?(i=(o=sb.call(t)).length-1,e()):o.slice()},t.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:e>=i?[a[i-1],r]:[a[e-1],a[e]]},t.copy=function(){return jo().domain([n,r]).range(o)},Mo(t)}function Lo(){function t(t){if(t<=t)return n[Cu(e,t,0,r)]}var e=[.5],n=[0,1],r=1;return t.domain=function(i){return arguments.length?(e=sb.call(i),r=Math.min(e.length,n.length-1),t):e.slice()},t.range=function(i){return arguments.length?(n=sb.call(i),r=Math.min(e.length,n.length-1),t):n.slice()},t.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},t.copy=function(){return Lo().domain(e).range(n)},t}function Uo(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(new Date(+n))}while(e(n,a),t(n),n<r);return o},i.filter=function(n){return Uo(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return pb.setTime(+e),mb.setTime(+r),t(pb),t(mb),Math.floor(n(pb,mb))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}function zo(t){return Uo(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*yb)/xb})}function Vo(t){return Uo(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/xb})}function Bo(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Yo(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ho(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Qo(t){function e(t,e){return function(n){var r,i,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),null!=(i=yx[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}}function n(t,e){return function(n){var i=Ho(1900);if(r(i,t,n+="",0)!=n.length)return null;if("p"in i&&(i.H=i.H%12+12*i.p),"W"in i||"U"in i){"w"in i||(i.w="W"in i?1:0);var a="Z"in i?Yo(Ho(i.y)).getUTCDay():e(Ho(i.y)).getDay();i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7}return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Yo(i)):e(i)}}function r(t,e,n,r){for(var i,a,o=0,s=e.length,l=n.length;o<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=z[i in yx?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function i(t,e,n){var r=E.exec(e.slice(n));return r?(t.p=O[r[0].toLowerCase()],n+r[0].length):-1}function a(t,e,n){var r=I.exec(e.slice(n));return r?(t.w=R[r[0].toLowerCase()],n+r[0].length):-1}function o(t,e,n){var r=D.exec(e.slice(n));return r?(t.w=$[r[0].toLowerCase()],n+r[0].length):-1}function s(t,e,n){var r=q.exec(e.slice(n));return r?(t.m=j[r[0].toLowerCase()],n+r[0].length):-1}function l(t,e,n){var r=F.exec(e.slice(n));return r?(t.m=N[r[0].toLowerCase()],n+r[0].length):-1}function u(t,e,n){return r(t,w,e,n)}function c(t,e,n){return r(t,S,e,n)}function h(t,e,n){return r(t,k,e,n)}function f(t){return C[t.getDay()]}function d(t){return T[t.getDay()]}function p(t){return P[t.getMonth()]}function m(t){return A[t.getMonth()]}function g(t){return M[+(t.getHours()>=12)]}function v(t){return C[t.getUTCDay()]}function y(t){return T[t.getUTCDay()]}function b(t){return P[t.getUTCMonth()]}function x(t){return A[t.getUTCMonth()]}function _(t){return M[+(t.getUTCHours()>=12)]}var w=t.dateTime,S=t.date,k=t.time,M=t.periods,T=t.days,C=t.shortDays,A=t.months,P=t.shortMonths,E=Ko(M),O=Xo(M),D=Ko(T),$=Xo(T),I=Ko(C),R=Xo(C),F=Ko(A),N=Xo(A),q=Ko(P),j=Xo(P),L={a:f,A:d,b:p,B:m,c:null,d:fs,e:fs,H:ds,I:ps,j:ms,L:gs,m:vs,M:ys,p:g,S:bs,U:xs,w:_s,W:ws,x:null,X:null,y:Ss,Y:ks,Z:Ms,"%":Ls},U={a:v,A:y,b:b,B:x,c:null,d:Ts,e:Ts,H:Cs,I:As,j:Ps,L:Es,m:Os,M:Ds,p:_,S:$s,U:Is,w:Rs,W:Fs,x:null,X:null,y:Ns,Y:qs,Z:js,"%":Ls},z={a:a,A:o,b:s,B:l,c:u,d:as,e:as,H:ss,I:ss,j:os,L:cs,m:is,M:ls,p:i,S:us,U:Zo,w:Jo,W:ts,x:c,X:h,y:ns,Y:es,Z:rs,"%":hs};return L.x=e(S,L),L.X=e(k,L),L.c=e(w,L),U.x=e(S,U),U.X=e(k,U),U.c=e(w,U),{format:function(t){var n=e(t+="",L);return n.toString=function(){return t},n},parse:function(t){var e=n(t+="",Bo);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",U);return n.toString=function(){return t},n},utcParse:function(t){var e=n(t,Yo);return e.toString=function(){return t},e}}}function Wo(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Go(t){return t.replace(_x,"\\$&")}function Ko(t){return new RegExp("^(?:"+t.map(Go).join("|")+")","i")}function Xo(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Jo(t,e,n){var r=bx.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Zo(t,e,n){var r=bx.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function ts(t,e,n){var r=bx.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function es(t,e,n){var r=bx.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function ns(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function rs(t,e,n){var r=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function is(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function as(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function os(t,e,n){var r=bx.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ss(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ls(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function us(t,e,n){var r=bx.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function cs(t,e,n){var r=bx.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function hs(t,e,n){var r=xx.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function fs(t,e){return Wo(t.getDate(),e,2)}function ds(t,e){return Wo(t.getHours(),e,2)}function ps(t,e){return Wo(t.getHours()%12||12,e,2)}function ms(t,e){return Wo(1+Cb.count(Yb(t),t),e,3)}function gs(t,e){return Wo(t.getMilliseconds(),e,3)}function vs(t,e){return Wo(t.getMonth()+1,e,2)}function ys(t,e){return Wo(t.getMinutes(),e,2)}function bs(t,e){return Wo(t.getSeconds(),e,2)}function xs(t,e){return Wo(Pb.count(Yb(t),t),e,2)}function _s(t){return t.getDay()}function ws(t,e){return Wo(Eb.count(Yb(t),t),e,2)}function Ss(t,e){return Wo(t.getFullYear()%100,e,2)}function ks(t,e){return Wo(t.getFullYear()%1e4,e,4)}function Ms(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Wo(e/60|0,"0",2)+Wo(e%60,"0",2)}function Ts(t,e){return Wo(t.getUTCDate(),e,2)}function Cs(t,e){return Wo(t.getUTCHours(),e,2)}function As(t,e){return Wo(t.getUTCHours()%12||12,e,2)}function Ps(t,e){return Wo(1+Xb.count(mx(t),t),e,3)}function Es(t,e){return Wo(t.getUTCMilliseconds(),e,3)}function Os(t,e){return Wo(t.getUTCMonth()+1,e,2)}function Ds(t,e){return Wo(t.getUTCMinutes(),e,2)}function $s(t,e){return Wo(t.getUTCSeconds(),e,2)}function Is(t,e){return Wo(Zb.count(mx(t),t),e,2)}function Rs(t){return t.getUTCDay()}function Fs(t,e){return Wo(tx.count(mx(t),t),e,2)}function Ns(t,e){return Wo(t.getUTCFullYear()%100,e,2)}function qs(t,e){return Wo(t.getUTCFullYear()%1e4,e,4)}function js(){return"+0000"}function Ls(){return"%"}function Us(e){return gx=Qo(e),t.timeFormat=gx.format,t.timeParse=gx.parse,t.utcFormat=gx.utcFormat,t.utcParse=gx.utcParse,gx}function zs(t){return t.toISOString()}function Vs(t){var e=new Date(t);return isNaN(e)?null:e}function Bs(t){return new Date(t)}function Ys(t){return t instanceof Date?+t:+new Date(+t)}function Hs(t,e,r,i,a,o,s,l,u){function c(n){return(s(n)<n?m:o(n)<n?g:a(n)<n?v:i(n)<n?y:e(n)<n?r(n)<n?b:x:t(n)<n?_:w)(n)}function h(e,r,i,a){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(i-r)/e,s=Mu(function(t){return t[2]}).right(S,o);s===S.length?(a=n(r/Ox,i/Ox,e),e=t):s?(s=S[o/S[s-1][2]<S[s][2]/o?s-1:s],a=s[1],e=s[0]):(a=n(r,i,e),e=l)}return null==a?e:e.every(a)}var f=ko(yo,uf),d=f.invert,p=f.domain,m=u(".%L"),g=u(":%S"),v=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),x=u("%b %d"),_=u("%B"),w=u("%Y"),S=[[s,1,Mx],[s,5,5*Mx],[s,15,15*Mx],[s,30,30*Mx],[o,1,Tx],[o,5,5*Tx],[o,15,15*Tx],[o,30,30*Tx],[a,1,Cx],[a,3,3*Cx],[a,6,6*Cx],[a,12,12*Cx],[i,1,Ax],[i,2,2*Ax],[r,1,Px],[e,1,Ex],[e,3,3*Ex],[t,1,Ox]];return f.invert=function(t){return new Date(d(t))},f.domain=function(t){return arguments.length?p(ob.call(t,Ys)):p().map(Bs)},f.ticks=function(t,e){var n,r=p(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=h(t,i,a,e),n=n?n.range(i,a+1):[],o?n.reverse():n},f.tickFormat=function(t,e){return null==e?c:u(e)},f.nice=function(t,e){var n=p();return(t=h(t,n[0],n[n.length-1],e))?p(db(n,t)):f},f.copy=function(){return So(f,Hs(t,e,r,i,a,o,s,l,u))},f}function Qs(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Ws(t){function e(e){var a=(e-n)/(r-n);return t(i?Math.max(0,Math.min(1,a)):a)}var n=0,r=1,i=!1;return e.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],e):[n,r]},e.clamp=function(t){return arguments.length?(i=!!t,e):i},e.interpolator=function(n){return arguments.length?(t=n,e):t},e.copy=function(){return Ws(t).domain([n,r]).clamp(i)},Mo(e)}function Gs(t){return t.innerRadius}function Ks(t){return t.outerRadius}function Xs(t){return t.startAngle}function Js(t){return t.endAngle}function Zs(t){return t&&t.padAngle}function tl(t){return t>=1?Xx:t<=-1?-Xx:Math.asin(t)}function el(t,e,n,r,i,a,o,s){var l=n-t,u=r-e,c=o-i,h=s-a,f=(c*(e-a)-h*(t-i))/(h*l-c*u);return[t+f*l,e+f*u]}function nl(t,e,n,r,i,a,o){var s=t-n,l=e-r,u=(o?a:-a)/Math.sqrt(s*s+l*l),c=u*l,h=-u*s,f=t+c,d=e+h,p=n+c,m=r+h,g=(f+p)/2,v=(d+m)/2,y=p-f,b=m-d,x=y*y+b*b,_=i-a,w=f*m-p*d,S=(b<0?-1:1)*Math.sqrt(Math.max(0,_*_*x-w*w)),k=(w*b-y*S)/x,M=(-w*y-b*S)/x,T=(w*b+y*S)/x,C=(-w*y+b*S)/x,A=k-g,P=M-v,E=T-g,O=C-v;return A*A+P*P>E*E+O*O&&(k=T,M=C),{cx:k,cy:M,x01:-c,y01:-h,x11:k*(i/_-1),y11:M*(i/_-1)}}function rl(t){this._context=t}function il(t){return t[0]}function al(t){return t[1]}function ol(t){this._curve=t}function sl(t){function e(e){return new ol(t(e))}return e._curve=t,e}function ll(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(sl(t)):e()._curve},t}function ul(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function cl(t){this._context=t}function hl(t){this._context=t}function fl(t){this._context=t}function dl(t,e){this._basis=new cl(t),this._beta=e}function pl(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function ml(t,e){this._context=t,this._k=(1-e)/6}function gl(t,e){this._context=t,this._k=(1-e)/6}function vl(t,e){this._context=t,this._k=(1-e)/6}function yl(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Gx){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>Gx){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function bl(t,e){this._context=t,this._alpha=e}function xl(t,e){this._context=t,this._alpha=e}function _l(t,e){this._context=t,this._alpha=e}function wl(t){this._context=t}function Sl(t){return t<0?-1:1}function kl(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Sl(a)+Sl(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Ml(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tl(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Cl(t){this._context=t}function Al(t){this._context=new Pl(t)}function Pl(t){this._context=t}function El(t){return new Cl(t)}function Ol(t){return new Al(t)}function Dl(t){this._context=t}function $l(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Il(t,e){this._context=t,this._t=e}function Rl(t){return new Il(t,0)}function Fl(t){return new Il(t,1)}function Nl(t,e){return t[e]}function ql(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function jl(t){return t[0]}function Ll(t){return t[1]}function Ul(){this._=null}function zl(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Vl(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Bl(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Yl(t){for(;t.L;)t=t.L;return t}function Hl(t,e,n,r){var i=[null,null],a=iw.push(i)-1;return i.left=t,i.right=e,n&&Wl(i,t,e,n),r&&Wl(i,e,t,r),nw[t.index].halfedges.push(a),nw[e.index].halfedges.push(a),i}function Ql(t,e,n){var r=[e,n];return r.left=t,r}function Wl(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Gl(t,e,n,r,i){var a,o=t[0],s=t[1],l=o[0],u=o[1],c=s[0],h=s[1],f=0,d=1,p=c-l,m=h-u;if(a=e-l,p||!(a>0)){if(a/=p,p<0){if(a<f)return;a<d&&(d=a)}else if(p>0){if(a>d)return;a>f&&(f=a)}if(a=r-l,p||!(a<0)){if(a/=p,p<0){if(a>d)return;a>f&&(f=a)}else if(p>0){if(a<f)return;a<d&&(d=a)}if(a=n-u,m||!(a>0)){if(a/=m,m<0){if(a<f)return;a<d&&(d=a)}else if(m>0){if(a>d)return;a>f&&(f=a)}if(a=i-u,m||!(a<0)){if(a/=m,m<0){if(a>d)return;a>f&&(f=a)}else if(m>0){if(a<f)return;a<d&&(d=a)}return!(f>0||d<1)||(f>0&&(t[0]=[l+f*p,u+f*m]),d<1&&(t[1]=[l+d*p,u+d*m]),!0)}}}}}function Kl(t,e,n,r,i){var a=t[1];if(a)return!0;var o,s,l=t[0],u=t.left,c=t.right,h=u[0],f=u[1],d=c[0],p=c[1],m=(h+d)/2,g=(f+p)/2;if(p===f){if(m<e||m>=r)return;if(h>d){if(l){if(l[1]>=i)return}else l=[m,n];a=[m,i]}else{if(l){if(l[1]<n)return}else l=[m,i];a=[m,n]}}else if(o=(h-d)/(p-f),s=g-o*m,o<-1||o>1)if(h>d){if(l){if(l[1]>=i)return}else l=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/o,i];a=[(n-s)/o,n]}else if(f<p){if(l){if(l[0]>=r)return}else l=[e,o*e+s];a=[r,o*r+s]}else{if(l){if(l[0]<e)return}else l=[r,o*r+s];a=[e,o*e+s]}return t[0]=l,t[1]=a,!0}function Xl(t,e,n,r){for(var i,a=iw.length;a--;)Kl(i=iw[a],t,e,n,r)&&Gl(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>sw||Math.abs(i[0][1]-i[1][1])>sw)||delete iw[a]}function Jl(t){return nw[t.index]={site:t,halfedges:[]}}function Zl(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function tu(t,e){return e[+(e.left!==t.site)]}function eu(t,e){return e[+(e.left===t.site)]}function nu(){for(var t,e,n,r,i=0,a=nw.length;i<a;++i)if((t=nw[i])&&(r=(e=t.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=Zl(t,iw[e[n]]);for(o.sort(function(t,e){return s[e]-s[t]}),n=0;n<r;++n)s[n]=e[o[n]];for(n=0;n<r;++n)e[n]=s[n]}}function ru(t,e,n,r){var i,a,o,s,l,u,c,h,f,d,p,m,g=nw.length,v=!0;for(i=0;i<g;++i)if(a=nw[i]){for(o=a.site,l=a.halfedges,s=l.length;s--;)iw[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)d=eu(a,iw[l[s]]),p=d[0],m=d[1],c=tu(a,iw[l[++s%u]]),h=c[0],f=c[1],(Math.abs(p-h)>sw||Math.abs(m-f)>sw)&&(l.splice(s,0,iw.push(Ql(o,d,Math.abs(p-t)<sw&&r-m>sw?[t,Math.abs(h-t)<sw?f:r]:Math.abs(m-r)<sw&&n-p>sw?[Math.abs(f-r)<sw?h:n,r]:Math.abs(p-n)<sw&&m-e>sw?[n,Math.abs(h-n)<sw?f:e]:Math.abs(m-e)<sw&&p-t>sw?[Math.abs(f-e)<sw?h:t,e]:null))-1),++u);u&&(v=!1)}if(v){var y,b,x,_=1/0;for(i=0,v=null;i<g;++i)(a=nw[i])&&(o=a.site,y=o[0]-t,b=o[1]-e,(x=y*y+b*b)<_&&(_=x,v=a));if(v){var w=[t,e],S=[t,r],k=[n,r],M=[n,e];v.halfedges.push(iw.push(Ql(o=v.site,w,S))-1,iw.push(Ql(o,S,k))-1,iw.push(Ql(o,k,M))-1,iw.push(Ql(o,M,w))-1)}}for(i=0;i<g;++i)(a=nw[i])&&(a.halfedges.length||delete nw[i])}function iu(){zl(this),this.x=this.y=this.arc=this.site=this.cy=null}function au(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,a=n.site;if(r!==a){var o=i[0],s=i[1],l=r[0]-o,u=r[1]-s,c=a[0]-o,h=a[1]-s,f=2*(l*h-u*c);if(!(f>=-lw)){var d=l*l+u*u,p=c*c+h*h,m=(h*d-u*p)/f,g=(l*p-c*d)/f,v=aw.pop()||new iu;v.arc=t,v.site=i,v.x=m+o,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,b=rw._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}rw.insert(y,v),y||(tw=v)}}}}function ou(t){var e=t.circle;e&&(e.P||(tw=e.N),rw.remove(e),aw.push(e),zl(e),t.circle=null)}function su(){zl(this),this.edge=this.site=this.circle=null}function lu(t){var e=ow.pop()||new su;return e.site=t,e}function uu(t){ou(t),ew.remove(t),ow.push(t),zl(t)}function cu(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],a=t.P,o=t.N,s=[t];uu(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<sw&&Math.abs(r-l.circle.cy)<sw;)a=l.P,s.unshift(l),uu(l),l=a;s.unshift(l),ou(l);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<sw&&Math.abs(r-u.circle.cy)<sw;)o=u.N,s.push(u),uu(u),u=o;s.push(u),ou(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],Wl(u.edge,l.site,u.site,i);l=s[0],u=s[h-1],u.edge=Hl(l.site,u.site,null,i),au(l),au(u)}function hu(t){for(var e,n,r,i,a=t[0],o=t[1],s=ew._;s;)if((r=fu(s,o)-a)>sw)s=s.L;else{if(!((i=a-du(s,o))>sw)){r>-sw?(e=s.P,n=s):i>-sw?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}Jl(t);var l=lu(t);if(ew.insert(e,l),e||n){if(e===n)return ou(e),n=lu(e.site),ew.insert(l,n),l.edge=n.edge=Hl(e.site,l.site),au(e),void au(n);if(!n)return void(l.edge=Hl(e.site,l.site));ou(e),ou(n);var u=e.site,c=u[0],h=u[1],f=t[0]-c,d=t[1]-h,p=n.site,m=p[0]-c,g=p[1]-h,v=2*(f*g-d*m),y=f*f+d*d,b=m*m+g*g,x=[(g*y-d*b)/v+c,(f*b-m*y)/v+h];Wl(n.edge,u,p,x),l.edge=Hl(u,t,null,x),n.edge=Hl(t,p,null,x),au(e),au(n)}}function fu(t,e){var n=t.site,r=n[0],i=n[1],a=i-e;if(!a)return r;var o=t.P;if(!o)return-1/0;n=o.site;var s=n[0],l=n[1],u=l-e;if(!u)return s;var c=s-r,h=1/a-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+i-a/2)))/h+r:(r+s)/2}function du(t,e){var n=t.N;if(n)return fu(n,e);var r=t.site;return r[1]===e?r[0]:1/0}function pu(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function mu(t,e){return e[1]-t[1]||e[0]-t[0]}function gu(t,e){var n,r,i,a=t.sort(mu).pop();for(iw=[],nw=new Array(t.length),ew=new Ul,rw=new Ul;;)if(i=tw,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(hu(a),n=a[0],r=a[1]),a=t.pop();else{if(!i)break;cu(i.arc)}if(nu(),e){var o=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];Xl(o,s,l,u),ru(o,s,l,u)}this.edges=iw,this.cells=nw,ew=rw=iw=nw=null}function vu(t,e,n){this.target=t,this.type=e,this.transform=n}function yu(t,e,n){this.k=t,this.x=e,this.y=n}function bu(t){return t.__zoom||hw}function xu(){t.event.stopImmediatePropagation()}function _u(){return!t.event.button}function wu(){var t,e,n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,t=n.width.baseVal.value,e=n.height.baseVal.value):(t=n.clientWidth,e=n.clientHeight),[[0,0],[t,e]]}function Su(){return this.__zoom||hw}var ku=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Mu=function(t){return 1===t.length&&(t=e(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}},Tu=Mu(ku),Cu=Tu.right,Au=Tu.left,Pu=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Eu=function(t){return null===t?NaN:+t},Ou=function(t,e){var n,r,i=t.length,a=0,o=0,s=-1,l=0;if(null==e)for(;++s<i;)isNaN(n=Eu(t[s]))||(r=n-a,a+=r/++l,o+=r*(n-a));else for(;++s<i;)isNaN(n=Eu(e(t[s],s,t)))||(r=n-a,a+=r/++l,o+=r*(n-a));if(l>1)return o/(l-1)},Du=function(t,e){var n=Ou(t,e);return n?Math.sqrt(n):n},$u=function(t,e){var n,r,i,a=-1,o=t.length;if(null==e){for(;++a<o;)if(null!=(r=t[a])&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=t[a])&&(n>r&&(n=r),i<r&&(i=r))}else{for(;++a<o;)if(null!=(r=e(t[a],a,t))&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=e(t[a],a,t))&&(n>r&&(n=r),i<r&&(i=r))}return[n,i]},Iu=Array.prototype,Ru=Iu.slice,Fu=Iu.map,Nu=function(t){return function(){return t}},qu=function(t){return t},ju=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},Lu=Math.sqrt(50),Uu=Math.sqrt(10),zu=Math.sqrt(2),Vu=function(t,e,r){var i=n(t,e,r);return ju(Math.ceil(t/i)*i,Math.floor(e/i)*i+i/2,i)},Bu=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},Yu=function(){function t(t){var i,a,o=t.length,s=new Array(o);for(i=0;i<o;++i)s[i]=e(t[i],i,t);var l=n(s),u=l[0],c=l[1],h=r(s,u,c);Array.isArray(h)||(h=Vu(u,c,h));for(var f=h.length;h[0]<=u;)h.shift(),--f;for(;h[f-1]>=c;)h.pop(),--f;var d,p=new Array(f+1);for(i=0;i<=f;++i)d=p[i]=[],d.x0=i>0?h[i-1]:u,d.x1=i<f?h[i]:c;for(i=0;i<o;++i)a=s[i],u<=a&&a<=c&&p[Cu(h,a,0,f)].push(t[i]);return p}var e=qu,n=$u,r=Bu;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Nu(n),t):e},t.domain=function(e){return arguments.length?(n="function"==typeof e?e:Nu([e[0],e[1]]),t):n},t.thresholds=function(e){return arguments.length?(r="function"==typeof e?e:Nu(Array.isArray(e)?Ru.call(e):e),t):r},t},Hu=function(t,e,n){if(null==n&&(n=Eu),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}},Qu=function(t,e,n){return t=Fu.call(t,Eu).sort(ku),Math.ceil((n-e)/(2*(Hu(t,.75)-Hu(t,.25))*Math.pow(t.length,-1/3)))},Wu=function(t,e,n){return Math.ceil((n-e)/(3.5*Du(t)*Math.pow(t.length,-1/3)))},Gu=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&r>n&&(n=r)}return n},Ku=function(t,e){var n,r=0,i=t.length,a=-1,o=i;if(null==e)for(;++a<i;)isNaN(n=Eu(t[a]))?--o:r+=n;else for(;++a<i;)isNaN(n=Eu(e(t[a],a,t)))?--o:r+=n;if(o)return r/o},Xu=function(t,e){var n,r=[],i=t.length,a=-1;if(null==e)for(;++a<i;)isNaN(n=Eu(t[a]))||r.push(n);else for(;++a<i;)isNaN(n=Eu(e(t[a],a,t)))||r.push(n);return Hu(r.sort(ku),.5)},Ju=function(t){for(var e,n,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(n=new Array(o);--i>=0;)for(r=t[i],e=r.length;--e>=0;)n[--o]=r[e];return n},Zu=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&n>r&&(n=r)}return n},tc=function(t){for(var e=0,n=t.length-1,r=t[0],i=new Array(n<0?0:n);e<n;)i[e]=[r,r=t[++e]];return i},ec=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},nc=function(t,e){if(n=t.length){var n,r,i=0,a=0,o=t[a];for(e||(e=ku);++i<n;)(e(r=t[i],o)<0||0!==e(o,o))&&(o=r,a=i);return 0===e(o,o)?a:void 0}},rc=function(t,e,n){for(var r,i,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)i=Math.random()*a--|0,r=t[a+e],t[a+e]=t[i+e],t[i+e]=r;return t},ic=function(t,e){var n,r=0,i=t.length,a=-1;if(null==e)for(;++a<i;)(n=+t[a])&&(r+=n);else for(;++a<i;)(n=+e(t[a],a,t))&&(r+=n);return r},ac=function(t){if(!(a=t.length))return[];for(var e=-1,n=Zu(t,r),i=new Array(n);++e<n;)for(var a,o=-1,s=i[e]=new Array(a);++o<a;)s[o]=t[o][e];return i},oc=function(){return ac(arguments)},sc=Array.prototype.slice,lc=function(t){return t},uc=1,cc=2,hc=3,fc=4,dc=1e-6,pc={value:function(){}};p.prototype=d.prototype={constructor:p,on:function(t,e){var n,r=this._,i=m(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=v(r[n],t.name,e);else if(null==e)for(n in r)r[n]=v(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=g(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new p(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],a=0,n=r.length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var mc="http://www.w3.org/1999/xhtml",gc={svg:"http://www.w3.org/2000/svg",xhtml:mc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},vc=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),gc.hasOwnProperty(e)?{space:gc[e],local:t}:t},yc=function(t){var e=vc(t);return(e.local?b:y)(e)},bc=0;_.prototype=x.prototype={constructor:_,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var xc=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var _c=document.documentElement;if(!_c.matches){var wc=_c.webkitMatchesSelector||_c.msMatchesSelector||_c.mozMatchesSelector||_c.oMatchesSelector;xc=function(t){return function(){return wc.call(this,t)}}}}var Sc=xc,kc={};if(t.event=null,"undefined"!=typeof document){"onmouseenter"in document.documentElement||(kc={mouseenter:"mouseover",mouseleave:"mouseout"})}var Mc=function(t,e,n){var r,i,a=k(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?T:M,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},Tc=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},Cc=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},Ac=function(t){var e=Tc();return e.changedTouches&&(e=e.changedTouches[0]),Cc(t,e)},Pc=function(t){return null==t?A:function(){return this.querySelector(t)}},Ec=function(t){"function"!=typeof t&&(t=Pc(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new dt(r,this._parents)},Oc=function(t){return null==t?P:function(){return this.querySelectorAll(t)}},Dc=function(t){"function"!=typeof t&&(t=Oc(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new dt(r,i)},$c=function(t){"function"!=typeof t&&(t=Sc(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new dt(r,this._parents)},Ic=function(t){return new Array(t.length)},Rc=function(){return new dt(this._enter||this._groups.map(Ic),this._parents)};E.prototype={constructor:E,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Fc=function(t){return function(){return t}},Nc="$",qc=function(t,e){if(!t)return d=new Array(this.size()),u=-1,this.each(function(t){d[++u]=t}),d;var n=e?D:O,r=this._parents,i=this._groups;"function"!=typeof t&&(t=Fc(t));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],h=i[u],f=h.length,d=t.call(c,c&&c.__data__,u,r),p=d.length,m=s[u]=new Array(p),g=o[u]=new Array(p);n(c,h,m,g,l[u]=new Array(f),d,e);for(var v,y,b=0,x=0;b<p;++b)if(v=m[b]){for(b>=x&&(x=b+1);!(y=g[x])&&++x<p;);v._next=y||null}}return o=new dt(o,r),o._enter=s,o._exit=l,o},jc=function(){return new dt(this._exit||this._groups.map(Ic),this._parents)},Lc=function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,f=o[s]=new Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(f[d]=l);for(;s<r;++s)o[s]=e[s];return new dt(o,this._parents)},Uc=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},zc=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=$);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(e)}return new dt(i,this._parents).order()},Vc=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},Bc=function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},Yc=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},Hc=function(){var t=0;return this.each(function(){++t}),t},Qc=function(){return!this.node()},Wc=function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},Gc=function(t,e){var n=vc(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?R:I:"function"==typeof e?n.local?j:q:n.local?N:F)(n,e))},Kc=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView},Xc=function(t,e,n){var r;return arguments.length>1?this.each((null==e?L:"function"==typeof e?z:U)(t,e,null==n?"":n)):Kc(r=this.node()).getComputedStyle(r,null).getPropertyValue(t)},Jc=function(t,e){return arguments.length>1?this.each((null==e?V:"function"==typeof e?Y:B)(t,e)):this.node()[t]};W.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Zc=function(t,e){var n=H(t+"");if(arguments.length<2){for(var r=Q(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Z:e?X:J)(n,e))},th=function(t){return arguments.length?this.each(null==t?tt:("function"==typeof t?nt:et)(t)):this.node().textContent},eh=function(t){return arguments.length?this.each(null==t?rt:("function"==typeof t?at:it)(t)):this.node().innerHTML},nh=function(){return this.each(ot)},rh=function(){return this.each(st)},ih=function(t){var e="function"==typeof t?t:yc(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},ah=function(t,e){var n="function"==typeof t?t:yc(t),r=null==e?lt:"function"==typeof e?e:Pc(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},oh=function(){return this.each(ut)},sh=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},lh=function(t,e){return this.each(("function"==typeof e?ft:ht)(t,e))},uh=[null];dt.prototype=pt.prototype={constructor:dt,select:Ec,selectAll:Dc,filter:$c,data:qc,enter:Rc,exit:jc,merge:Lc,order:Uc,sort:zc,call:Vc,nodes:Bc,node:Yc,size:Hc,empty:Qc,each:Wc,attr:Gc,style:Xc,property:Jc,classed:Zc,text:th,html:eh,raise:nh,lower:rh,append:ih,insert:ah,remove:oh,datum:sh,on:Mc,dispatch:lh};var ch=function(t){return"string"==typeof t?new dt([[document.querySelector(t)]],[document.documentElement]):new dt([[t]],uh)},hh=function(t){return"string"==typeof t?new dt([document.querySelectorAll(t)],[document.documentElement]):new dt([null==t?[]:t],uh)},fh=function(t,e,n){arguments.length<3&&(n=e,e=Tc().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return Cc(t,r);return null},dh=function(t,e){null==e&&(e=Tc().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=Cc(t,e[n]);return i},ph=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},mh=function(t){var e=t.document.documentElement,n=ch(t).on("dragstart.drag",ph,!0);"onselectstart"in e?n.on("selectstart.drag",ph,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")},gh=function(t){return function(){return t}};vt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var vh=function(){function e(t){t.on("mousedown.drag",n).on("touchstart.drag",a).on("touchmove.drag",o).on("touchend.drag touchcancel.drag",s).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function n(){if(!c&&h.apply(this,arguments)){var e=l("mouse",f.apply(this,arguments),Ac,this,arguments);e&&(ch(t.event.view).on("mousemove.drag",r,!0).on("mouseup.drag",i,!0),mh(t.event.view),mt(),u=!1,e("start"))}}function r(){ph(),u=!0,m.mouse("drag")}function i(){ch(t.event.view).on("mousemove.drag mouseup.drag",null),gt(t.event.view,u),ph(),m.mouse("end")}function a(){if(h.apply(this,arguments)){var e,n,r=t.event.changedTouches,i=f.apply(this,arguments),a=r.length;for(e=0;e<a;++e)(n=l(r[e].identifier,i,fh,this,arguments))&&(mt(),n("start"))}}function o(){var e,n,r=t.event.changedTouches,i=r.length;for(e=0;e<i;++e)(n=m[r[e].identifier])&&(ph(),n("drag"))}function s(){var e,n,r=t.event.changedTouches,i=r.length;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),e=0;e<i;++e)(n=m[r[e].identifier])&&(mt(),n("end"))}function l(n,r,i,a,o){var s,l,u,c=i(r,n),h=g.copy();if(C(new vt(e,"beforestart",s,n,v,c[0],c[1],0,0,h),function(){return null!=(t.event.subject=s=p.apply(a,o))&&(l=s.x-c[0]||0,u=s.y-c[1]||0,!0)}))return function t(f){var d,p=c;switch(f){case"start":m[n]=t,d=v++;break;case"end":delete m[n],--v;case"drag":c=i(r,n),d=v}C(new vt(e,f,s,n,d,c[0]+l,c[1]+u,c[0]-p[0],c[1]-p[1],h),h.apply,h,[f,a,o])}}var u,c,h=yt,f=bt,p=xt,m={},g=d("start","drag","end"),v=0;return e.filter=function(t){return arguments.length?(h="function"==typeof t?t:gh(!!t),e):h},e.container=function(t){return arguments.length?(f="function"==typeof t?t:gh(t),e):f},e.subject=function(t){return arguments.length?(p="function"==typeof t?t:gh(t),e):p},e.on=function(){var t=g.on.apply(g,arguments);return t===g?e:t},e},yh=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},bh=1/.7,xh="\\s*([+-]?\\d+)\\s*",_h="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",wh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Sh=/^#([0-9a-f]{3})$/,kh=/^#([0-9a-f]{6})$/,Mh=new RegExp("^rgb\\("+[xh,xh,xh]+"\\)$"),Th=new RegExp("^rgb\\("+[wh,wh,wh]+"\\)$"),Ch=new RegExp("^rgba\\("+[xh,xh,xh,_h]+"\\)$"),Ah=new RegExp("^rgba\\("+[wh,wh,wh,_h]+"\\)$"),Ph=new RegExp("^hsl\\("+[_h,wh,wh]+"\\)$"),Eh=new RegExp("^hsla\\("+[_h,wh,wh,_h]+"\\)$"),Oh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yh(wt,St,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),yh(At,Ct,_t(wt,{brighter:function(t){return t=null==t?bh:Math.pow(bh,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),yh(Dt,Ot,_t(wt,{brighter:function(t){return t=null==t?bh:Math.pow(bh,t),new Dt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Dt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new At($t(t>=240?t-240:t+120,i,r),$t(t,i,r),$t(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Dh=Math.PI/180,$h=180/Math.PI,Ih=.95047,Rh=1,Fh=1.08883,Nh=4/29,qh=6/29,jh=3*qh*qh,Lh=qh*qh*qh;yh(Ft,Rt,_t(wt,{brighter:function(t){return new Ft(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Ft(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=Rh*qt(t),e=Ih*qt(e),n=Fh*qt(n),new At(jt(3.2404542*e-1.5371385*t-.4985314*n),jt(-.969266*e+1.8760108*t+.041556*n),jt(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),yh(Vt,zt,_t(wt,{brighter:function(t){return new Vt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Vt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return It(this).rgb()}}));var Uh=1.78277,zh=-.29227,Vh=-.90649,Bh=1.97294,Yh=Bh*Vh,Hh=Bh*Uh,Qh=Uh*zh- -.14861*Vh;yh(Ht,Yt,_t(wt,{brighter:function(t){return t=null==t?bh:Math.pow(bh,t),new Ht(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ht(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Dh,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new At(255*(e+n*(-.14861*r+Uh*i)),255*(e+n*(zh*r+Vh*i)),255*(e+n*(Bh*r)),this.opacity)}}));var Wh,Gh,Kh,Xh,Jh,Zh,tf=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Qt((n-r/e)*e,o,i,a,s)}},ef=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Qt((n-r/e)*e,i,a,o,s)}},nf=function(t){return function(){return t}},rf=function t(e){function n(t,e){var n=r((t=Ct(t)).r,(e=Ct(e)).r),i=r(t.g,e.g),a=r(t.b,e.b),o=Jt(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}var r=Xt(e);return n.gamma=t,n}(1),af=Zt(tf),of=Zt(ef),sf=function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(r),o=new Array(r);for(n=0;n<i;++n)a[n]=pf(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}},lf=function(t,e){var n=new Date;return t=+t,e-=t,function(r){return n.setTime(t+e*r),n}},uf=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},cf=function(t,e){var n,r={},i={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?r[n]=pf(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},hf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ff=new RegExp(hf.source,"g"),df=function(t,e){var n,r,i,a=hf.lastIndex=ff.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=hf.exec(t))&&(r=ff.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:uf(n,r)})),a=ff.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?ee(l[0].x):te(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})},pf=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?nf(e):("number"===r?uf:"string"===r?(n=St(e))?(e=n,rf):df:e instanceof St?rf:e instanceof Date?lf:Array.isArray(e)?sf:isNaN(e)?cf:uf)(t,e)},mf=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}},gf=180/Math.PI,vf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},yf=function(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*gf,skewX:Math.atan(l)*gf,scaleX:o,scaleY:s}},bf=ie(ne,"px, ","px)","deg)"),xf=ie(re,", ",")",")"),_f=Math.SQRT2,wf=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],l=e[1],u=e[2],c=s-i,h=l-a,f=c*c+h*h;if(f<1e-12)r=Math.log(u/o)/_f,n=function(t){return[i+t*c,a+t*h,o*Math.exp(_f*t*r)]};else{var d=Math.sqrt(f),p=(u*u-o*o+4*f)/(2*o*2*d),m=(u*u-o*o-4*f)/(2*u*2*d),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(m*m+1)-m);r=(v-g)/_f,n=function(t){var e=t*r,n=ae(g),s=o/(2*d)*(n*se(_f*e+g)-oe(g));return[i+s*c,a+s*h,o*n/ae(_f*e+g)]}}return n.duration=1e3*r,n},Sf=le(Kt),kf=le(Jt),Mf=ce(Kt),Tf=ce(Jt),Cf=he(Kt),Af=he(Jt),Pf=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},Ef=0,Of=0,Df=0,$f=1e3,If=0,Rf=0,Ff=0,Nf="object"==typeof performance&&performance.now?performance:Date,qf="function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){setTimeout(t,17)};pe.prototype=me.prototype={constructor:pe,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?fe():+n)+(null==e?0:+e),this._next||Zh===this||(Zh?Zh._next=this:Jh=this,Zh=this),this._call=t,this._time=n,xe()},stop:function(){this._call&&(this._call=null,this._time=1/0,xe())}};var jf=function(t,e,n){var r=new pe;return e=null==e?0:+e,r.restart(function(n){r.stop(),t(n+e)},e,n),r},Lf=function(t,e,n){var r=new pe,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?fe():+n,r.restart(function a(o){o+=i,r.restart(a,i+=e,n),t(o)},e,n),r)},Uf=d("start","end","interrupt"),zf=[],Vf=0,Bf=1,Yf=2,Hf=3,Qf=4,Wf=5,Gf=6,Kf=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};ke(t,n,{name:e,index:r,group:i,on:Uf,tween:zf,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Vf})},Xf=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){e=null==e?null:e+"";for(i in a)(n=a[i]).name===e?(r=n.state>Yf&&n.state<Wf,n.state=Gf,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}},Jf=function(t){return this.each(function(){Xf(this,t)})},Zf=function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Se(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?Me:Te)(n,t,e))},td=function(t,e){var n;return("number"==typeof e?uf:e instanceof St?rf:(n=St(e))?(e=n,rf):df)(t,e)},ed=function(t,e){var n=vc(t),r="transform"===n?xf:td;return this.attrTween(t,"function"==typeof e?(n.local?$e:De)(n,r,Ce(this,"attr."+t,e)):null==e?(n.local?Pe:Ae)(n):(n.local?Oe:Ee)(n,r,e))},nd=function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=vc(t);return this.tween(n,(r.local?Ie:Re)(r,e))},rd=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Fe:Ne)(e,t)):Se(this.node(),e).delay},id=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?qe:je)(e,t)):Se(this.node(),e).duration},ad=function(t){var e=this._id;return arguments.length?this.each(Le(e,t)):Se(this.node(),e).ease},od=function(t){"function"!=typeof t&&(t=Sc(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new Xe(r,this._parents,this._name,this._id)},sd=function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,f=o[s]=new Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(f[d]=l);for(;s<r;++s)o[s]=e[s];return new Xe(o,this._parents,this._name,this._id)},ld=function(t,e){var n=this._id;return arguments.length<2?Se(this.node(),n).on.on(t):this.each(ze(n,t,e))},ud=function(){return this.on("end.remove",Ve(this._id))},cd=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Pc(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,l,u=r[o],c=u.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=u[f])&&(l=t.call(s,s.__data__,f,u))&&("__data__"in s&&(l.__data__=s.__data__),h[f]=l,Kf(h[f],e,n,f,h,Se(s,n)));return new Xe(a,this._parents,e,n)},hd=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Oc(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,d=t.call(l,l.__data__,h,u),p=Se(l,n),m=0,g=d.length;m<g;++m)(f=d[m])&&Kf(f,e,n,m,d,p);a.push(d),o.push(l)}return new Xe(a,o,e,n)},fd=pt.prototype.constructor,dd=function(){return new fd(this._groups,this._parents)},pd=function(t,e,n){var r="transform"==(t+="")?bf:td;return null==e?this.styleTween(t,Be(t,r)).on("end.style."+t,Ye(t)):this.styleTween(t,"function"==typeof e?Qe(t,r,Ce(this,"style."+t,e)):He(t,r,e),n)},md=function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,We(t,e,null==n?"":n))},gd=function(t){return this.tween("text","function"==typeof t?Ke(Ce(this,"text",t)):Ge(null==t?"":t+""))},vd=function(){for(var t=this._name,e=this._id,n=Ze(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=Se(o,e);Kf(o,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Xe(r,this._parents,t,n)},yd=0,bd=pt.prototype;Xe.prototype=Je.prototype={constructor:Xe,select:cd,selectAll:hd,filter:od,merge:sd,selection:dd,transition:vd,call:bd.call,nodes:bd.nodes,node:bd.node,size:bd.size,empty:bd.empty,each:bd.each,on:ld,attr:ed,attrTween:nd,style:pd,styleTween:md,text:gd,remove:ud,tween:Zf,delay:rd,duration:id,ease:ad};var xd=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),_d=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),wd=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Sd=Math.PI,kd=Sd/2,Md=4/11,Td=6/11,Cd=8/11,Ad=.75,Pd=9/11,Ed=10/11,Od=.9375,Dd=21/22,$d=63/64,Id=1/Md/Md,Rd=1.70158,Fd=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(Rd),Nd=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(Rd),qd=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(Rd),jd=2*Math.PI,Ld=function t(e,n){function r(t){return e*Math.pow(2,10*--t)*Math.sin((i-t)/n)}var i=Math.asin(1/(e=Math.max(1,e)))*(n/=jd);return r.amplitude=function(e){return t(e,n*jd)},r.period=function(n){return t(e,n)},r}(1,.3),Ud=function t(e,n){function r(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+i)/n)}var i=Math.asin(1/(e=Math.max(1,e)))*(n/=jd);return r.amplitude=function(e){return t(e,n*jd)},r.period=function(n){return t(e,n)},r}(1,.3),zd=function t(e,n){function r(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((i-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((i+t)/n))/2}var i=Math.asin(1/(e=Math.max(1,e)))*(n/=jd);return r.amplitude=function(e){return t(e,n*jd)},r.period=function(n){return t(e,n)},r}(1,.3),Vd={time:null,delay:0,duration:250,ease:sn},Bd=function(t){var e,n;t instanceof Xe?(e=t._id,t=t._name):(e=Ze(),(n=Vd).time=fe(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)(o=s[u])&&Kf(o,t,e,u,s,n||xn(o,e));return new Xe(r,this._parents,t,e)};pt.prototype.interrupt=Jf,pt.prototype.transition=Bd;var Yd=[null],Hd=function(t,e){var n,r,i=t.__transition;if(i){e=null==e?null:e+"";for(r in i)if((n=i[r]).state>Bf&&n.name===e)return new Xe([[t]],Yd,e,+r)}return null},Qd=function(t){return function(){return t}},Wd=function(t,e,n){this.target=t,this.type=e,this.selection=n},Gd=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},Kd={name:"drag"},Xd={name:"space"},Jd={name:"handle"},Zd={name:"center"},tp={name:"x",handles:["e","w"].map(wn),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},ep={name:"y",handles:["n","s"].map(wn),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},np={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(wn),input:function(t){return t},output:function(t){return t}},rp={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ip={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},ap={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},op={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},sp={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},lp=function(){return En(np)},up=Math.cos,cp=Math.sin,hp=Math.PI,fp=hp/2,dp=2*hp,pp=Math.max,mp=function(){function t(t){var a,o,s,l,u,c,h=t.length,f=[],d=ju(h),p=[],m=[],g=m.groups=new Array(h),v=new Array(h*h);for(a=0,u=-1;++u<h;){for(o=0,c=-1;++c<h;)o+=t[u][c];f.push(o),p.push(ju(h)),a+=o}for(n&&d.sort(function(t,e){return n(f[t],f[e])}),r&&p.forEach(function(e,n){e.sort(function(e,i){return r(t[n][e],t[n][i])})}),a=pp(0,dp-e*h)/a,l=a?e:dp/h,o=0,u=-1;++u<h;){for(s=o,c=-1;++c<h;){var y=d[u],b=p[y][c],x=t[y][b],_=o,w=o+=x*a;v[b*h+y]={index:y,subindex:b,startAngle:_,endAngle:w,value:x}}g[y]={index:y,startAngle:s,endAngle:o,value:f[y]},o+=l}for(u=-1;++u<h;)for(c=u-1;++c<h;){var S=v[c*h+u],k=v[u*h+c];(S.value||k.value)&&m.push(S.value<k.value?{source:k,target:S}:{source:S,target:k})}return i?m.sort(i):m}var e=0,n=null,r=null,i=null;return t.padAngle=function(n){return arguments.length?(e=pp(0,n),t):e},t.sortGroups=function(e){return arguments.length?(n=e,t):n},t.sortSubgroups=function(e){return arguments.length?(r=e,t):r},t.sortChords=function(e){return arguments.length?(null==e?i=null:(i=On(e))._=e,t):i&&i._},t},gp=Array.prototype.slice,vp=function(t){return function(){return t}},yp=Math.PI,bp=2*yp,xp=1e-6,_p=bp-xp;Dn.prototype=$n.prototype={constructor:Dn,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,l=r-e,u=a-t,c=o-e,h=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>xp)if(Math.abs(c*s-l*u)>xp&&i){var f=n-a,d=r-o,p=s*s+l*l,m=f*f+d*d,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((yp-Math.acos((p+h-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>xp&&(this._+="L"+(t+b*u)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>u*d)+","+(this._x1=t+x*s)+","+(this._y1=e+x*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,a){t=+t,e=+e,n=+n;var o=n*Math.cos(r),s=n*Math.sin(r),l=t+o,u=e+s,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>xp||Math.abs(this._y1-u)>xp)&&(this._+="L"+l+","+u),n&&(h>_p?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):(h<0&&(h=h%bp+bp),this._+="A"+n+","+n+",0,"+ +(h>=yp)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var wp=function(){function t(){var t,s=gp.call(arguments),l=e.apply(this,s),u=n.apply(this,s),c=+r.apply(this,(s[0]=l,s)),h=i.apply(this,s)-fp,f=a.apply(this,s)-fp,d=c*up(h),p=c*cp(h),m=+r.apply(this,(s[0]=u,s)),g=i.apply(this,s)-fp,v=a.apply(this,s)-fp;if(o||(o=t=$n()),o.moveTo(d,p),o.arc(0,0,c,h,f),h===g&&f===v||(o.quadraticCurveTo(0,0,m*up(g),m*cp(g)),o.arc(0,0,m,g,v)),o.quadraticCurveTo(0,0,d,p),o.closePath(),t)return o=null,t+""||null}var e=In,n=Rn,r=Fn,i=Nn,a=qn,o=null;return t.radius=function(e){return arguments.length?(r="function"==typeof e?e:vp(+e),t):r},t.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:vp(+e),t):i},t.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:vp(+e),t):a},t.source=function(n){return arguments.length?(e=n,t):e},t.target=function(e){return arguments.length?(n=e,t):n},t.context=function(e){return arguments.length?(o=null==e?null:e,t):o},t},Sp="$";jn.prototype=Ln.prototype={constructor:jn,has:function(t){return Sp+t in this},get:function(t){return this[Sp+t]},set:function(t,e){return this[Sp+t]=e,this},remove:function(t){var e=Sp+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Sp&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Sp&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Sp&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Sp&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Sp&&++t;return t},empty:function(){for(var t in this)if(t[0]===Sp)return!1;return!0},each:function(t){for(var e in this)e[0]===Sp&&t(this[e],e.slice(1),this)}};var kp=function(){function t(e,i,o,s){if(i>=a.length)return null!=r?r(e):null!=n?e.sort(n):e;for(var l,u,c,h=-1,f=e.length,d=a[i++],p=Ln(),m=o();++h<f;)(c=p.get(l=d(u=e[h])+""))?c.push(u):p.set(l,[u]);return p.each(function(e,n){s(m,n,t(e,i,o,s))}),m}function e(t,n){if(++n>a.length)return t;var i,s=o[n-1];return null!=r&&n>=a.length?i=t.entries():(i=[],t.each(function(t,r){i.push({key:r,values:e(t,n)})})),null!=s?i.sort(function(t,e){return s(t.key,e.key)}):i}var n,r,i,a=[],o=[];return i={object:function(e){return t(e,0,Un,zn)},map:function(e){return t(e,0,Vn,Bn)},entries:function(n){return e(t(n,0,Vn,Bn),0)},key:function(t){return a.push(t),i},sortKeys:function(t){return o[a.length-1]=t,i},sortValues:function(t){return n=t,i},rollup:function(t){return r=t,i}}},Mp=Ln.prototype;Yn.prototype=Hn.prototype={constructor:Yn,has:Mp.has,add:function(t){return t+="",this[Sp+t]=t,this},remove:Mp.remove,clear:Mp.clear,values:Mp.keys,size:Mp.size,empty:Mp.empty,each:Mp.each};var Tp=function(t){var e=[];for(var n in t)e.push(n);return e},Cp=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Ap=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},Pp=function(t){function e(t,e){var r,i,a=n(t,function(t,n){return r?r(t,n-1):(i=t,void(r=e?Wn(t,e):Qn(t)))});return a.columns=i,a}function n(t,e){function n(){if(c>=u)return o;if(i)return i=!1,a;var e,n=c;if(34===t.charCodeAt(n)){for(var r=n;r++<u;)if(34===t.charCodeAt(r)){if(34!==t.charCodeAt(r+1))break;++r}return c=r+2,e=t.charCodeAt(r+1),13===e?(i=!0,10===t.charCodeAt(r+2)&&++c):10===e&&(i=!0),t.slice(n+1,r).replace(/""/g,'"')}for(;c<u;){var s=1;if(10===(e=t.charCodeAt(c++)))i=!0;else if(13===e)i=!0,10===t.charCodeAt(c)&&(++c,++s);else if(e!==l)continue;return t.slice(n,c-s)}return t.slice(n)}for(var r,i,a={},o={},s=[],u=t.length,c=0,h=0;(r=n())!==o;){for(var f=[];r!==a&&r!==o;)f.push(r),r=n();e&&null==(f=e(f,h++))||s.push(f)}return s}function r(e,n){return null==n&&(n=Gn(e)),[n.map(o).join(t)].concat(e.map(function(e){return n.map(function(t){return o(e[t])}).join(t)})).join("\n")}function i(t){return t.map(a).join("\n")}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":s.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return{parse:e,parseRows:n,format:r,formatRows:i}},Ep=Pp(","),Op=Ep.parse,Dp=Ep.parseRows,$p=Ep.format,Ip=Ep.formatRows,Rp=Pp("\t"),Fp=Rp.parse,Np=Rp.parseRows,qp=Rp.format,jp=Rp.formatRows,Lp=function(t,e){function n(){var n,i,a=r.length,o=0,s=0;for(n=0;n<a;++n)i=r[n],o+=i.x,s+=i.y;for(o=o/a-t,s=s/a-e,n=0;n<a;++n)i=r[n],i.x-=o,i.y-=s}var r;return null==t&&(t=0),null==e&&(e=0),n.initialize=function(t){r=t},n.x=function(e){return arguments.length?(t=+e,n):t},n.y=function(t){return arguments.length?(e=+t,n):e},n},Up=function(t){return function(){return t}},zp=function(){return 1e-6*(Math.random()-.5)},Vp=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Kn(this.cover(e,n),e,n,t)},Bp=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{if(!(n>t||t>i||r>e||e>a))return this;var o,s,l=i-n,u=this._root;switch(s=(e<(r+a)/2)<<1|t<(n+i)/2){case 0:do{o=new Array(4),o[s]=u,u=o}while(l*=2,i=n+l,a=r+l,t>i||e>a);break;case 1:do{o=new Array(4),o[s]=u,u=o}while(l*=2,n=i-l,a=r+l,n>t||e>a);break;case 2:do{o=new Array(4),o[s]=u,u=o}while(l*=2,i=n+l,r=a-l,t>i||r>e);break;case 3:do{o=new Array(4),o[s]=u,u=o}while(l*=2,n=i-l,r=a-l,n>t||r>e)}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},Yp=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},Hp=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Qp=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i},Wp=function(t,e,n){var r,i,a,o,s,l,u,c=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new Qp(m,c,h,f,d)),null==n?n=1/0:(c=t-n,h=e-n,f=t+n,d=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>f||(a=l.y0)>d||(o=l.x1)<c||(s=l.y1)<h))if(m.length){var g=(i+o)/2,v=(a+s)/2;p.push(new Qp(m[3],g,v,o,s),new Qp(m[2],i,v,g,s),new Qp(m[1],g,a,o,v),new Qp(m[0],i,a,g,v)),(u=(e>=v)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var y=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,h=e-_,f=t+_,d=e+_,r=m.data}}return r},Gp=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,l,u,c,h,f,d=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((u=a>=(s=(p+g)/2))?p=s:g=s,(c=o>=(l=(m+v)/2))?m=l:v=l,e=d,!(d=d[h=c<<1|u]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},Kp=function(){return this._root},Xp=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},Jp=function(t){var e,n,r,i,a,o,s=[],l=this._root;for(l&&s.push(new Qp(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&l.length){var u=(r+a)/2,c=(i+o)/2;(n=l[3])&&s.push(new Qp(n,u,c,a,o)),(n=l[2])&&s.push(new Qp(n,r,c,u,o)),(n=l[1])&&s.push(new Qp(n,u,i,a,c)),(n=l[0])&&s.push(new Qp(n,r,i,u,c))}return this},Zp=function(t){var e,n=[],r=[];for(this._root&&n.push(new Qp(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(o+l)/2,h=(s+u)/2;(a=i[0])&&n.push(new Qp(a,o,s,c,h)),(a=i[1])&&n.push(new Qp(a,c,s,l,h)),(a=i[2])&&n.push(new Qp(a,o,h,c,u)),(a=i[3])&&n.push(new Qp(a,c,h,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},tm=function(t){return arguments.length?(this._x=t,this):this._x},em=function(t){return arguments.length?(this._y=t,this):this._y},nm=er.prototype=nr.prototype;nm.copy=function(){var t,e,n=new nr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=rr(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=rr(e));return n},nm.add=Vp,nm.addAll=Xn,nm.cover=Bp,nm.data=Yp,nm.extent=Hp,nm.find=Wp,nm.remove=Gp,nm.removeAll=Jn,nm.root=Kp,nm.size=Xp,nm.visit=Jp,nm.visitAfter=Zp,nm.x=tm,nm.y=em;var rm,im=function(t){function e(){function t(t,e,n,r,i){var a=t.data,s=t.r,d=h+s;if(!a)return e>u+d||r<u-d||n>c+d||i<c-d;if(a.index>l.index){var p=u-a.x-a.vx,m=c-a.y-a.vy,g=p*p+m*m;g<d*d&&(0===p&&(p=zp(),g+=p*p),0===m&&(m=zp(),g+=m*m),g=(d-(g=Math.sqrt(g)))/g*o,l.vx+=(p*=g)*(d=(s*=s)/(f+s)),l.vy+=(m*=g)*d,a.vx-=p*(d=1-d),a.vy-=m*d)}}for(var e,r,l,u,c,h,f,d=i.length,p=0;p<s;++p)for(r=er(i,ir,ar).visitAfter(n),e=0;e<d;++e)l=i[e],h=a[l.index],f=h*h,u=l.x+l.vx,c=l.y+l.vy,r.visit(t)}function n(t){if(t.data)return t.r=a[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function r(){if(i){var e,n,r=i.length;for(a=new Array(r),e=0;e<r;++e)n=i[e],a[n.index]=+t(n,e,i)}}var i,a,o=1,s=1;return"function"!=typeof t&&(t=Up(null==t?1:+t)),e.initialize=function(t){i=t,r()},e.iterations=function(t){return arguments.length?(s=+t,e):s},e.strength=function(t){return arguments.length?(o=+t,e):o},e.radius=function(n){return arguments.length?(t="function"==typeof n?n:Up(+n),r(),e):t},e},am=function(t){function e(t){return 1/Math.min(u[t.source.index],u[t.target.index])}function n(e){for(var n=0,r=t.length;n<p;++n)for(var i,a,l,u,h,f,d,m=0;m<r;++m)i=t[m],a=i.source,l=i.target,u=l.x+l.vx-a.x-a.vx||zp(),h=l.y+l.vy-a.y-a.vy||zp(),f=Math.sqrt(u*u+h*h),f=(f-s[m])/f*e*o[m],u*=f,h*=f,l.vx-=u*(d=c[m]),l.vy-=h*d,a.vx+=u*(d=1-d),a.vy+=h*d}function r(){if(l){var e,n,r=l.length,f=t.length,d=Ln(l,h);for(e=0,u=new Array(r);e<f;++e)n=t[e],n.index=e,"object"!=typeof n.source&&(n.source=sr(d,n.source)),"object"!=typeof n.target&&(n.target=sr(d,n.target)),u[n.source.index]=(u[n.source.index]||0)+1,u[n.target.index]=(u[n.target.index]||0)+1;for(e=0,c=new Array(f);e<f;++e)n=t[e],c[e]=u[n.source.index]/(u[n.source.index]+u[n.target.index]);o=new Array(f),i(),s=new Array(f),a()}}function i(){if(l)for(var e=0,n=t.length;e<n;++e)o[e]=+f(t[e],e,t)}function a(){if(l)for(var e=0,n=t.length;e<n;++e)s[e]=+d(t[e],e,t)}var o,s,l,u,c,h=or,f=e,d=Up(30),p=1;return null==t&&(t=[]),n.initialize=function(t){l=t,r()},n.links=function(e){return arguments.length?(t=e,r(),n):t},n.id=function(t){return arguments.length?(h=t,n):h},n.iterations=function(t){return arguments.length?(p=+t,n):p},n.strength=function(t){return arguments.length?(f="function"==typeof t?t:Up(+t),i(),n):f},n.distance=function(t){return arguments.length?(d="function"==typeof t?t:Up(+t),a(),n):d},n},om=10,sm=Math.PI*(3-Math.sqrt(5)),lm=function(t){function e(){n(),p.call("tick",a),o<s&&(f.stop(),p.call("end",a))}function n(){var e,n,r=t.length;for(o+=(u-o)*l,h.each(function(t){t(o)}),e=0;e<r;++e)n=t[e],null==n.fx?n.x+=n.vx*=c:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=c:(n.y=n.fy,n.vy=0)}function r(){for(var e,n=0,r=t.length;n<r;++n){if(e=t[n],e.index=n,isNaN(e.x)||isNaN(e.y)){var i=om*Math.sqrt(n),a=n*sm;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function i(e){return e.initialize&&e.initialize(t),e}var a,o=1,s=.001,l=1-Math.pow(s,1/300),u=0,c=.6,h=Ln(),f=me(e),p=d("tick","end");return null==t&&(t=[]),r(),a={tick:n,restart:function(){return f.restart(e),a},stop:function(){return f.stop(),a},nodes:function(e){return arguments.length?(t=e,r(),h.each(i),a):t},alpha:function(t){return arguments.length?(o=+t,a):o},alphaMin:function(t){return arguments.length?(s=+t,a):s},alphaDecay:function(t){return arguments.length?(l=+t,a):+l},alphaTarget:function(t){return arguments.length?(u=+t,a):u},velocityDecay:function(t){return arguments.length?(c=1-t,a):1-c},force:function(t,e){return arguments.length>1?(null==e?h.remove(t):h.set(t,i(e)),a):h.get(t)},find:function(e,n,r){var i,a,o,s,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)s=t[u],i=e-s.x,a=n-s.y,(o=i*i+a*a)<r&&(l=s,r=o);return l},on:function(t,e){return arguments.length>1?(p.on(t,e),a):p.on(t)}}},um=function(){function t(t){var e,s=i.length,l=er(i,lr,ur).visitAfter(n);for(o=t,e=0;e<s;++e)a=i[e],l.visit(r)}function e(){if(i){var t,e,n=i.length;for(s=new Array(n),t=0;t<n;++t)e=i[t],s[e.index]=+l(e,t,i)}}function n(t){var e,n,r,i,a,o=0;if(t.length){for(r=i=a=0;a<4;++a)(e=t[a])&&(n=e.value)&&(o+=n,r+=n*e.x,i+=n*e.y);t.x=r/o,t.y=i/o}else{e=t,e.x=e.data.x,e.y=e.data.y;do{o+=s[e.data.index]}while(e=e.next)}t.value=o}function r(t,e,n,r){if(!t.value)return!0;var i=t.x-a.x,l=t.y-a.y,f=r-e,d=i*i+l*l;if(f*f/h<d)return d<c&&(0===i&&(i=zp(),d+=i*i),0===l&&(l=zp(),d+=l*l),d<u&&(d=Math.sqrt(u*d)),a.vx+=i*t.value*o/d,a.vy+=l*t.value*o/d),!0;if(!(t.length||d>=c)){(t.data!==a||t.next)&&(0===i&&(i=zp(),d+=i*i),0===l&&(l=zp(),d+=l*l),d<u&&(d=Math.sqrt(u*d)));do{t.data!==a&&(f=s[t.data.index]*o/d,a.vx+=i*f,a.vy+=l*f)}while(t=t.next)}}var i,a,o,s,l=Up(-30),u=1,c=1/0,h=.81;return t.initialize=function(t){i=t,e()},t.strength=function(n){return arguments.length?(l="function"==typeof n?n:Up(+n),e(),t):l},t.distanceMin=function(e){return arguments.length?(u=e*e,t):Math.sqrt(u)},t.distanceMax=function(e){return arguments.length?(c=e*e,t):Math.sqrt(c)},t.theta=function(e){return arguments.length?(h=e*e,t):Math.sqrt(h)},t},cm=function(t){function e(t){for(var e,n=0,o=r.length;n<o;++n)e=r[n],e.vx+=(a[n]-e.x)*i[n]*t}function n(){if(r){var e,n=r.length;for(i=new Array(n),a=new Array(n),e=0;e<n;++e)i[e]=isNaN(a[e]=+t(r[e],e,r))?0:+o(r[e],e,r)}}var r,i,a,o=Up(.1);return"function"!=typeof t&&(t=Up(null==t?0:+t)),e.initialize=function(t){r=t,n()},e.strength=function(t){return arguments.length?(o="function"==typeof t?t:Up(+t),n(),e):o},e.x=function(r){return arguments.length?(t="function"==typeof r?r:Up(+r),n(),e):t},e},hm=function(t){function e(t){for(var e,n=0,o=r.length;n<o;++n)e=r[n],e.vy+=(a[n]-e.y)*i[n]*t}function n(){if(r){var e,n=r.length;for(i=new Array(n),a=new Array(n),e=0;e<n;++e)i[e]=isNaN(a[e]=+t(r[e],e,r))?0:+o(r[e],e,r)}}var r,i,a,o=Up(.1);return"function"!=typeof t&&(t=Up(null==t?0:+t)),e.initialize=function(t){r=t,n()},e.strength=function(t){return arguments.length?(o="function"==typeof t?t:Up(+t),n(),e):o},e.y=function(r){return arguments.length?(t="function"==typeof r?r:Up(+r),n(),e):t},e},fm=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},dm=function(t){return t=fm(Math.abs(t)),t?t[1]:NaN},pm=function(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}},mm=function(t,e){t=t.toPrecision(e);t:for(var n,r=t.length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},gm=function(t,e){var n=fm(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(rm=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+fm(t,Math.max(0,e+a-1))[0]},vm=function(t,e){var n=fm(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},ym={"":mm,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return vm(100*t,e)},r:vm,s:gm,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},bm=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,xm=function(t){return new cr(t)};cr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var _m,wm=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Sm=function(t){function e(t){function e(t){var e,i,l,y=p,b=m;if("c"===d)b=g(t)+b,t="";else{t=+t;var x=(t<0||1/t<0)&&(t*=-1,!0);if(t=g(t,f),x)for(e=-1,i=t.length,x=!1;++e<i;)if(48<(l=t.charCodeAt(e))&&l<58||"x"===d&&96<l&&l<103||"X"===d&&64<l&&l<71){x=!0;break}if(y=(x?"("===s?s:"-":"-"===s||"("===s?"":s)+y,b=b+("s"===d?wm[8+rm/3]:"")+(x&&"("===s?")":""),v)for(e=-1,i=t.length;++e<i;)if(48>(l=t.charCodeAt(e))||l>57){b=(46===l?a+t.slice(e+1):t.slice(e))+b,t=t.slice(0,e);break}}h&&!u&&(t=r(t,1/0));var _=y.length+t.length+b.length,w=_<c?new Array(c-_+1).join(n):"";switch(h&&u&&(t=r(w+t,w.length?c-b.length:1/0),w=""),o){case"<":return y+t+b+w;case"=":return y+w+t+b;case"^":return w.slice(0,_=w.length>>1)+y+t+b+w.slice(_)}return w+y+t+b}t=xm(t);var n=t.fill,o=t.align,s=t.sign,l=t.symbol,u=t.zero,c=t.width,h=t.comma,f=t.precision,d=t.type,p="$"===l?i[0]:"#"===l&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",m="$"===l?i[1]:/[%p]/.test(d)?"%":"",g=ym[d],v=!d||/[defgprs%]/.test(d);return f=null==f?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),e.toString=function(){return t+""},e}function n(t,n){var r=e((t=xm(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(dm(n)/3))),a=Math.pow(10,-i),o=wm[8+i/3];return function(t){return r(a*t)+o}}var r=t.grouping&&t.thousands?pm(t.grouping,t.thousands):hr,i=t.currency,a=t.decimal;return{format:e,formatPrefix:n}};fr({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var km=function(t){return Math.max(0,-dm(Math.abs(t)))},Mm=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(dm(e)/3)))-dm(Math.abs(t)))},Tm=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,dm(e)-dm(t))+1},Cm=function(){return new dr};dr.prototype={constructor:dr,reset:function(){this.s=this.t=0},add:function(t){pr(ag,t,this.t),pr(this,ag.s,this.s),this.s?this.t+=ag.t:this.s=ag.t},valueOf:function(){return this.s}};var Am,Pm,Em,Om,Dm,$m,Im,Rm,Fm,Nm,qm,jm,Lm,Um,zm,Vm,Bm,Ym,Hm,Qm,Wm,Gm,Km,Xm,Jm,Zm,tg,eg,ng,rg,ig,ag=new dr,og=1e-6,sg=Math.PI,lg=sg/2,ug=sg/4,cg=2*sg,hg=180/sg,fg=sg/180,dg=Math.abs,pg=Math.atan,mg=Math.atan2,gg=Math.cos,vg=Math.ceil,yg=Math.exp,bg=Math.log,xg=Math.pow,_g=Math.sin,wg=Math.sign||function(t){return t>0?1:t<0?-1:0},Sg=Math.sqrt,kg=Math.tan,Mg={Feature:function(t,e){br(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)br(n[r].geometry,e)}},Tg={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){xr(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)xr(n[r],e,0)},Polygon:function(t,e){_r(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)_r(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)br(n[r],e)}},Cg=function(t,e){t&&Mg.hasOwnProperty(t.type)?Mg[t.type](t,e):br(t,e)},Ag=Cm(),Pg=Cm(),Eg={point:yr,lineStart:yr,lineEnd:yr,polygonStart:function(){Ag.reset(),Eg.lineStart=wr,Eg.lineEnd=Sr},polygonEnd:function(){var t=+Ag;Pg.add(t<0?cg+t:t),this.lineStart=this.lineEnd=this.point=yr},sphere:function(){Pg.add(cg)}},Og=function(t){return Pg.reset(),Cg(t,Eg),2*Pg},Dg=Cm(),$g={point:$r,lineStart:Rr,lineEnd:Fr,polygonStart:function(){$g.point=Nr,$g.lineStart=qr,$g.lineEnd=jr,Dg.reset(),Eg.polygonStart()},polygonEnd:function(){Eg.polygonEnd(),$g.point=$r,$g.lineStart=Rr,$g.lineEnd=Fr,Ag<0?($m=-(Rm=180),Im=-(Fm=90)):Dg>og?Fm=90:Dg<-og&&(Im=-90),zm[0]=$m,zm[1]=Rm}},Ig=function(t){var e,n,r,i,a,o,s;if(Fm=Rm=-($m=Im=1/0),Um=[],Cg(t,$g),n=Um.length){for(Um.sort(Ur),e=1,r=Um[0],a=[r];e<n;++e)i=Um[e],zr(r,i[0])||zr(r,i[1])?(Lr(r[0],i[1])>Lr(r[0],r[1])&&(r[1]=i[1]),Lr(i[0],r[1])>Lr(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,e=0,r=a[n];e<=n;r=i,++e)i=a[e],(s=Lr(r[1],i[0]))>o&&(o=s,$m=i[0],Rm=r[1])}return Um=zm=null,$m===1/0||Im===1/0?[[NaN,NaN],[NaN,NaN]]:[[$m,Im],[Rm,Fm]]},Rg={sphere:yr,point:Vr,lineStart:Yr,lineEnd:Wr,polygonStart:function(){Rg.lineStart=Gr,Rg.lineEnd=Kr},polygonEnd:function(){Rg.lineStart=Yr,Rg.lineEnd=Wr}},Fg=function(t){Vm=Bm=Ym=Hm=Qm=Wm=Gm=Km=Xm=Jm=Zm=0,Cg(t,Rg);var e=Xm,n=Jm,r=Zm,i=e*e+n*n+r*r;return i<1e-12&&(e=Wm,n=Gm,r=Km,Bm<og&&(e=Ym,n=Hm,r=Qm),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[mg(n,e)*hg,gr(r/Sg(i))*hg]},Ng=function(t){return function(){return t}},qg=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};Zr.invert=Zr;var jg,Lg,Ug,zg,Vg,Bg,Yg,Hg,Qg,Wg,Gg,Kg=function(t){function e(e){return e=t(e[0]*fg,e[1]*fg),e[0]*=hg,e[1]*=hg,e}return t=ti(t[0]*fg,t[1]*fg,t.length>2?t[2]*fg:0),e.invert=function(e){return e=t.invert(e[0]*fg,e[1]*fg),e[0]*=hg,e[1]*=hg,e},e},Xg=function(){function t(t,e){n.push(t=r(t,e)),t[0]*=hg,t[1]*=hg}function e(){var t=i.apply(this,arguments),e=a.apply(this,arguments)*fg,l=o.apply(this,arguments)*fg;return n=[],r=ti(-t[0]*fg,-t[1]*fg,0).invert,ii(s,e,l,1),t={type:"Polygon",coordinates:[n]},n=r=null,t}var n,r,i=Ng([0,0]),a=Ng(90),o=Ng(6),s={point:t};return e.center=function(t){return arguments.length?(i="function"==typeof t?t:Ng([+t[0],+t[1]]),e):i},e.radius=function(t){return arguments.length?(a="function"==typeof t?t:Ng(+t),e):a},e.precision=function(t){return arguments.length?(o="function"==typeof t?t:Ng(+t),e):o},e},Jg=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:yr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Zg=function(t,e,n,r,i,a){var o,s=t[0],l=t[1],u=e[0],c=e[1],h=0,f=1,d=u-s,p=c-l;if(o=n-s,d||!(o>0)){if(o/=d,d<0){if(o<h)return;o<f&&(f=o)}else if(d>0){if(o>f)return;o>h&&(h=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>f)return;o>h&&(h=o)}else if(d>0){if(o<h)return;o<f&&(f=o)}if(o=r-l,p||!(o>0)){if(o/=p,p<0){if(o<h)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>h&&(h=o)}if(o=a-l,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>h&&(h=o)}else if(p>0){if(o<h)return;o<f&&(f=o)}return h>0&&(t[0]=s+h*d,t[1]=l+h*p),f<1&&(e[0]=s+f*d,e[1]=l+f*p),!0}}}}},tv=function(t,e){return dg(t[0]-e[0])<og&&dg(t[1]-e[1])<og},ev=function(t,e,n,r,i){var a,o,s=[],l=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(tv(r,o)){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}s.push(n=new oi(r,t,null,!0)),l.push(n.o=new oi(r,null,n,!1)),s.push(n=new oi(o,t,null,!1)),l.push(n.o=new oi(o,null,n,!0))}}),s.length){for(l.sort(e),si(s),si(l),a=0,o=l.length;a<o;++a)l[a].e=n=!n;for(var u,c,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,o=u.length;a<o;++a)i.point((c=u[a])[0],c[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(u=f.p.z,a=u.length-1;a>=0;--a)i.point((c=u[a])[0],c[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,u=f.z,d=!d}while(!f.v);i.lineEnd()}}},nv=1e9,rv=-nv,iv=function(){var t,e,n,r=0,i=0,a=960,o=500;return n={stream:function(n){return t&&e===n?t:t=li(r,i,a,o)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],a=+s[1][0],o=+s[1][1],t=e=null,n):[[r,i],[a,o]]}}},av=Cm(),ov={sphere:yr,point:yr,lineStart:ui,lineEnd:yr,polygonStart:yr,polygonEnd:yr},sv=function(t){return av.reset(),Cg(t,ov),+av},lv=[null,null],uv={type:"LineString",coordinates:lv},cv=function(t,e){return lv[0]=t,lv[1]=e,sv(uv)},hv=function(t,e){var n=t[0]*fg,r=t[1]*fg,i=e[0]*fg,a=e[1]*fg,o=gg(r),s=_g(r),l=gg(a),u=_g(a),c=o*gg(n),h=o*_g(n),f=l*gg(i),d=l*_g(i),p=2*gr(Sg(vr(a-r)+o*l*vr(i-n))),m=_g(p),g=p?function(t){var e=_g(t*=p)/m,n=_g(p-t)/m,r=n*c+e*f,i=n*h+e*d,a=n*s+e*u;return[mg(i,r)*hg,mg(a,Sg(r*r+i*i))*hg]}:function(){return[n*hg,r*hg]};return g.distance=p,g},fv=function(t){return t},dv=Cm(),pv=Cm(),mv={point:yr,lineStart:yr,lineEnd:yr,polygonStart:function(){mv.lineStart=vi,mv.lineEnd=xi},polygonEnd:function(){mv.lineStart=mv.lineEnd=mv.point=yr,dv.add(dg(pv)),pv.reset()},result:function(){var t=dv/2;return dv.reset(),t}},gv=1/0,vv=gv,yv=-gv,bv=yv,xv={point:_i,lineStart:yr,lineEnd:yr,polygonStart:yr,polygonEnd:yr,result:function(){var t=[[gv,vv],[yv,bv]];return yv=bv=-(vv=gv=1/0),t}},_v=0,wv=0,Sv=0,kv=0,Mv=0,Tv=0,Cv=0,Av=0,Pv=0,Ev={point:wi,lineStart:Si,lineEnd:Ti,polygonStart:function(){Ev.lineStart=Ci,Ev.lineEnd=Ai},polygonEnd:function(){Ev.point=wi,Ev.lineStart=Si,Ev.lineEnd=Ti},result:function(){var t=Pv?[Cv/Pv,Av/Pv]:Tv?[kv/Tv,Mv/Tv]:Sv?[_v/Sv,wv/Sv]:[NaN,NaN];return _v=wv=Sv=kv=Mv=Tv=Cv=Av=Pv=0,t}};Oi.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,cg)}},result:yr},Di.prototype={_circle:$i(4.5),pointRadius:function(t){return this._circle=$i(t),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}}};var Ov=function(t,e){function n(t){return t&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),Cg(t,r(i))),i.result()}var r,i,a=4.5;return n.area=function(t){return Cg(t,r(mv)),mv.result()},n.bounds=function(t){return Cg(t,r(xv)),xv.result()},n.centroid=function(t){return Cg(t,r(Ev)),Ev.result()},n.projection=function(e){return arguments.length?(r=null==e?(t=null,fv):(t=e).stream,n):t},n.context=function(t){return arguments.length?(i=null==t?(e=null,new Di):new Oi(e=t),"function"!=typeof a&&i.pointRadius(a),n):e},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(t).context(e)},Dv=Cm(),$v=function(t,e){var n=e[0],r=e[1],i=[_g(n),-gg(n),0],a=0,o=0;Dv.reset();for(var s=0,l=t.length;s<l;++s)if(c=(u=t[s]).length)for(var u,c,h=u[c-1],f=h[0],d=h[1]/2+ug,p=_g(d),m=gg(d),g=0;g<c;++g,f=y,p=x,m=_,h=v){var v=u[g],y=v[0],b=v[1]/2+ug,x=_g(b),_=gg(b),w=y-f,S=w>=0?1:-1,k=S*w,M=k>sg,T=p*x;if(Dv.add(mg(T*S*_g(k),m*_+T*gg(k))),a+=M?w+S*cg:w,M^f>=n^y>=n){var C=Pr(Cr(h),Cr(v));Dr(C);var A=Pr(i,C);Dr(A);var P=(M^w>=0?-1:1)*gr(A[2]);(r>P||r===P&&(C[0]||C[1]))&&(o+=M^w>=0?1:-1)}}return(a<-og||a<og&&Dv<-og)^1&o},Iv=function(t,e,n,r){return function(i,a){function o(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&a.point(e,n)}function s(t,e){var n=i(t,e);g.point(n[0],n[1])}function l(){_.point=s,g.lineStart()}function u(){_.point=o,g.lineEnd()}function c(t,e){m.push([t,e]);var n=i(t,e);b.point(n[0],n[1])}function h(){b.lineStart(),m=[]}function f(){c(m[0][0],m[0][1]),b.lineEnd();var t,e,n,r,i=b.clean(),o=y.result(),s=o.length;if(m.pop(),d.push(m),m=null,s)if(1&i){if(n=o[0],(e=n.length-1)>0){for(x||(a.polygonStart(),x=!0),a.lineStart(),t=0;t<e;++t)a.point((r=n[t])[0],r[1]);a.lineEnd()}}else s>1&&2&i&&o.push(o.pop().concat(o.shift())),p.push(o.filter(Ii))}var d,p,m,g=e(a),v=i.invert(r[0],r[1]),y=Jg(),b=e(y),x=!1,_={point:o,lineStart:l,lineEnd:u,polygonStart:function(){_.point=c,_.lineStart=h,_.lineEnd=f,p=[],d=[]},polygonEnd:function(){_.point=o,_.lineStart=l,_.lineEnd=u,p=Ju(p);var t=$v(d,v);p.length?(x||(a.polygonStart(),x=!0),ev(p,Ri,t,n,a)):t&&(x||(a.polygonStart(),x=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),x&&(a.polygonEnd(),x=!1),p=d=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};return _}},Rv=Iv(function(){return!0},Fi,qi,[-sg,-lg]),Fv=function(t,e){function n(n,r,i,a){ii(a,t,e,i,n,r)}function r(t,e){return gg(t)*gg(e)>s}function i(t){var e,n,i,s,c;return{lineStart:function(){s=i=!1,c=1},point:function(h,f){var d,p=[h,f],m=r(h,f),g=l?m?0:o(h,f):m?o(h+(h<0?sg:-sg),f):0;if(!e&&(s=i=m)&&t.lineStart(),m!==i&&(d=a(e,p),(tv(e,d)||tv(p,d))&&(p[0]+=og,p[1]+=og,m=r(p[0],p[1]))),m!==i)c=0,m?(t.lineStart(),d=a(p,e),t.point(d[0],d[1])):(d=a(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(u&&e&&l^m){var v;g&n||!(v=a(p,e,!0))||(c=0,l?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!m||e&&tv(e,p)||t.point(p[0],p[1]),e=p,i=m,n=g},lineEnd:function(){i&&t.lineEnd(),e=null},clean:function(){return c|(s&&i)<<1}}}function a(t,e,n){var r=Cr(t),i=Cr(e),a=[1,0,0],o=Pr(r,i),l=Ar(o,o),u=o[0],c=l-u*u;if(!c)return!n&&t;var h=s*l/c,f=-s*u/c,d=Pr(a,o),p=Or(a,h);Er(p,Or(o,f));var m=d,g=Ar(p,m),v=Ar(m,m),y=g*g-v*(Ar(p,p)-1);if(!(y<0)){var b=Sg(y),x=Or(m,(-g-b)/v);if(Er(x,p),x=Tr(x),!n)return x;var _,w=t[0],S=e[0],k=t[1],M=e[1];S<w&&(_=w,w=S,S=_);var T=S-w,C=dg(T-sg)<og,A=C||T<og;if(!C&&M<k&&(_=k,k=M,M=_),A?C?k+M>0^x[1]<(dg(x[0]-w)<og?k:M):k<=x[1]&&x[1]<=M:T>sg^(w<=x[0]&&x[0]<=S)){var P=Or(m,(-g+b)/v);return Er(P,p),[x,Tr(P)]}}}function o(e,n){var r=l?t:sg-t,i=0;return e<-r?i|=1:e>r&&(i|=2),n<-r?i|=4:n>r&&(i|=8),i}var s=gg(t),l=s>0,u=dg(s)>og;return Iv(r,i,n,l?[0,-t]:[-sg,t-sg])},Nv=function(t){return{stream:ji(t)}};Li.prototype={constructor:Li,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var qv=16,jv=gg(30*fg),Lv=function(t,e){return+e?Bi(t,e):Vi(t)},Uv=ji({point:function(t,e){this.stream.point(t*fg,e*fg)}}),zv=function(){return Qi(Gi).scale(155.424).center([0,33.6442])},Vv=function(){return zv().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},Bv=function(){function t(t){var e=t[0],n=t[1];return s=null,i.point(e,n),s||(a.point(e,n),s)||(o.point(e,n),s)}function e(){return n=r=null,t}var n,r,i,a,o,s,l=Vv(),u=zv().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=zv().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){s=[t,e]}};return t.invert=function(t){var e=l.scale(),n=l.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:l).invert(t)},t.stream=function(t){return n&&r===t?n:n=Ki([l.stream(r=t),u.stream(t),c.stream(t)])},t.precision=function(t){return arguments.length?(l.precision(t),u.precision(t),c.precision(t),e()):l.precision()},t.scale=function(e){return arguments.length?(l.scale(e),u.scale(.35*e),c.scale(e),t.translate(l.translate())):l.scale()},t.translate=function(t){if(!arguments.length)return l.translate();var n=l.scale(),r=+t[0],s=+t[1];return i=l.translate(t).clipExtent([[r-.455*n,s-.238*n],[r+.455*n,s+.238*n]]).stream(h),a=u.translate([r-.307*n,s+.201*n]).clipExtent([[r-.425*n+og,s+.12*n+og],[r-.214*n-og,s+.234*n-og]]).stream(h),o=c.translate([r-.205*n,s+.212*n]).clipExtent([[r-.214*n+og,s+.166*n+og],[r-.115*n-og,s+.234*n-og]]).stream(h),e()},t.fitExtent=function(e,n){return Ui(t,e,n)},t.fitSize=function(e,n){return zi(t,e,n)},t.scale(1070)},Yv=Xi(function(t){return Sg(2/(1+t))});Yv.invert=Ji(function(t){return 2*gr(t/2)});var Hv=function(){return Yi(Yv).scale(124.75).clipAngle(179.999)},Qv=Xi(function(t){return(t=mr(t))&&t/_g(t)});Qv.invert=Ji(function(t){return t});var Wv=function(){return Yi(Qv).scale(79.4188).clipAngle(179.999)};Zi.invert=function(t,e){return[t,2*pg(yg(e))-lg]};var Gv=function(){return ta(Zi).scale(961/cg)},Kv=function(){return Qi(na).scale(109.5).parallels([30,30])};ra.invert=ra;var Xv=function(){return Yi(ra).scale(152.63)},Jv=function(){return Qi(ia).scale(131.154).center([0,13.9389])};aa.invert=Ji(pg);var Zv=function(){return Yi(aa).scale(144.049).clipAngle(60)},ty=function(){function t(){return i=a=null,o}var e,n,r,i,a,o,s=1,l=0,u=0,c=1,h=1,f=fv,d=null,p=fv;return o={stream:function(t){return i&&a===t?i:i=f(p(a=t))},clipExtent:function(i){return arguments.length?(p=null==i?(d=e=n=r=null,fv):li(d=+i[0][0],e=+i[0][1],n=+i[1][0],r=+i[1][1]),t()):null==d?null:[[d,e],[n,r]]},scale:function(e){return arguments.length?(f=oa((s=+e)*c,s*h,l,u),t()):s},translate:function(e){return arguments.length?(f=oa(s*c,s*h,l=+e[0],u=+e[1]),t()):[l,u]},reflectX:function(e){return arguments.length?(f=oa(s*(c=e?-1:1),s*h,l,u),t()):c<0},reflectY:function(e){return arguments.length?(f=oa(s*c,s*(h=e?-1:1),l,u),t()):h<0},fitExtent:function(t,e){return Ui(o,t,e)},fitSize:function(t,e){return zi(o,t,e)}}};sa.invert=Ji(gr);var ey=function(){return Yi(sa).scale(249.5).clipAngle(90+og)};la.invert=Ji(function(t){return 2*pg(t)});var ny=function(){return Yi(la).scale(250).clipAngle(142)};ua.invert=function(t,e){return[-e,2*pg(yg(t))-lg]};var ry=function(){var t=ta(ua),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90]).scale(159.155)},iy=function(){function t(t){var a,o=0;t.eachAfter(function(t){var n=t.children;n?(t.x=ha(n),t.y=da(n)):(t.x=a?o+=e(t,a):0,t.y=0,a=t)});var s=ma(t),l=ga(t),u=s.x-e(s,l)/2,c=l.x+e(l,s)/2;return t.eachAfter(i?function(e){e.x=(e.x-t.x)*n,e.y=(t.y-e.y)*r}:function(e){e.x=(e.x-u)/(c-u)*n,e.y=(1-(t.y?e.y/t.y:1))*r})}var e=ca,n=1,r=1,i=!1;return t.separation=function(n){return arguments.length?(e=n,t):e},t.size=function(e){return arguments.length?(i=!1,n=+e[0],r=+e[1],t):i?null:[n,r]},t.nodeSize=function(e){return arguments.length?(i=!0,n=+e[0],r=+e[1],t):i?[n,r]:null},t},ay=function(){return this.eachAfter(va)},oy=function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},sy=function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},ly=function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},uy=function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},cy=function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},hy=function(t){for(var e=this,n=ya(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},fy=function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},dy=function(){var t=[];return this.each(function(e){t.push(e)}),t},py=function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},my=function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e};ka.prototype=ba.prototype={constructor:ka,count:ay,each:oy,eachAfter:ly,eachBefore:sy,sum:uy,sort:cy,path:hy,ancestors:fy,descendants:dy,leaves:py,links:my,copy:xa};var gy=function(t){for(var e=(t=t.slice()).length,n=null,r=n;e;){var i=new Ma(t[e-1]);r=r?r.next=i:n=i,t[void 0]=t[--e]}return{head:n,tail:r}},vy=function(t){return Ca(gy(t),[])},yy=function(t){return Fa(t),t},by=function(t){return function(){return t}},xy=function(){function t(t){return t.x=n/2,t.y=r/2,e?t.eachBefore(Ua(e)).eachAfter(za(i,.5)).eachBefore(Va(1)):t.eachBefore(Ua(La)).eachAfter(za(ja,1)).eachAfter(za(i,t.r/Math.min(n,r))).eachBefore(Va(Math.min(n,r)/(2*t.r))),t}var e=null,n=1,r=1,i=ja;return t.radius=function(n){return arguments.length?(e=Na(n),t):e},t.size=function(e){return arguments.length?(n=+e[0],r=+e[1],t):[n,r]},t.padding=function(e){return arguments.length?(i="function"==typeof e?e:by(+e),t):i},t},_y=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},wy=function(t,e,n,r,i){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-e)/t.value;++s<l;)a=o[s],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u},Sy=function(){function t(t){var o=t.height+1;return t.x0=t.y0=i,t.x1=n,t.y1=r/o,t.eachBefore(e(r,o)),a&&t.eachBefore(_y),t}function e(t,e){return function(n){n.children&&wy(n,n.x0,t*(n.depth+1)/e,n.x1,t*(n.depth+2)/e);var r=n.x0,a=n.y0,o=n.x1-i,s=n.y1-i;o<r&&(r=o=(r+o)/2),s<a&&(a=s=(a+s)/2),n.x0=r,n.y0=a,n.x1=o,n.y1=s}}var n=1,r=1,i=0,a=!1;return t.round=function(e){return arguments.length?(a=!!e,t):a},t.size=function(e){return arguments.length?(n=+e[0],r=+e[1],t):[n,r]},t.padding=function(e){return arguments.length?(i=+e,t):i},t},ky="$",My={depth:-1},Ty={},Cy=function(){function t(t){var r,i,a,o,s,l,u,c=t.length,h=new Array(c),f={};for(i=0;i<c;++i)r=t[i],s=h[i]=new ka(r),null!=(l=e(r,i,t))&&(l+="")&&(u=ky+(s.id=l),f[u]=u in f?Ty:s);for(i=0;i<c;++i)if(s=h[i],null!=(l=n(t[i],i,t))&&(l+="")){if(!(o=f[ky+l]))throw new Error("missing: "+l);if(o===Ty)throw new Error("ambiguous: "+l);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=My,a.eachBefore(function(t){t.depth=t.parent.depth+1,--c}).eachBefore(Sa),a.parent=null,c>0)throw new Error("cycle");return a}var e=Ba,n=Ya;return t.id=function(n){return arguments.length?(e=qa(n),t):e},t.parentId=function(e){return arguments.length?(n=qa(e),t):n},t};Ja.prototype=Object.create(ka.prototype);var Ay=function(){function t(t){var r=Za(t);if(r.eachAfter(e),r.parent.m=-r.z,r.eachBefore(n),l)t.eachBefore(i);else{var u=t,c=t,h=t;t.eachBefore(function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)});var f=u===c?1:a(u,c)/2,d=f-u.x,p=o/(c.x+f+d),m=s/(h.depth||1);t.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*m})}return t}function e(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e){Ka(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+a(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+a(t._,i._));t.parent.A=r(t,i,t.parent.A||n[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,n){if(e){for(var r,i=t,o=t,s=e,l=i.parent.children[0],u=i.m,c=o.m,h=s.m,f=l.m;s=Wa(s),i=Qa(i),s&&i;)l=Qa(l),o=Wa(o),o.a=t,r=s.z+h-i.z-u+a(s._,i._),r>0&&(Ga(Xa(s,t,n),t,r),u+=r,c+=r),h+=s.m,u+=i.m,f+=l.m,c+=o.m;s&&!Wa(o)&&(o.t=s,o.m+=h-c),i&&!Qa(l)&&(l.t=i,l.m+=u-f,n=t)}return n}function i(t){t.x*=o,t.y=t.depth*s}var a=Ha,o=1,s=1,l=null;return t.separation=function(e){return arguments.length?(a=e,t):a},t.size=function(e){return arguments.length?(l=!1,o=+e[0],s=+e[1],t):l?null:[o,s]},t.nodeSize=function(e){return arguments.length?(l=!0,o=+e[0],s=+e[1],t):l?[o,s]:null},t},Py=function(t,e,n,r,i){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(i-n)/t.value;++s<l;)a=o[s],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*u},Ey=(1+Math.sqrt(5))/2,Oy=function t(e){function n(t,n,r,i,a){to(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Ey),Dy=function(){function t(t){return t.x0=t.y0=0,t.x1=i,t.y1=a,t.eachBefore(e),o=[0],r&&t.eachBefore(_y),t}function e(t){var e=o[t.depth],r=t.x0+e,i=t.y0+e,a=t.x1-e,f=t.y1-e;a<r&&(r=a=(r+a)/2),f<i&&(i=f=(i+f)/2),t.x0=r,t.y0=i,t.x1=a,t.y1=f,t.children&&(e=o[t.depth+1]=s(t)/2,r+=h(t)-e,i+=l(t)-e,a-=u(t)-e,f-=c(t)-e,a<r&&(r=a=(r+a)/2),f<i&&(i=f=(i+f)/2),n(t,r,i,a,f))}var n=Oy,r=!1,i=1,a=1,o=[0],s=ja,l=ja,u=ja,c=ja,h=ja;return t.round=function(e){return arguments.length?(r=!!e,t):r},t.size=function(e){return arguments.length?(i=+e[0],a=+e[1],t):[i,a]},t.tile=function(e){return arguments.length?(n=qa(e),t):n},t.padding=function(e){return arguments.length?t.paddingInner(e).paddingOuter(e):t.paddingInner()},t.paddingInner=function(e){return arguments.length?(s="function"==typeof e?e:by(+e),t):s},t.paddingOuter=function(e){return arguments.length?t.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):t.paddingTop()},t.paddingTop=function(e){return arguments.length?(l="function"==typeof e?e:by(+e),t):l},t.paddingRight=function(e){return arguments.length?(u="function"==typeof e?e:by(+e),t):u},t.paddingBottom=function(e){return arguments.length?(c="function"==typeof e?e:by(+e),t):c},t.paddingLeft=function(e){return arguments.length?(h="function"==typeof e?e:by(+e),t):h},t},$y=function(t,e,n,r,i){function a(t,e,n,r,i,o,s){if(t>=e-1){var u=l[t];return u.x0=r,u.y0=i,u.x1=o,void(u.y1=s)}for(var h=c[t],f=n/2+h,d=t+1,p=e-1;d<p;){var m=d+p>>>1;c[m]<f?d=m+1:p=m}var g=c[d]-h,v=n-g;if(s-i>o-r){var y=(i*v+s*g)/n;a(t,d,g,r,i,o,y),a(d,e,v,r,y,o,s)}else{var b=(r*v+o*g)/n;a(t,d,g,r,i,b,s),a(d,e,v,b,i,o,s)}}var o,s,l=t.children,u=l.length,c=new Array(u+1);for(c[0]=s=o=0;o<u;++o)c[o+1]=s+=l[o].value;a(0,u,t.value,e,n,r,i)},Iy=function(t,e,n,r,i){(1&t.depth?Py:wy)(t,e,n,r,i)},Ry=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,l,u,c,h=-1,f=o.length,d=t.value;++h<f;){for(s=o[h],l=s.children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?wy(s,n,r,i,r+=(a-r)*s.value/d):Py(s,n,r,n+=(i-n)*s.value/d,a),d-=s.value}else t._squarify=o=to(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Ey),Fy=function(t){for(var e,n=-1,r=t.length,i=t[r-1],a=0;++n<r;)e=i,i=t[n],a+=e[1]*i[0]-e[0]*i[1];return a/2},Ny=function(t){for(var e,n,r=-1,i=t.length,a=0,o=0,s=t[i-1],l=0;++r<i;)e=s,s=t[r],l+=n=e[0]*s[1]-s[0]*e[1],a+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return l*=3,[a/l,o/l]},qy=function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])},jy=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(eo),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var a=no(r),o=no(i),s=o[0]===a[0],l=o[o.length-1]===a[a.length-1],u=[];for(e=a.length-1;e>=0;--e)u.push(t[r[a[e]][2]]);for(e=+s;e<o.length-l;++e)u.push(t[r[o[e]][2]]);return u},Ly=function(t,e){for(var n,r,i=t.length,a=t[i-1],o=e[0],s=e[1],l=a[0],u=a[1],c=!1,h=0;h<i;++h)a=t[h],n=a[0],r=a[1],r>s!=u>s&&o<(l-n)*(s-r)/(u-r)+n&&(c=!c),l=n,u=r;return c},Uy=function(t){for(var e,n,r=-1,i=t.length,a=t[i-1],o=a[0],s=a[1],l=0;++r<i;)e=o,n=s,a=t[r],o=a[0],s=a[1],e-=o,n-=s,l+=Math.sqrt(e*e+n*n);return l},zy=[].slice,Vy={};ro.prototype=uo.prototype={constructor:ro,defer:function(t){if("function"!=typeof t||this._call)throw new Error;if(null!=this._error)return this;var e=zy.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),io(this),this},abort:function(){return null==this._error&&so(this,new Error("abort")),this},await:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=function(e,n){t.apply(null,[e].concat(n))},lo(this),this},awaitAll:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=t,lo(this),this}};var By=function(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return Math.random()*e+t}},Yy=function(t,e){var n,r;return t=null==t?0:+t,e=null==e?1:+e,function(){var i;if(null!=n)i=n,n=null;else do{n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i}while(!r||r>1);return t+e*i*Math.sqrt(-2*Math.log(r)/r)}},Hy=function(){var t=Yy.apply(this,arguments);return function(){return Math.exp(t())}},Qy=function(t){return function(){for(var e=0,n=0;n<t;++n)e+=Math.random();return e}},Wy=function(t){var e=Qy(t);return function(){return e()/t}},Gy=function(t){return function(){return-Math.log(1-Math.random())/t}},Ky=function(t,e){function n(t){var e,n=u.status;if(!n&&ho(u)||n>=200&&n<300||304===n){if(a)try{e=a.call(r,u)}catch(t){return void s.call("error",r,t)}else e=u;s.call("load",r,e)}else s.call("error",r,t)}var r,i,a,o,s=d("beforesend","progress","load","error"),l=Ln(),u=new XMLHttpRequest,c=null,h=null,f=0;if("undefined"==typeof XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=u.ontimeout=n:u.onreadystatechange=function(t){u.readyState>3&&n(t)},u.onprogress=function(t){s.call("progress",r,t)},r={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l.get(t):(null==e?l.remove(t):l.set(t,e+""),r)},mimeType:function(t){return arguments.length?(i=null==t?null:t+"",r):i},responseType:function(t){return arguments.length?(o=t,r):o},timeout:function(t){return arguments.length?(f=+t,r):f},user:function(t){return arguments.length<1?c:(c=null==t?null:t+"",r)},password:function(t){return arguments.length<1?h:(h=null==t?null:t+"",r)},response:function(t){return a=t,r},get:function(t,e){return r.send("GET",t,e)},post:function(t,e){return r.send("POST",t,e)},send:function(e,n,a){return u.open(e,t,!0,c,h),null==i||l.has("accept")||l.set("accept",i+",*/*"),u.setRequestHeader&&l.each(function(t,e){u.setRequestHeader(e,t)}),null!=i&&u.overrideMimeType&&u.overrideMimeType(i),null!=o&&(u.responseType=o),f>0&&(u.timeout=f),null==a&&"function"==typeof n&&(a=n,n=null),null!=a&&1===a.length&&(a=co(a)),null!=a&&r.on("error",a).on("load",function(t){a(null,t)}),s.call("beforesend",r,u),u.send(null==n?null:n),r},abort:function(){return u.abort(),r},on:function(){var t=s.on.apply(s,arguments);return t===s?r:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return r.get(e)}return r},Xy=function(t,e){return function(n,r){var i=Ky(n).mimeType(t).response(e);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}},Jy=Xy("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),Zy=Xy("application/json",function(t){return JSON.parse(t.responseText)}),tb=Xy("text/plain",function(t){return t.responseText}),eb=Xy("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e}),nb=function(t,e){return function(n,r,i){arguments.length<3&&(i=r,r=null);var a=Ky(n).mimeType(t);return a.row=function(t){return arguments.length?a.response(fo(e,r=t)):r},a.row(r),i?a.get(i):a}},rb=nb("text/csv",Op),ib=nb("text/tab-separated-values",Fp),ab=Array.prototype,ob=ab.map,sb=ab.slice,lb={name:"implicit"},ub=function(t){return function(){return t}},cb=function(t){return+t},hb=[0,1],fb=function(e,r,i){var a,o=e[0],s=e[e.length-1],l=n(o,s,null==r?10:r);switch(i=xm(null==i?",f":i),i.type){case"s":var u=Math.max(Math.abs(o),Math.abs(s));return null!=i.precision||isNaN(a=Mm(l,u))||(i.precision=a),t.formatPrefix(i,u);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(a=Tm(l,Math.max(Math.abs(o),Math.abs(s))))||(i.precision=a-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(a=km(l))||(i.precision=a-2*("%"===i.type))}return t.format(i)},db=function(t,e){t=t.slice();var n,r=0,i=t.length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t},pb=new Date,mb=new Date,gb=Uo(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});gb.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Uo(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):gb:null};var vb=gb.range,yb=6e4,bb=36e5,xb=6048e5,_b=Uo(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),wb=_b.range,Sb=Uo(function(t){t.setTime(Math.floor(t/yb)*yb)},function(t,e){t.setTime(+t+e*yb)},function(t,e){return(e-t)/yb},function(t){return t.getMinutes()}),kb=Sb.range,Mb=Uo(function(t){var e=t.getTimezoneOffset()*yb%bb;e<0&&(e+=bb),t.setTime(Math.floor((+t-e)/bb)*bb+e)},function(t,e){t.setTime(+t+e*bb)},function(t,e){return(e-t)/bb},function(t){return t.getHours()}),Tb=Mb.range,Cb=Uo(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*yb)/864e5},function(t){return t.getDate()-1}),Ab=Cb.range,Pb=zo(0),Eb=zo(1),Ob=zo(2),Db=zo(3),$b=zo(4),Ib=zo(5),Rb=zo(6),Fb=Pb.range,Nb=Eb.range,qb=Ob.range,jb=Db.range,Lb=$b.range,Ub=Ib.range,zb=Rb.range,Vb=Uo(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Bb=Vb.range,Yb=Uo(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Yb.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Uo(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Hb=Yb.range,Qb=Uo(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*yb)},function(t,e){return(e-t)/yb},function(t){return t.getUTCMinutes()}),Wb=Qb.range,Gb=Uo(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*bb)},function(t,e){return(e-t)/bb},function(t){return t.getUTCHours()}),Kb=Gb.range,Xb=Uo(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),Jb=Xb.range,Zb=Vo(0),tx=Vo(1),ex=Vo(2),nx=Vo(3),rx=Vo(4),ix=Vo(5),ax=Vo(6),ox=Zb.range,sx=tx.range,lx=ex.range,ux=nx.range,cx=rx.range,hx=ix.range,fx=ax.range,dx=Uo(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),px=dx.range,mx=Uo(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});mx.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Uo(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var gx,vx=mx.range,yx={"-":"",_:" ",0:"0"},bx=/^\s*\d+/,xx=/^%/,_x=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;Us({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var wx="%Y-%m-%dT%H:%M:%S.%LZ",Sx=Date.prototype.toISOString?zs:t.utcFormat(wx),kx=+new Date("2000-01-01T00:00:00.000Z")?Vs:t.utcParse(wx),Mx=1e3,Tx=60*Mx,Cx=60*Tx,Ax=24*Cx,Px=7*Ax,Ex=30*Ax,Ox=365*Ax,Dx=function(){return Hs(Yb,Vb,Pb,Cb,Mb,Sb,_b,gb,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},$x=function(){return Hs(mx,dx,Zb,Xb,Gb,Qb,_b,gb,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},Ix=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},Rx=Ix("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Fx=Ix("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Nx=Ix("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),qx=Ix("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),jx=Af(Yt(300,.5,0),Yt(-240,.5,1)),Lx=Af(Yt(-100,.75,.35),Yt(80,1.5,.8)),Ux=Af(Yt(260,.75,.35),Yt(80,1.5,.8)),zx=Yt(),Vx=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return zx.h=360*t-100,zx.s=1.5-1.5*e,zx.l=.8-.9*e,zx+""},Bx=Qs(Ix("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Yx=Qs(Ix("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Hx=Qs(Ix("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Qx=Qs(Ix("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Wx=function(t){return function(){return t}},Gx=1e-12,Kx=Math.PI,Xx=Kx/2,Jx=2*Kx,Zx=function(){function t(){var t,u,c=+e.apply(this,arguments),h=+n.apply(this,arguments),f=a.apply(this,arguments)-Xx,d=o.apply(this,arguments)-Xx,p=Math.abs(d-f),m=d>f;if(l||(l=t=$n()),h<c&&(u=h,h=c,c=u),h>Gx)if(p>Jx-Gx)l.moveTo(h*Math.cos(f),h*Math.sin(f)),l.arc(0,0,h,f,d,!m),c>Gx&&(l.moveTo(c*Math.cos(d),c*Math.sin(d)),l.arc(0,0,c,d,f,m));else{var g,v,y=f,b=d,x=f,_=d,w=p,S=p,k=s.apply(this,arguments)/2,M=k>Gx&&(i?+i.apply(this,arguments):Math.sqrt(c*c+h*h)),T=Math.min(Math.abs(h-c)/2,+r.apply(this,arguments)),C=T,A=T;if(M>Gx){var P=tl(M/c*Math.sin(k)),E=tl(M/h*Math.sin(k));(w-=2*P)>Gx?(P*=m?1:-1,x+=P,_-=P):(w=0,x=_=(f+d)/2),(S-=2*E)>Gx?(E*=m?1:-1,y+=E,b-=E):(S=0,y=b=(f+d)/2)}var O=h*Math.cos(y),D=h*Math.sin(y),$=c*Math.cos(_),I=c*Math.sin(_);if(T>Gx){var R=h*Math.cos(b),F=h*Math.sin(b),N=c*Math.cos(x),q=c*Math.sin(x);if(p<Kx){var j=w>Gx?el(O,D,N,q,R,F,$,I):[$,I],L=O-j[0],U=D-j[1],z=R-j[0],V=F-j[1],B=1/Math.sin(Math.acos((L*z+U*V)/(Math.sqrt(L*L+U*U)*Math.sqrt(z*z+V*V)))/2),Y=Math.sqrt(j[0]*j[0]+j[1]*j[1]);C=Math.min(T,(c-Y)/(B-1)),A=Math.min(T,(h-Y)/(B+1))}}S>Gx?A>Gx?(g=nl(N,q,O,D,h,A,m),v=nl(R,F,$,I,h,A,m),l.moveTo(g.cx+g.x01,g.cy+g.y01),A<T?l.arc(g.cx,g.cy,A,Math.atan2(g.y01,g.x01),Math.atan2(v.y01,v.x01),!m):(l.arc(g.cx,g.cy,A,Math.atan2(g.y01,g.x01),Math.atan2(g.y11,g.x11),!m),l.arc(0,0,h,Math.atan2(g.cy+g.y11,g.cx+g.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),!m),l.arc(v.cx,v.cy,A,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!m))):(l.moveTo(O,D),l.arc(0,0,h,y,b,!m)):l.moveTo(O,D),c>Gx&&w>Gx?C>Gx?(g=nl($,I,R,F,c,-C,m),v=nl(O,D,N,q,c,-C,m),l.lineTo(g.cx+g.x01,g.cy+g.y01),C<T?l.arc(g.cx,g.cy,C,Math.atan2(g.y01,g.x01),Math.atan2(v.y01,v.x01),!m):(l.arc(g.cx,g.cy,C,Math.atan2(g.y01,g.x01),Math.atan2(g.y11,g.x11),!m),l.arc(0,0,c,Math.atan2(g.cy+g.y11,g.cx+g.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),m),l.arc(v.cx,v.cy,C,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!m))):l.arc(0,0,c,_,x,m):l.lineTo($,I)}else l.moveTo(0,0);if(l.closePath(),t)return l=null,t+""||null}var e=Gs,n=Ks,r=Wx(0),i=null,a=Xs,o=Js,s=Zs,l=null;return t.centroid=function(){var t=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +o.apply(this,arguments))/2-Kx/2;return[Math.cos(r)*t,Math.sin(r)*t]},t.innerRadius=function(n){return arguments.length?(e="function"==typeof n?n:Wx(+n),t):e},t.outerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Wx(+e),t):n},t.cornerRadius=function(e){return arguments.length?(r="function"==typeof e?e:Wx(+e),t):r},t.padRadius=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:Wx(+e),t):i},t.startAngle=function(e){return arguments.length?(a="function"==typeof e?e:Wx(+e),t):a},t.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:Wx(+e),t):o},t.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:Wx(+e),t):s},t.context=function(e){return arguments.length?(l=null==e?null:e,t):l},t};rl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var t_=function(t){return new rl(t)},e_=function(){function t(t){var s,l,u,c=t.length,h=!1;for(null==i&&(o=a(u=$n())),s=0;s<=c;++s)!(s<c&&r(l=t[s],s,t))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(l,s,t),+n(l,s,t));if(u)return o=null,u+""||null}var e=il,n=al,r=Wx(!0),i=null,a=t_,o=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:Wx(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:Wx(+e),t):n},t.defined=function(e){return arguments.length?(r="function"==typeof e?e:Wx(!!e),t):r},t.curve=function(e){return arguments.length?(a=e,null!=i&&(o=a(i)),t):a},t.context=function(e){return arguments.length?(null==e?i=o=null:o=a(i=e),t):i},t},n_=function(){function t(t){var e,c,h,f,d,p=t.length,m=!1,g=new Array(p),v=new Array(p);for(null==s&&(u=l(d=$n())),e=0;e<=p;++e){if(!(e<p&&o(f=t[e],e,t))===m)if(m=!m)c=e,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),h=e-1;h>=c;--h)u.point(g[h],v[h]);u.lineEnd(),u.areaEnd()}m&&(g[e]=+n(f,e,t),v[e]=+i(f,e,t),u.point(r?+r(f,e,t):g[e],a?+a(f,e,t):v[e]))}if(d)return u=null,d+""||null}function e(){return e_().defined(o).curve(l).context(s)}var n=il,r=null,i=Wx(0),a=al,o=Wx(!0),s=null,l=t_,u=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:Wx(+e),r=null,t):n},t.x0=function(e){return arguments.length?(n="function"==typeof e?e:Wx(+e),t):n},t.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Wx(+e),t):r},t.y=function(e){return arguments.length?(i="function"==typeof e?e:Wx(+e),a=null,t):i},t.y0=function(e){return arguments.length?(i="function"==typeof e?e:Wx(+e),t):i},t.y1=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:Wx(+e),t):a},t.lineX0=t.lineY0=function(){return e().x(n).y(i)},t.lineY1=function(){return e().x(n).y(a)},t.lineX1=function(){return e().x(r).y(i)},t.defined=function(e){return arguments.length?(o="function"==typeof e?e:Wx(!!e),t):o},t.curve=function(e){return arguments.length?(l=e,null!=s&&(u=l(s)),t):l},t.context=function(e){return arguments.length?(null==e?s=u=null:u=l(s=e),t):s},t},r_=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},i_=function(t){return t},a_=function(){function t(t){var s,l,u,c,h,f=t.length,d=0,p=new Array(f),m=new Array(f),g=+i.apply(this,arguments),v=Math.min(Jx,Math.max(-Jx,a.apply(this,arguments)-g)),y=Math.min(Math.abs(v)/f,o.apply(this,arguments)),b=y*(v<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+e(t[s],s,t))>0&&(d+=h);for(null!=n?p.sort(function(t,e){return n(m[t],m[e])}):null!=r&&p.sort(function(e,n){return r(t[e],t[n])}),s=0,u=d?(v-f*b)/d:0;s<f;++s,g=c)l=p[s],h=m[l],c=g+(h>0?h*u:0)+b,m[l]={data:t[l],index:s,value:h,startAngle:g,endAngle:c,padAngle:y};return m}var e=i_,n=r_,r=null,i=Wx(0),a=Wx(Jx),o=Wx(0);return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Wx(+n),t):e},t.sortValues=function(e){return arguments.length?(n=e,r=null,t):n},t.sort=function(e){return arguments.length?(r=e,n=null,t):r},t.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:Wx(+e),t):i},t.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:Wx(+e),t):a},t.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:Wx(+e),t):o},t},o_=sl(t_);ol.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var s_=function(){return ll(e_().curve(o_))},l_=function(){var t=n_().curve(o_),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return ll(n())},delete t.lineX0,t.lineEndAngle=function(){return ll(r())},delete t.lineX1,t.lineInnerRadius=function(){return ll(i())},delete t.lineY0,t.lineOuterRadius=function(){return ll(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(sl(t)):e()._curve},t},u_={draw:function(t,e){var n=Math.sqrt(e/Kx);t.moveTo(n,0),t.arc(0,0,n,0,Jx)}},c_={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},h_=Math.sqrt(1/3),f_=2*h_,d_={draw:function(t,e){var n=Math.sqrt(e/f_),r=n*h_;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},p_=Math.sin(Kx/10)/Math.sin(7*Kx/10),m_=Math.sin(Jx/10)*p_,g_=-Math.cos(Jx/10)*p_,v_={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=m_*n,i=g_*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=Jx*a/5,s=Math.cos(o),l=Math.sin(o);t.lineTo(l*n,-s*n),t.lineTo(s*r-l*i,l*r+s*i)}t.closePath()}},y_={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},b_=Math.sqrt(3),x_={draw:function(t,e){var n=-Math.sqrt(e/(3*b_));t.moveTo(0,2*n),t.lineTo(-b_*n,-n),t.lineTo(b_*n,-n),t.closePath()}},__=-.5,w_=Math.sqrt(3)/2,S_=1/Math.sqrt(12),k_=3*(S_/2+1),M_={draw:function(t,e){var n=Math.sqrt(e/k_),r=n/2,i=n*S_,a=r,o=n*S_+n,s=-a,l=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,l),t.lineTo(__*r-w_*i,w_*r+__*i),t.lineTo(__*a-w_*o,w_*a+__*o),t.lineTo(__*s-w_*l,w_*s+__*l),t.lineTo(__*r+w_*i,__*i-w_*r),t.lineTo(__*a+w_*o,__*o-w_*a),t.lineTo(__*s+w_*l,__*l-w_*s),t.closePath()}},T_=[u_,c_,d_,y_,v_,x_,M_],C_=function(){function t(){var t;if(r||(r=t=$n()),e.apply(this,arguments).draw(r,+n.apply(this,arguments)),t)return r=null,t+""||null}var e=Wx(u_),n=Wx(64),r=null;return t.type=function(n){return arguments.length?(e="function"==typeof n?n:Wx(n),t):e},t.size=function(e){return arguments.length?(n="function"==typeof e?e:Wx(+e),t):n},t.context=function(e){return arguments.length?(r=null==e?null:e,t):r},t},A_=function(){};cl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ul(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ul(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var P_=function(t){return new cl(t)};hl.prototype={areaStart:A_,areaEnd:A_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ul(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var E_=function(t){return new hl(t)};fl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:ul(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var O_=function(t){return new fl(t)};dl.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*o),this._beta*e[l]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var D_=function t(e){function n(t){return 1===e?new cl(t):new dl(t,e)}return n.beta=function(e){return t(+e)},n}(.85);ml.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:pl(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:pl(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var $_=function t(e){function n(t){return new ml(t,e)}return n.tension=function(e){return t(+e)},n}(0);gl.prototype={areaStart:A_,areaEnd:A_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:pl(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var I_=function t(e){function n(t){return new gl(t,e)}return n.tension=function(e){return t(+e)},n}(0);vl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:pl(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var R_=function t(e){function n(t){return new vl(t,e)}return n.tension=function(e){return t(+e)},n}(0);bl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:yl(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var F_=function t(e){function n(t){return e?new bl(t,e):new ml(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);xl.prototype={areaStart:A_,areaEnd:A_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:yl(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var N_=function t(e){function n(t){return e?new xl(t,e):new gl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);_l.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:yl(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var q_=function t(e){function n(t){return e?new _l(t,e):new vl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);wl.prototype={areaStart:A_,areaEnd:A_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var j_=function(t){return new wl(t)};Cl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tl(this,this._t0,Ml(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tl(this,Ml(this,n=kl(this,t,e)),n);break;default:Tl(this,this._t0,n=kl(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Al.prototype=Object.create(Cl.prototype)).point=function(t,e){Cl.prototype.point.call(this,e,t)},Pl.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Dl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=$l(t),i=$l(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var L_=function(t){return new Dl(t)};Il.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var U_=function(t){return new Il(t,.5)},z_=Array.prototype.slice,V_=function(t,e){if((r=t.length)>1)for(var n,r,i=1,a=t[e[0]],o=a.length;i<r;++i){n=a,a=t[e[i]];for(var s=0;s<o;++s)a[s][1]+=a[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}},B_=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n},Y_=function(){function t(t){var a,o,s=e.apply(this,arguments),l=t.length,u=s.length,c=new Array(u);for(a=0;a<u;++a){for(var h,f=s[a],d=c[a]=new Array(l),p=0;p<l;++p)d[p]=h=[0,+i(t[p],f,p,t)],h.data=t[p];d.key=f}for(a=0,o=n(c);a<u;++a)c[o[a]].index=a;return r(c,o),c}var e=Wx([]),n=B_,r=V_,i=Nl;return t.keys=function(n){return arguments.length?(e="function"==typeof n?n:Wx(z_.call(n)),t):e},t.value=function(e){return arguments.length?(i="function"==typeof e?e:Wx(+e),t):i},t.order=function(e){return arguments.length?(n=null==e?B_:"function"==typeof e?e:Wx(z_.call(e)),t):n},t.offset=function(e){return arguments.length?(r=null==e?V_:e,t):r},t},H_=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}V_(t,e)}},Q_=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}V_(t,e)}},W_=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,l=0,u=0;s<i;++s){for(var c=t[e[s]],h=c[o][1]||0,f=c[o-1][1]||0,d=(h-f)/2,p=0;p<s;++p){var m=t[e[p]];d+=(m[o][1]||0)-(m[o-1][1]||0)}l+=h,u+=d*h}n[o-1][1]+=n[o-1][0]=a,l&&(a-=u/l)}n[o-1][1]+=n[o-1][0]=a,V_(t,e)}},G_=function(t){var e=t.map(ql);return B_(t).sort(function(t,n){return e[t]-e[n]})},K_=function(t){return G_(t).reverse()},X_=function(t){var e,n,r=t.length,i=t.map(ql),a=B_(t).sort(function(t,e){return i[e]-i[t]}),o=0,s=0,l=[],u=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],l.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(l)},J_=function(t){return B_(t).reverse()},Z_=function(t){return function(){return t}};Ul.prototype={constructor:Ul,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Yl(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Vl(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Bl(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Bl(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Vl(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,a=t.L,o=t.R;if(n=a?o?Yl(o):a:o,i?i.L===t?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=o,o.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,Vl(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Bl(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Vl(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,Bl(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Vl(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Bl(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var tw,ew,nw,rw,iw,aw=[],ow=[],sw=1e-6,lw=1e-12;gu.prototype={constructor:gu,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return tu(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(a=(i=n.halfedges).length)for(var i,a,o,s=n.site,l=-1,u=e[i[a-1]],c=u.left===s?u.right:u.left;++l<a;)o=c,u=e[i[l]],c=u.left===s?u.right:u.left,o&&c&&r<o.index&&r<c.index&&pu(s,o,c)<0&&t.push([s.data,o.data,c.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=a.cells[r=o],o=null,i.halfedges.forEach(function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,o=s.index)}})}while(null!==o);return a._found=r,null==n||c<=n*n?i.site:null}};var uw=function(){function t(t){return new gu(t.map(function(r,i){var a=[Math.round(e(r,i,t)/sw)*sw,Math.round(n(r,i,t)/sw)*sw];return a.index=i,a.data=r,a}),r)}var e=jl,n=Ll,r=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:Z_(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:Z_(+e),t):n},t.extent=function(e){return arguments.length?(r=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):r&&[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},t.size=function(e){return arguments.length?(r=null==e?null:[[0,0],[+e[0],+e[1]]],t):r&&[r[1][0]-r[0][0],r[1][1]-r[0][1]]},t},cw=function(t){return function(){return t}};yu.prototype={constructor:yu,scale:function(t){return 1===t?this:new yu(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new yu(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var hw=new yu(1,0,0);bu.prototype=yu.prototype;var fw=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},dw=function(){function e(t){t.on("wheel.zoom",u).on("mousedown.zoom",c).on("dblclick.zoom",h).on("touchstart.zoom",f).on("touchmove.zoom",p).on("touchend.zoom touchcancel.zoom",m).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",Su)}function n(t,e){return e=Math.max(x,Math.min(_,e)),e===t.k?t:new yu(e,t.x,t.y)}function r(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new yu(t.k,r,i)}function i(t,e){var n=t.invertX(e[0][0])-w,r=t.invertX(e[1][0])-S,i=t.invertY(e[0][1])-k,a=t.invertY(e[1][1])-M;return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function a(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function o(t,e,n){t.on("start.zoom",function(){s(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){s(this,arguments).end()}).tween("zoom",function(){var t=this,r=arguments,i=s(t,r),o=b.apply(t,r),l=n||a(o),u=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,r):e,f=A(c.invert(l).concat(u/c.k),h.invert(l).concat(u/h.k));return function(t){if(1===t)t=h;else{var e=f(t),n=u/e[2];t=new yu(n,l[0]-e[0]*n,l[1]-e[1]*n)}i.zoom(null,t)}})}function s(t,e){for(var n,r=0,i=P.length;r<i;++r)if((n=P[r]).that===t)return n;return new l(t,e)}function l(t,e){this.that=t,this.args=e,this.index=-1,this.active=0,this.extent=b.apply(t,e)}function u(){function e(){a.wheel=null,a.end()}if(y.apply(this,arguments)){var a=s(this,arguments),o=this.__zoom,l=Math.max(x,Math.min(_,o.k*Math.pow(2,-t.event.deltaY*(t.event.deltaMode?120:1)/500))),u=Ac(this);if(a.wheel)a.mouse[0][0]===u[0]&&a.mouse[0][1]===u[1]||(a.mouse[1]=o.invert(a.mouse[0]=u)),clearTimeout(a.wheel);else{if(o.k===l)return;a.mouse=[u,o.invert(u)],Xf(this),a.start()}fw(),a.wheel=setTimeout(e,D),a.zoom("mouse",i(r(n(o,l),a.mouse[0],a.mouse[1]),a.extent))}}function c(){function e(){fw(),a.moved=!0,a.zoom("mouse",i(r(a.that.__zoom,a.mouse[0]=Ac(a.that),a.mouse[1]),a.extent))}function n(){o.on("mousemove.zoom mouseup.zoom",null),gt(t.event.view,a.moved),fw(),a.end()}if(!v&&y.apply(this,arguments)){var a=s(this,arguments),o=ch(t.event.view).on("mousemove.zoom",e,!0).on("mouseup.zoom",n,!0),l=Ac(this);mh(t.event.view),xu(),a.mouse=[l,this.__zoom.invert(l)],Xf(this),a.start()}}function h(){if(y.apply(this,arguments)){var a=this.__zoom,s=Ac(this),l=a.invert(s),u=a.k*(t.event.shiftKey?.5:2),c=i(r(n(a,u),s,l),b.apply(this,arguments));fw(),T>0?ch(this).transition().duration(T).call(o,c,s):ch(this).call(e.transform,c)}}function f(){if(y.apply(this,arguments)){var e,n,r,i,a=s(this,arguments),o=t.event.changedTouches,l=o.length;for(xu(),n=0;n<l;++n)r=o[n],i=fh(this,o,r.identifier),i=[i,this.__zoom.invert(i),r.identifier],a.touch0?a.touch1||(a.touch1=i):(a.touch0=i,e=!0);return g&&(g=clearTimeout(g),!a.touch1)?(a.end(),void((i=ch(this).on("dblclick.zoom"))&&i.apply(this,arguments))):void(e&&(g=setTimeout(function(){g=null},O),Xf(this),a.start()))}}function p(){var e,a,o,l,u=s(this,arguments),c=t.event.changedTouches,h=c.length;for(fw(),g&&(g=clearTimeout(g)),e=0;e<h;++e)a=c[e],o=fh(this,c,a.identifier),u.touch0&&u.touch0[2]===a.identifier?u.touch0[0]=o:u.touch1&&u.touch1[2]===a.identifier&&(u.touch1[0]=o);if(a=u.that.__zoom,u.touch1){var f=u.touch0[0],d=u.touch0[1],p=u.touch1[0],m=u.touch1[1],v=(v=p[0]-f[0])*v+(v=p[1]-f[1])*v,y=(y=m[0]-d[0])*y+(y=m[1]-d[1])*y;a=n(a,Math.sqrt(v/y)),o=[(f[0]+p[0])/2,(f[1]+p[1])/2],l=[(d[0]+m[0])/2,(d[1]+m[1])/2]}else{if(!u.touch0)return;o=u.touch0[0],l=u.touch0[1]}u.zoom("touch",i(r(a,o,l),u.extent))}function m(){var e,n,r=s(this,arguments),i=t.event.changedTouches,a=i.length;for(xu(),v&&clearTimeout(v),v=setTimeout(function(){v=null},O),e=0;e<a;++e)n=i[e],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0||r.end()}var g,v,y=_u,b=wu,x=0,_=1/0,w=-_,S=_,k=w,M=S,T=250,A=wf,P=[],E=d("start","zoom","end"),O=500,D=150;return e.transform=function(t,e){var n=t.selection?t.selection():t;n.property("__zoom",Su),t!==n?o(t,e):n.interrupt().each(function(){s(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},e.scaleBy=function(t,n){e.scaleTo(t,function(){return this.__zoom.k*("function"==typeof n?n.apply(this,arguments):n)})},e.scaleTo=function(t,o){e.transform(t,function(){var t=b.apply(this,arguments),e=this.__zoom,s=a(t),l=e.invert(s);return i(r(n(e,"function"==typeof o?o.apply(this,arguments):o),s,l),t)})},e.translateBy=function(t,n,r){e.transform(t,function(){return i(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof r?r.apply(this,arguments):r),b.apply(this,arguments))})},l.prototype={start:function(){return 1==++this.active&&(this.index=P.push(this)-1,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(P.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){C(new vu(e,t,this.that.__zoom),E.apply,E,[t,this.that,this.args])}},e.filter=function(t){return arguments.length?(y="function"==typeof t?t:cw(!!t),e):y},e.extent=function(t){return arguments.length?(b="function"==typeof t?t:cw([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):b},e.scaleExtent=function(t){return arguments.length?(x=+t[0],_=+t[1],e):[x,_]},e.translateExtent=function(t){return arguments.length?(w=+t[0][0],S=+t[1][0],k=+t[0][1],M=+t[1][1],e):[[w,k],[S,M]]},e.duration=function(t){return arguments.length?(T=+t,e):T},e.interpolate=function(t){return arguments.length?(A=t,e):A},e.on=function(){var t=E.on.apply(E,arguments);return t===E?e:t},e};t.version="4.5.0",t.bisect=Cu,t.bisectRight=Cu,t.bisectLeft=Au,t.ascending=ku,t.bisector=Mu,t.descending=Pu,t.deviation=Du,t.extent=$u,t.histogram=Yu,t.thresholdFreedmanDiaconis=Qu,t.thresholdScott=Wu,t.thresholdSturges=Bu,t.max=Gu,t.mean=Ku,t.median=Xu,t.merge=Ju,t.min=Zu,t.pairs=tc,t.permute=ec,t.quantile=Hu,t.range=ju,t.scan=nc,t.shuffle=rc,t.sum=ic,t.ticks=Vu,t.tickStep=n,t.transpose=ac,t.variance=Ou,t.zip=oc,t.axisTop=u,t.axisRight=c,t.axisBottom=h,t.axisLeft=f,t.brush=lp,t.brushX=An,t.brushY=Pn,t.brushSelection=Cn,t.chord=mp,t.ribbon=wp,t.nest=kp,t.set=Hn,t.map=Ln,t.keys=Tp,t.values=Cp,t.entries=Ap,t.color=St,t.rgb=Ct,t.hsl=Ot,t.lab=Rt,t.hcl=zt,t.cubehelix=Yt,t.dispatch=d,t.drag=vh,t.dragDisable=mh,t.dragEnable=gt,t.dsvFormat=Pp,t.csvParse=Op,t.csvParseRows=Dp,t.csvFormat=$p,t.csvFormatRows=Ip,t.tsvParse=Fp,t.tsvParseRows=Np,t.tsvFormat=qp,t.tsvFormatRows=jp,t.easeLinear=tn,t.easeQuad=rn,t.easeQuadIn=en,t.easeQuadOut=nn,t.easeQuadInOut=rn,t.easeCubic=sn,t.easeCubicIn=an,t.easeCubicOut=on,t.easeCubicInOut=sn,t.easePoly=wd,t.easePolyIn=xd,t.easePolyOut=_d,t.easePolyInOut=wd,t.easeSin=cn,t.easeSinIn=ln,t.easeSinOut=un,t.easeSinInOut=cn,t.easeExp=dn,t.easeExpIn=hn,t.easeExpOut=fn,t.easeExpInOut=dn,t.easeCircle=gn,t.easeCircleIn=pn,t.easeCircleOut=mn,t.easeCircleInOut=gn,t.easeBounce=yn,t.easeBounceIn=vn,t.easeBounceOut=yn,t.easeBounceInOut=bn,t.easeBack=qd,t.easeBackIn=Fd,t.easeBackOut=Nd,t.easeBackInOut=qd,t.easeElastic=Ud,t.easeElasticIn=Ld,t.easeElasticOut=Ud,t.easeElasticInOut=zd,t.forceCenter=Lp,t.forceCollide=im,t.forceLink=am,t.forceManyBody=um,t.forceSimulation=lm,t.forceX=cm,t.forceY=hm,t.formatDefaultLocale=fr,t.formatLocale=Sm,t.formatSpecifier=xm,t.precisionFixed=km,t.precisionPrefix=Mm,t.precisionRound=Tm,t.geoArea=Og,t.geoBounds=Ig,t.geoCentroid=Fg,t.geoCircle=Xg,t.geoClipExtent=iv,t.geoDistance=cv,t.geoGraticule=mi,t.geoGraticule10=gi,t.geoInterpolate=hv,t.geoLength=sv,t.geoPath=Ov,t.geoAlbers=Vv,t.geoAlbersUsa=Bv,t.geoAzimuthalEqualArea=Hv,t.geoAzimuthalEqualAreaRaw=Yv,t.geoAzimuthalEquidistant=Wv,t.geoAzimuthalEquidistantRaw=Qv,t.geoConicConformal=Kv,t.geoConicConformalRaw=na,t.geoConicEqualArea=zv,t.geoConicEqualAreaRaw=Gi,t.geoConicEquidistant=Jv,t.geoConicEquidistantRaw=ia,t.geoEquirectangular=Xv,t.geoEquirectangularRaw=ra,t.geoGnomonic=Zv,t.geoGnomonicRaw=aa,t.geoIdentity=ty,t.geoProjection=Yi,t.geoProjectionMutator=Hi,t.geoMercator=Gv,t.geoMercatorRaw=Zi,t.geoOrthographic=ey,t.geoOrthographicRaw=sa,t.geoStereographic=ny,t.geoStereographicRaw=la,t.geoTransverseMercator=ry,t.geoTransverseMercatorRaw=ua,t.geoRotation=Kg,t.geoStream=Cg,t.geoTransform=Nv,t.cluster=iy,t.hierarchy=ba,t.pack=xy,t.packSiblings=yy,t.packEnclose=vy,t.partition=Sy,t.stratify=Cy,t.tree=Ay,t.treemap=Dy,t.treemapBinary=$y,t.treemapDice=wy,t.treemapSlice=Py,t.treemapSliceDice=Iy,t.treemapSquarify=Oy,t.treemapResquarify=Ry,t.interpolate=pf,t.interpolateArray=sf,t.interpolateBasis=tf,t.interpolateBasisClosed=ef,t.interpolateDate=lf,t.interpolateNumber=uf,t.interpolateObject=cf,t.interpolateRound=mf,t.interpolateString=df,t.interpolateTransformCss=bf,t.interpolateTransformSvg=xf,t.interpolateZoom=wf,t.interpolateRgb=rf,t.interpolateRgbBasis=af,t.interpolateRgbBasisClosed=of,t.interpolateHsl=Sf,t.interpolateHslLong=kf,t.interpolateLab=ue,t.interpolateHcl=Mf,t.interpolateHclLong=Tf,t.interpolateCubehelix=Cf,t.interpolateCubehelixLong=Af,t.quantize=Pf,t.path=$n,t.polygonArea=Fy,t.polygonCentroid=Ny,t.polygonHull=jy,t.polygonContains=Ly,t.polygonLength=Uy;t.quadtree=er,t.queue=uo,t.randomUniform=By,t.randomNormal=Yy,t.randomLogNormal=Hy,t.randomBates=Wy,t.randomIrwinHall=Qy,t.randomExponential=Gy,t.request=Ky,t.html=Jy,t.json=Zy,t.text=tb,t.xml=eb,t.csv=rb,t.tsv=ib,t.scaleBand=mo,t.scalePoint=vo,t.scaleIdentity=Co,t.scaleLinear=To,t.scaleLog=Io,t.scaleOrdinal=po,t.scaleImplicit=lb,t.scalePow=Fo,t.scaleSqrt=No,t.scaleQuantile=qo,t.scaleQuantize=jo,t.scaleThreshold=Lo,t.scaleTime=Dx,t.scaleUtc=$x,t.schemeCategory10=Rx,t.schemeCategory20b=Fx,t.schemeCategory20c=Nx,t.schemeCategory20=qx,t.interpolateCubehelixDefault=jx,t.interpolateRainbow=Vx,t.interpolateWarm=Lx,t.interpolateCool=Ux,t.interpolateViridis=Bx,t.interpolateMagma=Yx,t.interpolateInferno=Hx,t.interpolatePlasma=Qx,t.scaleSequential=Ws,t.creator=yc,t.local=x,t.matcher=Sc,t.mouse=Ac,t.namespace=vc,t.namespaces=gc,t.select=ch,t.selectAll=hh,t.selection=pt,t.selector=Pc,t.selectorAll=Oc,t.touch=fh,t.touches=dh,t.window=Kc,t.customEvent=C,t.arc=Zx,t.area=n_,t.line=e_,t.pie=a_,t.radialArea=l_,t.radialLine=s_,t.symbol=C_,t.symbols=T_,t.symbolCircle=u_,t.symbolCross=c_,t.symbolDiamond=d_,t.symbolSquare=y_,t.symbolStar=v_,t.symbolTriangle=x_,t.symbolWye=M_,t.curveBasisClosed=E_,t.curveBasisOpen=O_,t.curveBasis=P_,t.curveBundle=D_,t.curveCardinalClosed=I_,t.curveCardinalOpen=R_,t.curveCardinal=$_,t.curveCatmullRomClosed=N_,t.curveCatmullRomOpen=q_,t.curveCatmullRom=F_,t.curveLinearClosed=j_,t.curveLinear=t_,t.curveMonotoneX=El,t.curveMonotoneY=Ol,t.curveNatural=L_,t.curveStep=U_,t.curveStepAfter=Fl,t.curveStepBefore=Rl,t.stack=Y_,t.stackOffsetExpand=H_,t.stackOffsetNone=V_,t.stackOffsetSilhouette=Q_,t.stackOffsetWiggle=W_,t.stackOrderAscending=G_,t.stackOrderDescending=K_,t.stackOrderInsideOut=X_,t.stackOrderNone=B_,t.stackOrderReverse=J_,t.timeInterval=Uo,t.timeMillisecond=gb,t.timeMilliseconds=vb,t.utcMillisecond=gb,t.utcMilliseconds=vb,t.timeSecond=_b,t.timeSeconds=wb,t.utcSecond=_b,t.utcSeconds=wb,t.timeMinute=Sb,t.timeMinutes=kb,t.timeHour=Mb,t.timeHours=Tb,t.timeDay=Cb,t.timeDays=Ab,t.timeWeek=Pb,t.timeWeeks=Fb,t.timeSunday=Pb,t.timeSundays=Fb,t.timeMonday=Eb,t.timeMondays=Nb,t.timeTuesday=Ob,t.timeTuesdays=qb,t.timeWednesday=Db,t.timeWednesdays=jb,t.timeThursday=$b,t.timeThursdays=Lb,t.timeFriday=Ib,t.timeFridays=Ub,t.timeSaturday=Rb,t.timeSaturdays=zb,t.timeMonth=Vb,t.timeMonths=Bb,t.timeYear=Yb,t.timeYears=Hb,t.utcMinute=Qb,t.utcMinutes=Wb,t.utcHour=Gb,t.utcHours=Kb,t.utcDay=Xb,t.utcDays=Jb,t.utcWeek=Zb,t.utcWeeks=ox,t.utcSunday=Zb,t.utcSundays=ox,t.utcMonday=tx,t.utcMondays=sx,t.utcTuesday=ex,t.utcTuesdays=lx,t.utcWednesday=nx,t.utcWednesdays=ux,t.utcThursday=rx,t.utcThursdays=cx,t.utcFriday=ix,t.utcFridays=hx,t.utcSaturday=ax,t.utcSaturdays=fx,t.utcMonth=dx,t.utcMonths=px,t.utcYear=mx,t.utcYears=vx,t.timeFormatDefaultLocale=Us,t.timeFormatLocale=Qo,t.isoFormat=Sx,t.isoParse=kx,t.now=fe,t.timer=me,t.timerFlush=ge,t.timeout=jf,t.interval=Lf,t.transition=Je,t.active=Hd,t.interrupt=Xf,t.voronoi=uw,t.zoom=dw,t.zoomTransform=bu,t.zoomIdentity=hw,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){"use strict";function r(t,e){var n=new l.default;if(!t||0===t.length)return n;var r=u[e.transform];if(!r)throw{message:"Transformer "+e.transform+" not found"};return r.transform(t,e,n),n}n.d(e,"b",function(){return u}),n.d(e,"a",function(){return r});var i=n(4),a=n.n(i),o=n(820),s=n(801),l=n(802),u={};u.timeseries_to_rows={description:"Time series to rows",getColumns:function(){return[]},transform:function(t,e,n){n.columns=[{text:"Time",type:"date"},{text:"Metric"},{text:"Value"}];for(var r=0;r<t.length;r++)for(var i=t[r],a=0;a<i.datapoints.length;a++){var o=i.datapoints[a];n.rows.push([o[1],i.target,o[0]])}}},u.timeseries_to_columns={description:"Time series to columns",getColumns:function(){return[]},transform:function(t,e,n){n.columns.push({text:"Time",type:"date"});for(var r={},i=0;i<t.length;i++){var a=t[i];n.columns.push({text:a.target});for(var o=0;o<a.datapoints.length;o++){var s=a.datapoints[o],l=s[1].toString();r[l]?r[l][i]=s[0]:(r[l]={time:s[1]},r[l][i]=s[0])}}for(var u in r){for(var c=r[u],h=[c.time],i=0;i<t.length;i++){var f=c[i];h.push(f)}n.rows.push(h)}}},u.timeseries_aggregations={description:"Time series aggregations",getColumns:function(){return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Current",value:"current"},{text:"Count",value:"count"}]},transform:function(t,e,n){var r,i;for(n.columns.push({text:"Metric"}),r=0;r<e.columns.length;r++)n.columns.push({text:e.columns[r].text});for(r=0;r<t.length;r++){var a=new s.default({datapoints:t[r].datapoints,alias:t[r].target});a.getFlotPairs("connected");var o=[a.alias];for(i=0;i<e.columns.length;i++)o.push(a.stats[e.columns[i].value]);n.rows.push(o)}}},u.annotations={description:"Annotations",getColumns:function(){return[]},transform:function(t,e,n){if(n.columns.push({text:"Time",type:"date"}),n.columns.push({text:"Title"}),n.columns.push({text:"Text"}),n.columns.push({text:"Tags"}),t&&t.annotations&&0!==t.annotations.length)for(var r=0;r<t.annotations.length;r++){var i=t.annotations[r];n.rows.push([i.min,i.title,i.text,i.tags])}}},u.table={description:"Table",getColumns:function(t){return t&&0!==t.length?t[0].columns:[]},transform:function(t,e,n){if(t&&0!==t.length){if("table"!==t[0].type)throw{message:"Query result is not in table format, try using another transform."};n.columns=t[0].columns,n.rows=t[0].rows}}},u.json={description:"JSON Data",getColumns:function(t){if(!t||0===t.length)return[];for(var e={},n=0;n<t.length;n++){var r=t[n];if("docs"===r.type)for(var i=Math.min(r.datapoints.length,100),s=0;s<i;s++){var l=r.datapoints[s],u=Object(o.default)(l,null);for(var c in u)e[c]=!0}}return a.a.map(e,function(t,e){return{text:e,value:e}})},transform:function(t,e,n){for(var r,i,s,l=0,u=e.columns;l<u.length;l++){var c=u[l],h={text:c.text};t.length>0&&t[0].filterable&&(h.filterable=!0),n.columns.push(h)}for(0===n.columns.length&&n.columns.push({text:"JSON"}),r=0;r<t.length;r++){var f=t[r];for(i=0;i<f.datapoints.length;i++){var d=f.datapoints[i],p=[];if(a.a.isObject(d)&&e.columns.length>0){var m=Object(o.default)(d,null);for(s=0;s<e.columns.length;s++)p.push(m[e.columns[s].value])}else p.push(JSON.stringify(d));n.rows.push(p)}}}}},function(t,e,n){"use strict";e.isArrayLike=function(t){return t&&"number"==typeof t.length}},function(t,e,n){"use strict";function r(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}e.isPromise=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(291),a=n(838),o=n(811),s=n(1018),l=function(t){function e(e,n){t.call(this),this.array=e,this.scheduler=n,n||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,n){return new e(t,n)},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];var r=t[t.length-1];s.isScheduler(r)?t.pop():r=null;var i=t.length;return i>1?new e(t,r):1===i?new a.ScalarObservable(t[0],r):new o.EmptyObservable(r)},e.dispatch=function(t){var e=t.array,n=t.index,r=t.count,i=t.subscriber;if(n>=r)return void i.complete();i.next(e[n]),i.closed||(t.index=n+1,this.schedule(t))},e.prototype._subscribe=function(t){var n=this.array,r=n.length,i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{array:n,index:0,count:r,subscriber:t});for(var a=0;a<r&&!t.closed;a++)t.next(n[a]);t.complete()},e}(i.Observable);e.ArrayObservable=l},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(291),a=function(t){function e(e,n){t.call(this),this.value=e,this.scheduler=n,this._isScalar=!0,n&&(this._isScalar=!1)}return r(e,t),e.create=function(t,n){return new e(t,n)},e.dispatch=function(t){var e=t.done,n=t.value,r=t.subscriber;if(e)return void r.complete();r.next(n),r.closed||(t.done=!0,this.schedule(t))},e.prototype._subscribe=function(t){var n=this.value,r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{done:!1,value:n,subscriber:t});t.next(n),t.closed||t.complete()},e}(i.Observable);e.ScalarObservable=a},,,,,,,,,,,,,,,,function(t,e,n){var r,i;r=[n(856),n(871),n(857),n(859),n(860),n(861),n(862),n(863),n(864),n(865),n(866),n(869),n(870),n(855),n(872),n(873),n(875),n(808),n(876),n(877),n(878),n(881),n(882),n(883),n(886)],void 0!==(i=function(){}.apply(e,r))&&(t.exports=i)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4)],void 0!==(i=function(t,e){"use strict";t.module("grafana.services").service("unsavedChangesSrv",["$rootScope","$q","$location","$timeout","contextSrv","dashboardSrv","$window",function(n,r,i,a,o,s,l){function u(t,e,n){var r=this;this.current=t,this.originalPath=i.path(),this.scope=e,e.onAppEvent("dashboard-saved",function(){this.original=this.current.getSaveModelClone(),this.originalPath=i.path()}.bind(this)),l.onbeforeunload=function(){if(!r.ignoreChanges())return r.hasChanges()?"There are unsaved changes to this dashboard":void 0},e.$on("$locationChangeStart",function(t,e){return r.originalPath===i.path()||!!r.ignoreChanges()||void(r.hasChanges()&&(t.preventDefault(),r.next=e,a(function(){r.open_modal()})))}),n?a(function(){r.original=t.getSaveModelClone()},n):r.original=t.getSaveModelClone()}var c=u.prototype;c.ignoreChanges=function(){if(!this.original)return!0;if(!o.isEditor)return!0;if(!this.current||!this.current.meta)return!0;var t=this.current.meta;return!t.canSave||t.fromScript||t.fromFile},c.cleanDashboardFromIgnoredChanges=function(t){t.time=0,t.refresh=0,t.schemaVersion=0,t.editMode=!1,t.rows=e.filter(t.rows,function(t){return!t.repeatRowId&&(t.panels=e.filter(t.panels,function(t){return!t.repeatPanelId&&(t.scopedVars=null,t.span=null,t.legend&&(delete t.legend.sort,delete t.legend.sortDesc),!0)}),t.collapse=!1,!0)}),e.each(t.templating.list,function(t){t.current=null,t.options=null,t.filters=null})},c.hasChanges=function(){var n=this.current.getSaveModelClone(),r=this.original;this.cleanDashboardFromIgnoredChanges(n),this.cleanDashboardFromIgnoredChanges(r);var i=e.find(n.nav,{type:"timepicker"}),a=e.find(r.nav,{type:"timepicker"});return i&&a&&(i.now=a.now),t.toJson(n)!==t.toJson(r)},c.discardChanges=function(){this.original=null,this.gotoNext()},c.open_modal=function(){n.appEvent("show-modal",{templateHtml:'<unsaved-changes-modal dismiss="dismiss()"></unsaved-changes-modal>',modalClass:"modal--narrow confirm-modal"})},c.saveChanges=function(){var t=this,e=n.$on("dashboard-saved",function(){e(),a(function(){t.gotoNext()})});n.appEvent("save-dashboard")},c.gotoNext=function(){var t=i.absUrl().length-i.url().length,e=this.next.substring(t);i.url(e)},this.Tracker=u,this.init=function(t,e){return this.tracker=new u(t,e,1e3),this.tracker}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashboardCtrl",function(){return l});var r=n(21),i=n.n(r),a=n(8),o=n.n(a),s=n(2),l=function(){function t(t,e,n,r,a,s,l,u,c,h,f,d,p){this.$scope=t,t.editor={index:0};var m;t.setupDashboard=function(e){try{t.setupDashboardInternal(e)}catch(e){t.onInitFailed(e,"Dashboard init failed",!0)}},t.setupDashboardInternal=function(e){var i=l.create(e.dashboard,e.meta);l.setCurrent(i),r.init(i),s.init(i,e.alerts),a.init(i).catch(t.onInitFailed.bind(this,"Templating init failed",!1)).finally(function(){c.init(i),c.process(),u.init(i,t),t.dashboard=i,t.dashboardMeta=i.meta,t.dashboardViewState=h.create(t),n.setupDashboardBindings(t,i),t.dashboard.updateSubmenuVisibility(),t.setWindowTitleAndTheme(),t.appEvent("dashboard-initialized",t.dashboard)}).catch(t.onInitFailed.bind(this,"Dashboard init failed",!0))},t.onInitFailed=function(e,n,r){console.log(e,r),r.data&&r.data.message?r.message=r.data.message:r.message||(r={message:r.toString()}),t.appEvent("alert-error",[e,r.message]),n&&!t.loadedFallbackDashboard&&(t.loadedFallbackDashboard=!0,t.setupDashboard({dashboard:{title:"Dashboard Init failed"}}))},t.templateVariableUpdated=function(){c.process()},t.setWindowTitleAndTheme=function(){window.document.title=i.a.window_title_prefix+t.dashboard.title},t.broadcastRefresh=function(){e.$broadcast("refresh")},t.addRowDefault=function(){t.dashboard.addEmptyRow()},t.showJsonEditor=function(n,r){var i=e.$new();i.object=r.object,i.updateHandler=r.updateHandler,t.appEvent("show-dash-editor",{src:"public/app/partials/edit_json.html",scope:i})},t.registerWindowResizeEvent=function(){o.a.element(window).bind("resize",function(){p.cancel(m),m=p(function(){t.$broadcast("render")},200)}),t.$on("$destroy",function(){o.a.element(window).unbind("resize"),t.dashboard.destroy()})},t.timezoneChanged=function(){e.$broadcast("refresh")}}return t.$inject=["$scope","$rootScope","keybindingSrv","timeSrv","variableSrv","alertingSrv","dashboardSrv","unsavedChangesSrv","dynamicDashboardSrv","dashboardViewStateSrv","contextSrv","alertSrv","$timeout"],t.prototype.init=function(t){this.$scope.onAppEvent("show-json-editor",this.$scope.showJsonEditor),this.$scope.onAppEvent("template-variable-value-updated",this.$scope.templateVariableUpdated),this.$scope.setupDashboard(t),this.$scope.registerWindowResizeEvent()},t}();s.default.controller("DashboardCtrl",l)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/history/history.html",controller:c,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"HistoryListCtrl",function(){return c}),e.dashboardHistoryDirective=r;var i=(n(858),n(4)),a=n.n(i),o=n(8),s=n.n(o),l=n(1),u=n.n(l),c=function(){function t(t,e,n,r,i,a){this.$route=t,this.$rootScope=e,this.$location=n,this.$q=r,this.historySrv=i,this.$scope=a,this.appending=!1,this.diff="basic",this.limit=10,this.loading=!1,this.max=2,this.mode="list",this.start=0,this.canCompare=!1,this.$rootScope.onAppEvent("dashboard-saved",this.onDashboardSaved.bind(this),a),this.resetFromSource()}return t.$inject=["$route","$rootScope","$location","$q","historySrv","$scope"],t.prototype.onDashboardSaved=function(){this.resetFromSource()},t.prototype.switchMode=function(t){this.mode=t,"list"===this.mode&&this.reset()},t.prototype.dismiss=function(){this.$rootScope.appEvent("hide-dash-editor")},t.prototype.addToLog=function(){this.start=this.start+this.limit,this.getLog(!0)},t.prototype.revisionSelectionChanged=function(){var t=a.a.filter(this.revisions,{checked:!0}).length;this.canCompare=2===t},t.prototype.formatDate=function(t){return this.dashboard.formatDate(t)},t.prototype.formatBasicDate=function(t){var e="browser"===this.dashboard.timezone?u()():u.a.utc();return("browser"===this.dashboard.timezone?u()(t):u.a.utc(t)).from(e)},t.prototype.getDiff=function(t){var e=this;if(this.diff=t,this.mode="compare",this.delta[this.diff])return this.$q.when(this.delta[this.diff]);var n=a.a.filter(this.revisions,{checked:!0});this.newInfo=n[0],this.baseInfo=n[1],this.isNewLatest=this.newInfo.version===this.dashboard.version,this.loading=!0;var r={new:{dashboardId:this.dashboard.id,version:this.newInfo.version},base:{dashboardId:this.dashboard.id,version:this.baseInfo.version},diffType:t};return this.historySrv.calculateDiff(r).then(function(t){e.delta[e.diff]=t}).catch(function(){e.mode="list"}).finally(function(){e.loading=!1})},t.prototype.getLog=function(t){var e=this;void 0===t&&(t=!1),this.loading=!t,this.appending=t;var n={limit:this.limit,start:this.start};return this.historySrv.getHistoryList(this.dashboard,n).then(function(n){for(var r=0,i=n;r<i.length;r++){var a=i[r];a.createdDateString=e.formatDate(a.created),a.ageString=e.formatBasicDate(a.created),a.checked=!1}e.revisions=t?e.revisions.concat(n):n}).catch(function(t){e.loading=!1}).finally(function(){e.loading=!1,e.appending=!1})},t.prototype.isLastPage=function(){return a.a.find(this.revisions,function(t){return 1===t.version})},t.prototype.reset=function(){this.delta={basic:"",json:""},this.diff="basic",this.mode="list",this.revisions=a.a.map(this.revisions,function(t){return a.a.extend({},t,{checked:!1})}),this.canCompare=!1,this.start=0,this.isNewLatest=!1},t.prototype.resetFromSource=function(){return this.revisions=[],this.getLog().then(this.reset.bind(this))},t.prototype.restore=function(t){this.$rootScope.appEvent("confirm-modal",{title:"Restore version",text:"",text2:"Are you sure you want to restore the dashboard to version "+t+"? All unsaved changes will be lost.",icon:"fa-history",yesText:"Yes, restore to version "+t,onConfirm:this.restoreConfirm.bind(this,t)})},t.prototype.restoreConfirm=function(t){var e=this;return this.loading=!0,this.historySrv.restoreDashboard(this.dashboard,t).then(function(n){e.$location.path("dashboard/db/"+n.slug),e.$route.reload(),e.$rootScope.appEvent("alert-success",["Dashboard restored","Restored from version "+t])}).catch(function(){e.mode="list",e.loading=!1})},t}();s.a.module("grafana.directives").directive("gfDashboardHistory",r)},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=n(2),o=function(){function t(t,e){this.backendSrv=t,this.$q=e}return t.$inject=["backendSrv","$q"],t.prototype.getHistoryList=function(t,e){var n=t&&t.id?t.id:void 0;return n?this.backendSrv.get("api/dashboards/id/"+n+"/versions",e):this.$q.when([])},t.prototype.calculateDiff=function(t){return this.backendSrv.post("api/dashboards/calculate-diff",t)},t.prototype.restoreDashboard=function(t,e){var n=t&&t.id?t.id:void 0,r="api/dashboards/id/"+n+"/restore";return n&&i.a.isNumber(e)?this.backendSrv.post(r,{version:e}):this.$q.when({})},t}();a.default.service("historySrv",o)},function(t,e,n){(function(t){var r,i;r=[n(8),n(1),n(4),n(10),n(109),n(292),n(808),n(21)],void 0!==(i=function(t,e,n,r,i,a,o){"use strict";t.module("grafana.services").service("dashboardLoaderSrv",["backendSrv","dashboardSrv","datasourceSrv","$http","$q","$timeout","contextSrv","$routeParams","$rootScope",function(t,s,l,u,c,h,f,d,p){var m=this;this._dashboardLoadFailed=function(t,e){return e=e||!1,{meta:{canStar:!1,isSnapshot:e,canDelete:!1,canSave:!1,canEdit:!1,dashboardNotFound:!0},dashboard:{title:t}}},this.loadDashboard=function(e,n){var r;return r="script"===e?this._loadScriptedDashboard(n):"snapshot"===e?t.get("/api/snapshots/"+d.slug).catch(function(){return m._dashboardLoadFailed("Snapshot not found",!0)}):t.getDashboard(d.type,d.slug).catch(function(){return m._dashboardLoadFailed("Not found")}),r.then(function(t){return!0!==t.meta.dashboardNotFound&&o.impressions.addDashboardImpression(t.dashboard.id),t}),r},this._loadScriptedDashboard=function(t){var e="public/dashboards/"+t.replace(/\.(?!js)/,"/")+"?"+(new Date).getTime();return u({url:e,method:"GET"}).then(this._executeScript).then(function(t){return{meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:t.data}},function(t){return console.log("Script dashboard error "+t),p.appEvent("alert-error",["Script Error","Please make sure it exists and returns a valid dashboard"]),m._dashboardLoadFailed("Scripted dashboard")})},this._executeScript=function(t){var o={dashboardSrv:s,datasourceSrv:l,$q:c},u=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",t.data),f=u(d,i,a,n,e,window,document,r,r,o);if(n.isFunction(f)){var p=c.defer();return f(function(t){h(function(){p.resolve({data:t})})}),p.promise}return{data:f}}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/dashnav/dashnav.html",controller:h,bindToController:!0,controllerAs:"ctrl",transclude:!0,scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashNavCtrl",function(){return h}),e.dashNavDirective=r;var i=n(4),a=n.n(i),o=n(1),s=n.n(o),l=n(8),u=n.n(l),c=n(290),h=function(){function t(t,e,n,r,i,a,o){if(this.$scope=t,this.$rootScope=e,this.dashboardSrv=n,this.$location=r,this.backendSrv=i,this.contextSrv=a,this.navModel=o.getDashboardNav(this.dashboard,this),c.appEvents.on("save-dashboard",this.saveDashboard.bind(this),t),c.appEvents.on("delete-dashboard",this.deleteDashboard.bind(this),t),this.dashboard.meta.isSnapshot){var l=this.dashboard.meta;this.titleTooltip="Created: &nbsp;"+s()(l.created).calendar(),l.expires&&(this.titleTooltip+="<br>Expires: &nbsp;"+s()(l.expires).fromNow()+"<br>")}}return t.$inject=["$scope","$rootScope","dashboardSrv","$location","backendSrv","contextSrv","navModelSrv"],t.prototype.toggleSideMenu=function(){this.contextSrv.toggleSideMenu()},t.prototype.openEditView=function(t){var e=a.a.extend(this.$location.search(),{editview:t});this.$location.search(e)},t.prototype.showHelpModal=function(){c.appEvents.emit("show-modal",{templateHtml:"<help-modal></help-modal>"})},t.prototype.starDashboard=function(){var t=this;if(this.dashboard.meta.isStarred)return this.backendSrv.delete("/api/user/stars/dashboard/"+this.dashboard.id).then(function(){t.dashboard.meta.isStarred=!1});this.backendSrv.post("/api/user/stars/dashboard/"+this.dashboard.id).then(function(){t.dashboard.meta.isStarred=!0})},t.prototype.shareDashboard=function(t){var e=this.$scope.$new();e.tabIndex=t,e.dashboard=this.dashboard,c.appEvents.emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:e})},t.prototype.hideTooltip=function(t){u.a.element(t.currentTarget).tooltip("hide")},t.prototype.makeEditable=function(){return this.dashboard.editable=!0,this.dashboardSrv.saveDashboard({makeEditable:!0,overwrite:!1}).then(function(){window.location.href=window.location.href})},t.prototype.exitFullscreen=function(){this.$rootScope.appEvent("panel-change-view",{fullscreen:!1,edit:!1})},t.prototype.saveDashboard=function(){return this.dashboardSrv.saveDashboard()},t.prototype.deleteDashboard=function(){var t=this,e="",n=this.dashboard.title,r=this.dashboard.rows.reduce(function(t,e){return t+=e.panels.filter(function(t){return t.alert}).length},0);r>0&&(e="DELETE",n="This dashboad contains "+r+" alerts. Deleting this dashboad will also delete those alerts"),c.appEvents.emit("confirm-modal",{title:"Delete",text:"Do you want to delete this dashboard?",text2:n,icon:"fa-trash",confirmText:e,yesText:"Delete",onConfirm:function(){t.dashboard.meta.canSave=!1,t.deleteDashboardConfirmed()}})},t.prototype.deleteDashboardConfirmed=function(){var t=this;this.backendSrv.delete("/api/dashboards/db/"+this.dashboard.meta.slug).then(function(){c.appEvents.emit("alert-success",["Dashboard Deleted",t.dashboard.title+" has been deleted"]),t.$location.url("/")})},t.prototype.saveDashboardAs=function(){return this.dashboardSrv.showSaveAsModal()},t.prototype.viewJson=function(){var t=this.dashboard.getSaveModelClone();this.$rootScope.appEvent("show-json-editor",{object:t})},t.prototype.showSearch=function(){this.$rootScope.appEvent("show-dash-search")},t.prototype.navItemClicked=function(t,e){t.clickHandler&&(t.clickHandler(),e.preventDefault())},t}();u.a.module("grafana.directives").directive("dashnav",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/submenu/submenu.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SubmenuCtrl",function(){return l}),e.submenuDirective=r;var i=n(8),a=n.n(i),o=n(4),s=n.n(o),l=function(){function t(t,e,n){this.$rootScope=t,this.variableSrv=e,this.$location=n,this.annotations=this.dashboard.templating.list,this.variables=this.variableSrv.variables}return t.$inject=["$rootScope","variableSrv","$location"],t.prototype.annotationStateChanged=function(){this.$rootScope.$broadcast("refresh")},t.prototype.variableUpdated=function(t){this.variableSrv.variableUpdated(t,!0)},t.prototype.openEditView=function(t){var e=s.a.extend(this.$location.search(),{editview:t});this.$location.search(e)},t}();a.a.module("grafana.directives").directive("dashboardSubmenu",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",template:a,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SaveDashboardAsModalCtrl",function(){return o}),e.saveDashboardAsDirective=r;var i=n(2),a='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-copy"></i>\n\t\t\t<span class="p-l-1">Save As...</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n\t<form name="ctrl.saveForm" ng-submit="ctrl.save()" class="modal-content" novalidate>\n\t\t<div class="p-t-2">\n\t\t\t<div class="gf-form">\n\t\t\t\t<label class="gf-form-label">New name</label>\n\t\t\t\t<input type="text" class="gf-form-input" ng-model="ctrl.clone.title" give-focus="true" required>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="gf-form-button-row text-center">\n\t\t\t<button type="submit" class="btn btn-success" ng-disabled="ctrl.saveForm.$invalid">Save</button>\n\t\t\t<a class="btn-text" ng-click="ctrl.dismiss();">Cancel</a>\n\t\t</div>\n\t</form>\n</div>\n',o=function(){function t(t){this.dashboardSrv=t;var e=this.dashboardSrv.getCurrent();this.clone=e.getSaveModelClone(),this.clone.id=null,this.clone.title+=" Copy",this.clone.editable=!0,this.clone.hideControls=!1,e.id>0&&this.clone.rows.forEach(function(t){t.panels.forEach(function(t){delete t.thresholds,delete t.alert})}),delete this.clone.autoUpdate}return t.$inject=["dashboardSrv"],t.prototype.save=function(){return this.dashboardSrv.save(this.clone).then(this.dismiss)},t.prototype.keyDown=function(t){13===t.keyCode&&this.save()},t}();i.default.directive("saveDashboardAsModal",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",template:a,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SaveDashboardModalCtrl",function(){return o}),e.saveDashboardModalDirective=r;var i=n(2),a='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-save"></i>\n\t\t\t<span class="p-l-1">Save changes</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n\t<form name="ctrl.saveForm" ng-submit="ctrl.save()" class="modal-content" novalidate>\n\t\t<h6 class="text-center">Add a note to describe your changes</h6>\n\t\t<div class="p-t-2">\n\t\t\t<div class="gf-form">\n\t\t\t\t<label class="gf-form-hint">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="message"\n\t\t\t\t\t\tclass="gf-form-input"\n\t\t\t\t\t\tplaceholder="Updates to &hellip;"\n\t\t\t\t\t\tgive-focus="true"\n\t\t\t\t\t\tng-model="ctrl.message"\n\t\t\t\t\t\tng-model-options="{allowInvalid: true}"\n\t\t\t\t\t\tng-maxlength="this.max"\n\t\t\t\t\t\tautocomplete="off" />\n\t\t\t\t\t<small class="gf-form-hint-text muted" ng-cloak>\n\t\t\t\t\t\t<span ng-class="{\'text-error\': ctrl.saveForm.message.$invalid && ctrl.saveForm.message.$dirty }">\n\t\t\t\t\t\t\t{{ctrl.message.length || 0}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t/ {{ctrl.max}} characters\n\t\t\t\t\t</small>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="gf-form-button-row text-center">\n\t\t\t<button type="submit" class="btn btn-success" ng-disabled="ctrl.saveForm.$invalid">Save</button>\n\t\t\t<button class="btn btn-inverse" ng-click="ctrl.dismiss();">Cancel</button>\n\t\t</div>\n\t</form>\n</div>\n',o=function(){function t(t){this.dashboardSrv=t,this.message="",this.max=64}return t.$inject=["dashboardSrv"],t.prototype.save=function(){if(this.saveForm.$valid){var t=this.dashboardSrv.getCurrent(),e=t.getSaveModelClone(),n={message:this.message};return this.dashboardSrv.save(e,n).then(this.dismiss)}},t}();i.default.directive("saveDashboardModal",r)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(10),n(1),n(21)],void 0!==(i=function(t,e,n,r,i){"use strict";t.module("grafana.controllers").controller("ShareModalCtrl",["$scope","$rootScope","$location","$timeout","timeSrv","templateSrv","linkSrv",function(e,n,a,o,s,l,u){e.options={forCurrent:!0,includeTemplateVars:!0,theme:"current"},e.editor={index:e.tabIndex||0},e.init=function(){e.modeSharePanel=!!e.panel,e.tabs=[{title:"Link",src:"shareLink.html"}],e.modeSharePanel?(e.modalTitle="Share Panel",e.tabs.push({title:"Embed",src:"shareEmbed.html"})):e.modalTitle="Share",e.dashboard.meta.isSnapshot||e.tabs.push({title:"Snapshot",src:"shareSnapshot.html"}),e.dashboard.meta.isSnapshot||e.modeSharePanel||e.tabs.push({title:"Export",src:"shareExport.html"}),e.buildUrl()},e.buildUrl=function(){var n=a.absUrl(),o=n.indexOf("?");-1!==o&&(n=n.substring(0,o));var c=t.copy(a.search()),h=s.timeRange();c.from=h.from.valueOf(),c.to=h.to.valueOf(),c.orgId=i.bootData.user.orgId,e.options.includeTemplateVars&&l.fillVariableValuesForUrl(c),e.options.forCurrent||(delete c.from,delete c.to),"current"!==e.options.theme&&(c.theme=e.options.theme),e.modeSharePanel?(c.panelId=e.panel.id,c.fullscreen=!0):(delete c.panelId,delete c.fullscreen),e.shareUrl=u.addParamsToUrl(n,c);var f=n.replace(i.appSubUrl+"/dashboard/",i.appSubUrl+"/dashboard-solo/");delete c.fullscreen,delete c.edit,f=u.addParamsToUrl(f,c),e.iframeHtml='<iframe src="'+f+'" width="450" height="200" frameborder="0"></iframe>',e.imageUrl=f.replace(i.appSubUrl+"/dashboard-solo/",i.appSubUrl+"/render/dashboard-solo/"),e.imageUrl+="&width=1000",e.imageUrl+="&height=500",e.imageUrl+="&tz=UTC"+encodeURIComponent(r().format("Z"))},e.getShareUrl=function(){return e.shareUrl}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){(function(t){var r,i;r=[n(8),n(4)],void 0!==(i=function(t,e){"use strict";t.module("grafana.controllers").controller("ShareSnapshotCtrl",["$scope","$rootScope","$location","backendSrv","$timeout","timeSrv",function(t,n,r,i,a,o){t.snapshot={name:t.dashboard.title,expires:0,timeoutSeconds:4},t.step=1,t.expireOptions=[{text:"1 Hour",value:3600},{text:"1 Day",value:86400},{text:"7 Days",value:604800},{text:"Never",value:0}],t.accessOptions=[{text:"Anyone with the link",value:1},{text:"Organization users",value:2},{text:"Public on the web",value:3}],t.init=function(){i.get("/api/snapshot/shared-options").then(function(e){t.externalUrl=e.externalSnapshotURL,t.sharingButtonText=e.externalSnapshotName,t.externalEnabled=e.externalEnabled})},t.apiUrl="/api/snapshots",t.createSnapshot=function(e){t.dashboard.snapshot={timestamp:new Date},e||(t.dashboard.snapshot.originalUrl=r.absUrl()),t.loading=!0,t.snapshot.external=e,n.$broadcast("refresh"),a(function(){t.saveSnapshot(e)},1e3*t.snapshot.timeoutSeconds)},t.saveSnapshot=function(e){var n=t.dashboard.getSaveModelClone();t.scrubDashboard(n);var a={dashboard:n,name:n.title,expires:t.snapshot.expires},o=e?t.externalUrl+t.apiUrl:t.apiUrl;i.post(o,a).then(function(n){if(t.loading=!1,e)t.deleteUrl=n.deleteUrl,t.snapshotUrl=n.url,t.saveExternalSnapshotRef(a,n);else{var i=r.url(),o=r.absUrl();"/"!==i&&(o=o.replace(i,"")+"/"),t.snapshotUrl=o+"dashboard/snapshot/"+n.key,t.deleteUrl=o+"api/snapshots-delete/"+n.deleteKey}t.step=2},function(){t.loading=!1})},t.getSnapshotUrl=function(){return t.snapshotUrl},t.scrubDashboard=function(n){if(n.title=t.snapshot.name,n.time=o.timeRange(),n.forEachPanel(function(t){t.targets=[],t.links=[],t.datasource=null}),n.annotations.list=e.chain(n.annotations.list).filter(function(t){return t.enable}).map(function(t){return{name:t.name,enable:t.enable,iconColor:t.iconColor,snapshotData:t.snapshotData}}).value(),e.each(n.templating.list,function(t){t.query="",t.options=t.current,t.refresh=!1}),t.modeSharePanel){var r=n.getPanelById(t.panel.id);r.span=12,n.rows=[{height:"500px",span:12,panels:[r]}]}delete t.dashboard.snapshot,t.dashboard.forEachPanel(function(t){delete t.snapshotData}),e.each(t.dashboard.annotations.list,function(t){delete t.snapshotData})},t.deleteSnapshot=function(){i.get(t.deleteUrl).then(function(){t.step=3})},t.saveExternalSnapshotRef=function(t,e){t.external=!0,t.key=e.key,t.deleteKey=e.deleteKey,i.post("/api/snapshots/",t)}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashboardSrv",function(){return a});var r=n(2),i=n(867),a=function(){function t(t,e,n){this.backendSrv=t,this.$rootScope=e,this.$location=n}return t.$inject=["backendSrv","$rootScope","$location"],t.prototype.create=function(t,e){return new i.a(t,e)},t.prototype.setCurrent=function(t){this.dash=t},t.prototype.getCurrent=function(){return this.dash},t.prototype.handleSaveDashboardError=function(t,e){var n=this;e.data&&"version-mismatch"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Conflict",text:"Someone else has updated this dashboard.",text2:"Would you still like to save this dashboard?",yesText:"Save & Overwrite",icon:"fa-warning",onConfirm:function(){n.save(t,{overwrite:!0})}})),e.data&&"name-exists"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Conflict",text:"Dashboard with the same name exists.",text2:"Would you still like to save this dashboard?",yesText:"Save & Overwrite",icon:"fa-warning",onConfirm:function(){n.save(t,{overwrite:!0})}})),e.data&&"plugin-dashboard"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Plugin Dashboard",text:e.data.message,text2:"Your changes will be lost when you update the plugin. Use Save As to create custom version.",yesText:"Overwrite",icon:"fa-warning",altActionText:"Save As",onAltAction:function(){n.showSaveAsModal()},onConfirm:function(){n.save(t,{overwrite:!0})}}))},t.prototype.postSave=function(t,e){this.dash.version=e.version;var n="/dashboard/db/"+e.slug;n!==this.$location.path()&&this.$location.url(n),this.$rootScope.appEvent("dashboard-saved",this.dash),this.$rootScope.appEvent("alert-success",["Dashboard saved"])},t.prototype.save=function(t,e){return this.backendSrv.saveDashboard(t,e).then(this.postSave.bind(this,t)).catch(this.handleSaveDashboardError.bind(this,t))},t.prototype.saveDashboard=function(t,e){return e&&this.setCurrent(this.create(e,this.dash.meta)),this.dash.meta.canSave||!0===t.makeEditable?"New dashboard"===this.dash.title?this.showSaveAsModal():this.dash.version>0?this.showSaveModal():this.save(this.dash.getSaveModelClone(),t):Promise.resolve()},t.prototype.showSaveAsModal=function(){var t=this.$rootScope.$new();t.clone=this.dash.getSaveModelClone(),t.clone.editable=!0,t.clone.hideControls=!1,this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-as-modal dismiss="dismiss()"></save-dashboard-as-modal>',scope:t,modalClass:"modal--narrow"})},t.prototype.showSaveModal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-modal dismiss="dismiss()"></save-dashboard-modal>',scope:this.$rootScope.$new(),modalClass:"modal--narrow"})},t}();r.default.service("dashboardSrv",a)},function(t,e,n){"use strict";n.d(e,"a",function(){return m});var r=n(8),i=n.n(r),a=n(1),o=n.n(a),s=n(4),l=n.n(s),u=n(10),c=n.n(u),h=n(111),f=n(290),d=n(814),p=n(868),m=function(){function t(t,e){if(t||(t={}),this.events=new f.Emitter,this.id=t.id||null,this.revision=t.revision,this.title=t.title||"No Title",this.autoUpdate=t.autoUpdate,this.description=t.description,this.tags=t.tags||[],this.style=t.style||"dark",this.timezone=t.timezone||"",this.editable=!1!==t.editable,this.graphTooltip=t.graphTooltip||0,this.hideControls=t.hideControls||!1,this.time=t.time||{from:"now-6h",to:"now"},this.timepicker=t.timepicker||{},this.templating=this.ensureListExist(t.templating),this.annotations=this.ensureListExist(t.annotations),this.refresh=t.refresh,this.snapshot=t.snapshot,this.schemaVersion=t.schemaVersion||0,this.version=t.version||0,this.links=t.links||[],this.gnetId=t.gnetId||null,this.rows=[],t.rows)for(var n=0,r=t.rows;n<r.length;n++){var i=r[n];this.rows.push(new d.a(i))}this.addBuiltInAnnotationQuery(),this.updateSchema(t),this.initMeta(e)}return t.prototype.addBuiltInAnnotationQuery=function(){for(var t=!1,e=0,n=this.annotations.list;e<n.length;e++){if(1===n[e].builtIn){t=!0;break}}t||this.annotations.list.unshift({datasource:"-- Grafana --",name:"Annotations & Alerts",type:"dashboard",iconColor:h.b,enable:!0,hide:!0,builtIn:1})},t.prototype.initMeta=function(t){t=t||{},t.canShare=!1!==t.canShare,t.canSave=!1!==t.canSave,t.canStar=!1!==t.canStar,t.canEdit=!1!==t.canEdit,this.editable||(t.canEdit=!1,t.canDelete=!1,t.canSave=!1),this.meta=t},t.prototype.getSaveModelClone=function(){var t=this.events,e=this.meta,n=this.rows,r=this.templating.list;delete this.events,delete this.meta,this.rows=l.a.map(n,function(t){return t.getSaveModel()}),this.templating.list=l.a.map(r,function(t){return t.getSaveModel?t.getSaveModel():t});var i=c.a.extend(!0,{},this);return i=Object(p.a)(i),this.events=t,this.meta=e,this.rows=n,this.templating.list=r,i},t.prototype.addEmptyRow=function(){this.rows.push(new d.a({isNew:!0}))},t.prototype.ensureListExist=function(t){return t||(t={}),t.list||(t.list=[]),t},t.prototype.getNextPanelId=function(){var t,e,n,r,i=0;for(t=0;t<this.rows.length;t++)for(n=this.rows[t],e=0;e<n.panels.length;e++)r=n.panels[e],r.id>i&&(i=r.id);return i+1},t.prototype.forEachPanel=function(t){var e,n,r;for(e=0;e<this.rows.length;e++)for(r=this.rows[e],n=0;n<r.panels.length;n++)t(r.panels[n],n,r,e)},t.prototype.getPanelById=function(t){for(var e=0;e<this.rows.length;e++)for(var n=this.rows[e],r=0;r<n.panels.length;r++){var i=n.panels[r];if(i.id===t)return i}return null},t.prototype.addPanel=function(t,e){t.id=this.getNextPanelId(),e.addPanel(t)},t.prototype.removeRow=function(t,e){var n=this,r=l.a.indexOf(this.rows,t);if(!t.panels.length||e)return this.rows.splice(r,1),void t.destroy();f.appEvents.emit("confirm-modal",{title:"Remove Row",text:"Are you sure you want to remove this row?",icon:"fa-trash",yesText:"Delete",onConfirm:function(){n.rows.splice(r,1),t.destroy()}})},t.prototype.setPanelFocus=function(t){this.meta.focusPanelId=t},t.prototype.updateSubmenuVisibility=function(){var t=this;this.meta.submenuEnabled=function(){return t.links.length>0||(l.a.filter(t.templating.list,function(t){return 2!==t.hide}).length>0||l.a.filter(t.annotations.list,function(t){return!0!==t.hide}).length>0)}()},t.prototype.getPanelInfoById=function(t){var e={};return l.a.each(this.rows,function(n){l.a.each(n.panels,function(r,i){r.id===t&&(e.panel=r,e.row=n,e.index=i)})}),e.panel?e:null},t.prototype.duplicatePanel=function(t,e){var n=i.a.copy(t);return n.id=this.getNextPanelId(),delete n.repeat,delete n.repeatIteration,delete n.repeatPanelId,delete n.scopedVars,n.alert&&delete n.thresholds,delete n.alert,e.addPanel(n),n},t.prototype.formatDate=function(t,e){return t=o.a.isMoment(t)?t:o()(t),e=e||"YYYY-MM-DD HH:mm:ss","browser"===this.getTimezone()?o()(t).format(e):o.a.utc(t).format(e)},t.prototype.destroy=function(){this.events.removeAllListeners();for(var t=0,e=this.rows;t<e.length;t++){e[t].destroy()}},t.prototype.cycleGraphTooltip=function(){this.graphTooltip=(this.graphTooltip+1)%3},t.prototype.sharedTooltipModeEnabled=function(){return this.graphTooltip>0},t.prototype.sharedCrosshairModeOnly=function(){return 1===this.graphTooltip},t.prototype.getRelativeTime=function(t){return t=o.a.isMoment(t)?t:o()(t),"browser"===this.timezone?o()(t).fromNow():o.a.utc(t).fromNow()},t.prototype.getNextQueryLetter=function(t){return l.a.find("ABCDEFGHIJKLMNOPQRSTUVWXYZ",function(e){return l.a.every(t.targets,function(t){return t.refId!==e})})},t.prototype.isTimezoneUtc=function(){return"utc"===this.getTimezone()},t.prototype.getTimezone=function(){return this.timezone?this.timezone:f.contextSrv.user.timezone},t.prototype.updateSchema=function(t){var e,n,r,i=this.schemaVersion,a=[];if(this.schemaVersion=14,i!==this.schemaVersion){if(i<2&&(t.services&&t.services.filter&&(this.time=t.services.filter.time,this.templating.list=t.services.filter.list||[]),a.push(function(t){"graphite"===t.type&&(t.type="graph"),"graph"===t.type&&(l.a.isBoolean(t.legend)&&(t.legend={show:t.legend}),t.grid&&(t.grid.min&&(t.grid.leftMin=t.grid.min,delete t.grid.min),t.grid.max&&(t.grid.leftMax=t.grid.max,delete t.grid.max)),t.y_format&&(t.y_formats[0]=t.y_format,delete t.y_format),t.y2_format&&(t.y_formats[1]=t.y2_format,delete t.y2_format))})),i<3){var o=this.getNextPanelId();a.push(function(t){t.id||(t.id=o,o+=1)})}if(i<4&&a.push(function(t){"graph"===t.type&&(l.a.each(t.aliasYAxis,function(e,n){t.seriesOverrides=[{alias:n,yaxis:e}]}),delete t.aliasYAxis)}),i<6){var s=l.a.find(t.pulldowns,{type:"annotations"});for(s&&(this.annotations={list:s.annotations||[]}),e=0;e<this.templating.list.length;e++){var u=this.templating.list[e];void 0===u.datasource&&(u.datasource=null),"filter"===u.type&&(u.type="query"),void 0===u.type&&(u.type="query"),void 0===u.allFormat&&(u.allFormat="glob")}}if(i<7&&(t.nav&&t.nav.length&&(this.timepicker=t.nav[0]),a.push(function(t){l.a.each(t.targets,function(e){e.refId||(e.refId=this.getNextQueryLetter(t))}.bind(this))})),i<8&&a.push(function(t){l.a.each(t.targets,function(t){t.fields&&t.tags&&t.groupBy&&(t.rawQuery?(delete t.fields,delete t.fill):(t.select=l.a.map(t.fields,function(t){var e=[];return e.push({type:"field",params:[t.name]}),e.push({type:t.func,params:[]}),t.mathExpr&&e.push({type:"math",params:[t.mathExpr]}),t.asExpr&&e.push({type:"alias",params:[t.asExpr]}),e}),delete t.fields,l.a.each(t.groupBy,function(t){"time"===t.type&&t.interval&&(t.params=[t.interval],delete t.interval),"tag"===t.type&&t.key&&(t.params=[t.key],delete t.key)}),t.fill&&(t.groupBy.push({type:"fill",params:[t.fill]}),delete t.fill)))})}),i<9&&a.push(function(t){if(("singlestat"===t.type||""===t.thresholds)&&t.thresholds){var e=t.thresholds.split(",");e.length>=3&&(e.shift(),t.thresholds=e.join(","))}}),i<10&&a.push(function(t){"table"===t.type&&l.a.each(t.styles,function(t){if(t.thresholds&&t.thresholds.length>=3){var e=t.thresholds;e.shift(),t.thresholds=e}})}),i<12&&l.a.each(this.templating.list,function(t){t.refresh&&(t.refresh=1),t.refresh||(t.refresh=0),t.hideVariable?t.hide=2:t.hideLabel&&(t.hide=1)}),i<12&&a.push(function(t){"graph"===t.type&&t.grid&&(t.yaxes||(t.yaxes=[{show:t["y-axis"],min:t.grid.leftMin,max:t.grid.leftMax,logBase:t.grid.leftLogBase,format:t.y_formats[0],label:t.leftYAxisLabel},{show:t["y-axis"],min:t.grid.rightMin,max:t.grid.rightMax,logBase:t.grid.rightLogBase,format:t.y_formats[1],label:t.rightYAxisLabel}],t.xaxis={show:t["x-axis"]},delete t.grid.leftMin,delete t.grid.leftMax,delete t.grid.leftLogBase,delete t.grid.rightMin,delete t.grid.rightMax,delete t.grid.rightLogBase,delete t.y_formats,delete t.leftYAxisLabel,delete t.rightYAxisLabel,delete t["y-axis"],delete t["x-axis"]))}),i<13&&a.push(function(t){if("graph"===t.type&&t.grid){t.thresholds=[];var e={},n={};null!==t.grid.threshold1&&(e.value=t.grid.threshold1,t.grid.thresholdLine?(e.line=!0,e.lineColor=t.grid.threshold1Color,e.colorMode="custom"):(e.fill=!0,e.fillColor=t.grid.threshold1Color,e.colorMode="custom")),null!==t.grid.threshold2&&(n.value=t.grid.threshold2,t.grid.thresholdLine?(n.line=!0,n.lineColor=t.grid.threshold2Color,n.colorMode="custom"):(n.fill=!0,n.fillColor=t.grid.threshold2Color,n.colorMode="custom")),l.a.isNumber(e.value)&&(l.a.isNumber(n.value)?e.value>n.value?(e.op=n.op="lt",t.thresholds.push(e),t.thresholds.push(n)):(e.op=n.op="gt",t.thresholds.push(e),t.thresholds.push(n)):(e.op="gt",t.thresholds.push(e))),delete t.grid.threshold1,delete t.grid.threshold1Color,delete t.grid.threshold2,delete t.grid.threshold2Color,delete t.grid.thresholdLine}}),i<14&&(this.graphTooltip=t.sharedCrosshair?1:0),0!==a.length)for(e=0;e<this.rows.length;e++){var c=this.rows[e];for(n=0;n<c.panels.length;n++)for(r=0;r<a.length;r++)a[r].call(this,c.panels[n])}}},t}()},function(t,e,n){"use strict";function r(t){if(a.a.isArray(t))return t.map(r);if(a.a.isPlainObject(t)){for(var e={},n=0,i=a.a.keys(t).sort();n<i.length;n++){var o=i[n];e[o]=r(t[o])}return e}return t}e.a=r;var i=n(4),a=n.n(i)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(10),n(21)],void 0!==(i=function(t,e,n,r){"use strict";t.module("grafana.services").factory("dashboardViewStateSrv",["$location","$timeout",function(t,i){function a(e){var n=this;n.state={},n.panelScopes=[],n.$scope=e,n.dashboard=e.dashboard,e.onAppEvent("$routeUpdate",function(){var t=n.getQueryStringState();n.needsSync(t)&&n.update(t,!0)}),e.onAppEvent("panel-change-view",function(t,e){n.update(e)}),e.onAppEvent("panel-initialized",function(t,e){n.registerPanel(e.scope)}),t.replace(),this.update(this.getQueryStringState()),this.expandRowForPanel()}return a.prototype.expandRowForPanel=function(){if(this.state.panelId){var t=this.$scope.dashboard.getPanelInfoById(this.state.panelId);t&&(t.row.collapse=!1)}},a.prototype.needsSync=function(t){return!1===e.isEqual(this.state,t)},a.prototype.getQueryStringState=function(){var e=t.search();return e.panelId=parseInt(e.panelId)||null,e.fullscreen=!!e.fullscreen||null,e.edit="true"===e.edit||!0===e.edit||null,e.editview=e.editview||null,e.orgId=r.bootData.user.orgId,e},a.prototype.serializeToUrl=function(){var t=e.clone(this.state);return t.fullscreen=!!this.state.fullscreen||null,t.edit=!!this.state.edit||null,t},a.prototype.update=function(n,r){n.toggle&&(delete n.toggle,this.state.fullscreen&&n.fullscreen&&this.state.edit===n.edit&&(n.fullscreen=!n.fullscreen)),this.editStateChanged=n.edit!==this.state.edit,e.extend(this.state,n),this.dashboard.meta.fullscreen=this.state.fullscreen,this.state.fullscreen||(this.state.fullscreen=null,this.state.edit=null,this.dashboard.meta.soloMode||(this.state.panelId=null)),this.state.edit||delete this.state.tab,!0!==r&&t.search(this.serializeToUrl()),this.syncState()},a.prototype.syncState=function(){if(0!==this.panelScopes.length)if(this.dashboard.meta.fullscreen){var t=this.getPanelScope(this.state.panelId);if(!t)return;if(this.fullscreenPanel){if(this.fullscreenPanel===t&&!1===this.editStateChanged)return;this.leaveFullscreen(!1)}t.ctrl.editModeInitiated||t.ctrl.initEditMode(),t.ctrl.fullscreen||this.enterFullscreen(t)}else this.fullscreenPanel&&this.leaveFullscreen(!0)},a.prototype.getPanelScope=function(t){return e.find(this.panelScopes,function(e){return e.ctrl.panel.id===t})},a.prototype.leaveFullscreen=function(t){var e=this,n=e.fullscreenPanel.ctrl;if(n.editMode=!1,n.fullscreen=!1,n.dashboard.editMode=this.oldDashboardEditMode,this.$scope.appEvent("panel-fullscreen-exit",{panelId:n.panel.id}),!t)return!1;i(function(){e.oldTimeRange!==n.range?e.$scope.broadcastRefresh():e.$scope.$broadcast("render"),delete e.fullscreenPanel})},a.prototype.enterFullscreen=function(t){var e=t.ctrl;e.editMode=this.state.edit&&this.dashboard.meta.canEdit,e.fullscreen=!0,this.oldDashboardEditMode=this.dashboard.editMode,this.oldTimeRange=e.range,this.fullscreenPanel=t,this.dashboard.editMode=!1,n(window).scrollTop(0),this.$scope.appEvent("panel-fullscreen-enter",{panelId:e.panel.id}),i(function(){e.render()})},a.prototype.registerPanel=function(t){var n=this;n.panelScopes.push(t),n.dashboard.meta.soloMode||n.state.panelId===t.ctrl.panel.id&&(n.state.edit?t.ctrl.editPanel():t.ctrl.viewPanel());var r=t.$on("$destroy",function(){n.panelScopes=e.without(n.panelScopes,t),r()})},{create:function(t){return new a(t)}}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),a=n(4),o=n.n(a),s=n(2),l=n(109),u=n.n(l),c=n(292),h=function(){function t(t,e,n,r,i){var a=this;this.$rootScope=t,this.$timeout=e,this.$location=n,this.timer=r,this.contextSrv=i,this.time={from:"6h",to:"now"},t.$on("zoom-out",this.zoomOut.bind(this)),t.$on("$routeUpdate",this.routeUpdated.bind(this)),document.addEventListener("visibilitychange",function(){a.autoRefreshBlocked&&"visible"===document.visibilityState&&(a.autoRefreshBlocked=!1,a.refreshDashboard())})}return t.$inject=["$rootScope","$timeout","$location","timer","contextSrv"],t.prototype.init=function(t){this.timer.cancelAll(),this.dashboard=t,this.time=t.time,this.refresh=t.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=o.a.cloneDeep(this.time),this.refresh&&this.setAutoRefresh(this.refresh)},t.prototype.parseTime=function(){o.a.isString(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=i()(this.time.from).utc()),o.a.isString(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=i()(this.time.to).utc())},t.prototype.parseUrlParam=function(t){if(-1!==t.indexOf("now"))return t;if(8===t.length)return i.a.utc(t,"YYYYMMDD");if(15===t.length)return i.a.utc(t,"YYYYMMDDTHHmmss");if(!isNaN(t)){var e=parseInt(t);return i.a.utc(e)}return null},t.prototype.initTimeFromUrl=function(){var t=this.$location.search();t.from&&(this.time.from=this.parseUrlParam(t.from)||this.time.from),t.to&&(this.time.to=this.parseUrlParam(t.to)||this.time.to),t.refresh&&(this.refresh=t.refresh||this.refresh)},t.prototype.routeUpdated=function(){var t=this.$location.search(),e=this.timeRangeForUrl();t.from&&t.to?t.from===e.from&&t.to===e.to||(this.initTimeFromUrl(),this.setTime(this.time,!0)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)},t.prototype.timeHasChangedSinceLoad=function(){return this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to},t.prototype.setAutoRefresh=function(t){var e=this;if(this.dashboard.refresh=t,this.cancelNextRefresh(),t){var n=u.a.interval_to_ms(t);this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(n),e.refreshDashboard()},n))}var r=this.$location.search();t?(r.refresh=t,this.$location.search(r)):r.refresh&&(delete r.refresh,this.$location.search(r))},t.prototype.refreshDashboard=function(){this.$rootScope.$broadcast("refresh")},t.prototype.startNextRefreshTimer=function(t){var e=this;this.cancelNextRefresh(),this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(t),e.contextSrv.isGrafanaVisible()?e.refreshDashboard():e.autoRefreshBlocked=!0},t))},t.prototype.cancelNextRefresh=function(){this.timer.cancel(this.refreshTimer)},t.prototype.setTime=function(t,e){if(o.a.extend(this.time,t),i.a.isMoment(t.to)?(this.oldRefresh=this.dashboard.refresh||this.oldRefresh,this.setAutoRefresh(!1)):this.oldRefresh&&this.oldRefresh!==this.dashboard.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=null),!0!==e){var n=this.timeRangeForUrl(),r=this.$location.search();r.from=n.from,r.to=n.to,this.$location.search(r)}this.$rootScope.appEvent("time-range-changed",this.time),this.$timeout(this.refreshDashboard.bind(this),0)},t.prototype.timeRangeForUrl=function(){var t=this.timeRange().raw;return i.a.isMoment(t.from)&&(t.from=t.from.valueOf().toString()),i.a.isMoment(t.to)&&(t.to=t.to.valueOf().toString()),t},t.prototype.timeRange=function(){var t={from:i.a.isMoment(this.time.from)?i()(this.time.from):this.time.from,to:i.a.isMoment(this.time.to)?i()(this.time.to):this.time.to},e=this.dashboard&&this.dashboard.getTimezone();return{from:c.parse(t.from,!1,e),to:c.parse(t.to,!0,e),raw:t}},t.prototype.zoomOut=function(t,e){var n=this.timeRange(),r=n.to.valueOf()-n.from.valueOf(),a=n.to.valueOf()-r/2,o=a+r*e/2,s=a-r*e/2;if(o>Date.now()&&n.to<=Date.now()){s-=o-Date.now(),o=Date.now()}this.setTime({from:i.a.utc(s),to:i.a.utc(o)})},t}();s.default.service("timeSrv",h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AlertingSrv",function(){return i});var r=n(2),i=function(){function t(){}return t.prototype.init=function(t,e){this.dashboard=t,this.alerts=e||[]},t}();r.default.service("alertingSrv",i)},function(t,e,n){"use strict";function r(){return{restrict:"E",template:a,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"UnsavedChangesModalCtrl",function(){return o}),e.unsavedChangesModalDirective=r;var i=n(2),a='\n<div class="modal-body">\n  <div class="modal-header">\n    <h2 class="modal-header-title">\n      <i class="fa fa-exclamation"></i>\n      <span class="p-l-1">Unsaved changes</span>\n    </h2>\n\n    <a class="modal-header-close" ng-click="ctrl.dismiss();">\n      <i class="fa fa-remove"></i>\n    </a>\n  </div>\n\n  <div class="modal-content text-center">\n\n    <div class="confirm-modal-text">\n      Do you want to save your changes?\n    </div>\n\n    <div class="confirm-modal-buttons">\n      <button type="button" class="btn btn-inverse" ng-click="ctrl.dismiss()">Cancel</button>\n      <button type="button" class="btn btn-danger" ng-click="ctrl.discard()">Discard</button>\n      <button type="button" class="btn btn-success" ng-click="ctrl.save()">Save</button>\n    </div>\n  </div>\n</div>\n',o=function(){function t(t){this.unsavedChangesSrv=t}return t.$inject=["unsavedChangesSrv"],t.prototype.discard=function(){this.dismiss(),this.unsavedChangesSrv.tracker.discardChanges()},t.prototype.save=function(){this.dismiss(),this.unsavedChangesSrv.tracker.saveChanges()},t}();i.default.directive("unsavedChangesModal",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/settings.html",controller:d,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}function i(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/timepicker.html",controller:d,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TimePickerCtrl",function(){return d}),e.settingsDirective=r,e.timePickerDirective=i;var a=n(4),o=n.n(a),s=n(8),l=n.n(s),u=n(1),c=n.n(u),h=n(295),f=n(874),d=function(){function t(e,n,r){var i=this;this.$scope=e,this.$rootScope=n,this.timeSrv=r,e.ctrl=this,n.onAppEvent("shift-time-forward",function(){return i.move(1)},e),n.onAppEvent("shift-time-backward",function(){return i.move(-1)},e),n.onAppEvent("refresh",this.onRefresh.bind(this),e),this.panel=this.dashboard.timepicker,o.a.defaults(this.panel,t.defaults),this.firstDayOfWeek=c.a.localeData().firstDayOfWeek(),this.onRefresh()}return t.$inject=["$scope","$rootScope","timeSrv"],t.prototype.onRefresh=function(){var t=l.a.copy(this.timeSrv.timeRange()),e=l.a.copy(t.raw);this.dashboard.isTimezoneUtc()?this.isUtc=!0:(t.from.local(),t.to.local(),c.a.isMoment(e.from)&&e.from.local(),c.a.isMoment(e.to)&&e.to.local(),this.isUtc=!1),this.rangeString=h.describeTimeRange(e),this.absolute={fromJs:t.from.toDate(),toJs:t.to.toDate()},this.tooltip=this.dashboard.formatDate(t.from)+" <br>to<br>",this.tooltip+=this.dashboard.formatDate(t.to),this.timeRaw=e},t.prototype.zoom=function(t){this.$rootScope.appEvent("zoom-out",2)},t.prototype.move=function(t){var e,n,r=this.timeSrv.timeRange(),i=(r.to.valueOf()-r.from.valueOf())/2;-1===t?(e=r.to.valueOf()-i,n=r.from.valueOf()-i):1===t?(e=r.to.valueOf()+i,n=r.from.valueOf()+i,e>Date.now()&&r.to<Date.now()&&(e=Date.now(),n=r.from.valueOf())):(e=r.to.valueOf(),n=r.from.valueOf()),this.timeSrv.setTime({from:c.a.utc(n),to:c.a.utc(e)})},t.prototype.openDropdown=function(){this.onRefresh(),this.editTimeRaw=this.timeRaw,this.timeOptions=h.getRelativeTimesList(this.panel,this.rangeString),this.refresh={value:this.dashboard.refresh,options:o.a.map(this.panel.refresh_intervals,function(t){return{text:t,value:t}})},this.refresh.options.unshift({text:"off"}),this.$rootScope.appEvent("show-dash-editor",{editview:"timepicker",scope:this.$scope,cssClass:"gf-timepicker-dropdown"})},t.prototype.applyCustom=function(){this.refresh.value!==this.dashboard.refresh&&this.timeSrv.setAutoRefresh(this.refresh.value),this.timeSrv.setTime(this.editTimeRaw),this.$rootScope.appEvent("hide-dash-editor")},t.prototype.absoluteFromChanged=function(){this.editTimeRaw.from=this.getAbsoluteMomentForTimezone(this.absolute.fromJs)},t.prototype.absoluteToChanged=function(){this.editTimeRaw.to=this.getAbsoluteMomentForTimezone(this.absolute.toJs)},t.prototype.getAbsoluteMomentForTimezone=function(t){return this.dashboard.isTimezoneUtc()?c()(t).utc():c()(t)},t.prototype.setRelativeFilter=function(t){var e={from:t.from,to:t.to};this.panel.nowDelay&&"now"===e.to&&(e.to="now-"+this.panel.nowDelay),this.timeSrv.setTime(e),this.$rootScope.appEvent("hide-dash-editor")},t.tooltipFormat="MMM D, YYYY HH:mm:ss",t.defaults={time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},t}();l.a.module("grafana.directives").directive("gfTimePickerSettings",r),l.a.module("grafana.directives").directive("gfTimePicker",i),l.a.module("grafana.directives").directive("inputDatetime",f.a)},function(t,e,n){"use strict";function r(){return{restrict:"A",require:"ngModel",link:function(t,e,n,r){var i="YYYY-MM-DD HH:mm:ss",s=function(e){if(-1!==e.indexOf("now"))return o.isValid(e)?(r.$setValidity("error",!0),e):void r.$setValidity("error",!1);var n;return n=t.ctrl.isUtc?a.a.utc(e,i):a()(e,i),n.isValid()?(r.$setValidity("error",!0),n):void r.$setValidity("error",!1)},l=function(t){return a.a.isMoment(t)?t.format(i):t};r.$parsers.push(s),r.$formatters.push(l)}}}e.a=r;var i=n(1),a=n.n(i),o=n(292)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(109)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.controllers").controller("GraphiteImportCtrl",["$scope","datasourceSrv","dashboardSrv","$location",function(r,i,a,o){function s(r,i){var s,l,u;s={title:"",panels:[],height:300},l=t.copy(s);var c=a.create({});c.rows=[],c.title=r.name,c.rows.push(l),e.each(r.graphs,function(n,r){2===l.panels.length&&(l=t.copy(s),c.rows.push(l)),u={type:"graph",span:6,title:n[1].title,targets:[],datasource:i,id:r+1},e.each(n[1].target,function(t){u.targets.push({target:t})}),l.panels.push(u)}),window.grafanaImportDashboard=c,o.path("/dashboard-import/"+n.slugifyForUrl(c.title))}r.options={},r.init=function(){r.datasources=[],e.each(i.getAll(),function(t){"graphite"===t.type&&(r.options.sourceName=t.name,r.datasources.push(t.name))})},r.listAll=function(){i.get(r.options.sourceName).then(function(t){r.datasource=t,r.datasource.listDashboards("").then(function(t){r.dashboards=t},function(t){var e=t.message||t.statusText||"Error";r.appEvent("alert-error",["Failed to load dashboard list from graphite",e])})})},r.import=function(t){r.datasource.loadDashboard(t).then(function(t){if(!t.data||!t.data.state)throw{message:"no dashboard state received from graphite"};s(t.data.state,r.datasource.name)},function(t){var e=t.message||t.statusText||"Error";r.appEvent("alert-error",["Failed to load dashboard from graphite",e])})}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";function r(t,e,n){return{restrict:"E",template:i,scope:{onUpload:"&"},link:function(t){function n(e){for(var n,r=e.target.files,i=0;n=r[i];i++){var a=new FileReader;a.onload=function(){return function(e){var n;try{n=JSON.parse(e.target.result)}catch(e){return console.log(e),void t.appEvent("alert-error",["Import failed","JSON -> JS Serialization failed: "+e.message])}t.$apply(function(){t.onUpload({dash:n})})}}(),a.readAsText(n)}}var r=window;r.File&&r.FileReader&&r.FileList&&r.Blob?document.getElementById("dashupload").addEventListener("change",n,!1):e.set("Oops","Sorry, the HTML5 File APIs are not fully supported in this browser.","error")}}}r.$inject=["timer","alertSrv","$location"],Object.defineProperty(e,"__esModule",{value:!0});var i='\n<input type="file" id="dashupload" name="dashupload" class="hide"/>\n<label class="btn btn-secondary" for="dashupload">\n  <i class="fa fa-upload"></i>\n  Upload .json File\n</label>\n';n(2).default.directive("dashUpload",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/import/dash_import.html",controller:u,bindToController:!0,controllerAs:"ctrl"}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashImportCtrl",function(){return u}),e.dashImportDirective=r;var i=n(2),a=n(21),o=n.n(a),s=n(4),l=n.n(s),u=function(){function t(t,e,n,r){this.backendSrv=t,this.$location=e,this.$scope=n,this.step=1,this.nameExists=!1,r.gnetId&&(this.gnetUrl=r.gnetId,this.checkGnetDashboard())}return t.$inject=["backendSrv","$location","$scope","$routeParams"],t.prototype.onUpload=function(t){if(this.dash=t,this.dash.id=null,this.step=2,this.inputs=[],this.dash.__inputs)for(var e=0,n=this.dash.__inputs;e<n.length;e++){var r=n[e],i={name:r.name,label:r.label,info:r.description,value:r.value,type:r.type,pluginId:r.pluginId,options:[]};"datasource"===r.type?this.setDatasourceOptions(r,i):i.info||(i.info="Specify a string constant"),this.inputs.push(i)}this.inputsValid=0===this.inputs.length,this.titleChanged()},t.prototype.setDatasourceOptions=function(t,e){var n=l.a.filter(o.a.datasources,function(e){return e.type===t.pluginId});0===n.length?e.info="No data sources of type "+t.pluginName+" found":e.info||(e.info="Select a "+t.pluginName+" data source"),e.options=n.map(function(t){return{text:t.name,value:t.name}})},t.prototype.inputValueChanged=function(){this.inputsValid=!0;for(var t=0,e=this.inputs;t<e.length;t++){e[t].value||(this.inputsValid=!1)}},t.prototype.titleChanged=function(){var t=this;this.backendSrv.search({query:this.dash.title}).then(function(e){t.nameExists=!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.dash.title===i.title){t.nameExists=!0;break}}})},t.prototype.saveDashboard=function(){var t=this,e=this.inputs.map(function(t){return{name:t.name,type:t.type,pluginId:t.pluginId,value:t.value}});return this.backendSrv.post("api/dashboards/import",{dashboard:this.dash,overwrite:!0,inputs:e}).then(function(e){t.$location.url("dashboard/"+e.importedUri),t.$scope.dismiss()})},t.prototype.loadJsonText=function(){try{this.parseError="";var t=JSON.parse(this.jsonText);this.onUpload(t)}catch(t){return console.log(t),void(this.parseError=t.message)}},t.prototype.checkGnetDashboard=function(){var t=this;this.gnetError="";var e,n=/(^\d+$)|dashboards\/(\d+)/.exec(this.gnetUrl);return n&&n[1]?e=n[1]:n&&n[2]?e=n[2]:this.gnetError="Could not find dashboard",this.backendSrv.get("api/gnet/dashboards/"+e).then(function(e){t.gnetInfo=e,e.json.gnetId=e.id,t.onUpload(e.json)}).catch(function(e){e.isHandled=!0,t.gnetError=e.data.message||e})},t.prototype.back=function(){this.gnetUrl="",this.step=1,this.gnetError="",this.gnetInfo=""},t}();i.default.directive("dashImport",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export/export_modal.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashExportCtrl",function(){return l}),e.dashExportDirective=r;var i=n(8),a=n.n(i),o=n(2),s=n(879),l=function(){function t(t,e,n){var r=this;this.dashboardSrv=t,this.$scope=n,this.exporter=new s.a(e),this.exporter.makeExportable(this.dashboardSrv.getCurrent()).then(function(t){r.$scope.$apply(function(){r.dash=t})})}return t.$inject=["dashboardSrv","datasourceSrv","$scope"],t.prototype.save=function(){var t=new Blob([a.a.toJson(this.dash,!0)],{type:"application/json;charset=utf-8"});window.saveAs(t,this.dash.title+"-"+(new Date).getTime()+".json")},t.prototype.saveJson=function(){var t=this.dashboardSrv.getCurrent().getSaveModelClone();this.$scope.$root.appEvent("show-json-editor",{object:t}),this.dismiss()},t}();o.default.directive("dashExportModal",r)},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(21),i=n.n(r),a=n(4),o=n.n(a),s=n(880),l=function(){function t(t){this.datasourceSrv=t}return t.prototype.makeExportable=function(t){var e=this,n=new s.a;n.init(t),n.process({cleanUpOnly:!0});var r=t.getSaveModelClone();r.id=null,n.process();for(var a=[],l={},u={},c=[],h={},f=0,d=r.templating.list;f<d.length;f++){var p=d[f];h[p.name]=p}for(var m=function(t){t.datasource&&0===t.datasource.indexOf("$")&&h[t.datasource.substring(1)]||c.push(e.datasourceSrv.get(t.datasource).then(function(e){if(!e.meta.builtIn){var n="DS_"+e.name.replace(" ","_").toUpperCase();u[n]={name:n,label:e.name,description:"",type:"datasource",pluginId:e.meta.id,pluginName:e.meta.name},t.datasource="${"+n+"}",l["datasource"+e.meta.id]={type:"datasource",id:e.meta.id,name:e.meta.name,version:e.meta.info.version||"1.0.0"}}}))},g=0,v=r.rows;g<v.length;g++)for(var y=v[g],b=0,x=y.panels;b<x.length;b++){var _=x[b];if(void 0!==_.datasource&&m(_),_.targets)for(var w=0,S=_.targets;w<S.length;w++){var k=S[w];void 0!==k.datasource&&m(k)}var M=i.a.panels[_.type];M&&(l["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}for(var T=0,C=r.templating.list;T<C.length;T++){var p=C[T];"query"===p.type&&(m(p),p.options=[],p.current={},p.refresh=p.refresh>0?p.refresh:1)}for(var A=0,P=r.annotations.list;A<P.length;A++){m(P[A])}return l.grafana={type:"grafana",id:"grafana",name:"Grafana",version:i.a.buildInfo.version},Promise.all(c).then(function(){o.a.each(u,function(t,e){a.push(t)});for(var t=0,e=r.templating.list;t<e.length;t++){var n=e[t];if("constant"===n.type){var i="VAR_"+n.name.replace(" ","_").toUpperCase();a.push({name:i,type:"constant",label:n.label||n.name,value:n.current.value,description:""}),n.query="${"+i+"}",n.options[0]=n.current={value:n.query,text:n.query}}}var s={};return s.__inputs=a,s.__requires=o.a.sortBy(l,["id"]),o.a.defaults(s,r),s}).catch(function(t){return console.log("Export failed:",t),{error:t}})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(2),l=n(814),u=function(){function t(){}return t.prototype.init=function(t){this.dashboard=t,this.variables=t.templating.list},t.prototype.process=function(t){if(!this.dashboard.snapshot&&0!==this.variables.length){this.iteration=(this.iteration||(new Date).getTime())+1,t=t||{};var e,n,r,i,a=t.cleanUpOnly;for(e=0;e<this.dashboard.rows.length;e++)for(r=this.dashboard.rows[e],delete r.scopedVars,n=0;n<r.panels.length;n++)delete r.panels[n].scopedVars;for(e=0;e<this.dashboard.rows.length;e++){if(r=this.dashboard.rows[e],r.repeat)a||this.repeatRow(r,e);else if(r.repeatRowId&&r.repeatIteration!==this.iteration){this.dashboard.removeRow(r,!0),e-=1;continue}for(n=0;n<r.panels.length;n++)i=r.panels[n],i.repeat?a||this.repeatPanel(i,r):i.repeatPanelId&&i.repeatIteration!==this.iteration&&(r.panels=o.a.without(r.panels,i),n-=1);r.panelSpanChanged()}}},t.prototype.getRowClone=function(t,e,n){if(0===e)return t;var r,a,o,s,u=n+1;for(r=0;r<this.dashboard.rows.length;r++)if(o=this.dashboard.rows[r],o.repeatRowId===u&&o.repeatIteration!==this.iteration){s=o,s.copyPropertiesFromRowSource(t);break}if(!s){var c=i.a.copy(t.getSaveModel());for(s=new l.a(c),this.dashboard.rows.splice(n+e,0,s),r=0;r<s.panels.length;r++)a=s.panels[r],a.id=this.dashboard.getNextPanelId()}return s.repeat=null,s.repeatRowId=u,s.repeatIteration=this.iteration,s},t.prototype.repeatRow=function(t,e){var n=this,r=o.a.find(this.variables,{name:t.repeat});if(r){var i,a,s,l;i="All"===r.current.text?r.options.slice(1,r.options.length):o.a.filter(r.options,{selected:!0}),o.a.each(i,function(i,o){for(a=n.getRowClone(t,o,e),a.scopedVars={},a.scopedVars[r.name]=i,s=0;s<a.panels.length;s++)l=a.panels[s],l.scopedVars={},l.scopedVars[r.name]=i})}},t.prototype.getPanelClone=function(t,e,n){if(0===n)return t;var r,a,o,s;for(r=0;r<e.panels.length;r++)if(o=e.panels[r],o.repeatIteration!==this.iteration&&o.repeatPanelId===t.id){s=o;break}return s||(s={id:this.dashboard.getNextPanelId()},e.panels.push(s)),a=s.id,i.a.copy(t,s),s.id=a,s.repeatIteration=this.iteration,s.repeatPanelId=t.id,s.repeat=null,s},t.prototype.repeatPanel=function(t,e){var n=this,r=o.a.find(this.variables,{name:t.repeat});if(r){var i;i="All"===r.current.text?r.options.slice(1,r.options.length):o.a.filter(r.options,{selected:!0}),o.a.each(i,function(a,o){var s=n.getPanelClone(t,e,o);s.span=Math.max(12/i.length,t.minSpan||4),s.scopedVars=s.scopedVars||{},s.scopedVars[r.name]=a})}},t}();s.default.service("dynamicDashboardSrv",u)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export_data/export_data_modal.html",controller:l,controllerAs:"ctrl",scope:{panel:"<",data:"<"},bindToController:!0}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ExportDataModalCtrl",function(){return l}),e.exportDataModal=r;var i=n(8),a=n.n(i),o=n(815),s=n(39),l=function(){function t(){this.asRows=!0,this.dateTimeFormat="YYYY-MM-DDTHH:mm:ssZ"}return t.prototype.export=function(){"table"===this.panel?o.exportTableDataToCsv(this.data,this.excel):this.asRows?o.exportSeriesListToCsv(this.data,this.dateTimeFormat,this.excel):o.exportSeriesListToCsvColumns(this.data,this.dateTimeFormat,this.excel),this.dismiss()},t.prototype.dismiss=function(){s.a.emit("hide-modal")},t}();a.a.module("grafana.directives").directive("exportDataModal",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",template:c,controller:u,bindToController:!0,controllerAs:"ctrl",scope:{variable:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AdHocFiltersCtrl",function(){return u}),e.adHocFiltersComponent=r;var i=n(4),a=n.n(i),o=n(8),s=n.n(o),l=n(2),u=function(){function t(t,e,n,r,i,a){this.uiSegmentSrv=t,this.datasourceSrv=e,this.$q=n,this.variableSrv=r,this.$rootScope=a,this.removeTagFilterSegment=t.newSegment({fake:!0,value:"-- remove filter --"}),this.buildSegmentModel(),this.$rootScope.onAppEvent("template-variable-value-updated",this.buildSegmentModel.bind(this),i)}return t.$inject=["uiSegmentSrv","datasourceSrv","$q","variableSrv","$scope","$rootScope"],t.prototype.buildSegmentModel=function(){this.segments=[],this.variable.value&&a.a.isArray(this.variable.value);for(var t=0,e=this.variable.filters;t<e.length;t++){var n=e[t];this.segments.length>0&&this.segments.push(this.uiSegmentSrv.newCondition("AND")),void 0!==n.key&&void 0!==n.value&&(this.segments.push(this.uiSegmentSrv.newKey(n.key)),this.segments.push(this.uiSegmentSrv.newOperator(n.operator)),this.segments.push(this.uiSegmentSrv.newKeyValue(n.value)))}this.segments.push(this.uiSegmentSrv.newPlusButton())},t.prototype.getOptions=function(t,e){var n=this;return"operator"===t.type?this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<",">","=~","!~"])):"condition"===t.type?this.$q.when([this.uiSegmentSrv.newSegment("AND")]):this.datasourceSrv.get(this.variable.datasource).then(function(r){var i={},o=null;return"value"!==t.type?o=r.getTagKeys():(i.key=n.segments[e-2].value,o=r.getTagValues(i)),o.then(function(e){return e=a.a.map(e,function(t){return n.uiSegmentSrv.newSegment({value:t.text})}),"key"===t.type&&e.splice(0,0,s.a.copy(n.removeTagFilterSegment)),e})})},t.prototype.segmentChanged=function(t,e){this.segments[e]=t,t.value===this.removeTagFilterSegment.value?(this.segments.splice(e,3),0===this.segments.length?this.segments.push(this.uiSegmentSrv.newPlusButton()):this.segments.length>2&&(this.segments.splice(Math.max(e-1,0),1),"plus-button"!==this.segments[this.segments.length-1].type&&this.segments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.segments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.segments.push(this.uiSegmentSrv.newOperator("=")),this.segments.push(this.uiSegmentSrv.newFake("select tag value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.segments.length&&this.segments.push(this.uiSegmentSrv.newPlusButton())),this.updateVariableModel()},t.prototype.updateVariableModel=function(){var t=[],e=-1,n=!1;this.segments.forEach(function(r){if("value"===r.type&&r.fake)return void(n=!0);switch(r.type){case"key":t.push({key:r.value}),e+=1;break;case"value":t[e].value=r.value;break;case"operator":t[e].operator=r.value;break;case"condition":t[e].condition=r.value}}),n||(this.variable.setFilters(t),this.variableSrv.variableUpdated(this.variable,!0))},t}(),c='\n<div class="gf-form-inline">\n  <div class="gf-form" ng-repeat="segment in ctrl.segments">\n    <metric-segment segment="segment" get-options="ctrl.getOptions(segment, $index)"\n                    on-change="ctrl.segmentChanged(segment, $index)"></metric-segment>\n  </div>\n</div>\n';l.default.directive("adHocFilters",r)},function(t,e,n){"use strict";function r(t){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/row.html",controller:h,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"=",row:"="},link:function(e,n){e.$watchGroup(["ctrl.row.collapse","ctrl.row.height"],function(){n.toggleClass("dash-row--collapse",e.ctrl.row.collapse),n.find(".panels-wrapper").css({minHeight:e.ctrl.row.collapse?"5px":e.ctrl.row.height})}),t.onAppEvent("panel-fullscreen-enter",function(t,r){s.a.find(e.ctrl.row.panels,{id:r.panelId})||n.hide()},e),t.onAppEvent("panel-fullscreen-exit",function(){n.show()},e)}}}function i(t){return function(e,n){function r(){i||(n[0].style.width=e.panel.span/1.2*10+"%")}var i=!1;t.onAppEvent("panel-fullscreen-enter",function(t,r){i=!0,e.panel.id!==r.panelId?n.hide():n[0].style.width="100%"},e),t.onAppEvent("panel-fullscreen-exit",function(t,a){i=!1,e.panel.id!==a.panelId&&n.show(),r()},e),e.$watch("panel.span",r),i&&n.hide()}}function a(t){return function(t,e){function n(t,n){e.find(".panel-container").css("height",a.height),e[0].style.width=t/1.2*10+"%",s.text(n),e.show()}function r(){e.hide()}function i(){if(0===a.panels.length&&!1===o)return n(12,"Empty Space");var t=12-a.span;return t>0?o?n(t,"Drop Here"):n(t,"Empty Space"):!0===o&&t>1?n(t,"Drop Here"):void r()}var a=t.ctrl.row,o=!1,s=e.find(".panel-drop-zone-text");a.events.on("span-changed",i,t),t.$on("ANGULAR_DRAG_START",function(){o=!0,i()}),t.$on("ANGULAR_DRAG_END",function(){o=!1,i()}),i()}}r.$inject=["$rootScope"],i.$inject=["$rootScope"],a.$inject=["$timeout"],Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashRowCtrl",function(){return h});var o=n(4),s=n.n(o),l=n(21),u=n.n(l),c=n(290),h=(n(884),n(885),function(){function t(t,e,n){this.$scope=t,this.$rootScope=e,this.$timeout=n,this.row.title=this.row.title||"Row title",this.row.isNew&&(this.dropView=1)}return t.$inject=["$scope","$rootScope","$timeout"],t.prototype.onDrop=function(t,e){var n,r=this;n=s.a.isString(t)?{row:this.row,panel:{title:u.a.new_panel_title,type:t,id:this.dashboard.getNextPanelId(),isNew:!0}}:this.dashboard.getPanelInfoById(t),e?(e=this.dashboard.getPanelInfoById(e.id),n.panel.isNew?(n.panel.span=e.panel.span=e.panel.span/2,e.row.panels.splice(e.index+1,0,n.panel)):this.row===n.row?this.row.movePanel(n.index,e.index):(n.panel.span=e.panel.span=e.panel.span/2,e.row.panels.splice(e.index+1,0,n.panel),n.row.removePanel(n.panel,!1))):(n.panel.span=12-this.row.span,this.row.panels.push(n.panel),n.panel.isNew||n.row.removePanel(n.panel,!1)),this.dropView=0,this.row.panelSpanChanged(),this.$timeout(function(){r.$rootScope.$broadcast("render")})},t.prototype.setHeight=function(t){this.row.height=t,this.$scope.$broadcast("render")},t.prototype.moveRow=function(t){var e=this.dashboard.rows,n=s.a.indexOf(e,this.row),r=n+t;r>=0&&r<=e.length-1&&s.a.move(e,n,r)},t.prototype.toggleCollapse=function(){this.closeDropView(),this.row.collapse=!this.row.collapse},t.prototype.onMenuAddPanel=function(){this.dropView=1},t.prototype.onMenuRowOptions=function(){this.dropView=2},t.prototype.closeDropView=function(){this.dropView=0},t.prototype.onMenuDeleteRow=function(){this.dashboard.removeRow(this.row)},t}());c.coreModule.directive("dashRow",r),c.coreModule.directive("panelWidth",i),c.coreModule.directive("panelDropZone",a)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/options.html",controller:a,bindToController:!0,controllerAs:"ctrl",scope:{rowCtrl:"="}}}var i=n(290),a=function(){function t(){this.fontSizes=["h1","h2","h3","h4","h5","h6"],this.row=this.rowCtrl.row,this.dashboard=this.rowCtrl.dashboard,this.row.titleSize=this.row.titleSize||"h6"}return t}();i.coreModule.directive("dashRowOptions",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/add_panel.html",controller:u,bindToController:!0,controllerAs:"ctrl",scope:{rowCtrl:"="}}}var i=n(4),a=n.n(i),o=n(21),s=n.n(o),l=n(290),u=function(){function t(t,e){this.$timeout=t,this.$rootScope=e,this.row=this.rowCtrl.row,this.dashboard=this.rowCtrl.dashboard,this.activeIndex=0,this.allPanels=a.a.chain(s.a.panels).filter({hideFromList:!1}).map(function(t){return t}).orderBy("sort").value(),this.panelHits=this.allPanels}return t.$inject=["$timeout","$rootScope"],t.prototype.keyDown=function(t){if(27===t.keyCode)return void(this.rowCtrl.dropView=0);if(40!==t.keyCode&&39!==t.keyCode||this.moveSelection(1),38!==t.keyCode&&37!==t.keyCode||this.moveSelection(-1),13===t.keyCode){var e=this.panelHits[this.activeIndex];e&&this.addPanel(e)}},t.prototype.moveSelection=function(t){var e=this.panelHits.length,n=this.activeIndex+t;this.activeIndex=(n%=e)<0?n+e:n},t.prototype.panelSearchChanged=function(){for(var t,e=this.allPanels.slice(),n=[],r=[],i=this.panelSearch.toLowerCase();t=e.shift();){var a=t.name.toLowerCase();0===a.indexOf(i)?n.push(t):-1!==a.indexOf(i)&&r.push(t)}this.panelHits=n.concat(r),this.activeIndex=0},t.prototype.addPanel=function(t){var e=this,n=12-this.row.span,r={id:null,title:s.a.new_panel_title,span:n<12&&n>0?n:12,type:t.id};this.rowCtrl.closeDropView(),this.dashboard.addPanel(r,this.row),this.$timeout(function(){e.$rootScope.$broadcast("render")})},t}();l.coreModule.directive("dashRowAddPanel",r)},function(t,e,n){"use strict";function r(t){return{restrict:"E",template:i,scope:{model:"="},link:function(e,n){n.css({display:"block",width:"100%"}),e.variables=t.variables.map(function(t){return{text:t.name,value:t.name}}),0===e.variables.length&&e.variables.unshift({text:"No template variables found",value:null}),e.variables.unshift({text:"Disabled",value:null})}}}r.$inject=["variableSrv"],Object.defineProperty(e,"__esModule",{value:!0});var i='\n<div class="gf-form-select-wrapper max-width-13">\n<select class="gf-form-input" ng-model="model.repeat" ng-options="f.value as f.text for f in variables">\n<option value=""></option>\n</div>\n';n(290).coreModule.directive("dashRepeatOption",r)},function(t,e,n){var r,i;r=[n(8),n(4),n(816)],void 0!==(i=function(t,e){"use strict";t.module("grafana.directives").directive("panelLinksEditor",function(){return{scope:{panel:"="},restrict:"E",controller:"PanelLinksEditorCtrl",templateUrl:"public/app/features/panellinks/module.html",link:function(){}}}).controller("PanelLinksEditorCtrl",["$scope","backendSrv",function(t,n){t.panel.links=t.panel.links||[],t.addLink=function(){t.panel.links.push({type:"dashboard"})},t.searchDashboards=function(t,r){n.search({query:t}).then(function(t){var n=e.map(t,function(t){return t.title});r(n)})},t.dashboardChanged=function(t){n.search({query:t.dashboard}).then(function(n){var r=e.find(n,{title:t.dashboard});r&&(t.dashUri=r.uri,t.title=r.title)})},t.deleteLink=function(n){t.panel.links=e.without(t.panel.links,n)}}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";function r(t,e){var n=h.a.partition(t,"regionId"),r=n[0],a=n[1],o=i(r,e.range);return t=h.a.concat(o,a)}function i(t,e){var n=h.a.filter(t,function(t){return t.regionId}),r=h.a.groupBy(n,"regionId");return r=h.a.compact(h.a.map(r,function(t){var n=h.a.head(t);return t&&t.length>1?(n.timeEnd=t[1].time,n.isRegion=!0,n):t&&t.length?(n.time&&n.timeEnd||(a(n)?n.timeEnd=e.to.valueOf()-1:(n.timeEnd=n.time,n.time=e.from.valueOf()+1),n.isRegion=!0),n):void 0}))}function a(t){return t.id&&t.id===t.regionId}function o(t){var e=[],n=h.a.partition(t,"id"),r=h.a.groupBy(n[0],"id");return e=h.a.map(r,function(t){return t.length>1&&!h.a.every(t,s)?h.a.find(t,function(t){return"panel-alert"!==t.eventType}):h.a.head(t)}),e=h.a.concat(e,n[1])}function s(t){return"panel-alert"===t.eventType}n.d(e,"a",function(){return d});var l=(n(889),n(8)),u=n.n(l),c=n(4),h=n.n(c),f=n(2),d=function(){function t(t,e,n,r,i){this.$rootScope=t,this.$q=e,this.datasourceSrv=n,this.backendSrv=r,this.timeSrv=i,t.onAppEvent("refresh",this.clearCache.bind(this),t),t.onAppEvent("dashboard-initialized",this.clearCache.bind(this),t)}return t.$inject=["$rootScope","$q","datasourceSrv","backendSrv","timeSrv"],t.prototype.clearCache=function(){this.globalAnnotationsPromise=null,this.alertStatesPromise=null},t.prototype.getAnnotations=function(t){var e=this;return this.$q.all([this.getGlobalAnnotations(t),this.getAlertStates(t)]).then(function(e){var n=h.a.flattenDeep(e[0]);return n=h.a.filter(n,function(e){return!e.panelId||"dashboard"!==e.source.type||e.panelId===t.panel.id}),n=o(n),n=r(n,t),{annotations:n,alertState:h.a.find(e[1],{panelId:t.panel.id})}}).catch(function(t){return!t.message&&t.data&&t.data.message&&(t.message=t.data.message),console.log("AnnotationSrv.query error",t),e.$rootScope.appEvent("alert-error",["Annotation Query Failed",t.message||t]),[]})},t.prototype.getAlertStates=function(t){return t.dashboard.id?t.panel&&!t.panel.alert?this.$q.when([]):"now"!==t.range.raw.to?this.$q.when([]):this.alertStatesPromise?this.alertStatesPromise:(this.alertStatesPromise=this.backendSrv.get("/api/alerts/states-for-dashboard",{dashboardId:t.dashboard.id}),this.alertStatesPromise):this.$q.when([])},t.prototype.getGlobalAnnotations=function(t){var e=this,n=t.dashboard;if(this.globalAnnotationsPromise)return this.globalAnnotationsPromise;for(var r=this.timeSrv.timeRange(),i=[],a=this,o=0,s=n.annotations.list;o<s.length;o++){var l=s[o],c=function(t){return t.enable?t.snapshotData?{value:a.translateQueryResult(t,t.snapshotData)}:void i.push(a.datasourceSrv.get(t.datasource).then(function(e){return e.annotationQuery({range:r,rangeRaw:r.raw,annotation:t,dashboard:n})}).then(function(r){return n.snapshot&&(t.snapshotData=u.a.copy(r)),e.translateQueryResult(t,r)})):"continue"}(l);if("object"==typeof c)return c.value}return this.globalAnnotationsPromise=this.$q.all(i),this.globalAnnotationsPromise},t.prototype.saveAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.post("/api/annotations",t)},t.prototype.updateAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.put("/api/annotations/"+t.id,t)},t.prototype.deleteAnnotationEvent=function(t){this.globalAnnotationsPromise=null;var e="/api/annotations/"+t.id;return t.isRegion&&(e="/api/annotations/region/"+t.regionId),this.backendSrv.delete(e)},t.prototype.translateQueryResult=function(t,e){t.snapshotData&&(t=u.a.copy(t),delete t.snapshotData);for(var n=0,r=e;n<r.length;n++){r[n].source=t}return e},t}();f.default.service("annotationsSrv",d)},function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(10),l=n.n(s),u=n(2),c=function(){function t(t,e){this.$scope=t,this.datasourceSrv=e,this.annotationDefaults={name:"",datasource:null,iconColor:"rgba(255, 96, 96, 1)",enable:!0,showIn:0,hide:!1},this.showOptions=[{text:"All Panels",value:0},{text:"Specific Panels",value:1}],t.ctrl=this,this.mode="list",this.datasources=e.getAnnotationSources(),this.annotations=t.dashboard.annotations.list,this.reset(),this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope","datasourceSrv"],t.prototype.datasourceChanged=function(){var t=this;return this.datasourceSrv.get(this.currentAnnotation.datasource).then(function(e){t.currentDatasource=e})},t.prototype.edit=function(t){this.currentAnnotation=t,this.currentAnnotation.showIn=this.currentAnnotation.showIn||0,this.currentIsNew=!1,this.datasourceChanged(),this.mode="edit",l()(".tooltip.in").remove()},t.prototype.reset=function(){this.currentAnnotation=i.a.copy(this.annotationDefaults),this.currentAnnotation.datasource=this.datasources[0].name,this.currentIsNew=!0,this.datasourceChanged()},t.prototype.update=function(){this.reset(),this.mode="list",this.$scope.broadcastRefresh()},t.prototype.setupNew=function(){this.mode="new",this.reset()},t.prototype.add=function(){this.annotations.push(this.currentAnnotation),this.reset(),this.mode="list",this.$scope.broadcastRefresh(),this.$scope.dashboard.updateSubmenuVisibility()},t.prototype.removeAnnotation=function(t){var e=o.a.indexOf(this.annotations,t);this.annotations.splice(e,1),this.$scope.dashboard.updateSubmenuVisibility(),this.$scope.broadcastRefresh()},t.prototype.onColorChange=function(t){this.currentAnnotation.iconColor=t},t.prototype.annotationEnabledChange=function(){this.$scope.broadcastRefresh()},t.prototype.annotationHiddenChanged=function(){this.$scope.dashboard.updateSubmenuVisibility()},t}();u.default.controller("AnnotationsEditorCtrl",c)},function(t,e,n){"use strict";function r(t){if(t&&o.a.isNumber(t)){var e=Number(t);return l()(e)}return t}function i(){return{restrict:"E",controller:c,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/annotations/partials/event_editor.html",scope:{panelCtrl:"=",event:"=",close:"&"}}}e.a=i;var a=n(4),o=n.n(a),s=n(1),l=n.n(s),u=n(290),c=function(){function t(t){this.annotationsSrv=t,this.event.panelId=this.panelCtrl.panel.id,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.time=r(this.event.time),this.event.isRegion&&(this.event.timeEnd=r(this.event.timeEnd)),this.timeFormated=this.panelCtrl.dashboard.formatDate(this.event.time)}return t.$inject=["annotationsSrv"],t.prototype.save=function(){var t=this;if(this.form.$valid){var e=o.a.cloneDeep(this.event);if(e.time=e.time.valueOf(),e.timeEnd=0,e.isRegion&&(e.timeEnd=this.event.timeEnd.valueOf(),e.timeEnd<e.time))return void console.log("invalid time");e.id?this.annotationsSrv.updateAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()}):this.annotationsSrv.saveAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})}},t.prototype.delete=function(){var t=this;return this.annotationsSrv.deleteAnnotationEvent(this.event).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})},t}();u.coreModule.directive("eventEditor",i)},function(t,e,n){"use strict";function r(t){return s.a.filter(t,"isRegion")}function i(t,e){var n,r=e.grid.markings,i=d.b;s.a.each(t,function(t){n=t.source?t.source.iconColor||i:i,n=a(n,d.e),r.push({xaxis:{from:t.min,to:t.timeEnd},color:n})})}function a(t,e){var n=h()(t);return n.isValid()?(n.setAlpha(e),n.toRgbString()):t}n.d(e,"a",function(){return p});var o=n(4),s=n.n(o),l=n(1),u=n.n(l),c=n(78),h=n.n(c),f=n(818),d=n(111),p=function(){function t(t){this.panelCtrl=t}return t.prototype.editorClosed=function(){this.event=null,this.editorOpen=!1,this.panelCtrl.render()},t.prototype.editorOpened=function(){this.editorOpen=!0},t.prototype.updateTime=function(t){this.event||(this.event=new f.a,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.panelId=this.panelCtrl.panel.id),this.event.time=u()(t.from),this.event.isRegion=!1,t.to&&(this.event.timeEnd=u()(t.to),this.event.isRegion=!0),this.panelCtrl.render()},t.prototype.editEvent=function(t,e){this.event=t,this.panelCtrl.render()},t.prototype.addFlotEvents=function(t,e){if(this.event||0!==t.length){var n={$__alerting:{color:d.a,position:"BOTTOM",markerSize:5},$__ok:{color:d.d,position:"BOTTOM",markerSize:5},$__no_data:{color:d.c,position:"BOTTOM",markerSize:5},$__editing:{color:d.b,position:"BOTTOM",markerSize:5}};if(this.event)t=this.event.isRegion?[{isRegion:!0,min:this.event.time.valueOf(),timeEnd:this.event.timeEnd.valueOf(),text:this.event.text,eventType:"$__editing",editModel:this.event}]:[{min:this.event.time.valueOf(),text:this.event.text,editModel:this.event,eventType:"$__editing"}];else for(var a=0;a<t.length;a++){var o=t[a];o.min=o.time,o.max=o.time,o.eventType=o.source.name,o.newState?o.eventType="$__"+o.newState:n[o.source.name]||(n[o.source.name]={color:o.source.iconColor,position:"BOTTOM",markerSize:5})}i(r(t),e);e.grid.eventSectionHeight=7,e.xaxis.eventSectionHeight=20,e.events={levels:s.a.keys(n).length+1,data:t,types:n,manager:this}}},t}()},function(t,e,n){"use strict";function r(t,e,n,r,i){function o(e){try{return t(e)}catch(t){return console.log("Could not sanitize annotation string, html escaping instead"),a.a.escape(e)}}return{restrict:"E",scope:{event:"=",onEdit:"&"},link:function(t,r){var a=t.event,l=a.title,c=a.text,h=e.getCurrent(),f='<div class="graph-annotation">',d="";if(a.alertId){var p=u.a.getStateDisplayModel(a.newState);d=p.stateClass,l='<i class="icon-gf '+p.iconClass+'"></i> '+p.text,c=u.a.getAlertAnnotationInfo(a),a.text&&(c=c+"<br />"+a.text)}else l&&(c=l+"<br />"+c,l="");var m='<div class="graph-annotation__header">';a.login&&(m+='<div class="graph-annotation__user" bs-tooltip="\'Created by '+a.login+'\'"><img src="'+a.avatarUrl+'" /></div>'),m+='\n          <span class="graph-annotation__title '+d+'">'+o(l)+'</span>\n          <span class="graph-annotation__time">'+h.formatDate(a.min)+"</span>\n      ",a.id&&n.isEditor&&(m+='\n          <span class="pointer graph-annotation__edit-icon" ng-click="onEdit()">\n            <i class="fa fa-pencil-square"></i>\n          </span>\n        '),m+="</div>",f+=m,f+='<div class="graph-annotation__body">',c&&(f+="<div>"+o(c.replace(/\n/g,"<br>"))+"</div>");var g=a.tags;g&&g.length&&(t.tags=g,f+='<span class="label label-tag small" ng-repeat="tag in tags" tag-color-from-name="tag">{{tag}}</span><br/>'),f+="</div>",f+="</div>",s()(f).appendTo(r),i(r.contents())(t)}}}r.$inject=["$sanitize","dashboardSrv","contextSrv","popoverSrv","$compile"],e.a=r;var i=n(4),a=n.n(i),o=n(10),s=n.n(o),l=n(2),u=n(799);l.default.directive("annotationTooltip",r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(894),i=(n.n(r),n(895),n(896)),a=n(897),o=n(898),s=n(899),l=n(900),u=n(901),c=n(902);n.d(e,"VariableSrv",function(){return i.a}),n.d(e,"IntervalVariable",function(){return a.a}),n.d(e,"QueryVariable",function(){return o.a}),n.d(e,"DatasourceVariable",function(){return s.a}),n.d(e,"CustomVariable",function(){return l.a}),n.d(e,"ConstantVariable",function(){return u.a}),n.d(e,"AdhocVariable",function(){return c.a})},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(109)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.services").service("templateSrv",function(){function t(t){return t.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}var r=this;this._regex=/\$(\w+)|\[\[([\s\S]+?)\]\]/g,this._index={},this._texts={},this._grafanaVariables={},this._builtIns={},this._builtIns.__interval={text:"1s",value:"1s"},this._builtIns.__interval_ms={text:"100",value:"100"},this.init=function(t){this.variables=t,this.updateTemplateData()},this.updateTemplateData=function(){this._index={},this._filters={};for(var t=0;t<this.variables.length;t++){var e=this.variables[t];e.current&&(e.current.isNone||e.current.value)&&(this._index[e.name]=e)}},this.variableInitialized=function(t){this._index[t.name]=t},this.getAdhocFilters=function(t){for(var e=[],n=0;n<this.variables.length;n++){var r=this.variables[n];"adhoc"===r.type&&(r.datasource===t&&(e=e.concat(r.filters)),0===r.datasource.indexOf("$")&&this.replace(r.datasource)===t&&(e=e.concat(r.filters)))}return e},this.luceneFormat=function(n){return"string"==typeof n?t(n):"("+e.map(n,function(e){return'"'+t(e)+'"'}).join(" OR ")+")"},this.formatValue=function(t,r,i){if(i=i||{},"function"==typeof r)return r(t,i,this.formatValue);switch(r){case"regex":return"string"==typeof t?n.regexEscape(t):"("+e.map(t,n.regexEscape).join("|")+")";case"lucene":return this.luceneFormat(t,r,i);case"pipe":return"string"==typeof t?t:t.join("|");case"distributed":return"string"==typeof t?t:this.distributeVariable(t,i.name);default:return e.isArray(t)?"{"+t.join(",")+"}":t}},this.setGrafanaVariable=function(t,e){this._grafanaVariables[t]=e},this.getVariableName=function(t){this._regex.lastIndex=0;var e=this._regex.exec(t);return e?e[1]||e[2]:null},this.variableExists=function(t){var e=this.getVariableName(t);return e&&void 0!==r._index[e]},this.highlightVariablesAsHtml=function(t){return t&&e.isString(t)?(t=e.escape(t),this._regex.lastIndex=0,t.replace(this._regex,function(t,e,n){return r._index[e||n]||r._builtIns[e||n]?'<span class="template-variable">'+t+"</span>":t})):t},this.getAllValue=function(t){if(t.allValue)return t.allValue;for(var e=[],n=1;n<t.options.length;n++)e.push(t.options[n].value);return e},this.replace=function(t,e,n){if(!t)return t;var i,a,o;return this._regex.lastIndex=0,t.replace(this._regex,function(t,s,l){return i=r._index[s||l],e&&(o=e[s||l])?r.formatValue(o.value,n,i):i?(a=r._grafanaVariables[i.current.value])?r.formatValue(a,n,i):(o=i.current.value,r.isAllValue(o)&&(o=r.getAllValue(i),i.allValue)?o:r.formatValue(o,n,i)):t})},this.isAllValue=function(t){return"$__all"===t||Array.isArray(t)&&"$__all"===t[0]},this.replaceWithText=function(t,e){if(!t)return t;var n;return this._regex.lastIndex=0,t.replace(this._regex,function(t,i,a){if(e){var o=e[i||a];if(o)return o.text}return n=r._index[i||a],n?r._grafanaVariables[n.current.value]||n.current.text:t})},this.fillVariableValuesForUrl=function(t,n){e.each(this.variables,function(e){n&&void 0!==n[e.name]?t["var-"+e.name]=n[e.name].value:t["var-"+e.name]=e.getValueForUrl()})},this.distributeVariable=function(t,n){return t=e.map(t,function(t,e){return 0!==e?n+"="+t:t}),t.join(",")}})}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=n(2),o=n(798),s=function(){function t(t,e,n,r){t.variableTypes=o.variableTypes,t.ctrl={},t.namePattern=/^(?!__).*$/,t.refreshOptions=[{value:0,text:"Never"},{value:1,text:"On Dashboard Load"},{value:2,text:"On Time Range Change"}],t.sortOptions=[{value:0,text:"Disabled"},{value:1,text:"Alphabetical (asc)"},{value:2,text:"Alphabetical (desc)"},{value:3,text:"Numerical (asc)"},{value:4,text:"Numerical (desc)"}],t.hideOptions=[{value:0,text:""},{value:1,text:"Label"},{value:2,text:"Variable"}],t.init=function(){t.mode="list",t.variables=n.variables,t.reset(),t.$watch("mode",function(e){"new"===e&&t.reset()})},t.add=function(){t.isValid()&&(n.addVariable(t.current),t.update())},t.isValid=function(){if(!t.ctrl.form.$valid)return!1;if(!t.current.name.match(/^\w+$/))return t.appEvent("alert-warning",["Validation","Only word and digit characters are allowed in variable names"]),!1;var e=i.a.find(t.variables,{name:t.current.name});return e&&e!==t.current?(t.appEvent("alert-warning",["Validation","Variable with the same name already exists"]),!1):"query"!==t.current.type||!t.current.query.match(new RegExp("\\$"+t.current.name+"(/| |$)"))||(t.appEvent("alert-warning",["Validation","Query cannot contain a reference to itself. Variable: $"+t.current.name]),!1)},t.validate=function(){t.infoText="","adhoc"===t.current.type&&null!==t.current.datasource&&(t.infoText="Adhoc filters are applied automatically to all queries that target this datasource",e.get(t.current.datasource).then(function(e){e.getTagKeys||(t.infoText="This datasource does not support adhoc filters yet.")}))},t.runQuery=function(){return n.updateOptions(t.current).then(null,function(e){e.data&&e.data.message&&(e.message=e.data.message),t.appEvent("alert-error",["Templating","Template variables could not be initialized: "+e.message])})},t.edit=function(e){t.current=e,t.currentIsNew=!1,t.mode="edit",t.validate()},t.duplicate=function(e){var r=i.a.cloneDeep(e.getSaveModel());t.current=n.createVariableFromModel(r),t.current.name="copy_of_"+e.name,n.addVariable(t.current)},t.update=function(){t.isValid()&&t.runQuery().then(function(){t.reset(),t.mode="list",r.updateTemplateData()})},t.reset=function(){t.currentIsNew=!0,t.current=n.createVariableFromModel({type:"query"}),t.datasources=i.a.filter(e.getMetricSources(),function(t){return!t.meta.mixed&&null!==t.value}),t.datasourceTypes=i()(t.datasources).uniqBy("meta.id").map(function(t){return{text:t.meta.name,value:t.meta.id}}).value()},t.typeChanged=function(){var e=t.current;t.current=n.createVariableFromModel({type:t.current.type}),t.current.name=e.name,t.current.hide=e.hide,t.current.label=e.label;var r=i.a.indexOf(this.variables,e);-1!==r&&(this.variables[r]=t.current),t.validate()},t.removeVariable=function(t){n.removeVariable(t)}}return t.$inject=["$scope","datasourceSrv","variableSrv","templateSrv"],t}();a.default.controller("VariableEditorCtrl",s)},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(2),l=n(798),u=function(){function t(t,e,n,r,i){this.$rootScope=t,this.$q=e,this.$location=n,this.$injector=r,this.templateSrv=i,t.$on("refresh",this.onDashboardRefresh.bind(this),t),t.$on("template-variable-value-updated",this.updateUrlParamsWithCurrentVariables.bind(this),t)}return t.$inject=["$rootScope","$q","$location","$injector","templateSrv"],t.prototype.init=function(t){var e=this;this.dashboard=t,this.variables=t.templating.list=t.templating.list.map(this.createVariableFromModel.bind(this)),this.templateSrv.init(this.variables);for(var n=0,r=this.variables;n<r.length;n++){r[n].initLock=this.$q.defer()}var i=this.$location.search();return this.$q.all(this.variables.map(function(t){return e.processVariable(t,i)})).then(function(){e.templateSrv.updateTemplateData()})},t.prototype.onDashboardRefresh=function(){var t=this,e=this.variables.filter(function(t){return 2===t.refresh}).map(function(e){var n=e.options.slice();return e.updateOptions().then(function(){i.a.toJson(n)!==i.a.toJson(e.options)&&t.$rootScope.$emit("template-variable-value-updated")})});return this.$q.all(e)},t.prototype.processVariable=function(t,e){for(var n=this,r=[],i=0,a=this.variables;i<a.length;i++){var o=a[i];t.dependsOn(o)&&r.push(o.initLock.promise)}return this.$q.all(r).then(function(){var n=e["var-"+t.name];return void 0!==n?t.setValueFromUrl(n).then(t.initLock.resolve):1===t.refresh||2===t.refresh?t.updateOptions().then(t.initLock.resolve):void t.initLock.resolve()}).finally(function(){n.templateSrv.variableInitialized(t),delete t.initLock})},t.prototype.createVariableFromModel=function(t){var e=l.variableTypes[t.type].ctor;if(!e)throw{message:"Unable to find variable constructor for "+t.type};return this.$injector.instantiate(e,{model:t})},t.prototype.addVariable=function(t){this.variables.push(t),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.removeVariable=function(t){var e=o.a.indexOf(this.variables,t);this.variables.splice(e,1),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.updateOptions=function(t){return t.updateOptions()},t.prototype.variableUpdated=function(t,e){var n=this;if(t.initLock)return this.$q.when();var r=o.a.map(this.variables,function(e){if(e!==t)return e.dependsOn(t)?n.updateOptions(e):void 0});return this.$q.all(r).then(function(){e&&(n.$rootScope.$emit("template-variable-value-updated"),n.$rootScope.$broadcast("refresh"))})},t.prototype.selectOptionsForCurrentValue=function(t){var e,n,r,i,a=[];for(e=0;e<t.options.length;e++)if(i=t.options[e],i.selected=!1,o.a.isArray(t.current.value))for(n=0;n<t.current.value.length;n++)r=t.current.value[n],i.value===r&&(i.selected=!0,a.push(i));else i.value===t.current.value&&(i.selected=!0,a.push(i));return a},t.prototype.validateVariableSelectionState=function(t){if(t.current||(t.current={}),o.a.isArray(t.current.value)){var e=this.selectOptionsForCurrentValue(t);return e=0===e.length?t.options[0]:{value:o.a.map(e,function(t){return t.value}),text:o.a.map(e,function(t){return t.text}).join(" + ")},t.setValue(e)}var n=o.a.find(t.options,{text:t.current.text});return n?t.setValue(n):t.options.length?t.setValue(t.options[0]):Promise.resolve()},t.prototype.setOptionFromUrl=function(t,e){var n=this.$q.when();return t.refresh&&(n=t.updateOptions()),n.then(function(){var n=o.a.find(t.options,function(t){return t.text===e||t.value===e});return n=n||{text:e,value:e},t.setValue(n)})},t.prototype.setOptionAsCurrent=function(t,e){return t.current=o.a.cloneDeep(e),o.a.isArray(t.current.text)&&(t.current.text=t.current.text.join(" + ")),this.selectOptionsForCurrentValue(t),this.variableUpdated(t)},t.prototype.updateUrlParamsWithCurrentVariables=function(){var t=this.$location.search();o.a.each(t,function(e,n){0===n.indexOf("var-")&&delete t[n]}),this.templateSrv.fillVariableValuesForUrl(t),this.$location.search(t)},t.prototype.setAdhocFilter=function(t){var e=o.a.find(this.variables,{type:"adhoc",datasource:t.datasource});e||(e=this.createVariableFromModel({name:"Filters",type:"adhoc",datasource:t.datasource}),this.addVariable(e));var n=e.filters,r=o.a.find(n,{key:t.key,value:t.value});r||(r={key:t.key,value:t.value},n.push(r)),r.operator=t.operator,this.variableUpdated(e,!0)},t}();s.default.service("variableSrv",u)},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(4),i=n.n(r),a=n(109),o=n.n(a),s=n(798),l=function(){function t(t,e,n,r){this.model=t,this.timeSrv=e,this.templateSrv=n,this.variableSrv=r,this.defaults={type:"interval",name:"",hide:0,label:"",refresh:2,options:[],current:{},query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",auto:!1,auto_min:"10s",auto_count:30},Object(s.assignModelProperties)(this,t,this.defaults),this.refresh=2}return t.$inject=["model","timeSrv","templateSrv","variableSrv"],t.prototype.getSaveModel=function(){return Object(s.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){return this.updateAutoValue(),this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateAutoValue=function(){if(this.auto){this.options.length&&"auto"!==this.options[0].text&&this.options.unshift({text:"auto",value:"$__auto_interval"});var t=o.a.calculateInterval(this.timeSrv.timeRange(),this.auto_count,this.auto_min);this.templateSrv.setGrafanaVariable("$__auto_interval",t.interval)}},t.prototype.updateOptions=function(){return this.options=i.a.map(this.query.match(/(["'])(.*?)\1|\w+/g),function(t){return t=t.replace(/["']+/g,""),{text:t.trim(),value:t.trim()}}),this.updateAutoValue(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.updateAutoValue(),this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();s.variableTypes.interval={name:"Interval",ctor:l,description:"Define a timespan interval (ex 1m, 1h, 1d)"}},function(t,e,n){"use strict";function r(){return{text:"None",value:"",isNone:!0}}n.d(e,"a",function(){return u});var i=n(4),a=n.n(i),o=n(109),s=n.n(o),l=n(798),u=function(){function t(t,e,n,r,i){this.model=t,this.datasourceSrv=e,this.templateSrv=n,this.variableSrv=r,this.timeSrv=i,this.defaults={type:"query",label:null,query:"",regex:"",sort:0,datasource:null,refresh:0,hide:0,name:"",multi:!1,includeAll:!1,allValue:null,options:[],current:{},tags:[],useTags:!1,tagsQuery:"",tagValuesQuery:""},Object(l.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model","datasourceSrv","templateSrv","variableSrv","timeSrv"],t.prototype.getSaveModel=function(){return Object(l.assignModelProperties)(this.model,this,this.defaults),0!==this.refresh&&(this.model.options=[]),this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t.prototype.updateOptions=function(){return this.datasourceSrv.get(this.datasource).then(this.updateOptionsFromMetricFindQuery.bind(this)).then(this.updateTags.bind(this)).then(this.variableSrv.validateVariableSelectionState.bind(this.variableSrv,this))},t.prototype.updateTags=function(t){var e=this;return this.useTags?this.metricFindQuery(t,this.tagsQuery).then(function(n){e.tags=[];for(var r=0;r<n.length;r++)e.tags.push(n[r].text);return t}):(delete this.tags,t)},t.prototype.getValuesForTag=function(t){var e=this;return this.datasourceSrv.get(this.datasource).then(function(n){var r=e.tagValuesQuery.replace("$tag",t);return e.metricFindQuery(n,r).then(function(t){return a.a.map(t,function(t){return t.text})})})},t.prototype.updateOptionsFromMetricFindQuery=function(t){var e=this;return this.metricFindQuery(t,this.query).then(function(n){return e.options=e.metricNamesToVariableValues(n),e.includeAll&&e.addAllOption(),e.options.length||e.options.push(r()),t})},t.prototype.metricFindQuery=function(t,e){var n={range:void 0,variable:this};return 2===this.refresh&&(n.range=this.timeSrv.timeRange()),t.metricFindQuery(e,n)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.metricNamesToVariableValues=function(t){var e,n,r,i;for(n=[],this.regex&&(e=s.a.stringToJsRegex(this.templateSrv.replace(this.regex,{},"regex"))),r=0;r<t.length;r++){var o=t[r],l=void 0===o.text||null===o.text?o.value:o.text,u=void 0===o.value||null===o.value?o.text:o.value;if(a.a.isNumber(u)&&(u=u.toString()),a.a.isNumber(l)&&(l=l.toString()),e){if(!(i=e.exec(u)))continue;i.length>1&&(u=i[1],l=i[1])}n.push({text:l,value:u})}return n=a.a.uniqBy(n,"value"),this.sortVariableValues(n,this.sort)},t.prototype.sortVariableValues=function(t,e){if(0===e)return t;var n=Math.ceil(e/2),r=e%2==0;return 1===n?t=a.a.sortBy(t,"text"):2===n&&(t=a.a.sortBy(t,function(t){var e=t.text.match(/.*?(\d+).*/);return!e||e.length<2?-1:parseInt(e[1],10)})),r&&(t=t.reverse()),t},t.prototype.dependsOn=function(t){return Object(l.containsVariable)(this.query,this.datasource,t.name)},t}();l.variableTypes.query={name:"Query",ctor:u,description:"Variable values are fetched from a datasource query",supportsMulti:!0}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(109),i=n.n(r),a=n(798),o=function(){function t(t,e,n,r){this.model=t,this.datasourceSrv=e,this.variableSrv=n,this.templateSrv=r,this.defaults={type:"datasource",name:"",hide:0,label:"",current:{},regex:"",options:[],query:"",refresh:1},Object(a.assignModelProperties)(this,t,this.defaults),this.refresh=1}return t.$inject=["model","datasourceSrv","variableSrv","templateSrv"],t.prototype.getSaveModel=function(){return Object(a.assignModelProperties)(this.model,this,this.defaults),this.model.options=[],this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){var t,e=[],n=this.datasourceSrv.getMetricSources({skipVariables:!0});this.regex&&(t=this.templateSrv.replace(this.regex,null,"regex"),t=i.a.stringToJsRegex(t));for(var r=0;r<n.length;r++){var a=n[r];a.meta.id===this.query&&(t&&!t.exec(a.name)||e.push({text:a.name,value:a.name}))}return 0===e.length&&e.push({text:"No data sources found",value:""}),this.options=e,this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!!this.regex&&Object(a.containsVariable)(this.regex,t.name)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();a.variableTypes.datasource={name:"Datasource",ctor:o,description:"Enabled you to dynamically switch the datasource for multiple panels"}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4),i=n.n(r),a=n(798),o=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"custom",name:"",label:"",hide:0,options:[],current:{},query:"",includeAll:!1,multi:!1,allValue:null},Object(a.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.getSaveModel=function(){return Object(a.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return this.options=i.a.map(this.query.split(/[,]+/),function(t){return{text:t.trim(),value:t.trim()}}),this.includeAll&&this.addAllOption(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t}();a.variableTypes.custom={name:"Custom",ctor:o,description:"Define variable values manually",supportsMulti:!0}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(798),i=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"constant",name:"",hide:2,label:"",query:"",current:{},options:[]},Object(r.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.getSaveModel=function(){return Object(r.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){return this.options=[{text:this.query.trim(),value:this.query.trim()}],this.setValue(this.options[0]),Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();r.variableTypes.constant={name:"Constant",ctor:i,description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share"}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4),i=n.n(r),a=n(798),o=function(){function t(t){this.model=t,this.defaults={type:"adhoc",name:"",label:"",hide:0,datasource:null,filters:[]},Object(a.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model"],t.prototype.setValue=function(t){return Promise.resolve()},t.prototype.getSaveModel=function(){return Object(a.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){var e=this;return i.a.isArray(t)||(t=[t]),this.filters=t.map(function(t){var n=t.split("|").map(function(t){return e.unescapeDelimiter(t)});return{key:n[0],operator:n[1],value:n[2]}}),Promise.resolve()},t.prototype.getValueForUrl=function(){var t=this;return this.filters.map(function(e){return[e.key,e.operator,e.value].map(function(e){return t.escapeDelimiter(e)}).join("|")})},t.prototype.escapeDelimiter=function(t){return t.replace(/\|/g,"__gfp__")},t.prototype.unescapeDelimiter=function(t){return t.replace(/__gfp__/g,"|")},t.prototype.setFilters=function(t){this.filters=t},t}();a.variableTypes.adhoc={name:"Ad hoc filters",ctor:o,description:"Add key/value filters on the fly"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n(904),n(905),n(906),n(907),n(908),n(909),n(910));n.n(r),n(1031)},function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(294),l=n.n(s),u=function(){function t(t,e,n,r,i,a){this.$scope=t,this.$rootScope=e,this.backendSrv=n,this.$sce=r,this.navModel=a.getPluginsNav(),this.model={},this.pluginId=i.pluginId,this.tabIndex=0,this.tabs=["Readme"],this.preUpdateHook=function(){return Promise.resolve()},this.postUpdateHook=function(){return Promise.resolve()}}return t.$inject=["$scope","$rootScope","backendSrv","$sce","$routeParams","navModelSrv"],t.prototype.init=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){return t.model=e,t.pluginIcon=t.getPluginIcon(t.model.type),t.model.dependencies.plugins.forEach(function(e){e.icon=t.getPluginIcon(e.type)}),t.includes=o.a.map(e.includes,function(e){return e.icon=t.getPluginIcon(e.type),e}),"app"===t.model.type&&(t.hasDashboards=o.a.find(e.includes,{type:"dashboard"}),t.hasDashboards&&t.tabs.unshift("Dashboards"),t.tabs.unshift("Config"),t.tabIndex=0),t.initReadme()})},t.prototype.initReadme=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/markdown/readme").then(function(e){var n=new l.a;t.readmeHtml=t.$sce.trustAsHtml(n.render(e))})},t.prototype.getPluginIcon=function(t){switch(t){case"datasource":return"icon-gf icon-gf-datasources";case"panel":return"icon-gf icon-gf-panel";case"app":return"icon-gf icon-gf-apps";case"page":return"icon-gf icon-gf-endpoint-tiny";case"dashboard":return"icon-gf icon-gf-dashboard";default:return"icon-gf icon-gf-apps"}},t.prototype.update=function(){var t=this;this.preUpdateHook().then(function(){var e=o.a.extend({enabled:t.model.enabled,pinned:t.model.pinned,jsonData:t.model.jsonData,secureJsonData:t.model.secureJsonData},{});return t.backendSrv.post("/api/plugins/"+t.pluginId+"/settings",e)}).then(this.postUpdateHook).then(function(t){window.location.href=window.location.href})},t.prototype.importDashboards=function(){return Promise.resolve()},t.prototype.setPreUpdateHook=function(t){this.preUpdateHook=t},t.prototype.setPostUpdateHook=function(t){this.postUpdateHook=t},t.prototype.updateAvailable=function(){var t=this.$scope.$new(!0);t.plugin=this.model,this.$rootScope.appEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:t})},t.prototype.enable=function(){this.model.enabled=!0,this.model.pinned=!0,this.update()},t.prototype.disable=function(){this.model.enabled=!1,this.model.pinned=!1,this.update()},t}();i.a.module("grafana.controllers").controller("PluginEditCtrl",u)},function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s={},l=function(){function t(t,e,n){this.backendSrv=t,this.$routeParams=e,this.$rootScope=n,this.pluginId=e.pluginId,s[this.pluginId]?this.initPage(s[this.pluginId]):this.loadPluginInfo()}return t.$inject=["backendSrv","$routeParams","$rootScope"],t.prototype.initPage=function(t){if(this.appModel=t,this.page=o.a.find(t.includes,{slug:this.$routeParams.slug}),s[this.pluginId]=t,!this.page)return this.$rootScope.appEvent("alert-error",["App Page Not Found",""]),void(this.navModel={section:{title:"Page not found",url:t.defaultNavUrl,icon:"icon-gf icon-gf-sadface"},menu:[]});for(var e=[],n=0,r=t.includes;n<r.length;n++){var i=r[n];i.addToNav&&("dashboard"===i.type&&e.push({title:i.name,url:"dashboard/db/"+i.slug,icon:"fa fa-fw fa-dot-circle-o"}),"page"===i.type&&e.push({title:i.name,url:"plugins/"+t.id+"/page/"+i.slug,icon:"fa fa-fw fa-dot-circle-o"}))}this.navModel={section:{title:t.name,url:t.defaultNavUrl,iconUrl:t.info.logos.small},menu:e}},t.prototype.loadPluginInfo=function(){var t=this;this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){t.initPage(e)})},t}();i.a.module("grafana.controllers").controller("AppPageCtrl",l)},function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=function(){function t(t,e,n){var r=this;this.backendSrv=t,this.tabIndex=0,this.navModel=n.getPluginsNav();var i=e.search().type||"panel";switch(i){case"datasource":this.tabIndex=1;break;case"app":this.tabIndex=2;break;case"panel":default:this.tabIndex=0}this.backendSrv.get("api/plugins",{embedded:0,type:i}).then(function(t){r.plugins=t})}return t.$inject=["backendSrv","$location","navModelSrv"],t}();i.a.module("grafana.controllers").controller("PluginListCtrl",a)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/plugins/import_list/import_list.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{plugin:"=",datasource:"="}}}var i=n(4),a=n.n(i),o=n(2),s=n(39),l=function(){function t(t,e,n){var r=this;this.backendSrv=e,this.$rootScope=n,this.dashboards=[],e.get("/api/plugins/"+this.plugin.id+"/dashboards").then(function(t){r.dashboards=t}),s.a.on("dashboard-list-import-all",this.importAll.bind(this),t)}return t.$inject=["$scope","backendSrv","$rootScope"],t.prototype.importAll=function(t){return this.importNext(0).then(function(){t.resolve("All dashboards imported")}).catch(function(e){t.reject(e)})},t.prototype.importNext=function(t){var e=this;return this.import(this.dashboards[t],!0).then(function(){return t+1<e.dashboards.length?new Promise(function(n){setTimeout(function(){e.importNext(t+1).then(function(){n()})},500)}):Promise.resolve()})},t.prototype.import=function(t,e){var n=this,r={pluginId:this.plugin.id,path:t.path,overwrite:e,inputs:[]};return this.datasource&&r.inputs.push({name:"*",type:"datasource",pluginId:this.datasource.type,value:this.datasource.name}),this.backendSrv.post("/api/dashboards/import",r).then(function(e){n.$rootScope.appEvent("alert-success",["Dashboard Imported",t.title]),a.a.extend(t,e)})},t.prototype.remove=function(t){var e=this;this.backendSrv.delete("/api/dashboards/"+t.importedUri).then(function(){e.$rootScope.appEvent("alert-success",["Dashboard Deleted",t.title]),t.imported=!1})},t}();o.default.directive("dashboardImportList",r)},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=n(21),o=n.n(a),s=n(290),l=[],u={name:"",type:"graphite",url:"",access:"proxy",jsonData:{},secureJsonFields:{}},c=!1,h=function(){function t(t,e,n,r,i,a){var o=this;this.$q=t,this.backendSrv=e,this.$routeParams=n,this.$location=r,this.datasourceSrv=i,this.navModelSrv=a,this.navModel=this.navModelSrv.getDatasourceNav(0),this.isNew=!0,this.datasources=[],this.tabIndex=0,this.loadDatasourceTypes().then(function(){o.$routeParams.id?o.getDatasourceById(o.$routeParams.id):o.initNewDatasourceModel()})}return t.$inject=["$q","backendSrv","$routeParams","$location","datasourceSrv","navModelSrv"],t.prototype.initNewDatasourceModel=function(){this.current=i.a.cloneDeep(u),this.$location.search().gettingstarted&&(this.gettingStarted=!0,this.current.isDefault=!0),this.typeChanged()},t.prototype.loadDatasourceTypes=function(){var t=this;return l.length>0?(this.types=l,this.$q.when(null)):this.backendSrv.get("/api/plugins",{enabled:1,type:"datasource"}).then(function(e){l=e,t.types=e})},t.prototype.getDatasourceById=function(t){var e=this;this.backendSrv.get("/api/datasources/"+t).then(function(t){return e.isNew=!1,e.current=t,c&&(c=!1,e.testDatasource()),e.typeChanged()})},t.prototype.userChangedType=function(){this.current=i.a.defaults({id:this.current.id,name:this.current.name,isDefault:this.current.isDefault,type:this.current.type},i.a.cloneDeep(u)),this.typeChanged()},t.prototype.typeChanged=function(){var t=this;return this.hasDashboards=!1,this.backendSrv.get("/api/plugins/"+this.current.type+"/settings").then(function(e){t.datasourceMeta=e,t.hasDashboards=i.a.find(e.includes,{type:"dashboard"})})},t.prototype.updateFrontendSettings=function(){var t=this;return this.backendSrv.get("/api/frontend/settings").then(function(e){o.a.datasources=e.datasources,o.a.defaultDatasource=e.defaultDatasource,t.datasourceSrv.init()})},t.prototype.testDatasource=function(){var t=this;this.datasourceSrv.get(this.current.name).then(function(e){e.testDatasource&&(t.testing={done:!1,status:"error"},t.backendSrv.withNoBackendCache(function(){return e.testDatasource().then(function(e){t.testing.message=e.message,t.testing.status=e.status}).catch(function(e){e.statusText?t.testing.message="HTTP Error "+e.statusText:t.testing.message=e.message})}).finally(function(){t.testing.done=!0}))})},t.prototype.saveChanges=function(){var t=this;if(this.editForm.$valid)return this.current.id?this.backendSrv.put("/api/datasources/"+this.current.id,this.current).then(function(){t.updateFrontendSettings().then(function(){t.testDatasource()})}):this.backendSrv.post("/api/datasources",this.current).then(function(e){t.updateFrontendSettings(),c=!0,t.$location.path("datasources/edit/"+e.id)})},t.prototype.confirmDelete=function(){var t=this;this.backendSrv.delete("/api/datasources/"+this.current.id).then(function(){t.$location.path("datasources")})},t.prototype.delete=function(t){var e=this;s.appEvents.emit("confirm-modal",{title:"Delete",text:"Are you sure you want to delete this datasource?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.confirmDelete()}})},t}();s.coreModule.controller("DataSourceEditCtrl",h),s.coreModule.directive("datasourceHttpSettings",function(){return{scope:{current:"=",suggestUrl:"@"},templateUrl:"public/app/features/plugins/partials/ds_http_settings.html",link:{pre:function(t,e,n){t.getSuggestUrls=function(){return[t.suggestUrl]}}}}})},function(t,e,n){"use strict";var r=n(2),i=function(){function t(t,e,n,r){var i=this;this.$scope=t,this.backendSrv=e,this.datasourceSrv=n,this.navModelSrv=r,this.navModel=this.navModelSrv.getDatasourceNav(0),e.get("/api/datasources").then(function(t){i.datasources=t})}return t.$inject=["$scope","backendSrv","datasourceSrv","navModelSrv"],t.prototype.removeDataSourceConfirmed=function(t){var e=this;this.backendSrv.delete("/api/datasources/"+t.id).then(function(){e.$scope.appEvent("alert-success",["Datasource deleted",""])},function(){e.$scope.appEvent("alert-error",["Unable to delete datasource",""])}).then(function(){e.backendSrv.get("/api/datasources").then(function(t){e.datasources=t}),e.backendSrv.get("/api/frontend/settings").then(function(t){e.datasourceSrv.init(t.datasources)})})},t.prototype.removeDataSource=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete datasource "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removeDataSourceConfirmed(t)}})},t}();r.default.controller("DataSourcesCtrl",i)},function(t,e,n){var r,i;r=[n(8),n(4),n(2),n(21),n(809)],void 0!==(i=function(t,e,n,r,i){"use strict";n.default.service("datasourceSrv",["$q","$injector","$rootScope","templateSrv",function(t,n,a,o){var s=this;this.init=function(){this.datasources={}},this.get=function(e){return e?(e=o.replace(e),"default"===e?this.get(r.defaultDatasource):this.datasources[e]?t.when(this.datasources[e]):this.loadDatasource(e)):this.get(r.defaultDatasource)},this.loadDatasource=function(e){var o=r.datasources[e];if(!o)return t.reject({message:"Datasource named "+e+" was not found"});var l=t.defer(),u=o.meta;return i.importPluginModule(u.module).then(function(t){if(s.datasources[e])return void l.resolve(s.datasources[e]);if(!t.Datasource)throw"Plugin module is missing Datasource constructor";var r=n.instantiate(t.Datasource,{instanceSettings:o});r.meta=u,r.name=e,s.datasources[e]=r,l.resolve(r)}).catch(function(t){a.appEvent("alert-error",[o.name+" plugin failed",t.toString()])}),l.promise},this.getAll=function(){return r.datasources},this.getAnnotationSources=function(){var t=[];return this.addDataSourceVariables(t),e.each(r.datasources,function(e){e.meta&&e.meta.annotations&&t.push(e)}),t},this.getMetricSources=function(t){var n=[];return e.each(r.datasources,function(t,e){t.meta&&t.meta.metrics&&(n.push({value:e,name:e,meta:t.meta}),e===r.defaultDatasource&&n.push({value:null,name:"default",meta:t.meta}))}),t&&t.skipVariables||this.addDataSourceVariables(n),n.sort(function(t,e){return"mixed"===t.meta.id||"grafana"===t.meta.id?1:"mixed"===e.meta.id||"grafana"===e.meta.id?-1:t.name.toLowerCase()>e.name.toLowerCase()?1:t.name.toLowerCase()<e.name.toLowerCase()?-1:0}),n},this.addDataSourceVariables=function(t){for(var e=0;e<o.variables.length;e++){var n=o.variables[e];if("datasource"===n.type){var i=n.current.value;"default"===i&&(i=r.defaultDatasource);var a=r.datasources[i];a&&t.push({name:"$"+n.name,value:"$"+n.name,meta:a.meta})}}},this.init()}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){(function(e,r,i,a){!function(){"use strict";function o(t){return pe?Symbol():"@@"+t}function s(t,e){ce||(e=e.replace(fe?/file:\/\/\//g:/file:\/\//g,""));var n,r=(t.message||t)+"\n  "+e;n=ve&&t.fileName?new Error(r,t.fileName,t.lineNumber):new Error(r);var i=t.originalErr?t.originalErr.stack:t.stack;return n.stack=he?r+"\n  "+i:i,n.originalErr=t.originalErr||t,n}function l(t,e){throw new RangeError('Unable to resolve "'+t+'" to '+e)}function u(t,e){t=t.trim();var n=e&&e.substr(0,e.indexOf(":")+1),r=t[0],i=t[1];if("/"===r&&"/"===i)return n||l(t,e),n+t;if("."===r&&("/"===i||"."===i&&("/"===t[2]||2===t.length&&(t+="/"))||1===t.length&&(t+="/"))||"/"===r){var a,o=!n||"/"!==e[n.length];if(o?(void 0===e&&l(t,e),a=e):a="/"===e[n.length+1]?"file:"!==n?(a=e.substr(n.length+2)).substr(a.indexOf("/")+1):e.substr(8):e.substr(n.length+1),"/"===r){if(!o)return e.substr(0,e.length-a.length-1)+t;l(t,e)}for(var s=a.substr(0,a.lastIndexOf("/")+1)+t,u=[],c=-1,h=0;h<s.length;h++)if(-1===c)if("."!==s[h])c=h;else{if("."!==s[h+1]||"/"!==s[h+2]&&h+2!==s.length){if("/"!==s[h+1]&&h+1!==s.length){c=h;continue}h+=1}else u.pop(),h+=2;o&&0===u.length&&l(t,e)}else"/"===s[h]&&(u.push(s.substring(c,h+1)),c=-1);return-1!==c&&u.push(s.substr(c)),e.substr(0,e.length-a.length)+u.join("")}return-1!==t.indexOf(":")?he&&":"===t[1]&&"\\"===t[2]&&t[0].match(/[a-z]/i)?"file:///"+t.replace(/\\/g,"/"):t:void 0}function c(t){if(t.values)return t.values();if("undefined"==typeof Symbol||!Symbol.iterator)throw new Error("Symbol.iterator not supported in this browser");var e={};return e[Symbol.iterator]=function(){var e=Object.keys(t),n=0;return{next:function(){return n<e.length?{value:t[e[n++]],done:!1}:{value:void 0,done:!0}}}},e}function h(){this.registry=new p}function f(t){if(!(t instanceof m))throw new TypeError("Module instantiation did not return a valid namespace object.");return t}function d(t){if(void 0===t)throw new RangeError("No resolution found.");return t}function p(){this[we]={}}function m(t){Object.defineProperty(this,Se,{value:t}),Object.keys(t).forEach(g,this)}function g(t){Object.defineProperty(this,t,{enumerable:!0,get:function(){return this[Se][t]}})}function v(){h.call(this);var t=this.registry.delete;this.registry.delete=function(n){var r=t.call(this,n);return e.hasOwnProperty(n)&&!e[n].linkRecord&&(delete e[n],r=!0),r};var e={};this[ke]={lastRegister:void 0,records:e},this.trace=!1}function y(t,e,n){return t.records[e]={key:e,registration:n,module:void 0,importerSetters:void 0,loadError:void 0,evalError:void 0,linkRecord:{instantiatePromise:void 0,dependencies:void 0,execute:void 0,executingRequire:!1,moduleObj:void 0,setters:void 0,depsInstantiatePromise:void 0,dependencyInstantiations:void 0}}}function b(t,e,n,r,i){var a=r[e];if(a)return Promise.resolve(a);var o=i.records[e];return o&&!o.module?o.loadError?Promise.reject(o.loadError):_(t,o,o.linkRecord,r,i):t.resolve(e,n).then(function(e){if(a=r[e])return a;if((o=i.records[e])&&!o.module||(o=y(i,e,o&&o.registration)),o.loadError)return Promise.reject(o.loadError);var n=o.linkRecord;return n?_(t,o,n,r,i):o})}function x(t,e,n){return function(){var t=n.lastRegister;return t?(n.lastRegister=void 0,e.registration=t,!0):!!e.registration}}function _(t,e,n,r,i){return n.instantiatePromise||(n.instantiatePromise=(e.registration?Promise.resolve():Promise.resolve().then(function(){return i.lastRegister=void 0,t[Me](e.key,t[Me].length>1&&x(t,e,i))})).then(function(a){if(void 0!==a){if(!(a instanceof m))throw new TypeError("Instantiate did not return a valid Module object.");return delete i.records[e.key],t.trace&&S(t,e,n),r[e.key]=a}var o=e.registration;if(e.registration=void 0,!o)throw new TypeError("Module instantiation did not call an anonymous or correctly named System.register.");return n.dependencies=o[0],e.importerSetters=[],n.moduleObj={},o[2]?(n.moduleObj.default=n.moduleObj.__useDefault={},n.executingRequire=o[1],n.execute=o[2]):k(t,e,n,o[1]),e}).catch(function(t){throw e.linkRecord=void 0,e.loadError=e.loadError||s(t,"Instantiating "+e.key)}))}function w(t,e,n,r,i,a){return t.resolve(e,n).then(function(n){a&&(a[e]=n);var o=i.records[n],s=r[n];if(s&&(!o||o.module&&s!==o.module))return s;if(o&&o.loadError)throw o.loadError;(!o||!s&&o.module)&&(o=y(i,n,o&&o.registration));var l=o.linkRecord;return l?_(t,o,l,r,i):o})}function S(t,e,n){t.loads=t.loads||{},t.loads[e.key]={key:e.key,deps:n.dependencies,dynamicDeps:[],depMap:n.depMap||{}}}function k(t,e,n,r){var i=n.moduleObj,a=e.importerSetters,o=!1,s=r.call(de,function(t,e){if("object"==typeof t){var n=!1;for(var r in t)e=t[r],"__useDefault"===r||r in i&&i[r]===e||(n=!0,i[r]=e);if(!1===n)return e}else{if((o||t in i)&&i[t]===e)return e;i[t]=e}for(var s=0;s<a.length;s++)a[s](i);return e},new C(t,e.key));n.setters=s.setters,n.execute=s.execute,s.exports&&(n.moduleObj=i=s.exports,o=!0)}function M(t,e,n,r,i){if(n.depsInstantiatePromise)return n.depsInstantiatePromise;for(var a=Array(n.dependencies.length),o=0;o<n.dependencies.length;o++)a[o]=w(t,n.dependencies[o],e.key,r,i,t.trace&&n.depMap||(n.depMap={}));var l=Promise.all(a).then(function(t){if(n.dependencyInstantiations=t,n.setters)for(var r=0;r<t.length;r++){var i=n.setters[r];if(i){var a=t[r];if(a instanceof m)i(a);else{if(a.loadError)throw a.loadError;i(a.module||a.linkRecord.moduleObj),a.importerSetters&&a.importerSetters.push(i)}}}return e});return t.trace&&(l=l.then(function(){return S(t,e,n),e})),(l=l.catch(function(t){throw n.depsInstantiatePromise=void 0,s(t,"Loading "+e.key)})).catch(function(){}),n.depsInstantiatePromise=l}function T(t,e,n,r,i){return new Promise(function(n,a){function o(e){var n=e.linkRecord;n&&-1===l.indexOf(e)&&(l.push(e),u++,M(t,e,n,r,i).then(s,a))}function s(t){u--;var e=t.linkRecord;if(e)for(var r=0;r<e.dependencies.length;r++){var i=e.dependencyInstantiations[r];i instanceof m||o(i)}0===u&&n()}var l=[],u=0;o(e)})}function C(t,e){this.loader=t,this.key=this.id=e,this.meta={url:e}}function A(t,e,n,r,i,a){if(e.module)return e.module;if(e.evalError)throw e.evalError;if(a&&-1!==a.indexOf(e))return e.linkRecord.moduleObj;var o=E(t,e,n,r,i,n.setters?[]:a||[]);if(o)throw o;return e.module}function P(t,e,n,r,i,a,o){return function(s){for(var l=0;l<n.length;l++)if(n[l]===s){var u,c=r[l];return u=c instanceof m?c:A(t,c,c.linkRecord,i,a,o),"__useDefault"in u?u.__useDefault:u}throw new Error("Module "+s+" not declared as a System.registerDynamic dependency of "+e)}}function E(t,e,n,r,i,a){a.push(e);var o;if(n.setters)for(var l,u,c=0;c<n.dependencies.length;c++)if(!((l=n.dependencyInstantiations[c])instanceof m)&&((u=l.linkRecord)&&-1===a.indexOf(l)&&(o=l.evalError?l.evalError:E(t,l,u,r,i,u.setters?a:[])),o))return e.linkRecord=void 0,e.evalError=s(o,"Evaluating "+e.key),e.evalError;if(n.execute)if(n.setters)o=O(n.execute);else{var h={id:e.key},f=n.moduleObj;Object.defineProperty(h,"exports",{configurable:!0,set:function(t){f.default=f.__useDefault=t},get:function(){return f.__useDefault}});var d=P(t,e.key,n.dependencies,n.dependencyInstantiations,r,i,a);if(!n.executingRequire)for(c=0;c<n.dependencies.length;c++)d(n.dependencies[c]);o=D(n.execute,d,f.default,h),h.exports!==f.__useDefault&&(f.default=f.__useDefault=h.exports);var p=f.default;if(p&&p.__esModule)for(var g in p)Object.hasOwnProperty.call(p,g)&&(f[g]=p[g])}if(e.linkRecord=void 0,o)return e.evalError=s(o,"Evaluating "+e.key);if(r[e.key]=e.module=new m(n.moduleObj),!n.setters){if(e.importerSetters)for(c=0;c<e.importerSetters.length;c++)e.importerSetters[c](e.module);e.importerSetters=void 0}}function O(t){try{t.call(Te)}catch(t){return t}}function D(t,e,n,r){try{var i=t.call(de,e,n,r);void 0!==i&&(r.exports=i)}catch(t){return t}}function $(){}function I(t){return t instanceof m?t:new m(t&&t.__esModule?t:{default:t,__useDefault:t})}function R(t){return void 0===Ce&&(Ce="undefined"!=typeof Symbol&&!!Symbol.toStringTag),t instanceof m||Ce&&"[object Module]"==Object.prototype.toString.call(t)}function F(t,e){(e||this.warnings&&"undefined"!=typeof console&&console.warn)&&console.warn(t)}function N(t,e,n){var r=new Uint8Array(e);return 0===r[0]&&97===r[1]&&115===r[2]?WebAssembly.compile(e).then(function(e){var r=[],i=[],a={};return WebAssembly.Module.imports&&WebAssembly.Module.imports(e).forEach(function(t){var e=t.module;i.push(function(t){a[e]=t}),-1===r.indexOf(e)&&r.push(e)}),t.register(r,function(t){return{setters:i,execute:function(){t(new WebAssembly.Instance(e,a).exports)}}}),n(),!0}):Promise.resolve(!1)}function q(t,e){if("."===t[0])throw new Error("Node module "+t+" can't be loaded as it is not a package require.");if(!Ae){var n=this._nodeRequire("module"),r=decodeURI(e.substr(fe?8:7));(Ae=new n(r)).paths=n._nodeModulePaths(r)}return Ae.require(t)}function j(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function L(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&void 0===t[n]&&(t[n]=e[n]);return t}function U(t,e,n){for(var r in e)if(Object.hasOwnProperty.call(e,r)){var i=e[r];void 0===t[r]?t[r]=i:i instanceof Array&&t[r]instanceof Array?t[r]=[].concat(n?i:t[r]).concat(n?t[r]:i):"object"==typeof i&&null!==i&&"object"==typeof t[r]?t[r]=(n?L:j)(j({},t[r]),i):n||(t[r]=i)}}function z(t){if(Ie||Re){var e=document.createElement("link");Ie?(e.rel="preload",e.as="script"):e.rel="prefetch",e.href=t,document.head.appendChild(e)}else(new Image).src=t}function V(t,e,n){try{importScripts(t)}catch(t){n(t)}e()}function B(t,e,n,r,i){function a(){r(),s()}function o(e){s(),i(new Error("Fetching "+t))}function s(){for(var t=0;t<Fe.length;t++)if(Fe[t].err===o){Fe.splice(t,1);break}l.removeEventListener("load",a,!1),l.removeEventListener("error",o,!1),document.head.removeChild(l)}if(t=t.replace(/#/g,"%23"),$e)return V(t,r,i);var l=document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.async=!0,e&&(l.crossOrigin=e),n&&(l.integrity=n),l.addEventListener("load",a,!1),l.addEventListener("error",o,!1),l.src=t,document.head.appendChild(l)}function Y(t,e){for(var n=t.split(".");n.length;)e=e[n.shift()];return e}function H(t,e,n){var r=W(e,n);if(r){var i=e[r]+n.substr(r.length),a=u(i,ue);return void 0!==a?a:t+i}return-1!==n.indexOf(":")?n:t+n}function Q(t){var e=this.name;if(e.substr(0,t.length)===t&&(e.length===t.length||"/"===e[t.length]||"/"===t[t.length-1]||":"===t[t.length-1])){var n=t.split("/").length;n>this.len&&(this.match=t,this.len=n)}}function W(t,e){if(Object.hasOwnProperty.call(t,e))return e;var n={name:e,match:void 0,len:0};return Object.keys(t).forEach(Q,n),n.match}function G(t,e,n,r){if("file:///"===t.substr(0,8)){if(Ue)return K(t,e,n,r);throw new Error("Unable to fetch file URLs in this environment.")}t=t.replace(/#/g,"%23");var i={headers:{Accept:"application/x-es-module, */*"}};return n&&(i.integrity=n),e&&("string"==typeof e&&(i.headers.Authorization=e),i.credentials="include"),fetch(t,i).then(function(t){if(t.ok)return r?t.arrayBuffer():t.text();throw new Error("Fetch error: "+t.status+" "+t.statusText)})}function K(t,e,n,r){return new Promise(function(n,i){function a(){n(r?s.response:s.responseText)}function o(){i(new Error("XHR error: "+(s.status?" ("+s.status+(s.statusText?" "+s.statusText:"")+")":"")+" loading "+t))}t=t.replace(/#/g,"%23");var s=new XMLHttpRequest;r&&(s.responseType="arraybuffer"),s.onreadystatechange=function(){4===s.readyState&&(0==s.status?s.response?a():(s.addEventListener("error",o),s.addEventListener("load",a)):200===s.status?a():o())},s.open("GET",t,!0),s.setRequestHeader&&(s.setRequestHeader("Accept","application/x-es-module, */*"),e&&("string"==typeof e&&s.setRequestHeader("Authorization",e),s.withCredentials=!0)),s.send(null)})}function X(t,e,r,i){return"file:///"!=t.substr(0,8)?Promise.reject(new Error('Unable to fetch "'+t+'". Only file URLs of the form file:/// supported running in Node.')):(qe=qe||n(917),t=fe?t.replace(/\//g,"\\").substr(8):t.substr(7),new Promise(function(e,n){qe.readFile(t,function(t,r){if(t)return n(t);if(i)e(r);else{var a=r+"";"\ufeff"===a[0]&&(a=a.substr(1)),e(a)}})}))}function J(){throw new Error("No fetch method is defined for this environment.")}function Z(){return{pluginKey:void 0,pluginArgument:void 0,pluginModule:void 0,packageKey:void 0,packageConfig:void 0,load:void 0}}function tt(t,e,n){var r=Z();if(n){var i;e.pluginFirst?-1!==(i=n.lastIndexOf("!"))&&(r.pluginArgument=r.pluginKey=n.substr(0,i)):-1!==(i=n.indexOf("!"))&&(r.pluginArgument=r.pluginKey=n.substr(i+1)),r.packageKey=W(e.packages,n),r.packageKey&&(r.packageConfig=e.packages[r.packageKey])}return r}function et(t,e){var n=this[Oe],r=Z(),i=tt(this,n,e),a=this;return Promise.resolve().then(function(){var n=t.lastIndexOf("#?");if(-1===n)return Promise.resolve(t);var r=_t.call(a,t.substr(n+2));return wt.call(a,r,e,!0).then(function(e){return e?t.substr(0,n):"@empty"})}).then(function(t){var o=ut(n.pluginFirst,t);return o?(r.pluginKey=o.plugin,Promise.all([ot.call(a,n,o.argument,i&&i.pluginArgument||e,r,i,!0),a.resolve(o.plugin,e)]).then(function(t){if(r.pluginArgument=t[0],r.pluginKey=t[1],r.pluginArgument===r.pluginKey)throw new Error("Plugin "+r.pluginArgument+" cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.");return ct(n.pluginFirst,t[0],t[1])})):ot.call(a,n,t,i&&i.pluginArgument||e,r,i,!1)}).then(function(t){return St.call(a,t,e,i)}).then(function(t){return lt.call(a,n,t,r),r.pluginKey||!r.load.loader?t:a.resolve(r.load.loader,t).then(function(e){return r.pluginKey=e,r.pluginArgument=t,t})}).then(function(t){return a[De][t]=r,t})}function nt(t,e){var n=ut(t.pluginFirst,e);if(n){var r=nt.call(this,t,n.plugin);return ct(t.pluginFirst,it.call(this,t,n.argument,void 0,!1,!1),r)}return it.call(this,t,e,void 0,!1,!1)}function rt(t,e){var n=this[Oe],r=Z(),i=i||tt(this,n,e),a=ut(n.pluginFirst,t);return a?(r.pluginKey=rt.call(this,a.plugin,e),ct(n.pluginFirst,at.call(this,n,a.argument,i.pluginArgument||e,r,i,!!r.pluginKey),r.pluginKey)):at.call(this,n,t,i.pluginArgument||e,r,i,!!r.pluginKey)}function it(t,e,n,r,i){var a=u(e,n||ue);if(a)return H(t.baseURL,t.paths,a);if(r){var o=W(t.map,e);if(o&&(e=t.map[o]+e.substr(o.length),a=u(e,ue)))return H(t.baseURL,t.paths,a)}if(this.registry.has(e))return e;if("@node/"===e.substr(0,6))return e;var s=i&&"/"!==e[e.length-1],l=H(t.baseURL,t.paths,s?e+"/":e);return s?l.substr(0,l.length-1):l}function at(t,e,n,r,i,a){if(i&&i.packageConfig&&"."!==e[0]){var o=i.packageConfig.map,s=o&&W(o,e);if(s&&"string"==typeof o[s]){var l=pt(this,t,i.packageConfig,i.packageKey,s,e,r,a);if(l)return l}}var u=it.call(this,t,e,n,!0,!0),c=yt(t,u);if(r.packageKey=c&&c.packageKey||W(t.packages,u),!r.packageKey)return u;if(-1!==t.packageConfigKeys.indexOf(u))return r.packageKey=void 0,u;r.packageConfig=t.packages[r.packageKey]||(t.packages[r.packageKey]=Pt());var h=u.substr(r.packageKey.length+1);return ft(this,t,r.packageConfig,r.packageKey,h,r,a)}function ot(t,e,n,r,i,a){var o=this;return Pe.then(function(){if(i&&i.packageConfig&&"./"!==e.substr(0,2)){var n=i.packageConfig.map,s=n&&W(n,e);if(s)return gt(o,t,i.packageConfig,i.packageKey,s,e,r,a)}return Pe}).then(function(i){if(i)return i;var s=it.call(o,t,e,n,!0,!0),l=yt(t,s);return r.packageKey=l&&l.packageKey||W(t.packages,s),r.packageKey?-1!==t.packageConfigKeys.indexOf(s)?(r.packageKey=void 0,r.load=st(),r.load.format="json",r.load.loader="",Promise.resolve(s)):(r.packageConfig=t.packages[r.packageKey]||(t.packages[r.packageKey]=Pt()),(l&&!r.packageConfig.configured?bt(o,t,l.configPath,r):Pe).then(function(){var e=s.substr(r.packageKey.length+1);return mt(o,t,r.packageConfig,r.packageKey,e,r,a)})):Promise.resolve(s)})}function st(){return{extension:"",deps:void 0,format:void 0,loader:void 0,scriptLoad:void 0,globals:void 0,nonce:void 0,integrity:void 0,sourceMap:void 0,exports:void 0,encapsulateGlobal:!1,crossOrigin:void 0,cjsRequireDetection:!0,cjsDeferDepsExecute:!1,esModule:!1}}function lt(t,e,n){n.load=n.load||st();var r,i=0;for(var a in t.meta)if(-1!==(r=a.indexOf("*"))&&a.substr(0,r)===e.substr(0,r)&&a.substr(r+1)===e.substr(e.length-a.length+r+1)){var o=a.split("/").length;o>i&&(i=o),U(n.load,t.meta[a],i!==o)}if(t.meta[e]&&U(n.load,t.meta[e],!1),n.packageKey){var s=e.substr(n.packageKey.length+1),l={};n.packageConfig.meta&&(i=0,xt(n.packageConfig.meta,s,function(t,e,n){n>i&&(i=n),U(l,e,n&&i>n)}),U(n.load,l,!1)),!n.packageConfig.format||n.pluginKey||n.load.loader||(n.load.format=n.load.format||n.packageConfig.format)}}function ut(t,e){var n,r,i=t?e.indexOf("!"):e.lastIndexOf("!");if(-1!==i)return t?(n=e.substr(i+1),r=e.substr(0,i)):(n=e.substr(0,i),r=e.substr(i+1)||n.substr(n.lastIndexOf(".")+1)),{argument:n,plugin:r}}function ct(t,e,n){return t?n+"!"+e:e+"!"+n}function ht(t,e,n,r,i){if(!r||!e.defaultExtension||"/"===r[r.length-1]||i)return r;var a=!1;if(e.meta&&xt(e.meta,r,function(t,e,n){if(0===n||t.lastIndexOf("*")!==t.length-1)return a=!0}),!a&&t.meta&&xt(t.meta,n+"/"+r,function(t,e,n){if(0===n||t.lastIndexOf("*")!==t.length-1)return a=!0}),a)return r;var o="."+e.defaultExtension;return r.substr(r.length-o.length)!==o?r+o:r}function ft(t,e,n,r,i,a,o){if(!i){if(!n.main)return r;i="./"===n.main.substr(0,2)?n.main.substr(2):n.main}if(n.map){var s="./"+i,l=W(n.map,s);if(l||(s="./"+ht(e,n,r,i,o))!="./"+i&&(l=W(n.map,s)),l){var u=pt(t,e,n,r,l,s,a,o);if(u)return u}}return r+"/"+ht(e,n,r,i,o)}function dt(t,e,n){return!(e.substr(0,t.length)===t&&n.length>t.length)}function pt(t,e,n,r,i,a,o,s){"/"===a[a.length-1]&&(a=a.substr(0,a.length-1));var l=n.map[i];if("object"==typeof l)throw new Error("Synchronous conditional normalization not supported sync normalizing "+i+" in "+r);if(dt(i,l,a)&&"string"==typeof l)return at.call(t,e,l+a.substr(i.length),r+"/",o,o,s)}function mt(t,e,n,r,i,a,o){if(!i){if(!n.main)return Promise.resolve(r);i="./"===n.main.substr(0,2)?n.main.substr(2):n.main}var s,l;return n.map&&(s="./"+i,(l=W(n.map,s))||(s="./"+ht(e,n,r,i,o))!="./"+i&&(l=W(n.map,s))),(l?gt(t,e,n,r,l,s,a,o):Pe).then(function(t){return t?Promise.resolve(t):Promise.resolve(r+"/"+ht(e,n,r,i,o))})}function gt(t,e,n,r,i,a,o,s){"/"===a[a.length-1]&&(a=a.substr(0,a.length-1));var l=n.map[i];if("string"==typeof l)return dt(i,l,a)?ot.call(t,e,l+a.substr(i.length),r+"/",o,o,s).then(function(e){return St.call(t,e,r+"/",o)}):Pe;var u=[],c=[];for(var h in l){var f=_t(h);c.push({condition:f,map:l[h]}),u.push(v.prototype.import.call(t,f.module,r))}return Promise.all(u).then(function(t){for(var e=0;e<c.length;e++){var n=c[e].condition,r=Y(n.prop,"__useDefault"in t[e]?t[e].__useDefault:t[e]);if(!n.negate&&r||n.negate&&!r)return c[e].map}}).then(function(n){if(n)return dt(i,n,a)?ot.call(t,e,n+a.substr(i.length),r+"/",o,o,s).then(function(e){return St.call(t,e,r+"/",o)}):Pe})}function vt(t){var e=t.lastIndexOf("*"),n=Math.max(e+1,t.lastIndexOf("/"));return{length:n,regEx:new RegExp("^("+t.substr(0,n).replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,"[^\\/]+")+")(\\/|$)"),wildcard:-1!==e}}function yt(t,e){for(var n,r,i=!1,a=0;a<t.packageConfigPaths.length;a++){var o=t.packageConfigPaths[a],s=Ve[o]||(Ve[o]=vt(o));if(!(e.length<s.length)){var l=e.match(s.regEx);!l||n&&(i&&s.wildcard||!(n.length<l[1].length))||(n=l[1],i=!s.wildcard,r=n+o.substr(s.length))}}if(n)return{packageKey:n,configPath:r}}function bt(t,e,n,r,i){var a=t.pluginLoader||t;return-1===e.packageConfigKeys.indexOf(n)&&e.packageConfigKeys.push(n),a.import(n).then(function(t){Et(r.packageConfig,t,r.packageKey,!0,e),r.packageConfig.configured=!0}).catch(function(t){throw s(t,"Unable to fetch package configuration file "+n)})}function xt(t,e,n){var r;for(var i in t){var a="./"===i.substr(0,2)?"./":"";if(a&&(i=i.substr(2)),-1!==(r=i.indexOf("*"))&&i.substr(0,r)===e.substr(0,r)&&i.substr(r+1)===e.substr(e.length-i.length+r+1)&&n(i,t[a+i],i.split("/").length))return}var o=t[e]&&Object.hasOwnProperty.call(t,e)?t[e]:t["./"+e];o&&n(o,o,0)}function _t(t){var e,n,r,i=t.lastIndexOf("|");return-1!==i?(e=t.substr(i+1),n=t.substr(0,i),"~"===e[0]&&(r=!0,e=e.substr(1))):(r="~"===t[0],e="default",n=t.substr(r),-1!==Be.indexOf(n)&&(e=n,n=null)),{module:n||"@system-env",prop:e,negate:r}}function wt(t,e,n){return v.prototype.import.call(this,t.module,e).then(function(e){var r=Y(t.prop,e);if(n&&"boolean"!=typeof r)throw new TypeError("Condition did not resolve to a boolean.");return t.negate?!r:r})}function St(t,e,n){var r=t.match(Ye);if(!r)return Promise.resolve(t);var i=_t.call(this,r[0].substr(2,r[0].length-3));return wt.call(this,i,e,!1).then(function(n){if("string"!=typeof n)throw new TypeError("The condition value for "+t+" doesn't resolve to a string.");if(-1!==n.indexOf("/"))throw new TypeError("Unabled to interpolate conditional "+t+(e?" in "+e:"")+"\n\tThe condition value "+n+' cannot contain a "/" separator.');return t.replace(Ye,n)})}function kt(t,e,n){for(var r=0;r<He.length;r++){var i=He[r];e[i]&&En[i.substr(0,i.length-6)]&&n(e[i])}}function Mt(t,e){var n={};for(var r in t){var i=t[r];e>1?i instanceof Array?n[r]=[].concat(i):"object"==typeof i?n[r]=Mt(i,e-1):"packageConfig"!==r&&(n[r]=i):n[r]=i}return n}function Tt(t,e){var n=t[e];return n instanceof Array?t[e].concat([]):"object"==typeof n?Mt(n,3):t[e]}function Ct(t){if(t){if(-1!==On.indexOf(t))return Tt(this[Oe],t);throw new Error('"'+t+'" is not a valid configuration name. Must be one of '+On.join(", ")+".")}for(var e={},n=0;n<On.length;n++){var r=On[n],i=Tt(this[Oe],r);void 0!==i&&(e[r]=i)}return e}function At(t,e){var n=this,r=this[Oe];if("warnings"in t&&(r.warnings=t.warnings),"wasm"in t&&(r.wasm="undefined"!=typeof WebAssembly&&t.wasm),("production"in t||"build"in t)&&se.call(n,!!t.production,!!(t.build||En&&En.build)),!e){var i;kt(n,t,function(t){i=i||t.baseURL}),(i=i||t.baseURL)&&(r.baseURL=u(i,ue)||u("./"+i,ue),"/"!==r.baseURL[r.baseURL.length-1]&&(r.baseURL+="/")),t.paths&&j(r.paths,t.paths),kt(n,t,function(t){t.paths&&j(r.paths,t.paths)});for(var a in r.paths)-1!==r.paths[a].indexOf("*")&&(F.call(r,"Path config "+a+" -> "+r.paths[a]+" is no longer supported as wildcards are deprecated."),delete r.paths[a])}if(t.defaultJSExtensions&&F.call(r,"The defaultJSExtensions configuration option is deprecated.\n  Use packages defaultExtension instead.",!0),"boolean"==typeof t.pluginFirst&&(r.pluginFirst=t.pluginFirst),t.map)for(var a in t.map){var o=t.map[a];if("string"==typeof o){var s=it.call(n,r,o,void 0,!1,!1);"/"===s[s.length-1]&&":"!==a[a.length-1]&&"/"!==a[a.length-1]&&(s=s.substr(0,s.length-1)),r.map[a]=s}else{g=(g=it.call(n,r,"/"!==a[a.length-1]?a+"/":a,void 0,!0,!0)).substr(0,g.length-1);var l=r.packages[g];l||((l=r.packages[g]=Pt()).defaultExtension=""),Et(l,{map:o},g,!1,r)}}if(t.packageConfigPaths){for(var c=[],h=0;h<t.packageConfigPaths.length;h++){var f=t.packageConfigPaths[h],d=Math.max(f.lastIndexOf("*")+1,f.lastIndexOf("/")),p=it.call(n,r,f.substr(0,d),void 0,!1,!1);c[h]=p+f.substr(d)}r.packageConfigPaths=c}if(t.bundles)for(var a in t.bundles){for(var m=[],h=0;h<t.bundles[a].length;h++)m.push(n.normalizeSync(t.bundles[a][h]));r.bundles[a]=m}if(t.packages)for(var a in t.packages){if(a.match(/^([^\/]+:)?\/\/$/))throw new TypeError('"'+a+'" is not a valid package name.');var g=it.call(n,r,"/"!==a[a.length-1]?a+"/":a,void 0,!0,!0);g=g.substr(0,g.length-1),Et(r.packages[g]=r.packages[g]||Pt(),t.packages[a],g,!1,r)}if(t.depCache)for(var a in t.depCache)r.depCache[n.normalizeSync(a)]=[].concat(t.depCache[a]);if(t.meta)for(var a in t.meta)if("*"===a[0])j(r.meta[a]=r.meta[a]||{},t.meta[a]);else{var v=it.call(n,r,a,void 0,!0,!0);j(r.meta[v]=r.meta[v]||{},t.meta[a])}"transpiler"in t&&(r.transpiler=t.transpiler);for(var y in t)-1===On.indexOf(y)&&-1===He.indexOf(y)&&(n[y]=t[y]);kt(n,t,function(t){n.config(t,!0)})}function Pt(){return{defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1}}function Et(t,e,n,r,i){for(var a in e)"main"===a||"format"===a||"defaultExtension"===a||"configured"===a?r&&void 0!==t[a]||(t[a]=e[a]):"map"===a?(r?L:j)(t.map=t.map||{},e.map):"meta"===a?(r?L:j)(t.meta=t.meta||{},e.meta):Object.hasOwnProperty.call(e,a)&&F.call(i,'"'+a+'" is not a valid package configuration option in package '+n);return void 0===t.defaultExtension&&(t.defaultExtension="js"),void 0===t.main&&t.map&&t.map["."]?(t.main=t.map["."],delete t.map["."]):"object"==typeof t.main&&(t.map=t.map||{},t.map["./@main"]=t.main,t.main.default=t.main.default||"./",t.main="@main"),t}function Ot(t){return Qe?Je+new e(t).toString("base64"):"undefined"!=typeof btoa?Je+btoa(unescape(encodeURIComponent(t))):""}function Dt(t,e,n,r){var i=t.lastIndexOf("\n");if(e){if("object"!=typeof e)throw new TypeError("load.metadata.sourceMap must be set to an object.");e=JSON.stringify(e)}return(r?"(function(System, SystemJS) {":"")+t+(r?"\n})(System, System);":"")+("\n//# sourceURL="!=t.substr(i,15)?"\n//# sourceURL="+n+(e?"!transpiled":""):"")+(e&&Ot(e)||"")}function $t(t,e,n,r,i){We||(We=document.head||document.body||document.documentElement);var a=document.createElement("script");a.text=Dt(e,n,r,!1);var o,s=window.onerror;if(window.onerror=function(t){o=addToError(t,"Evaluating "+r),s&&s.apply(this,arguments)},It(t),i&&a.setAttribute("nonce",i),We.appendChild(a),We.removeChild(a),Rt(),window.onerror=s,o)return o}function It(t){0==Ze++&&(Xe=de.System),de.System=de.SystemJS=t}function Rt(){0==--Ze&&(de.System=de.SystemJS=Xe)}function Ft(t,e,n,r,i,a,o){if(e){if(a&&tn)return $t(t,e,n,r,a);try{It(t),!Ge&&t._nodeRequire&&(Ge=t._nodeRequire("vm"),Ke=Ge.runInThisContext("typeof System !== 'undefined' && System")===t),Ke?Ge.runInThisContext(Dt(e,n,r,!o),{filename:r+(n?"!transpiled":"")}):(0,eval)(Dt(e,n,r,!o)),Rt()}catch(t){return Rt(),t}}}function Nt(t){return"file:///"===t.substr(0,8)?t.substr(7+!!fe):en&&t.substr(0,en.length)===en?t.substr(en.length):t}function qt(t,e){return Nt(this.normalizeSync(t,e))}function jt(t){var e,n=t.lastIndexOf("!"),r=(e=-1!==n?t.substr(0,n):t).split("/");return r.pop(),r=r.join("/"),{filename:Nt(e),dirname:Nt(r)}}function Lt(t){function e(t,e){for(var n=0;n<t.length;n++)if(t[n][0]<e.index&&t[n][1]>e.index)return!0;return!1}Le.lastIndex=ln.lastIndex=un.lastIndex=0;var n,r=[],i=[],a=[];if(t.length/t.split("\n").length<200){for(;n=un.exec(t);)i.push([n.index,n.index+n[0].length]);for(;n=ln.exec(t);)e(i,n)||a.push([n.index+n[1].length,n.index+n[0].length-1])}for(;n=Le.exec(t);)if(!e(i,n)&&!e(a,n)){var o=n[1].substr(1,n[1].length-2);if(o.match(/"|'/))continue;r.push(o)}return r}function Ut(t){if(-1===cn.indexOf(t)){try{var e=de[t]}catch(e){cn.push(t)}this(t,e)}}function zt(t){if("string"==typeof t)return Y(t,de);if(!(t instanceof Array))throw new Error("Global exports must be a string or array.");for(var e={},n=0;n<t.length;n++)e[t[n].split(".").pop()]=Y(t[n],de);return e}function Vt(t,e,n,r){var i=de.define;de.define=void 0;var a;if(n){a={};for(var o in n)a[o]=de[o],de[o]=n[o]}return e||(rn={},Object.keys(de).forEach(Ut,function(t,e){rn[t]=e})),function(){var t,n=e?zt(e):{},o=!!e;if(e&&!r||Object.keys(de).forEach(Ut,function(i,a){rn[i]!==a&&void 0!==a&&(r&&(de[i]=void 0),e||(n[i]=a,void 0!==t?o||t===a||(o=!0):t=a))}),n=o?n:t,a)for(var s in a)de[s]=a[s];return de.define=i,n}}function Bt(t,e){var n=((t=t.replace(ln,"")).match(dn)[1].split(",")[e]||"require").replace(pn,""),r=mn[n]||(mn[n]=new RegExp(hn+n+fn,"g"));r.lastIndex=0;for(var i,a=[];i=r.exec(t);)a.push(i[2]||i[3]);return a}function Yt(t){return function(e,n,r){t(e,n,r),"object"!=typeof(n=r.exports)&&"function"!=typeof n||"__esModule"in n||Object.defineProperty(r.exports,"__esModule",{value:!0})}}function Ht(t,e){on=t,vn=e,an=void 0,gn=!1}function Qt(t){an?t.registerDynamic(on?an[0].concat(on):an[0],!1,vn?Yt(an[1]):an[1]):gn&&t.registerDynamic([],!1,$)}function Wt(t,e){!t.load.esModule||"object"!=typeof e&&"function"!=typeof e||"__esModule"in e||Object.defineProperty(e,"__esModule",{value:!0})}function Gt(t,e){var n=this,r=this[Oe];return(Xt(r,this,t)||Pe).then(function(){if(!e()){var i=n[De][t];if("@node/"===t.substr(0,6)){if(!n._nodeRequire)throw new TypeError("Error loading "+t+". Can only load node core modules in Node.");return n.registerDynamic([],!1,function(){return q.call(n,t.substr(6),n.baseURL)}),void e()}return i.load.scriptLoad?!i.load.pluginKey&&yn||(i.load.scriptLoad=!1,F.call(r,'scriptLoad not supported for "'+t+'"')):!1!==i.load.scriptLoad&&!i.load.pluginKey&&yn&&(i.load.deps||i.load.globals||!("system"===i.load.format||"register"===i.load.format||"global"===i.load.format&&i.load.exports)||(i.load.scriptLoad=!0)),i.load.scriptLoad?new Promise(function(r,a){if("amd"===i.load.format&&de.define!==n.amdDefine)throw new Error("Loading AMD with scriptLoad requires setting the global `"+xn+".define = SystemJS.amdDefine`");B(t,i.load.crossOrigin,i.load.integrity,function(){if(!e()){i.load.format="global";var t=i.load.exports&&zt(i.load.exports);n.registerDynamic([],!1,function(){return Wt(i,t),t}),e()}r()},a)}):Kt(n,t,i).then(function(){return Jt(n,t,i,e,r.wasm)})}}).then(function(e){return delete n[De][t],e})}function Kt(t,e,n){return n.pluginKey?t.import(n.pluginKey).then(function(t){n.pluginModule=t,n.pluginLoad={name:e,address:n.pluginArgument,source:void 0,metadata:n.load},n.load.deps=n.load.deps||[]}):Pe}function Xt(t,e,n){var r=t.depCache[n];if(r)for(o=0;o<r.length;o++)e.normalize(r[o],n).then(z);else{var i=!1;for(var a in t.bundles){for(var o=0;o<t.bundles[a].length;o++){var s=t.bundles[a][o];if(s===n){i=!0;break}if(-1!==s.indexOf("*")){var l=s.split("*");if(2!==l.length){t.bundles[a].splice(o--,1);continue}if(n.substr(0,l[0].length)===l[0]&&n.substr(n.length-l[1].length,l[1].length)===l[1]){i=!0;break}}}if(i)return e.import(a)}}}function Jt(t,e,n,r,i){return n.load.exports&&!n.load.format&&(n.load.format="global"),Pe.then(function(){if(n.pluginModule&&n.pluginModule.locate)return Promise.resolve(n.pluginModule.locate.call(t,n.pluginLoad)).then(function(t){t&&(n.pluginLoad.address=t)})}).then(function(){return n.pluginModule?(i=!1,n.pluginModule.fetch?n.pluginModule.fetch.call(t,n.pluginLoad,function(t){return ze(t.address,n.load.authorization,n.load.integrity,!1)}):ze(n.pluginLoad.address,n.load.authorization,n.load.integrity,!1)):ze(e,n.load.authorization,n.load.integrity,i)}).then(function(a){return i&&"string"!=typeof a?N(t,a,r).then(function(i){if(!i){var o=ce?new TextDecoder("utf-8").decode(new Uint8Array(a)):a.toString();return Zt(t,e,o,n,r)}}):Zt(t,e,a,n,r)})}function Zt(t,e,n,r,i){return Promise.resolve(n).then(function(e){return"detect"===r.load.format&&(r.load.format=void 0),ae(e,r),r.pluginModule?(r.pluginLoad.source=e,r.pluginModule.translate?Promise.resolve(r.pluginModule.translate.call(t,r.pluginLoad,r.traceOpts)).then(function(t){if(r.load.sourceMap){if("object"!=typeof r.load.sourceMap)throw new Error("metadata.load.sourceMap must be set to an object.");ne(r.pluginLoad.address,r.load.sourceMap)}return"string"==typeof t?t:r.pluginLoad.source}):e):e}).then(function(n){return r.load.format||'"bundle"'!==n.substring(0,8)?"register"===r.load.format||!r.load.format&&te(n)?(r.load.format="register",n):"esm"===r.load.format||!r.load.format&&n.match(_n)?(r.load.format="esm",re(t,n,e,r,i)):n:(r.load.format="system",n)}).then(function(e){if("string"!=typeof e||!r.pluginModule||!r.pluginModule.instantiate)return e;var n=!1;return r.pluginLoad.source=e,Promise.resolve(r.pluginModule.instantiate.call(t,r.pluginLoad,function(t){if(e=t.source,r.load=t.metadata,n)throw new Error("Instantiate must only be called once.");n=!0})).then(function(t){return n?e:I(t)})}).then(function(n){if("string"!=typeof n)return n;r.load.format||(r.load.format=ee(n));var a=!1;switch(r.load.format){case"esm":case"register":case"system":if(l=Ft(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1))throw l;if(!i())return Ee;return;case"json":var o=JSON.parse(n);return t.newModule({default:o,__useDefault:o});case"amd":var s=de.define;de.define=t.amdDefine,Ht(r.load.deps,r.load.esModule);var l=Ft(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1);if((a=i())||(Qt(t),a=i()),de.define=s,l)throw l;break;case"cjs":var u=r.load.deps,c=(r.load.deps||[]).concat(r.load.cjsRequireDetection?Lt(n):[]);for(var h in r.load.globals)r.load.globals[h]&&c.push(r.load.globals[h]);t.registerDynamic(c,!0,function(i,a,o){if(i.resolve=function(e){return qt.call(t,e,o.id)},o.paths=[],o.require=i,!r.load.cjsDeferDepsExecute&&u)for(var s=0;s<u.length;s++)i(u[s]);var l=jt(o.id),c={exports:a,args:[i,a,o,l.filename,l.dirname,de,de]},h="(function (require, exports, module, __filename, __dirname, global, GLOBAL";if(r.load.globals)for(var f in r.load.globals)c.args.push(i(r.load.globals[f])),h+=", "+f;var d=de.define;de.define=void 0,de.__cjsWrapper=c,n=h+") {"+n.replace(Mn,"")+"\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);";var p=Ft(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1);if(p)throw p;Wt(r,a),de.__cjsWrapper=void 0,de.define=d}),a=i();break;case"global":c=r.load.deps||[];for(var h in r.load.globals){var f=r.load.globals[h];f&&c.push(f)}t.registerDynamic(c,!1,function(i,a,o){var s;if(r.load.globals){s={};for(var l in r.load.globals)r.load.globals[l]&&(s[l]=i(r.load.globals[l]))}var u=r.load.exports;u&&(n+="\n"+xn+'["'+u+'"] = '+u+";");var c=Vt(o.id,u,s,r.load.encapsulateGlobal),h=Ft(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!0);if(h)throw h;var f=c();return Wt(r,f),f}),a=i();break;default:throw new TypeError('Unknown module format "'+r.load.format+'" for "'+e+'".'+("es6"===r.load.format?' Use "esm" instead here.':""))}if(!a)throw new Error("Module "+e+" detected as "+r.load.format+" but didn't execute correctly.")})}function te(t){var e=t.match(wn);return e&&"System.register"===t.substr(e[0].length,15)}function ee(t){return t.match(Sn)?"amd":(kn.lastIndex=0,Le.lastIndex=0,Le.exec(t)||kn.exec(t)?"cjs":"global")}function ne(t,e){var n=t.split("!")[0];e.file&&e.file!=t||(e.file=n+"!transpiled"),(!e.sources||e.sources.length<=1&&(!e.sources[0]||e.sources[0]===t))&&(e.sources=[n])}function re(t,e,n,r,i){if(!t.transpiler)throw new TypeError("Unable to dynamically transpile ES module\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: 'transpiler-module' })`.");if(r.load.deps){for(var a="",o=0;o<r.load.deps.length;o++)a+='import "'+r.load.deps[o]+'"; ';e=a+e}return t.import.call(t,t.transpiler).then(function(i){if(!(i=i.__useDefault||i).translate)throw new Error(t.transpiler+" is not a valid transpiler plugin.");return i===r.pluginModule?e:("string"==typeof r.load.sourceMap&&(r.load.sourceMap=JSON.parse(r.load.sourceMap)),r.pluginLoad=r.pluginLoad||{name:n,address:n,source:e,metadata:r.load},r.load.deps=r.load.deps||[],Promise.resolve(i.translate.call(t,r.pluginLoad,r.traceOpts)).then(function(t){var e=r.load.sourceMap;return e&&"object"==typeof e&&ne(n,e),"esm"===r.load.format&&te(t)&&(r.load.format="register"),t}))},function(t){throw s(t,"Unable to load transpiler to transpile "+n)})}function ie(t,e,n){for(var r,i=e.split(".");i.length>1;)t=t[r=i.shift()]=t[r]||{};void 0===t[r=i.shift()]&&(t[r]=n)}function ae(t,e){var n=t.match(Tn);if(n)for(var r=n[0].match(Cn),i=0;i<r.length;i++){var a=r[i],o=a.length,s=a.substr(0,1);if(";"==a.substr(o-1,1)&&o--,'"'==s||"'"==s){var l=a.substr(1,a.length-3),u=l.substr(0,l.indexOf(" "));if(u){var c=l.substr(u.length+1,l.length-u.length-1);"deps"===u&&(u="deps[]"),"[]"===u.substr(u.length-2,2)?(u=u.substr(0,u.length-2),e.load[u]=e.load[u]||[],e.load[u].push(c)):"use"!==u&&ie(e.load,u,c)}else e.load[l]=!0}}}function oe(){v.call(this),this._loader={},this[De]={},this[Oe]={baseURL:ue,paths:{},packageConfigPaths:[],packageConfigKeys:[],map:{},packages:{},depCache:{},meta:{},bundles:{},production:!1,transpiler:void 0,loadedBundles:{},warnings:!1,pluginFirst:!1,wasm:!1},this.scriptSrc=bn,this._nodeRequire=sn,this.registry.set("@empty",Ee),se.call(this,!1,!1),nn(this)}function se(t,e){this[Oe].production=t,this.registry.set("@system-env",En=this.newModule({browser:ce,node:!!this._nodeRequire,production:!e&&t,dev:e||!t,build:e,default:!0}))}function le(t,e){F.call(t[Oe],"SystemJS."+e+" is deprecated for SystemJS.registry."+e)}var ue,ce="undefined"!=typeof window&&"undefined"!=typeof document,he=void 0!==r&&r.versions&&r.versions.node,fe=void 0!==r&&"string"==typeof r.platform&&r.platform.match(/^win/),de="undefined"!=typeof self?self:i,pe="undefined"!=typeof Symbol;if("undefined"!=typeof document&&document.getElementsByTagName){if(!(ue=document.baseURI)){var me=document.getElementsByTagName("base");ue=me[0]&&me[0].href||window.location.href}}else"undefined"!=typeof location&&(ue=location.href);if(ue){var ge=(ue=ue.split("#")[0].split("?")[0]).lastIndexOf("/");-1!==ge&&(ue=ue.substr(0,ge+1))}else{if(void 0===r||!r.cwd)throw new TypeError("No environment baseURI");ue="file://"+(fe?"/":"")+r.cwd(),fe&&(ue=ue.replace(/\\/g,"/"))}"/"!==ue[ue.length-1]&&(ue+="/");var ve="_"==new Error(0,"_").fileName,ye=Promise.resolve();h.prototype.constructor=h,h.prototype.import=function(t,e){if("string"!=typeof t)throw new TypeError("Loader import method must be passed a module key string");var n=this;return ye.then(function(){return n[xe](t,e)}).then(f).catch(function(n){throw s(n,"Loading "+t+(e?" from "+e:""))})};var be=h.resolve=o("resolve"),xe=h.resolveInstantiate=o("resolveInstantiate");h.prototype[xe]=function(t,e){var n=this;return n.resolve(t,e).then(function(t){return n.registry.get(t)})},h.prototype.resolve=function(t,e){var n=this;return ye.then(function(){return n[be](t,e)}).then(d).catch(function(n){throw s(n,"Resolving "+t+(e?" to "+e:""))})};var _e="undefined"!=typeof Symbol&&Symbol.iterator,we=o("registry");_e&&(p.prototype[Symbol.iterator]=function(){return this.entries()[Symbol.iterator]()},p.prototype.entries=function(){var t=this[we];return c(Object.keys(t).map(function(e){return[e,t[e]]}))}),p.prototype.keys=function(){return c(Object.keys(this[we]))},p.prototype.values=function(){var t=this[we];return c(Object.keys(t).map(function(e){return t[e]}))},p.prototype.get=function(t){return this[we][t]},p.prototype.set=function(t,e){if(!(e instanceof m))throw new Error("Registry must be set with an instance of Module Namespace");return this[we][t]=e,this},p.prototype.has=function(t){return Object.hasOwnProperty.call(this[we],t)},p.prototype.delete=function(t){return!!Object.hasOwnProperty.call(this[we],t)&&(delete this[we][t],!0)};var Se=o("baseObject");m.prototype=Object.create(null),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(m.prototype,Symbol.toStringTag,{value:"Module"});var ke=o("register-internal");v.prototype=Object.create(h.prototype),v.prototype.constructor=v;var Me=v.instantiate=o("instantiate");v.prototype[v.resolve=h.resolve]=function(t,e){return u(t,e||ue)},v.prototype[Me]=function(t,e){},v.prototype[h.resolveInstantiate]=function(t,e){var n=this,r=this[ke],i=this.registry[we];return b(n,t,e,i,r).then(function(t){if(t instanceof m)return t;var e=t.linkRecord;if(!e){if(t.module)return t.module;throw t.evalError}return T(n,t,e,i,r).then(function(){return A(n,t,e,i,r,void 0)})})},v.prototype.register=function(t,e,n){var r=this[ke];void 0===n?r.lastRegister=[t,e,void 0]:(r.records[t]||y(r,t,void 0)).registration=[e,n,void 0]},v.prototype.registerDynamic=function(t,e,n,r){var i=this[ke];"string"!=typeof t?i.lastRegister=[t,e,n]:(i.records[t]||y(i,t,void 0)).registration=[e,n,r]},C.prototype.import=function(t){return this.loader.trace&&this.loader.loads[this.key].dynamicDeps.push(t),this.loader.import(t,this.key)};var Te={};Object.freeze&&Object.freeze(Te);var Ce,Ae,Pe=Promise.resolve(),Ee=new m({}),Oe=o("loader-config"),De=o("metadata"),$e="undefined"==typeof window&&"undefined"!=typeof self&&"undefined"!=typeof importScripts,Ie=!1,Re=!1;if(ce&&function(){var t=document.createElement("link").relList;if(t&&t.supports){Re=!0;try{Ie=t.supports("preload")}catch(t){}}}(),ce){var Fe=[],Ne=window.onerror;window.onerror=function(t,e){for(var n=0;n<Fe.length;n++)if(Fe[n].src===e)return void Fe[n].err(t);Ne&&Ne.apply(this,arguments)}}var qe,je,Le=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF."'])require\s*\(\s*("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*'|`[^`\\]*(?:\\.[^`\\]*)*`)\s*\)/g,Ue="undefined"!=typeof XMLHttpRequest,ze=je="undefined"!=typeof self&&void 0!==self.fetch?G:Ue?K:void 0!==r?X:J,Ve={},Be=["browser","node","dev","build","production","default"],Ye=/#\{[^\}]+\}/,He=["browserConfig","nodeConfig","devConfig","buildConfig","productionConfig"],Qe=void 0!==e;try{Qe&&"YQ=="!==new e("a").toString("base64")&&(Qe=!1)}catch(o){Qe=!1}var We,Ge,Ke,Xe,Je="\n//# sourceMappingURL=data:application/json;base64,",Ze=0,tn=!1;ce&&"undefined"!=typeof document&&document.getElementsByTagName&&(window.chrome&&window.chrome.extension||navigator.userAgent.match(/^Node\.js/)||(tn=!0));var en,nn=function(t){function e(n,r,i,a){if("object"==typeof n&&!(n instanceof Array))return e.apply(null,Array.prototype.splice.call(arguments,1,arguments.length-1));if("string"==typeof n&&"function"==typeof r&&(n=[n]),!(n instanceof Array)){if("string"==typeof n){var o=t.decanonicalize(n,a),s=t.get(o);if(!s)throw new Error('Module not already loaded loading "'+n+'" as '+o+(a?' from "'+a+'".':"."));return"__useDefault"in s?s.__useDefault:s}throw new TypeError("Invalid require")}for(var l=[],u=0;u<n.length;u++)l.push(t.import(n[u],a));Promise.all(l).then(function(t){r&&r.apply(null,t)},i)}function n(n,r,i){function a(n,a,u){for(var c=[],h=0;h<r.length;h++)c.push(n(r[h]));if(u.uri=u.id,u.config=$,-1!==l&&c.splice(l,0,u),-1!==s&&c.splice(s,0,a),-1!==o){var f=function(r,i,a){return"string"==typeof r&&"function"!=typeof i?n(r):e.call(t,r,i,a,u.id)};f.toUrl=function(e){return t.normalizeSync(e,u.id)},c.splice(o,0,f)}var d=de.require;de.require=e;var p=i.apply(-1===s?de:a,c);de.require=d,void 0!==p&&(u.exports=p)}"string"!=typeof n&&(i=r,r=n,n=null),r instanceof Array||(i=r,r=["require","exports","module"].splice(0,i.length)),"function"!=typeof i&&(i=function(t){return function(){return t}}(i)),n||on&&(r=r.concat(on),on=void 0);var o,s,l;-1!==(o=r.indexOf("require"))&&(r.splice(o,1),n||(r=r.concat(Bt(i.toString(),o)))),-1!==(s=r.indexOf("exports"))&&r.splice(s,1),-1!==(l=r.indexOf("module"))&&r.splice(l,1),n?(t.registerDynamic(n,r,!1,a),an?(an=void 0,gn=!0):gn||(an=[r,a])):t.registerDynamic(r,!1,vn?Yt(a):a)}t.set("@@cjs-helpers",t.newModule({requireResolve:qt.bind(t),getPathVars:jt})),t.set("@@global-helpers",t.newModule({prepareGlobal:Vt})),n.amd={},t.amdDefine=n,t.amdRequire=e};"undefined"!=typeof window&&"undefined"!=typeof document&&window.location&&(en=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""));var rn,an,on,sn,ln=/(^|[^\\])(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,un=/("[^"\\\n\r]*(\\.[^"\\\n\r]*)*"|'[^'\\\n\r]*(\\.[^'\\\n\r]*)*')/g,cn=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"],hn="(?:^|[^$_a-zA-Z\\xA0-\\uFFFF.])",fn="\\s*\\(\\s*(\"([^\"]+)\"|'([^']+)')\\s*\\)",dn=/\(([^\)]*)\)/,pn=/^\s+|\s+$/g,mn={},gn=!1,vn=!1,yn=(ce||$e)&&"undefined"!=typeof navigator&&navigator.userAgent&&!navigator.userAgent.match(/MSIE (9|10).0/);void 0===r||r.browser||(sn=void 0);var bn,xn="undefined"!=typeof self?"self":"global",_n=/(^\s*|[}\);\n]\s*)(import\s*(['"]|(\*\s+as\s+)?(?!type)([^"'\(\)\n; ]+)\s*from\s*['"]|\{)|export\s+\*\s+from\s+["']|export\s*(\{|default|function|class|var|const|let|async\s+function))/,wn=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)*\s*/,Sn=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])define\s*\(\s*("[^"]+"\s*,\s*|'[^']+'\s*,\s*)?\s*(\[(\s*(("[^"]+"|'[^']+')\s*,|\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*(\s*("[^"]+"|'[^']+')\s*,?)?(\s*(\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*\s*\]|function\s*|{|[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*\))/,kn=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])(exports\s*(\[['"]|\.)|module(\.exports|\['exports'\]|\["exports"\])\s*(\[['"]|[=,\.]))/,Mn=/^\#\!.*/,Tn=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)+/,Cn=/\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\/\/[^\n]*|"[^"]+"\s*;?|'[^']+'\s*;?/g;if("undefined"==typeof Promise)throw new Error("SystemJS needs a Promise polyfill.");if("undefined"!=typeof document){var An=document.getElementsByTagName("script"),Pn=An[An.length-1];document.currentScript&&(Pn.defer||Pn.async)&&(Pn=document.currentScript),bn=Pn&&Pn.src}else if("undefined"!=typeof importScripts)try{throw new Error("_")}catch(o){o.stack.replace(/(?:at|@).*(http.+):[\d]+:[\d]+/,function(t,e){bn=e})}else void 0!==a&&(bn=a);var En;oe.prototype=Object.create(v.prototype),oe.prototype.constructor=oe,oe.prototype[oe.resolve=v.resolve]=oe.prototype.normalize=et,oe.prototype.load=function(t,e){return F.call(this[Oe],"System.load is deprecated."),this.import(t,e)},oe.prototype.decanonicalize=oe.prototype.normalizeSync=oe.prototype.resolveSync=rt,oe.prototype[oe.instantiate=v.instantiate]=Gt,oe.prototype.config=At,oe.prototype.getConfig=Ct,oe.prototype.global=de,oe.prototype.import=function(){return v.prototype.import.apply(this,arguments).then(function(t){return"__useDefault"in t?t.__useDefault:t})};for(var On=["baseURL","map","paths","packages","packageConfigPaths","depCache","meta","bundles","transpiler","warnings","pluginFirst","production","wasm"],Dn="undefined"!=typeof Proxy,$n=0;$n<On.length;$n++)!function(t){Object.defineProperty(oe.prototype,t,{get:function(){var e=Tt(this[Oe],t);return Dn&&"object"==typeof e&&(e=new Proxy(e,{set:function(e,n){throw new Error("Cannot set SystemJS."+t+'["'+n+'"] directly. Use SystemJS.config({ '+t+': { "'+n+'": ... } }) rather.')}})),e},set:function(e){throw new Error("Setting `SystemJS."+t+"` directly is no longer supported. Use `SystemJS.config({ "+t+": ... })`.")}})}(On[$n]);oe.prototype.delete=function(t){return le(this,"delete"),this.registry.delete(t)},oe.prototype.get=function(t){return le(this,"get"),this.registry.get(t)},oe.prototype.has=function(t){return le(this,"has"),this.registry.has(t)},oe.prototype.set=function(t,e){return le(this,"set"),this.registry.set(t,e)},oe.prototype.newModule=function(t){return new m(t)},oe.prototype.isModule=R,oe.prototype.register=function(t,e,n){return"string"==typeof t&&(t=nt.call(this,this[Oe],t)),v.prototype.register.call(this,t,e,n)},oe.prototype.registerDynamic=function(t,e,n,r){return"string"==typeof t&&(t=nt.call(this,this[Oe],t)),v.prototype.registerDynamic.call(this,t,e,n,r)},oe.prototype.version="0.20.19 Dev";var In=new oe;(ce||$e)&&(de.SystemJS=de.System=In),void 0!==t&&t.exports&&(t.exports=In)}()}).call(e,n(912).Buffer,n(916),n(40),"/index.js")},function(t,e,n){"use strict";(function(t){function r(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=a.prototype):(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return o(this,t,e,n)}function o(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?f(t,e,n,r):"string"==typeof e?c(t,e,n):d(t,e)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,n,r){return s(e),e<=0?i(t,e):void 0!==n?"string"==typeof r?i(t,e).fill(n,r):i(t,e).fill(n):i(t,e)}function u(t,e){if(s(e),t=i(t,e<0?0:0|p(e)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(e,n);t=i(t,r);var o=t.write(e,n);return o!==r&&(t=t.slice(0,o)),t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=i(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),a.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=a.prototype):t=h(t,e),t}function d(t,e){if(a.isBuffer(e)){var n=0|p(e.length);return t=i(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||G(e.length)?i(t,0):h(t,e);if("Buffer"===e.type&&J(e.data))return h(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function m(t){return+t!=t&&(t=0),a.alloc(+t)}function g(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(t).length;default:if(r)return B(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return E(this,e,n);case"latin1":case"binary":return O(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:x(t,e,n,r,i);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):x(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function x(t,e,n,r,i){function a(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,l/=2,n/=2}var u;if(i){var c=-1;for(u=n;u<s;u++)if(a(t,u)===a(e,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===l)return c*o}else-1!==c&&(u-=u-c),c=-1}else for(n+l>s&&(n=s-l),u=n;u>=0;u--){for(var h=!0,f=0;f<l;f++)if(a(t,u+f)!==a(e,f)){h=!1;break}if(h)return u}return-1}function _(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function w(t,e,n,r){return W(B(e,t.length-n),t,n,r)}function S(t,e,n,r){return W(Y(e),t,n,r)}function k(t,e,n,r){return S(t,e,n,r)}function M(t,e,n,r){return W(Q(e),t,n,r)}function T(t,e,n,r){return W(H(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a=t[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=n){var l,u,c,h;switch(s){case 1:a<128&&(o=a);break;case 2:l=t[i+1],128==(192&l)&&(h=(31&a)<<6|63&l)>127&&(o=h);break;case 3:l=t[i+1],u=t[i+2],128==(192&l)&&128==(192&u)&&(h=(15&a)<<12|(63&l)<<6|63&u)>2047&&(h<55296||h>57343)&&(o=h);break;case 4:l=t[i+1],u=t[i+2],c=t[i+3],128==(192&l)&&128==(192&u)&&128==(192&c)&&(h=(15&a)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&h<1114112&&(o=h)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return P(r)}function P(t){var e=t.length;if(e<=Z)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Z));return n}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function D(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=V(t[a]);return i}function $(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,i,o){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function F(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function q(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,i){return i||q(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,i){return i||q(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(t,e,n,r,52,8),n+8}function U(t){if(t=z(t).replace(tt,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function V(t){return t<16?"0"+t.toString(16):t.toString(16)}function B(t,e){e=e||1/0;for(var n,r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function Y(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function H(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}function Q(t){return K.toByteArray(U(t))}function W(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function G(t){return t!==t}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var K=n(913),X=n(914),J=n(915);e.Buffer=a,e.SlowBuffer=m,e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),a.poolSize=8192,a._augment=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,n){return o(null,t,e,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,n){return l(null,t,e,n)},a.allocUnsafe=function(t){return u(null,t)},a.allocUnsafeSlow=function(t){return u(null,t)},a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!J(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=a.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):v.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,n,r,i){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,l=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n),h=0;h<l;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return S(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return M(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;a.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=a.prototype;else{var i=e-t;r=new a(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},a.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},a.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},a.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*e)),a},a.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),X.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),X.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),X.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),X.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){R(this,t,e,n,Math.pow(2,8*n)-1,0)}var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},a.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){R(this,t,e,n,Math.pow(2,8*n)-1,0)}var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},a.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},a.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var o;if("number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=a.isBuffer(t)?t:B(new a(t,r).toString()),l=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%l]}return this};var tt=/[^+\/0-9A-Za-z-_]/g}).call(e,n(40))},function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function i(t){return 3*t.length/4-r(t)}function a(t){var e,n,i,a,o,s=t.length;a=r(t),o=new h(3*s/4-a),n=a>0?s-4:s;var l=0;for(e=0;e<n;e+=4)i=c[t.charCodeAt(e)]<<18|c[t.charCodeAt(e+1)]<<12|c[t.charCodeAt(e+2)]<<6|c[t.charCodeAt(e+3)],o[l++]=i>>16&255,o[l++]=i>>8&255,o[l++]=255&i;return 2===a?(i=c[t.charCodeAt(e)]<<2|c[t.charCodeAt(e+1)]>>4,o[l++]=255&i):1===a&&(i=c[t.charCodeAt(e)]<<10|c[t.charCodeAt(e+1)]<<4|c[t.charCodeAt(e+2)]>>2,o[l++]=i>>8&255,o[l++]=255&i),o}function o(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function s(t,e,n){for(var r,i=[],a=e;a<n;a+=3)r=(t[a]<<16)+(t[a+1]<<8)+t[a+2],i.push(o(r));return i.join("")}function l(t){for(var e,n=t.length,r=n%3,i="",a=[],o=0,l=n-r;o<l;o+=16383)a.push(s(t,o,o+16383>l?l:o+16383));return 1===r?(e=t[n-1],i+=u[e>>2],i+=u[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=u[e>>10],i+=u[e>>4&63],i+=u[e<<2&63],i+="="),a.push(i),a.join("")}e.byteLength=i,e.toByteArray=a,e.fromByteArray=l;for(var u=[],c=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,p=f.length;d<p;++d)u[d]=f[d],c[f.charCodeAt(d)]=d;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?i-1:0,f=n?-1:1,d=t[e+h];for(h+=f,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+t[e+h],h+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+t[e+h],h+=f,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=u}return(d?-1:1)*o*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),e+=o+h>=1?f/l:f*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(e*l-1)*Math.pow(2,i),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*m}},function(t,e){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function a(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function o(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&s())}function s(){if(!m){var t=i(o);m=!0;for(var e=p.length;e;){for(d=p,p=[];++g<e;)d&&d[g].run();g=-1,e=p.length}d=null,m=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function u(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var d,p=[],m=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new l(t,e)),1!==p.length||m||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",function(){return g});var r=n(21),i=n.n(r),a=n(10),o=n.n(a),s=n(4),l=n.n(s),u=n(109),c=n.n(u),h=n(804),f=n(295),d=n(292),p=n(919),m=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.editorTabIndex=1,r.$q=n.get("$q"),r.datasourceSrv=n.get("datasourceSrv"),r.timeSrv=n.get("timeSrv"),r.templateSrv=n.get("templateSrv"),r.scope=e,r.panel.datasource=r.panel.datasource||null,r.panel.targets||(r.panel.targets=[{}]),r.events.on("refresh",r.onMetricsPanelRefresh.bind(r)),r.events.on("init-edit-mode",r.onInitMetricsPanelEditMode.bind(r)),r.events.on("panel-teardown",r.onPanelTearDown.bind(r)),r}return m(e,t),e.prototype.onPanelTearDown=function(){this.dataSubscription&&(this.dataSubscription.unsubscribe(),this.dataSubscription=null)},e.prototype.onInitMetricsPanelEditMode=function(){this.addEditorTab("Metrics",p.a),this.addEditorTab("Time range","public/app/features/panel/partials/panelTime.html")},e.prototype.onMetricsPanelRefresh=function(){var t=this;if(!this.otherPanelInFullscreenMode()){if(this.panel.snapshotData){this.updateTimeRange();var e=this.panel.snapshotData;return l.a.isArray(e)||(e=e.data),void this.events.emit("data-snapshot-load",e)}this.dataStream||(delete this.error,this.loading=!0,this.setTimeQueryStart(),this.datasourceSrv.get(this.panel.datasource).then(this.updateTimeRange.bind(this)).then(this.issueQueries.bind(this)).then(this.handleQueryResult.bind(this)).catch(function(e){if(e.cancelled)return void console.log("Panel request cancelled",e);t.loading=!1,t.error=e.message||"Request Error",t.inspector={error:e},e.data&&(e.data.message&&(t.error=e.data.message),e.data.error&&(t.error=e.data.error)),t.events.emit("data-error",e),console.log("Panel data error:",e)}))}},e.prototype.setTimeQueryStart=function(){this.timing.queryStart=(new Date).getTime()},e.prototype.setTimeQueryEnd=function(){this.timing.queryEnd=(new Date).getTime()},e.prototype.updateTimeRange=function(t){return this.datasource=t||this.datasource,this.range=this.timeSrv.timeRange(),this.applyPanelTimeOverrides(),this.panel.maxDataPoints?this.resolution=this.panel.maxDataPoints:this.resolution=Math.ceil(o()(window).width()*(this.panel.span/12)),this.calculateInterval(),this.datasource},e.prototype.calculateInterval=function(){var t=this.panel.interval;t?t=this.templateSrv.replace(t,this.panel.scopedVars):this.datasource&&this.datasource.interval&&(t=this.datasource.interval);var e=c.a.calculateInterval(this.range,this.resolution,t);this.interval=e.interval,this.intervalMs=e.intervalMs},e.prototype.applyPanelTimeOverrides=function(){if(this.timeInfo="",this.panel.timeFrom){var t=this.templateSrv.replace(this.panel.timeFrom,this.panel.scopedVars),e=f.describeTextRange(t);if(e.invalid)return void(this.timeInfo="invalid time override");if(l.a.isString(this.range.raw.from)){var n=d.parse(e.from);this.timeInfo=e.display,this.range.from=n,this.range.to=d.parse(e.to),this.range.raw.from=e.from,this.range.raw.to=e.to}}if(this.panel.timeShift){var r=this.templateSrv.replace(this.panel.timeShift,this.panel.scopedVars);if(f.describeTextRange(r).invalid)return void(this.timeInfo="invalid timeshift");var i="-"+r;this.timeInfo+=" timeshift "+i,this.range.from=d.parseDateMath(i,this.range.from,!1),this.range.to=d.parseDateMath(i,this.range.to,!0),this.range.raw={from:this.range.from,to:this.range.to}}this.panel.hideTimeOverride&&(this.timeInfo="")},e.prototype.issueQueries=function(t){if(this.datasource=t,!this.panel.targets||0===this.panel.targets.length)return this.$q.when([]);var e=Object.assign({},this.panel.scopedVars,{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:this.intervalMs,value:this.intervalMs}}),n={timezone:this.dashboard.getTimezone(),panelId:this.panel.id,range:this.range,rangeRaw:this.range.raw,interval:this.interval,intervalMs:this.intervalMs,targets:this.panel.targets,format:"png"===this.panel.renderer?"png":"json",maxDataPoints:this.resolution,scopedVars:e,cacheTimeout:this.panel.cacheTimeout};return t.query(n)},e.prototype.handleQueryResult=function(t){if(this.setTimeQueryEnd(),this.loading=!1,t&&t.subscribe)return void this.handleDataStream(t);this.dashboard.snapshot&&(this.panel.snapshotData=t.data),t&&t.data||(console.log("Data source query result invalid, missing data field:",t),t={data:[]}),this.events.emit("data-received",t.data)},e.prototype.handleDataStream=function(t){var e=this;if(this.dataStream)return void console.log("two stream observables!");this.dataStream=t,this.dataSubscription=t.subscribe({next:function(t){console.log("dataSubject next!"),t.range&&(e.range=t.range),e.events.emit("data-received",t.data)},error:function(t){e.events.emit("data-error",t),console.log("panel: observer got error")},complete:function(){console.log("panel: observer got complete"),e.dataStream=null}})},e.prototype.setDatasource=function(t){var e=this;t.meta.mixed?l.a.each(this.panel.targets,function(t){t.datasource=e.panel.datasource,t.datasource||(t.datasource=i.a.defaultDatasource)}):this.datasource&&this.datasource.meta.mixed&&l.a.each(this.panel.targets,function(t){delete t.datasource}),this.panel.datasource=t.value,this.datasourceName=t.name,this.datasource=null,this.refresh()},e.prototype.addQuery=function(t){t.refId=this.dashboard.getNextQueryLetter(this.panel),this.panel.targets.push(t),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel)},e.prototype.removeQuery=function(t){var e=l.a.indexOf(this.panel.targets,t);this.panel.targets.splice(e,1),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.refresh()},e.prototype.moveQuery=function(t,e){var n=l.a.indexOf(this.panel.targets,t);l.a.move(this.panel.targets,n,n+e)},e}(h.a)},function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/panel/partials/metrics_tab.html",controller:o}}e.a=r;var i=n(294),a=n.n(i),o=function(){function t(t,e,n,r){this.$sce=e,this.backendSrv=r,this.panelCtrl=t.ctrl,t.ctrl=this,this.panel=this.panelCtrl.panel,this.dashboard=this.panelCtrl.dashboard,this.datasources=n.getMetricSources(),this.panelDsValue=this.panelCtrl.panel.datasource;for(var i=0,a=this.datasources;i<a.length;i++){var o=a[i];o.value===this.panelDsValue&&(this.datasourceInstance=o)}this.addQueryDropdown={text:"Add Query",value:null,fake:!0},this.panelCtrl.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.updateDatasourceOptions()}return t.$inject=["$scope","$sce","datasourceSrv","backendSrv"],t.prototype.updateDatasourceOptions=function(){this.datasourceInstance&&(this.hasQueryHelp=this.datasourceInstance.meta.hasQueryHelp,this.queryOptions=this.datasourceInstance.meta.queryOptions)},t.prototype.getOptions=function(t){return Promise.resolve(this.datasources.filter(function(e){return t||!e.meta.builtIn}).map(function(t){return{value:t.value,text:t.name,datasource:t}}))},t.prototype.datasourceChanged=function(t){t&&(this.datasourceInstance=t.datasource,this.panelCtrl.setDatasource(t.datasource),this.updateDatasourceOptions())},t.prototype.addMixedQuery=function(t){t&&(this.panelCtrl.addQuery({isNew:!0,datasource:t.datasource.name}),this.addQueryDropdown={text:"Add Query",value:null,fake:!0})},t.prototype.addQuery=function(){this.panelCtrl.addQuery({isNew:!0})},t.prototype.toggleHelp=function(){var t=this;this.optionsOpen=!1,this.queryTroubleshooterOpen=!1,this.helpOpen=!this.helpOpen,this.backendSrv.get("/api/plugins/"+this.datasourceInstance.meta.id+"/markdown/query_help").then(function(e){var n=new a.a;t.helpHtml=t.$sce.trustAsHtml(n.render(e))})},t.prototype.toggleOptions=function(){this.helpOpen=!1,this.queryTroubleshooterOpen=!1,this.optionsOpen=!this.optionsOpen},t.prototype.toggleQueryTroubleshooter=function(){this.helpOpen=!1,this.optionsOpen=!1,this.queryTroubleshooterOpen=!this.queryTroubleshooterOpen},t}()},function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/alerting/partials/alert_tab.html",controller:f}}e.a=r;var i=n(4),a=n.n(i),o=n(921),s=n(800),l=n(799),u=n(21),c=n.n(u),h=n(39),f=function(){function t(t,e,n,r,i,a){this.$scope=t,this.backendSrv=e,this.dashboardSrv=n,this.uiSegmentSrv=r,this.$q=i,this.datasourceSrv=a,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.subTabIndex=0,this.evalFunctions=l.a.evalFunctions,this.evalOperators=l.a.evalOperators,this.conditionTypes=l.a.conditionTypes,this.noDataModes=l.a.noDataModes,this.executionErrorModes=l.a.executionErrorModes,this.appSubUrl=c.a.appSubUrl}return t.$inject=["$scope","backendSrv","dashboardSrv","uiSegmentSrv","$q","datasourceSrv"],t.prototype.$onInit=function(){var t=this;this.addNotificationSegment=this.uiSegmentSrv.newPlusButton();var e=this.graphThresholdChanged.bind(this);return this.panelCtrl.events.on("threshold-changed",e),this.$scope.$on("$destroy",function(){t.panelCtrl.events.off("threshold-changed",e),t.panelCtrl.editingThresholds=!1,t.panelCtrl.render()}),this.notifications=[],this.alertNotifications=[],this.alertHistory=[],this.backendSrv.get("/api/alert-notifications").then(function(e){t.notifications=e,t.initModel(),t.validateModel()})},t.prototype.getAlertHistory=function(){var t=this;this.backendSrv.get("/api/annotations?dashboardId="+this.panelCtrl.dashboard.id+"&panelId="+this.panel.id+"&limit=50").then(function(e){t.alertHistory=a.a.map(e,function(e){return e.time=t.dashboardSrv.getCurrent().formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=l.a.getStateDisplayModel(e.newState),e.info=l.a.getAlertAnnotationInfo(e),e})})},t.prototype.getNotificationIcon=function(t){switch(t){case"email":return"fa fa-envelope";case"slack":return"fa fa-slack";case"victorops":return"fa fa-pagelines";case"webhook":return"fa fa-cubes";case"pagerduty":return"fa fa-bullhorn";case"opsgenie":return"fa fa-bell";case"hipchat":return"fa fa-mail-forward";case"pushover":return"fa fa-mobile";case"kafka":return"fa fa-random"}return"fa fa-bell"},t.prototype.getNotifications=function(){var t=this;return Promise.resolve(this.notifications.map(function(e){return t.uiSegmentSrv.newSegment(e.name)}))},t.prototype.changeTabIndex=function(t){this.subTabIndex=t,2===this.subTabIndex&&this.getAlertHistory()},t.prototype.notificationAdded=function(){var t=a.a.find(this.notifications,{name:this.addNotificationSegment.value});t&&(this.alertNotifications.push({name:t.name,iconClass:this.getNotificationIcon(t.type),isDefault:!1}),this.alert.notifications.push({id:t.id}),this.addNotificationSegment.value=this.uiSegmentSrv.newPlusButton().value,this.addNotificationSegment.html=this.uiSegmentSrv.newPlusButton().html)},t.prototype.removeNotification=function(t){this.alert.notifications.splice(t,1),this.alertNotifications.splice(t,1)},t.prototype.initModel=function(){var t=this,e=this.alert=this.panel.alert;if(e){e.conditions=e.conditions||[],0===e.conditions.length&&e.conditions.push(this.buildDefaultCondition()),e.noDataState=e.noDataState||"no_data",e.executionErrorState=e.executionErrorState||"alerting",e.frequency=e.frequency||"60s",e.handler=e.handler||1,e.notifications=e.notifications||[];var n=this.panel.title+" alert";e.name=e.name||n,this.conditionModels=a.a.reduce(e.conditions,function(e,n){return e.push(t.buildConditionModel(n)),e},[]),o.a.alertToGraphThresholds(this.panel);for(var r=0,i=e.notifications;r<i.length;r++){var s=i[r],l=a.a.find(this.notifications,{id:s.id});l&&!1===l.isDefault&&(l.iconClass=this.getNotificationIcon(l.type),this.alertNotifications.push(l))}for(var u=0,c=this.notifications;u<c.length;u++){var h=c[u];h.isDefault&&(h.iconClass=this.getNotificationIcon(h.type),h.bgColor="#00678b",this.alertNotifications.push(h))}this.panelCtrl.editingThresholds=!0,this.panelCtrl.render()}},t.prototype.graphThresholdChanged=function(t){for(var e=0,n=this.alert.conditions;e<n.length;e++){var r=n[e];if("query"===r.type){r.evaluator.params[t.handleIndex]=t.threshold.value,this.evaluatorParamsChanged();break}}},t.prototype.buildDefaultCondition=function(){return{type:"query",query:{params:["A","5m","now"]},reducer:{type:"avg",params:[]},evaluator:{type:"gt",params:[null]},operator:{type:"and"}}},t.prototype.validateModel=function(){var t=this;if(this.alert)for(var e,n=null,r=0,i=this.alert.conditions;r<i.length;r++){var a=i[r];if("query"===a.type){for(var o=0,s=this.panel.targets;o<s.length;o++){var l=s[o];if(e||(e=l),a.query.params[0]===l.refId){n=l;break}}n||(e?(a.query.params[0]=e.refId,n=e,!0):this.error="Could not find any metric queries");var u=n.datasource||this.panel.datasource;this.datasourceSrv.get(u).then(function(e){e.meta.alerting?e.targetContainsTemplate(n)?t.error="Template variables are not supported in alert queries":t.error="":t.error="The datasource does not support alerting queries"})}}},t.prototype.buildConditionModel=function(t){var e={source:t,type:t.type};return e.queryPart=new s.a(t.query,l.a.alertQueryDef),e.reducerPart=l.a.createReducerPart(t.reducer),e.evaluator=t.evaluator,e.operator=t.operator,e},t.prototype.handleQueryPartEvent=function(t,e){var n=this;switch(e.name){case"action-remove-part":break;case"get-part-actions":return this.$q.when([]);case"part-param-changed":this.validateModel();case"get-param-options":var r=this.panel.targets.map(function(t){return n.uiSegmentSrv.newSegment({value:t.refId})});return this.$q.when(r)}},t.prototype.handleReducerPartEvent=function(t,e){switch(e.name){case"action":t.source.reducer.type=e.action.value,t.reducerPart=l.a.createReducerPart(t.source.reducer);break;case"get-part-actions":for(var n=[],r=0,i=l.a.reducerTypes;r<i.length;r++){var a=i[r];a.value!==t.source.reducer.type&&n.push(a)}return this.$q.when(n)}},t.prototype.addCondition=function(t){var e=this.buildDefaultCondition();this.alert.conditions.push(e),this.conditionModels.push(this.buildConditionModel(e))},t.prototype.removeCondition=function(t){this.alert.conditions.splice(t,1),this.conditionModels.splice(t,1)},t.prototype.delete=function(){var t=this;h.a.emit("confirm-modal",{title:"Delete Alert",text:"Are you sure you want to delete this alert rule?",text2:"You need to save dashboard for the delete to take effect",icon:"fa-trash",yesText:"Delete",onConfirm:function(){delete t.panel.alert,t.alert=null,t.panel.thresholds=[],t.conditionModels=[],t.panelCtrl.alertState=null,t.panelCtrl.render()}})},t.prototype.enable=function(){this.panel.alert={},this.initModel()},t.prototype.evaluatorParamsChanged=function(){o.a.alertToGraphThresholds(this.panel),this.panelCtrl.render()},t.prototype.evaluatorTypeChanged=function(t){switch(t.type){case"lt":case"gt":t.params=[t.params[0]];break;case"within_range":case"outside_range":t.params=[t.params[0],t.params[1]];break;case"no_value":t.params=[]}this.evaluatorParamsChanged()},t.prototype.clearHistory=function(){var t=this;h.a.emit("confirm-modal",{title:"Delete Alert History",text:"Are you sure you want to remove all history & annotations for this alert?",icon:"fa-trash",yesText:"Yes",onConfirm:function(){t.backendSrv.post("/api/annotations/mass-delete",{dashboardId:t.panelCtrl.dashboard.id,panelId:t.panel.id}).then(function(e){t.alertHistory=[],t.panelCtrl.refresh()})}})},t.prototype.test=function(){var t=this;this.testing=!0,this.testResult=!1;var e={dashboard:this.dashboardSrv.getCurrent().getSaveModelClone(),panelId:this.panelCtrl.panel.id};return this.backendSrv.post("/api/alerts/test",e).then(function(e){t.testResult=e,t.testing=!1})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(){}return t.alertToGraphThresholds=function(t){if("graph"!==t.type)return!1;for(var e=0;e<t.alert.conditions.length;e++){var n=t.alert.conditions[e];if("query"===n.type){var r=n.evaluator,i=t.thresholds=[];switch(r.type){case"gt":var a=r.params[0];i.push({value:a,op:"gt"});break;case"lt":var a=r.params[0];i.push({value:a,op:"lt"});break;case"outside_range":var o=r.params[0],s=r.params[1];o>s?(i.push({value:o,op:"gt"}),i.push({value:s,op:"lt"})):(i.push({value:o,op:"lt"}),i.push({value:s,op:"gt"}));break;case"within_range":var o=r.params[0],s=r.params[1];o>s?(i.push({value:o,op:"lt"}),i.push({value:s,op:"gt"})):(i.push({value:o,op:"gt"}),i.push({value:s,op:"lt"}))}break}}for(var l=0,u=t.thresholds;l<u.length;l++){var c=u[l];c.fill=!0,c.line=!0,c.colorMode="critical"}return!0},t}()},function(t,e,n){"use strict";var r=n(923),i=n(931),a=n(935),o=n(944),s=n(948),l=n(950),u=n(955),c=n(957),h=n(961),f=n(965),d=n(972),p=n(973),m=n(985),g=n(986),v=n(987),y=n(988),b=n(997),x=n(1001),_=n(1003),w=n(1004),S=n(1005),k={"app/plugins/datasource/graphite/module":r,"app/plugins/datasource/cloudwatch/module":i,"app/plugins/datasource/elasticsearch/module":a,"app/plugins/datasource/opentsdb/module":o,"app/plugins/datasource/grafana/module":s,"app/plugins/datasource/influxdb/module":l,"app/plugins/datasource/mixed/module":u,"app/plugins/datasource/mysql/module":c,"app/plugins/datasource/postgres/module":h,"app/plugins/datasource/prometheus/module":f,"app/plugins/app/testdata/module":w,"app/plugins/app/testdata/datasource/module":S,"app/plugins/panel/text/module":d,"app/plugins/panel/graph/module":p,"app/plugins/panel/dashlist/module":m,"app/plugins/panel/pluginlist/module":g,"app/plugins/panel/alertlist/module":v,"app/plugins/panel/heatmap/module":y,"app/plugins/panel/table/module":b,"app/plugins/panel/singlestat/module":x,"app/plugins/panel/gettingstarted/module":_};e.a=k},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(924),i=n(925),a=n(930);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a}),n.d(e,"ConfigCtrl",function(){return a.a});var o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";function r(t,e,n,r){this.basicAuth=t.basicAuth,this.url=t.url,this.name=t.name,this.graphiteVersion=t.jsonData.graphiteVersion||"0.9",this.cacheTimeout=t.cacheTimeout,this.withCredentials=t.withCredentials,this.render_method=t.render_method||"POST",this.getQueryOptionsInfo=function(){return{maxDataPoints:!0,cacheTimeout:!0,links:[{text:"Help",url:"http://docs.grafana.org/features/datasources/graphite/#using-graphite-in-grafana"}]}},this.query=function(t){var n={from:this.translateTime(t.rangeRaw.from,!1),until:this.translateTime(t.rangeRaw.to,!0),targets:t.targets,format:t.format,cacheTimeout:t.cacheTimeout||this.cacheTimeout,maxDataPoints:t.maxDataPoints},r=this.buildGraphiteParams(n,t.scopedVars);if(0===r.length)return e.when({data:[]});var i={method:"POST",url:"/render",data:r.join("&"),headers:{"Content-Type":"application/x-www-form-urlencoded"}};return t.panelId&&(i.requestId=this.name+".panelId."+t.panelId),this.doGraphiteRequest(i).then(this.convertDataPointsToMs)},this.convertDataPointsToMs=function(t){if(!t||!t.data)return[];for(var e=0;e<t.data.length;e++)for(var n=t.data[e],r=0;r<n.datapoints.length;r++)n.datapoints[r][1]*=1e3;return t},this.parseTags=function(t){var e=[];return e=t.split(","),1===e.length&&(e=t.split(" "),""===e[0]&&(e=[])),e},this.annotationQuery=function(t){var e=this;if(t.annotation.target){var n=r.replace(t.annotation.target,{},"glob"),i={rangeRaw:t.rangeRaw,targets:[{target:n}],format:"json",maxDataPoints:100};return this.query(i).then(function(e){for(var n=[],r=0;r<e.data.length;r++)for(var i=e.data[r],a=0;a<i.datapoints.length;a++){var o=i.datapoints[a];o[0]&&n.push({annotation:t.annotation,time:o[1],title:i.target})}return n})}var o=r.replace(t.annotation.tags);return this.events({range:t.rangeRaw,tags:o}).then(function(n){for(var r=[],i=0;i<n.data.length;i++){var o=n.data[i],s=o.tags;a.a.isString(o.tags)&&(s=e.parseTags(o.tags)),r.push({annotation:t.annotation,time:1e3*o.when,title:o.what,tags:s,text:o.data})}return r})},this.events=function(t){try{var n="";return t.tags&&(n="&tags="+t.tags),this.doGraphiteRequest({method:"GET",url:"/events/get_data?from="+this.translateTime(t.range.from,!1)+"&until="+this.translateTime(t.range.to,!0)+n})}catch(t){return e.reject(t)}},this.targetContainsTemplate=function(t){return r.variableExists(t.target)},this.translateTime=function(t,e){if(a.a.isString(t)){if("now"===t)return"now";if(t.indexOf("now-")>=0&&-1===t.indexOf("/"))return t=t.substring(3),t=t.replace("m","min"),t=t.replace("M","mon");t=o.parse(t,e)}return e?t.get("s")&&t.add(1,"m"):!1===e&&t.get("s")&&t.subtract(1,"m"),t.unix()},this.metricFindQuery=function(t,e){var n=e||{},i=r.replace(t),o={method:"GET",url:"/metrics/find",params:{query:i},requestId:n.requestId};return n&&n.range&&(o.params.from=this.translateTime(n.range.from,!1),o.params.until=this.translateTime(n.range.to,!0)),this.doGraphiteRequest(o).then(function(t){return a.a.map(t.data,function(t){return{text:t.text,expandable:!!t.expandable}})})},this.testDatasource=function(){return this.metricFindQuery("*").then(function(){return{status:"success",message:"Data source is working"}})},this.doGraphiteRequest=function(t){return(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers=t.headers||{},t.headers.Authorization=this.basicAuth),t.url=this.url+t.url,t.inspect={type:"graphite"},n.datasourceRequest(t)},this._seriesRefLetters="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.buildGraphiteParams=function(t,e){function n(t){return t.replace("m","min").replace("M","mon")}function i(t,e){return h[e]||t}var o,s,l,u=["from","until","rawData","format","maxDataPoints","cacheTimeout"],c=[],h={},f=/\#([A-Z])/g,d=/'(\d+)m'/gi,p=!1;for(t.format="json",l=0;l<t.targets.length;l++)o=t.targets[l],o.target&&(o.refId||(o.refId=this._seriesRefLetters[l]),s=r.replace(o.target,e),s=s.replace(d,n),h[o.refId]=s);for(l=0;l<t.targets.length;l++)o=t.targets[l],o.target&&(s=h[o.refId],s=s.replace(f,i),h[o.refId]=s,o.hide||(p=!0,c.push("target="+encodeURIComponent(s))));return a.a.each(t,function(t,e){-1!==a.a.indexOf(u,e)&&t&&c.push(e+"="+encodeURIComponent(t))}),p?c:[]}}r.$inject=["instanceSettings","$q","backendSrv","templateSrv"],e.a=r;var i=n(4),a=n.n(i),o=n(292)},function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(926),i=(n.n(r),n(927)),a=(n.n(i),n(4)),o=n.n(a),s=n(821),l=n.n(s),u=n(928),c=n(797),h=n(39),f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r,i){var a=t.call(this,e,n)||this;return a.uiSegmentSrv=r,a.templateSrv=i,a.target&&(a.target.target=a.target.target||"",a.parseTarget()),a}return f(e,t),e.$inject=["$scope","$injector","uiSegmentSrv","templateSrv"],e.prototype.toggleEditorMode=function(){this.target.textEditor=!this.target.textEditor,this.parseTarget()},e.prototype.parseTarget=function(){if(this.functions=[],this.segments=[],this.error=null,!this.target.textEditor){var t=new u.a(this.target.target),e=t.getAst();if(null===e)return void this.checkOtherSegments(0);if("error"===e.type)return this.error=e.message+" at position: "+e.pos,void(this.target.textEditor=!0);try{this.parseTargetRecursive(e,null,0)}catch(t){console.log("error parsing target:",t.message),this.error=t.message,this.target.textEditor=!0}this.checkOtherSegments(this.segments.length-1)}},e.prototype.addFunctionParameter=function(t,e,n,r){r&&(n=Math.max(n-1,0)),t.params[n]=e},e.prototype.parseTargetRecursive=function(t,e,n){var r=this;if(null===t)return null;switch(t.type){case"function":var i=l.a.createFuncInstance(t.name,{withDefaultParams:!1});o.a.each(t.params,function(t,e){r.parseTargetRecursive(t,i,e)}),i.updateText(),this.functions.push(i);break;case"series-ref":this.addFunctionParameter(e,t.value,n,this.segments.length>0);break;case"bool":case"string":case"number":if(n-1>=e.def.params.length)throw{message:"invalid number of parameters to method "+e.def.name};var a=this.isShiftParamsBack(e);this.addFunctionParameter(e,t.value,n,a);break;case"metric":if(this.segments.length>0){if(1!==t.segments.length)throw{message:"Multiple metric params not supported, use text editor."};this.addFunctionParameter(e,t.segments[0].value,n,!0);break}this.segments=o.a.map(t.segments,function(t){return r.uiSegmentSrv.newSegment(t)})}},e.prototype.isShiftParamsBack=function(t){return"seriesByTag"!==t.def.name},e.prototype.getSegmentPathUpTo=function(t){var e=this.segments.slice(0,t);return o.a.reduce(e,function(t,e){return t?t+"."+e.value:e.value},"")},e.prototype.checkOtherSegments=function(t){var e=this;if(0===t)return void this.segments.push(this.uiSegmentSrv.newSelectMetric());var n=this.getSegmentPathUpTo(t+1);return""===n?Promise.resolve():this.datasource.metricFindQuery(n).then(function(r){if(0===r.length)""!==n&&(e.segments=e.segments.splice(0,t),e.segments.push(e.uiSegmentSrv.newSelectMetric()));else if(r[0].expandable){if(e.segments.length!==t)return e.checkOtherSegments(t+1);e.segments.push(e.uiSegmentSrv.newSelectMetric())}}).catch(function(t){h.a.emit("alert-error",["Error",t])})},e.prototype.setSegmentFocus=function(t){o.a.each(this.segments,function(e,n){e.focus=t===n})},e.prototype.wrapFunction=function(t,e){return e.render(t)},e.prototype.getAltSegments=function(t){var e=this,n=0===t?"*":this.getSegmentPathUpTo(t)+".*",r={range:this.panelCtrl.range,requestId:"get-alt-segments"};return this.datasource.metricFindQuery(n,r).then(function(t){var n=o.a.map(t,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});return 0===n.length?n:(o.a.each(e.templateSrv.variables,function(t){n.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),n.unshift(e.uiSegmentSrv.newSegment("*")),n)}).catch(function(t){return[]})},e.prototype.segmentValueChanged=function(t,e){var n=this;if(this.error=null,this.functions.length>0&&this.functions[0].def.fake&&(this.functions=[]),t.expandable)return this.checkOtherSegments(e+1).then(function(){n.setSegmentFocus(e+1),n.targetChanged()});this.segments=this.segments.splice(0,e+1),this.setSegmentFocus(e+1),this.targetChanged()},e.prototype.targetTextChanged=function(){this.updateModelTarget(),this.refresh()},e.prototype.updateModelTarget=function(){if(!this.target.textEditor){var t=this.getSegmentPathUpTo(this.segments.length);this.target.target=o.a.reduce(this.functions,this.wrapFunction,t)}this.updateRenderedTarget(this.target);for(var e=0,n=this.panelCtrl.panel.targets||[];e<n.length;e++){var r=n[e];r.refId!==this.target.refId&&this.updateRenderedTarget(r)}},e.prototype.updateRenderedTarget=function(t){var e=o.a.keyBy(this.panelCtrl.panel.targets,"refId");delete e[t.refId];for(var n=/\#([A-Z])/g,r=t.target;r.match(n);){var i=r.replace(n,function(t,n){var r=e[n];return r?(delete e[n],r.target):t});if(i===r)break;r=i}delete t.targetFull,t.target!==r&&(t.targetFull=r)},e.prototype.targetChanged=function(){if(!this.error){var t=this.target.target;if(this.updateModelTarget(),this.target.target!==t){"select metric"!==(this.segments.length>0?this.segments[this.segments.length-1]:{}).value&&this.panelCtrl.refresh()}}},e.prototype.removeFunction=function(t){this.functions=o.a.without(this.functions,t),this.targetChanged()},e.prototype.addFunction=function(t){var e=l.a.createFuncInstance(t,{withDefaultParams:!0});e.added=!0,this.functions.push(e),this.moveAliasFuncLast(),this.smartlyHandleNewAliasByNode(e),1===this.segments.length&&this.segments[0].fake&&(this.segments=[]),!e.params.length&&e.added&&this.targetChanged()},e.prototype.moveAliasFuncLast=function(){var t=o.a.find(this.functions,function(t){return"alias"===t.def.name||"aliasByNode"===t.def.name||"aliasByMetric"===t.def.name});t&&(this.functions=o.a.without(this.functions,t),this.functions.push(t))},e.prototype.smartlyHandleNewAliasByNode=function(t){if("aliasByNode"===t.def.name)for(var e=0;e<this.segments.length;e++)if(this.segments[e].value.indexOf("*")>=0)return t.params[0]=e,t.added=!1,void this.targetChanged()},e.templateUrl="partials/query.editor.html",e}(c.QueryCtrl)},function(t,e,n){var r,i;r=[n(8),n(4),n(10),n(821)],void 0!==(i=function(t,e,n,r){"use strict";function i(t){return e.reduce(t,function(t,n){return e.each(n,function(e){t.push(e.name)}),t},[])}function a(t){return e.map(t,function(t,n){return{text:n,submenu:e.map(t,function(t){return{text:t.name,click:"ctrl.addFunction('"+t.name+"')"}})}})}t.module("grafana.directives").directive("graphiteAddFunc",["$compile",function(t){return{link:function(o,s){var l=o.ctrl,u=l.datasource.graphiteVersion,c=r.getCategories(u),h=i(c);o.functionMenu=a(c);var f=n('<input type="text" class="gf-form-input" spellcheck="false" style="display:none"></input>'),d=n('<a  class="gf-form-label query-part dropdown-toggle" tabindex="1" gf-dropdown="functionMenu" data-toggle="dropdown"><i class="fa fa-plus"></i></a>');f.appendTo(s),d.appendTo(s),f.attr("data-provide","typeahead"),f.typeahead({source:h,minLength:1,items:10,updater:function(t){var n=r.getFuncDef(t);if(n||(t=t.toLowerCase(),n=e.find(h,function(e){return 0===e.toLowerCase().indexOf(t)})))return o.$apply(function(){l.addFunction(n)}),f.trigger("blur"),""}}),d.click(function(){d.hide(),f.show(),f.focus()}),f.keyup(function(){s.toggleClass("open",""===f.val())}),f.blur(function(){setTimeout(function(){f.val(""),f.hide(),d.show(),s.removeClass("open")},200)}),t(s.contents())(o)}}}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){var r,i;r=[n(8),n(4),n(10)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.directives").directive("graphiteFuncEditor",["$compile","templateSrv",function(t,r){return{restrict:"A",link:function(i,a){function o(t){var e=n(this),r=e.next();r.val(_.params[t]),r.css("width",e.width()+16+"px"),e.hide(),r.show(),r.focus(),r.select();var i=r.data("typeahead");i&&(r.val(""),i.lookup())}function s(){k!==_.params.length&&(S||(S=!0,setTimeout(function(){v(),S=!1},200)))}function l(t){var e=n(this),a=e.prev(),o=e.val();(""!==o||_.def.params[t].optional)&&(a.html(r.highlightVariablesAsHtml(o)),_.updateParam(e.val(),t),s(),i.$apply(function(){x.targetChanged()}),e.hide(),a.show())}function u(t,e){13===e.which&&l.call(this,t)}function c(){this.style.width=8*(3+this.value.length)+"px"}function h(t,n){t.attr("data-provide","typeahead");var r=w.params[n].options;"int"===w.params[n].type&&(r=e.map(r,function(t){return t.toString()})),t.typeahead({source:r,minLength:0,items:20,updater:function(e){return setTimeout(function(){l.call(t[0],n)},0),e}}),t.data("typeahead").lookup=function(){return this.query=this.$element.val()||"",this.process(this.source)}}function f(){var t=a.closest(".tight-form");if(a.hasClass("show-function-controls"))return a.removeClass("show-function-controls"),t.removeClass("has-open-function"),void b.hide();a.addClass("show-function-controls"),t.addClass("has-open-function"),b.show()}function d(){b.appendTo(a),y.appendTo(a),e.each(w.params,function(t,i){if(!(t.optional&&_.params.length<=i)){i>0&&n("<span>, </span>").appendTo(a);var s=r.highlightVariablesAsHtml(_.params[i]),f=n('<a ng-click="" class="graphite-func-param-link">'+s+"</a>"),d=n('<input type="text" style="display:none" class="input-mini tight-form-func-param"></input>');k++,f.appendTo(a),d.appendTo(a),d.blur(e.partial(l,i)),d.keyup(c),d.keypress(e.partial(u,i)),f.click(e.partial(o,i)),w.params[i].options&&h(d,i)}}),n("<span>)</span>").appendTo(a),t(a.contents())(i)}function p(){i.func.added&&(i.func.added=!1,setTimeout(function(){a.find(".graphite-func-param-link").first().click()},10))}function m(){y.click(f)}function g(){b.click(function(t){var r=n(t.target);return r.hasClass("fa-remove")?(f(),void i.$apply(function(){x.removeFunction(i.func)})):r.hasClass("fa-arrow-left")?void i.$apply(function(){e.move(x.functions,i.$index,i.$index-1),x.targetChanged()}):r.hasClass("fa-arrow-right")?void i.$apply(function(){e.move(x.functions,i.$index,i.$index+1),x.targetChanged()}):r.hasClass("fa-question-circle")?void window.open("http://graphite.readthedocs.org/en/latest/functions.html#graphite.render.functions."+w.name,"_blank"):void 0})}function v(){a.children().remove(),d(),p(),m(),g()}var y=n('<a ng-click="">{{func.def.name}}</a><span>(</span>'),b=n('<div class="tight-form-func-controls"><span class="pointer fa fa-arrow-left"></span><span class="pointer fa fa-question-circle"></span><span class="pointer fa fa-remove" ></span><span class="pointer fa fa-arrow-right"></span></div>'),x=i.ctrl,_=i.func,w=_.def,S=!1,k=0;v()}}}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";function r(t){this.expression=t,this.lexer=new i.a(t),this.tokens=this.lexer.tokenize(),this.index=0}e.a=r;var i=n(929);r.prototype={getAst:function(){return this.start()},start:function(){try{return this.functionCall()||this.metricExpression()}catch(t){return{type:"error",message:t.message,pos:t.pos}}},curlyBraceSegment:function(){if(this.match("identifier","{")||this.match("{")){for(var t="";!this.match("")&&!this.match("}");)t+=this.consumeToken().value;return this.match("}")||this.errorMark("Expected closing '}'"),t+=this.consumeToken().value,this.match("identifier")&&(t+=this.consumeToken().value),{type:"segment",value:t}}return null},metricSegment:function(){var t=this.curlyBraceSegment();if(t)return t;if(this.match("identifier")||this.match("number")){var e=this.consumeToken().value.split(".");return 2===e.length&&(this.tokens.splice(this.index,0,{type:"."}),this.tokens.splice(this.index+1,0,{type:"number",value:e[1]})),{type:"segment",value:e[0]}}this.match("templateStart")||this.errorMark("Expected metric identifier"),this.consumeToken(),this.match("identifier")||this.errorMark("Expected identifier after templateStart");var n={type:"template",value:this.consumeToken().value};return this.match("templateEnd")||this.errorMark("Expected templateEnd"),this.consumeToken(),n},metricExpression:function(){if(!(this.match("templateStart")||this.match("identifier")||this.match("number")||this.match("{")))return null;var t={type:"metric",segments:[]};for(t.segments.push(this.metricSegment());this.match(".");){this.consumeToken();var e=this.metricSegment();e||this.errorMark("Expected metric identifier"),t.segments.push(e)}return t},functionCall:function(){if(!this.match("identifier","("))return null;var t={type:"function",name:this.consumeToken().value};return this.consumeToken(),t.params=this.functionParameters(),this.match(")")||this.errorMark("Expected closing parenthesis"),this.consumeToken(),t},boolExpression:function(){return this.match("bool")?{type:"bool",value:"true"===this.consumeToken().value}:null},functionParameters:function(){if(this.match(")")||this.match(""))return[];var t=this.functionCall()||this.numericLiteral()||this.seriesRefExpression()||this.boolExpression()||this.metricExpression()||this.stringLiteral();return this.match(",")?(this.consumeToken(),[t].concat(this.functionParameters())):[t]},seriesRefExpression:function(){return this.match("identifier")&&this.tokens[this.index].value.match(/\#[A-Z]/)?{type:"series-ref",value:this.consumeToken().value}:null},numericLiteral:function(){return this.match("number")?{type:"number",value:parseFloat(this.consumeToken().value)}:null},stringLiteral:function(){if(!this.match("string"))return null;var t=this.consumeToken();if(t.isUnclosed)throw{message:"Unclosed string parameter",pos:t.pos};return{type:"string",value:t.value}},errorMark:function(t){var e=this.tokens[this.index];throw{message:t+" instead found "+(e?e.type:"end of string"),pos:e?e.pos:this.lexer.char}},consumeToken:function(){return this.index++,this.tokens[this.index-1]},matchToken:function(t,e){var n=this.tokens[this.index+e];return void 0===n&&""===t||n&&n.type===t},match:function(t,e){return this.matchToken(t,0)&&(!e||this.matchToken(e,1))}}},function(t,e,n){"use strict";function r(t){this.input=t,this.char=1,this.from=1}e.a=r;for(var i=n(4),a=n.n(i),o=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4304,4346,4348,4348,4352,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7104,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11520,11557,11568,11621,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,13312,19893,19893,19968,19968,40907,40907,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42897,42912,42921,43002,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,44032,55203,55203,55216,55238,55243,55291,63744,64045,64048,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500,65536,65547,65549,65574,65576,65594,65596,65597,65599,65613,65616,65629,65664,65786,65856,65908,66176,66204,66208,66256,66304,66334,66352,66378,66432,66461,66464,66499,66504,66511,66513,66517,66560,66717,67584,67589,67592,67592,67594,67637,67639,67640,67644,67644,67647,67669,67840,67861,67872,67897,68096,68096,68112,68115,68117,68119,68121,68147,68192,68220,68352,68405,68416,68437,68448,68466,68608,68680,69635,69687,69763,69807,73728,74606,74752,74850,77824,78894,92160,92728,110592,110593,119808,119892,119894,119964,119966,119967,119970,119970,119973,119974,119977,119980,119982,119993,119995,119995,119997,120003,120005,120069,120071,120074,120077,120084,120086,120092,120094,120121,120123,120126,120128,120132,120134,120134,120138,120144,120146,120485,120488,120512,120514,120538,120540,120570,120572,120596,120598,120628,120630,120654,120656,120686,120688,120712,120714,120744,120746,120770,120772,120779,131072,131072,173782,173782,173824,173824,177972,177972,177984,177984,178205,178205,194560,195101],s=[],l=0;l<128;l++)s[l]=l>=48&&l<=57||36===l||126===l||124===l||l>=65&&l<=90||95===l||45===l||42===l||58===l||91===l||93===l||63===l||37===l||35===l||61===l||l>=97&&l<=122;var u=s;r.prototype={peek:function(t){return this.input.charAt(t||0)},skip:function(t){t=t||1,this.char+=t,this.input=this.input.slice(t)},tokenize:function(){for(var t,e=[];t=this.next();)e.push(t);return e},next:function(){this.from=this.char;if(/\s/.test(this.peek())){for(this.char;/\s/.test(this.peek());)this.from+=1,this.skip();if(""===this.peek())return null}var t=this.scanStringLiteral();return t||(t=this.scanPunctuator()||this.scanNumericLiteral()||this.scanIdentifier()||this.scanTemplateSequence(),t?(this.skip(t.value.length),t):null)},scanTemplateSequence:function(){return"["===this.peek()&&"["===this.peek(1)?{type:"templateStart",value:"[[",pos:this.char}:"]"===this.peek()&&"]"===this.peek(1)?{type:"templateEnd",value:"[[",pos:this.char}:null},scanIdentifier:function(){function t(t){for(var e=0;e<o.length;){if(t<o[e++])return!1;if(t<=o[e++])return!0}return!1}function e(t){return/^[0-9a-fA-F]$/.test(t)}var n,r,i="",l=0,c=a.a.bind(function(){if(l+=1,"u"!==this.peek(l))return null;var n,r=this.peek(l+1),i=this.peek(l+2),a=this.peek(l+3),o=this.peek(l+4);return e(r)&&e(i)&&e(a)&&e(o)?(n=parseInt(r+i+a+o,16),t(n)?(l+=5,"\\u"+r+i+a+o):null):null},this),h=a.a.bind(function(){var e=this.peek(l),n=e.charCodeAt(0);return"*"===e?(l+=1,e):92===n?c():n<128?s[n]?(l+=1,e):null:t(n)?(l+=1,e):null},this),f=a.a.bind(function(){var e=this.peek(l),n=e.charCodeAt(0);return 92===n?c():n<128?u[n]?(l+=1,e):null:t(n)?(l+=1,e):null},this);if(null===(r=h()))return null;for(i=r;null!==(r=f());)i+=r;switch(i){case"true":case"false":n="bool";break;default:n="identifier"}return{type:n,value:i,pos:this.char}},scanNumericLiteral:function(){function t(t){return/^[0-9]$/.test(t)}function e(t){return/^[0-7]$/.test(t)}function n(t){return"$"===t||"_"===t||"\\"===t||t>="a"&&t<="z"||t>="A"&&t<="Z"}var r,i=0,a="",o=this.input.length,s=this.peek(i);if("-"===s&&(a+=s,i+=1,s=this.peek(i)),"."!==s&&!t(s))return null;if("."!==s){if(a+=this.peek(i),i+=1,s=this.peek(i),"0"===a){if("x"===s||"X"===s){for(i+=1,a+=s;i<o&&(s=this.peek(i),function(t){return/^[0-9a-fA-F]$/.test(t)}(s));)a+=s,i+=1;return a.length<=2?{type:"number",value:a,isMalformed:!0,pos:this.char}:i<o&&(s=this.peek(i),n(s))?null:{type:"number",value:a,base:16,isMalformed:!1,pos:this.char}}if(e(s)){for(i+=1,a+=s,r=!1;i<o;){if(s=this.peek(i),t(s)&&(r=!0),!e(s)){if(!this.isPunctuator(s))return null;break}a+=s,i+=1}return i<o&&(s=this.peek(i),n(s))?null:{type:"number",value:a,base:8,isMalformed:r}}t(s)&&(i+=1,a+=s)}for(;i<o&&(s=this.peek(i),t(s));)a+=s,i+=1}if("."===s)for(a+=s,i+=1;i<o&&(s=this.peek(i),t(s));)a+=s,i+=1;if("e"===s||"E"===s){if(a+=s,i+=1,s=this.peek(i),"+"!==s&&"-"!==s||(a+=this.peek(i),i+=1),s=this.peek(i),!t(s))return null;for(a+=s,i+=1;i<o&&(s=this.peek(i),t(s));)a+=s,i+=1}return i<o&&(s=this.peek(i),!this.isPunctuator(s))?null:{type:"number",value:a,base:10,pos:this.char,isMalformed:!isFinite(+a)}},isPunctuator:function(t){switch(t){case".":case"(":case")":case",":case"{":case"}":return!0}return!1},scanPunctuator:function(){var t=this.peek();return this.isPunctuator(t)?{type:t,value:t,pos:this.char}:null},scanStringLiteral:function(){var t=this.peek();if('"'!==t&&"'"!==t)return null;var e="";for(this.skip();this.peek()!==t;){if(""===this.peek())return{type:"string",value:e,isUnclosed:!0,quote:t,pos:this.char};e+=this.peek(),this.skip(1)}return this.skip(),{type:"string",value:e,isUnclosed:!1,quote:t,pos:this.char}}}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.graphiteVersions=[{name:"0.9.x",value:"0.9"},{name:"1.0.x",value:"1.0"},{name:"1.1.x",value:"1.1"}],this.current.jsonData=this.current.jsonData||{},this.current.jsonData.graphiteVersion=this.current.jsonData.graphiteVersion||"0.9"}return t.$inject=["$scope"],t.templateUrl="public/app/plugins/datasource/graphite/partials/config.html",t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return l});var r=n(822),i=(n.n(r),n(932)),a=n.n(i),o=n(933),s=n(934);n.d(e,"Datasource",function(){return a.a}),n.d(e,"QueryCtrl",function(){return o.a}),n.d(e,"ConfigCtrl",function(){return s.a});var l=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){var r,i;r=[n(8),n(4),n(1),n(292),n(109),n(798)],void 0!==(i=function(t,e,n,r,i,a){"use strict";function o(n,o,s,l,u){function c(t){return e.map(t.results.metricFindQuery.tables[0].rows,function(t){return{text:t[0],value:t[1]}})}this.type="cloudwatch",this.name=n.name,this.supportMetrics=!0,this.proxyUrl=n.url,this.defaultRegion=n.jsonData.defaultRegion,this.instanceSettings=n,this.standardStatistics=["Average","Maximum","Minimum","Sum","SampleCount"];var h=this;this.query=function(n){n=t.copy(n),n.targets=this.expandTemplateVariable(n.targets,n.scopedVars,l);var r=e.filter(n.targets,function(t){return!(!0===t.hide||!t.region||!t.namespace||!t.metricName||e.isEmpty(t.statistics))}).map(function(t){return t.region=l.replace(t.region,n.scopedVars),t.namespace=l.replace(t.namespace,n.scopedVars),t.metricName=l.replace(t.metricName,n.scopedVars),t.dimensions=h.convertDimensionFormat(t.dimensions,n.scopeVars),t.period=String(h.getPeriod(t,n)),e.extend({refId:t.refId,intervalMs:n.intervalMs,maxDataPoints:n.maxDataPoints,datasourceId:h.instanceSettings.id,type:"timeSeriesQuery"},t)});if(e.isEmpty(r)){var i=o.defer();return i.resolve({data:[]}),i.promise}var a={from:n.range.from.valueOf().toString(),to:n.range.to.valueOf().toString(),queries:r};return this.performTimeSeriesQuery(a)},this.getPeriod=function(t,e,n){var r=this.convertToCloudWatchTime(e.range.from,!1),a=this.convertToCloudWatchTime(e.range.to,!0);n=Math.round((n||Date.now())/1e3);var o,s=a-r,u=60;return t.period?o=/^\d+$/.test(t.period)?parseInt(t.period,10):i.interval_to_seconds(l.replace(t.period,e.scopedVars)):u=o=n-r<=1296e3?"AWS/EC2"===t.namespace?300:60:n-r<=5443200?300:3600,o<1&&(o=1),s/o>=1440&&(o=Math.ceil(s/1440/u)*u),o},this.performTimeSeriesQuery=function(t){return s.post("/api/tsdb/query",t).then(function(t){var n=[];return t.results&&e.forEach(t.results,function(t){e.forEach(t.series,function(t){n.push({target:t.name,datapoints:t.points})})}),{data:n}})},this.doMetricQueryRequest=function(t,n){var r=u.timeRange();return s.post("/api/tsdb/query",{from:r.from.valueOf().toString(),to:r.to.valueOf().toString(),queries:[e.extend({refId:"metricFindQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"metricFindQuery",subtype:t},n)]}).then(function(t){return c(t)})},this.getRegions=function(){return this.doMetricQueryRequest("regions",null)},this.getNamespaces=function(){return this.doMetricQueryRequest("namespaces",null)},this.getMetrics=function(t,e){return this.doMetricQueryRequest("metrics",{region:l.replace(e),namespace:l.replace(t)})},this.getDimensionKeys=function(t,e){return this.doMetricQueryRequest("dimension_keys",{region:l.replace(e),namespace:l.replace(t)})},this.getDimensionValues=function(t,e,n,r,i){return this.doMetricQueryRequest("dimension_values",{region:l.replace(t),namespace:l.replace(e),metricName:l.replace(n),dimensionKey:l.replace(r),dimensions:this.convertDimensionFormat(i,{})})},this.getEbsVolumeIds=function(t,e){return this.doMetricQueryRequest("ebs_volume_ids",{region:l.replace(t),instanceId:l.replace(e)})},this.getEc2InstanceAttribute=function(t,e,n){return this.doMetricQueryRequest("ec2_instance_attribute",{region:l.replace(t),attributeName:l.replace(e),filters:n})},this.metricFindQuery=function(t){var e,n,r;if(t.match(/^regions\(\)/))return this.getRegions();if(t.match(/^namespaces\(\)/))return this.getNamespaces();var i=t.match(/^metrics\(([^\)]+?)(,\s?([^,]+?))?\)/);if(i)return n=i[1],e=i[3],this.getMetrics(n,e);var a=t.match(/^dimension_keys\(([^\)]+?)(,\s?([^,]+?))?\)/);if(a)return n=a[1],e=a[3],this.getDimensionKeys(n,e);var s=t.match(/^dimension_values\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/);if(s){e=s[1],n=s[2],r=s[3];var u=s[4];return this.getDimensionValues(e,n,r,u,{})}var c=t.match(/^ebs_volume_ids\(([^,]+?),\s?([^,]+?)\)/);if(c){e=c[1];var h=c[2];return this.getEbsVolumeIds(e,h)}var f=t.match(/^ec2_instance_attribute\(([^,]+?),\s?([^,]+?),\s?(.+?)\)/);if(f){e=f[1];var d=f[2],p=JSON.parse(l.replace(f[3]));return this.getEc2InstanceAttribute(e,d,p)}return o.when([])},this.annotationQuery=function(t){var n=t.annotation,r=e.map(n.statistics,function(t){return l.replace(t)}),i=n.prefixMatching?"":"300",a=n.period||i;a=parseInt(a,10);var o={prefixMatching:n.prefixMatching,region:l.replace(n.region),namespace:l.replace(n.namespace),metricName:l.replace(n.metricName),dimensions:this.convertDimensionFormat(n.dimensions,{}),statistics:r,period:a,actionPrefix:n.actionPrefix||"",alarmNamePrefix:n.alarmNamePrefix||""};return s.post("/api/tsdb/query",{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[e.extend({refId:"annotationQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"annotationQuery"},o)]}).then(function(t){return e.map(t.results.annotationQuery.tables[0].rows,function(t){return{annotation:n,time:Date.parse(t[0]),title:t[1],tags:[t[2]],text:t[3]}})})},this.targetContainsTemplate=function(t){return l.variableExists(t.region)||l.variableExists(t.namespace)||l.variableExists(t.metricName)||e.find(t.dimensions,function(t,e){return l.variableExists(e)||l.variableExists(t)})},this.testDatasource=function(){var t=this.defaultRegion,e={};return this.getDimensionValues(t,"AWS/Billing","EstimatedCharges","ServiceName",e).then(function(){return{status:"success",message:"Data source is working"}},function(t){return{status:"error",message:t.message}})},this.awsRequest=function(t){var e={method:"POST",url:this.proxyUrl,data:t};return s.datasourceRequest(e).then(function(t){return t.data})},this.getDefaultRegion=function(){return this.defaultRegion},this.getExpandedVariables=function(n,r,i,a){var o=e.find(i.options,{selected:!0,text:"All"});return e.chain(i.options).filter(function(t){return o?"All"!==t.text:t.selected}).map(function(e){var o=t.copy(n),s={};return s[i.name]=e,o.refId=n.refId+"_"+e.value,o.dimensions[r]=a.replace(o.dimensions[r],s),o}).value()},this.expandTemplateVariable=function(t,n,r){var i=this;return e.chain(t).map(function(t){var o=e.findKey(t.dimensions,function(t){return r.variableExists(t)&&!e.has(n,r.getVariableName(t))});if(o){var s=e.find(r.variables,function(e){return a.containsVariable(t.dimensions[o],e.name)&&e.multi}),l=e.find(r.variables,function(e){return a.containsVariable(t.dimensions[o],e.name)});return i.getExpandedVariables(t,o,s||l,r)}return[t]}).flatten().value()},this.convertToCloudWatchTime=function(t,n){return e.isString(t)&&(t=r.parse(t,n)),Math.round(t.valueOf()/1e3)},this.convertDimensionFormat=function(t,n){var r={};return e.each(t,function(t,e){r[l.replace(e,n)]=l.replace(t,n)}),r}}return o.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],o}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(822),i=(n.n(r),n(797)),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.aliasSyntax="{{metric}} {{stat}} {{namespace}} {{region}} {{<dimension name>}}",r}return a(e,t),e.$inject=["$scope","$injector"],e.templateUrl="partials/query.editor.html",e}(i.QueryCtrl)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.accessKeyExist=!1,this.secretKeyExist=!1,this.authTypes=[{name:"Access & secret key",value:"keys"},{name:"Credentials file",value:"credentials"},{name:"ARN",value:"arn"}],this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp",this.current.jsonData.authType=this.current.jsonData.authType||"credentials",this.accessKeyExist=this.current.secureJsonFields.accessKey,this.secretKeyExist=this.current.secureJsonFields.secretKey}return t.$inject=["$scope"],t.prototype.resetAccessKey=function(){this.accessKeyExist=!1},t.prototype.resetSecretKey=function(){this.secretKeyExist=!1},t.templateUrl="partials/config.html",t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryOptionsCtrl",function(){return o}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(936),i=n(940),a=n(943);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a}),n.d(e,"ConfigCtrl",function(){return a.a});var o=function(){function t(){}return t.templateUrl="partials/query.options.html",t}(),s=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(1),l=n.n(s),u=n(937),c=n(938),h=n(939),f=function(){function t(t,e,n,r,i){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.timeSrv=i,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.url=t.url,this.name=t.name,this.index=t.index,this.timeField=t.jsonData.timeField,this.esVersion=t.jsonData.esVersion,this.indexPattern=new c.a(t.index,t.jsonData.interval),this.interval=t.jsonData.timeInterval,this.queryBuilder=new u.a({timeField:this.timeField,esVersion:this.esVersion})}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype.request=function(t,e,n){var r={url:this.url+"/"+e,method:t,data:n};return(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(r)},t.prototype.get=function(t){var e=this.timeSrv.timeRange(),n=this.indexPattern.getIndexList(e.from.valueOf(),e.to.valueOf());return o.a.isArray(n)&&n.length?this.request("GET",n[0]+t).then(function(t){return t.data.$$config=t.config,t.data}):this.request("GET",this.indexPattern.getIndexForToday()+t).then(function(t){return t.data.$$config=t.config,t.data})},t.prototype.post=function(t,e){return this.request("POST",t,e).then(function(t){return t.data.$$config=t.config,t.data})},t.prototype.annotationQuery=function(t){var e=t.annotation,n=e.timeField||"@timestamp",r=e.query||"*",a=e.tagsField||"tags",s=e.textField||null,u={};u[n]={from:t.range.from.valueOf(),to:t.range.to.valueOf(),format:"epoch_millis"};var c=this.templateSrv.replace(r,{},"lucene"),h={bool:{filter:[{range:u},{query_string:{query:c}}]}},f={query:h,size:1e4};this.esVersion<5&&(f.fields=[n,"_source"]);var d={search_type:"query_then_fetch",ignore_unavailable:!0};e.index?d.index=e.index:d.index=this.indexPattern.getIndexList(t.range.from,t.range.to);var p=i.a.toJson(d)+"\n"+i.a.toJson(f)+"\n";return this.post("_msearch",p).then(function(t){for(var r=[],i=t.responses[0].hits.hits,u=function(t,e){if(e){for(var n=e.split("."),r=t,i=0;i<n.length;i++)if(!(r=r[n[i]]))return console.log("could not find field in annotation: ",e),"";return r}},c=0;c<i.length;c++){var h=i[c]._source,f=h[n];if(void 0!==i[c].fields){var d=i[c].fields;(o.a.isString(d[n])||o.a.isNumber(d[n]))&&(f=d[n])}var p={annotation:e,time:l.a.utc(f).valueOf(),text:u(h,s),tags:u(h,a)};if(e.titleField){var m=u(h,e.titleField);m&&(p.text=m+"\n"+p.text)}"string"==typeof p.tags&&(p.tags=p.tags.split(",")),r.push(p)}return r})},t.prototype.testDatasource=function(){return this.timeSrv.setTime({from:"now-1m",to:"now"},!0),this.getFields({type:"date"}).then(function(t){return o.a.find(t,{text:this.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"error",message:"No date field named "+this.timeField+" found"}}.bind(this),function(t){if(console.log(t),t.data&&t.data.error){var e=i.a.toJson(t.data.error);return t.data.error.reason&&(e=t.data.error.reason),{status:"error",message:e}}return{status:"error",message:t.status}})},t.prototype.getQueryHeader=function(t,e,n){return i.a.toJson({search_type:t,ignore_unavailable:!0,index:this.indexPattern.getIndexList(e,n)})},t.prototype.query=function(t){for(var e,n="",r=[],a=this.templateSrv.getAdhocFilters(this.name),o=0;o<t.targets.length;o++)if(e=t.targets[o],!e.hide){var s=this.templateSrv.replace(e.query||"*",t.scopedVars,"lucene"),l=this.queryBuilder.build(e,a,s),u=i.a.toJson(l),c=0===l.size&&this.esVersion<5?"count":"query_then_fetch",f=this.getQueryHeader(c,t.range.from,t.range.to);n+=f+"\n",n+=u+"\n",r.push(e)}return 0===r.length?this.$q.when([]):(n=n.replace(/\$timeFrom/g,t.range.from.valueOf()),n=n.replace(/\$timeTo/g,t.range.to.valueOf()),n=this.templateSrv.replace(n,t.scopedVars),this.post("_msearch",n).then(function(t){return new h.a(r,t).getTimeSeries()}))},t.prototype.getFields=function(t){return this.get("/_mapping").then(function(e){function n(t,e,n){return"_"!==e[0]&&(!n.type||(n.type===t.type||n.type===i[t.type]))}function r(e){for(var i in e){var l=e[i];if(o.a.isObject(l.properties)&&(a.push(i),r(l.properties)),o.a.isObject(l.fields)&&(a.push(i),r(l.fields)),o.a.isString(l.type)){var u=a.concat(i).join(".");n(l,i,t)&&(s[u]={text:u,type:l.type})}}a.pop()}var i={float:"number",double:"number",integer:"number",long:"number",date:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"},a=[],s={};for(var l in e){var u=e[l];if(u&&u.mappings){var c=u.mappings;for(var h in c){r(c[h].properties)}}}return o.a.map(s,function(t){return t})})},t.prototype.getTerms=function(t){var e=this.timeSrv.timeRange(),n=this.esVersion>=5?"query_then_fetch":"count",r=this.getQueryHeader(n,e.from,e.to),a=i.a.toJson(this.queryBuilder.getTermsQuery(t));return a=a.replace(/\$timeFrom/g,e.from.valueOf()),a=a.replace(/\$timeTo/g,e.to.valueOf()),a=r+"\n"+a+"\n",this.post("_msearch?search_type="+n,a).then(function(t){if(!t.responses[0].aggregations)return[];var e=t.responses[0].aggregations[1].buckets;return o.a.map(e,function(t){return{text:t.key_as_string||t.key,value:t.key}})})},t.prototype.metricFindQuery=function(t){return t=i.a.fromJson(t),t?"fields"===t.find?(t.field=this.templateSrv.replace(t.field,{},"lucene"),this.getFields(t)):"terms"===t.find?(t.query=this.templateSrv.replace(t.query||"*",{},"lucene"),this.getTerms(t)):void 0:this.$q.when([])},t.prototype.getTagKeys=function(){return this.getFields({})},t.prototype.getTagValues=function(t){return this.getTerms({field:t.key,query:"*"})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(803),i=function(){function t(t){this.timeField=t.timeField,this.esVersion=t.esVersion}return t.prototype.getRangeFilter=function(){var t={};return t[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},t},t.prototype.buildTermsAgg=function(t,e,n){var r,i,a;if(e.terms={field:t.field},!t.settings)return e;if(e.terms.size=0===parseInt(t.settings.size,10)?500:parseInt(t.settings.size,10),void 0!==t.settings.orderBy&&(e.terms.order={},e.terms.order[t.settings.orderBy]=t.settings.order,r=parseInt(t.settings.orderBy,10),!isNaN(r)))for(a=0;a<n.metrics.length;a++)if(i=n.metrics[a],i.id===t.settings.orderBy){e.aggs={},e.aggs[i.id]={},e.aggs[i.id][i.type]={field:i.field};break}return void 0!==t.settings.min_doc_count&&(e.terms.min_doc_count=parseInt(t.settings.min_doc_count,10)),t.settings.missing&&(e.terms.missing=t.settings.missing),e},t.prototype.getDateHistogramAgg=function(t){var e={},n=t.settings||{};return e.interval=n.interval,e.field=this.timeField,e.min_doc_count=n.min_doc_count||0,e.extended_bounds={min:"$timeFrom",max:"$timeTo"},e.format="epoch_millis","auto"===e.interval&&(e.interval="$__interval"),n.missing&&(e.missing=n.missing),e},t.prototype.getHistogramAgg=function(t){var e={},n=t.settings||{};return e.interval=n.interval,e.field=t.field,e.min_doc_count=n.min_doc_count||0,n.missing&&(e.missing=n.missing),e},t.prototype.getFiltersAgg=function(t){for(var e={},n=0;n<t.settings.filters.length;n++){var r=t.settings.filters[n].query,i=t.settings.filters[n].label;i=""===i||void 0===i?r:i,e[i]={query_string:{query:r,analyze_wildcard:!0}}}return e},t.prototype.documentQuery=function(t,e){return t.size=e,t.sort={},t.sort[this.timeField]={order:"desc",unmapped_type:"boolean"},this.esVersion<5&&(t.fields=["*","_source"]),t.script_fields={},this.esVersion<5?t.fielddata_fields=[this.timeField]:t.docvalue_fields=[this.timeField],t},t.prototype.addAdhocFilters=function(t,e){if(e){var n,r,i,a;for(n=0;n<e.length;n++)switch(r=e[n],i={},i[r.key]=r.value,a={},a[r.key]={query:r.value},r.operator){case"=":t.query.bool.must||(t.query.bool.must=[]),t.query.bool.must.push({match_phrase:a});break;case"!=":t.query.bool.must_not||(t.query.bool.must_not=[]),t.query.bool.must_not.push({match_phrase:a});break;case"<":i[r.key]={lt:r.value},t.query.bool.filter.push({range:i});break;case">":i[r.key]={gt:r.value},t.query.bool.filter.push({range:i});break;case"=~":t.query.bool.filter.push({regexp:i});break;case"!~":t.query.bool.filter.push({bool:{must_not:{regexp:i}}})}}},t.prototype.build=function(t,e,n){t.metrics=t.metrics||[{type:"count",id:"1"}],t.dsType="elasticsearch",t.bucketAggs=t.bucketAggs||[{type:"date_histogram",id:"2",settings:{interval:"auto"}}],t.timeField=this.timeField;var i,a,o,s={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:n}}]}}};if(this.addAdhocFilters(s,e),0===t.bucketAggs.length){if(!(o=t.metrics[0])||"raw_document"!==o.type)throw{message:"Invalid query"};var l=o.settings&&o.settings.size||500;return this.documentQuery(s,l)}for(a=s,i=0;i<t.bucketAggs.length;i++){var u=t.bucketAggs[i],c={};switch(u.type){case"date_histogram":c.date_histogram=this.getDateHistogramAgg(u);break;case"histogram":c.histogram=this.getHistogramAgg(u);break;case"filters":c.filters={filters:this.getFiltersAgg(u)};break;case"terms":this.buildTermsAgg(u,c,t);break;case"geohash_grid":c.geohash_grid={field:u.field,precision:u.settings.precision}}a.aggs=a.aggs||{},a.aggs[u.id]=c,a=c}for(a.aggs={},i=0;i<t.metrics.length;i++)if(o=t.metrics[i],"count"!==o.type){var h={},f=null;if(r.isPipelineAgg(o.type)){if(!o.pipelineAgg||!/^\d*$/.test(o.pipelineAgg))continue;f={buckets_path:o.pipelineAgg}}else f={field:o.field};for(var d in o.settings)o.settings.hasOwnProperty(d)&&null!==o.settings[d]&&(f[d]=o.settings[d]);h[o.type]=f,a.aggs[o.id]=h}return s},t.prototype.getTermsQuery=function(t){var e={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};t.query&&e.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:t.query}});var n=500;return t.size&&(n=t.size),e.aggs={1:{terms:{field:t.field,size:n,order:{_term:"asc"}}}},e},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(1),i=n.n(r),a={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}},o=function(){function t(t,e){this.pattern=t,this.interval=e}return t.prototype.getIndexForToday=function(){return this.interval?i.a.utc().format(this.pattern):this.pattern},t.prototype.getIndexList=function(t,e){if(!this.interval)return this.pattern;for(var n=a[this.interval],r=i()(t).utc().startOf(n.startOf),o=i()(e).utc().startOf(n.startOf).valueOf(),s=[];r.valueOf()<=o;)s.push(r.format(this.pattern)),r.add(1,n.amount);return s},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(4),i=n.n(r),a=n(803),o=n(802),s=function(){function t(t,e){this.targets=t,this.response=e,this.targets=t,this.response=e}return t.prototype.processMetrics=function(t,e,n,r){var i,a,o,s,l,u;for(a=0;a<e.metrics.length;a++)if(i=e.metrics[a],!i.hide)switch(i.type){case"count":for(s={datapoints:[],metric:"count",props:r},o=0;o<t.buckets.length;o++)l=t.buckets[o],u=l.doc_count,s.datapoints.push([u,l.key]);n.push(s);break;case"percentiles":if(0===t.buckets.length)break;var c=t.buckets[0],h=c[i.id].values;for(var f in h){for(s={datapoints:[],metric:"p"+f,props:r,field:i.field},o=0;o<t.buckets.length;o++){l=t.buckets[o];var d=l[i.id].values;s.datapoints.push([d[f],l.key])}n.push(s)}break;case"extended_stats":for(var p in i.meta)if(i.meta[p]){for(s={datapoints:[],metric:p,props:r,field:i.field},o=0;o<t.buckets.length;o++){l=t.buckets[o];var m=l[i.id];m.std_deviation_bounds_upper=m.std_deviation_bounds.upper,m.std_deviation_bounds_lower=m.std_deviation_bounds.lower,s.datapoints.push([m[p],l.key])}n.push(s)}break;default:for(s={datapoints:[],metric:i.type,field:i.field,props:r},o=0;o<t.buckets.length;o++)l=t.buckets[o],void 0!==(u=l[i.id])&&(u.normalized_value?s.datapoints.push([u.normalized_value,l.key]):s.datapoints.push([u.value,l.key]));n.push(s)}},t.prototype.processAggregationDocs=function(t,e,n,r,a){if(0===r.columns.length){for(var o=0,s=i.a.keys(a);o<s.length;o++){var l=s[o];r.addColumn({text:l,filterable:!0})}r.addColumn({text:e.field,filterable:!0})}for(var u=function(t,e,n){r.addColumn({text:e}),t.push(n)},c=0,h=t.buckets;c<h.length;c++){for(var f=h[c],d=[],p=0,m=i.a.values(a);p<m.length;p++){var g=m[p];d.push(g)}d.push(f.key);for(var v=0,y=n.metrics;v<y.length;v++){var b=y[v];switch(b.type){case"count":u(d,this.getMetricName(b.type),f.doc_count);break;case"extended_stats":for(var x in b.meta)if(b.meta[x]){var _=f[b.id];_.std_deviation_bounds_upper=_.std_deviation_bounds.upper,_.std_deviation_bounds_lower=_.std_deviation_bounds.lower,u(d,this.getMetricName(x),_[x])}break;default:var w=this.getMetricName(b.type);i.a.filter(n.metrics,{type:b.type}).length>1&&(w+=" "+b.field),u(d,w,f[b.id].value)}}r.rows.push(d)}},t.prototype.processBuckets=function(t,e,n,r,a,o){var s,l,u,c,h=e.bucketAggs.length-1;for(c in t)if(l=i.a.find(e.bucketAggs,{id:c}),u=t[c],l)if(o===h)"date_histogram"===l.type?this.processMetrics(u,e,n,a):this.processAggregationDocs(u,l,e,r,a);else for(var f in u.buckets)s=u.buckets[f],a=i.a.clone(a),void 0!==s.key?a[l.field]=s.key:a.filter=f,s.key_as_string&&(a[l.field]=s.key_as_string),this.processBuckets(s,e,n,r,a,o+1)},t.prototype.getMetricName=function(t){var e=i.a.find(a.metricAggTypes,{value:t});return e||(e=i.a.find(a.extendedStats,{value:t})),e?e.text:t},t.prototype.getSeriesName=function(t,e,n){var r=this.getMetricName(t.metric);if(e.alias){var o=/\{\{([\s\S]+?)\}\}/g;return e.alias.replace(o,function(e,n,i){var a=n||i;return 0===a.indexOf("term ")?t.props[a.substring(5)]:void 0!==t.props[a]?t.props[a]:"metric"===a?r:"field"===a?t.field:e})}if(t.field&&a.isPipelineAgg(t.metric)){var s=i.a.find(e.metrics,{id:t.field});s?r+=" "+a.describeMetric(s):r="Unset"}else t.field&&(r+=" "+t.field);if(0===i.a.keys(t.props).length)return r;var l="";for(var u in t.props)l+=t.props[u]+" ";return 1===n?l.trim():l.trim()+" "+r},t.prototype.nameSeries=function(t,e){for(var n=i.a.uniq(i.a.map(t,"metric")).length,r=0;r<t.length;r++){var a=t[r];a.target=this.getSeriesName(a,e,n)}},t.prototype.processHits=function(t,e){var n,r,i,a,o={target:"docs",type:"docs",datapoints:[],total:t.total,filterable:!0};for(a=0;a<t.hits.length;a++){if(r=t.hits[a],i={_id:r._id,_type:r._type,_index:r._index},r._source)for(n in r._source)i[n]=r._source[n];for(n in r.fields)i[n]=r.fields[n];o.datapoints.push(i)}e.push(o)},t.prototype.trimDatapoints=function(t,e){var n=i.a.find(e.bucketAggs,{type:"date_histogram"});if(n&&n.settings&&n.settings.trimEdges){var r=n.settings.trimEdges;for(var a in t){var o=t[a];o.datapoints.length>2*r&&(o.datapoints=o.datapoints.slice(r,o.datapoints.length-r))}}},t.prototype.getErrorFromElasticResponse=function(t,e){var n={};return n.data=JSON.stringify(e,null,4),e.root_cause&&e.root_cause.length>0&&e.root_cause[0].reason?n.message=e.root_cause[0].reason:n.message=e.reason||"Unkown elatic error response",t.$$config&&(n.config=t.$$config),n},t.prototype.getTimeSeries=function(){for(var t=[],e=0;e<this.response.responses.length;e++){var n=this.response.responses[e];if(n.error)throw this.getErrorFromElasticResponse(this.response,n.error);if(n.hits&&n.hits.hits.length>0&&this.processHits(n.hits,t),n.aggregations){var r=n.aggregations,i=this.targets[e],a=[],s=new o.default;this.processBuckets(r,i,a,s,{},0),this.trimDatapoints(a,i),this.nameSeries(a,i);for(var l=0;l<a.length;l++)t.push(a[l]);s.rows.length>0&&t.push(s)}}return{data:t}},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(941),i=(n.n(r),n(942)),a=(n.n(i),n(8)),o=n.n(a),s=n(4),l=n.n(s),u=n(803),c=n(797),h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(e,n,r,i){var a=t.call(this,e,n)||this;return a.$rootScope=r,a.uiSegmentSrv=i,a.esVersion=a.datasource.esVersion,a.queryUpdated(),a}return h(e,t),e.$inject=["$scope","$injector","$rootScope","uiSegmentSrv"],e.prototype.getFields=function(t){var e=o.a.toJson({find:"fields",type:t});return this.datasource.metricFindQuery(e).then(this.uiSegmentSrv.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.queryUpdated=function(){var t=o.a.toJson(this.datasource.queryBuilder.build(this.target),!0);this.rawQueryOld&&t!==this.rawQueryOld&&this.refresh(),this.rawQueryOld=t,this.$rootScope.appEvent("elastic-query-updated")},e.prototype.getCollapsedText=function(){var t=this.target.metrics,e=this.target.bucketAggs,n=u.getMetricAggTypes(this.esVersion),r=u.bucketAggTypes,i="";return this.target.query&&(i+="Query: "+this.target.query+", "),i+="Metrics: ",l.a.each(t,function(t,e){var r=l.a.find(n,{value:t.type});i+=r.text+"(",r.requiresField&&(i+=t.field),i+="), "}),l.a.each(e,function(t,e){0===e&&(i+=" Group by: ");var n=l.a.find(r,{value:t.type});i+=n.text+"(",n.requiresField&&(i+=t.field),i+="), "}),this.target.alias&&(i+="Alias: "+this.target.alias),i},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.templateUrl="partials/query.editor.html",e}(c.QueryCtrl)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(803)],void 0!==(i=function(t,e,n){"use strict";var r=t.module("grafana.directives");r.directive("elasticBucketAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/bucket_agg.html",controller:"ElasticBucketAggCtrl",restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&"}}}),r.controller("ElasticBucketAggCtrl",["$scope","uiSegmentSrv","$q","$rootScope",function(t,r,i,a){var o=t.target.bucketAggs;t.orderByOptions=[],t.getBucketAggTypes=function(){return n.bucketAggTypes},t.getOrderOptions=function(){return n.orderOptions},t.getSizeOptions=function(){return n.sizeOptions},a.onAppEvent("elastic-query-updated",function(){t.validateModel()},t),t.init=function(){t.agg=o[t.index],t.validateModel()},t.onChangeInternal=function(){t.onChange()},t.onTypeChanged=function(){switch(t.agg.settings={},t.showOptions=!1,t.agg.type){case"date_histogram":case"histogram":case"terms":delete t.agg.query,t.agg.field="select field";break;case"filters":delete t.agg.field,t.agg.query="*";break;case"geohash_grid":t.agg.settings.precision=3}t.validateModel(),t.onChange()},t.validateModel=function(){t.index=e.indexOf(o,t.agg),t.isFirst=0===t.index,t.bucketAggCount=o.length;var r="",i=t.agg.settings||{};switch(t.agg.type){case"terms":i.order=i.order||"desc",i.size=i.size||"10",i.min_doc_count=i.min_doc_count||1,i.orderBy=i.orderBy||"_term","0"!==i.size&&(r=n.describeOrder(i.order)+" "+i.size+", "),i.min_doc_count>0&&(r+="Min Doc Count: "+i.min_doc_count+", "),r+="Order by: "+n.describeOrderBy(i.orderBy,t.target),"0"===i.size&&(r+=" ("+i.order+")");break;case"filters":i.filters=i.filters||[{query:"*"}],r=e.reduce(i.filters,function(t,e,n){return t+="Q"+(n+1)+"  = "+e.query+" "},""),r.length>50&&(r=r.substr(0,50)+"..."),r="Filter Queries ("+i.filters.length+")";break;case"date_histogram":i.interval=i.interval||"auto",i.min_doc_count=i.min_doc_count||0,t.agg.field=t.target.timeField,r="Interval: "+i.interval,i.min_doc_count>0&&(r+=", Min Doc Count: "+i.min_doc_count),(void 0===i.trimEdges||i.trimEdges<0)&&(i.trimEdges=0),i.trimEdges&&i.trimEdges>0&&(r+=", Trim edges: "+i.trimEdges);break;case"histogram":i.interval=i.interval||1e3,i.min_doc_count=e.defaultTo(i.min_doc_count,1),r="Interval: "+i.interval,i.min_doc_count>0&&(r+=", Min Doc Count: "+i.min_doc_count);break;case"geohash_grid":i.precision=Math.max(Math.min(i.precision,7),1),r="Precision: "+i.precision}return t.settingsLinkText=r,t.agg.settings=i,!0},t.addFiltersQuery=function(){t.agg.settings.filters.push({query:"*"})},t.removeFiltersQuery=function(n){t.agg.settings.filters=e.without(t.agg.settings.filters,n)},t.toggleOptions=function(){t.showOptions=!t.showOptions},t.getOrderByOptions=function(){return n.getOrderByOptions(t.target)},t.getFieldsInternal=function(){return"date_histogram"===t.agg.type?t.getFields({$fieldType:"date"}):t.getFields()},t.getIntervalOptions=function(){return i.when(r.transformToSegments(!0,"interval")(n.intervalOptions))},t.addBucketAgg=function(){var n=o[o.length-1],r=o.length-1;n&&n.type;var i=e.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id)>t?parseInt(e.id):t},0);o.splice(r,0,{type:"terms",field:"select field",id:(i+1).toString(),fake:!0}),t.onChange()},t.removeBucketAgg=function(){o.splice(t.index,1),t.onChange()},t.init()}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(803)],void 0!==(i=function(t,e,n){"use strict";var r=t.module("grafana.directives");r.directive("elasticMetricAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/metric_agg.html",controller:"ElasticMetricAggCtrl",restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&",esVersion:"="}}}),r.controller("ElasticMetricAggCtrl",["$scope","uiSegmentSrv","$q","$rootScope",function(t,r,i,a){var o=t.target.metrics;t.metricAggTypes=n.getMetricAggTypes(t.esVersion),t.extendedStats=n.extendedStats,t.pipelineAggOptions=[],t.modelSettingsValues={},t.init=function(){t.agg=o[t.index],t.validateModel(),t.updatePipelineAggOptions()},t.updatePipelineAggOptions=function(){t.pipelineAggOptions=n.getPipelineAggOptions(t.target)},a.onAppEvent("elastic-query-updated",function(){t.index=e.indexOf(o,t.agg),t.updatePipelineAggOptions(),t.validateModel()},t),t.validateModel=function(){if(t.isFirst=0===t.index,t.isSingle=1===o.length,t.settingsLinkText="",t.aggDef=e.find(t.metricAggTypes,{value:t.agg.type}),n.isPipelineAgg(t.agg.type)){t.agg.pipelineAgg=t.agg.pipelineAgg||"select metric",t.agg.field=t.agg.pipelineAgg;var r=n.getPipelineOptions(t.agg);r.length>0&&(e.each(r,function(e){t.agg.settings[e.text]=t.agg.settings[e.text]||e.default}),t.settingsLinkText="Options")}else t.agg.field||(t.agg.field="select field");switch(t.agg.type){case"cardinality":var i=t.agg.settings.precision_threshold||"";t.settingsLinkText="Precision threshold: "+i;break;case"percentiles":t.agg.settings.percents=t.agg.settings.percents||[25,50,75,95,99],t.settingsLinkText="Values: "+t.agg.settings.percents.join(",");break;case"extended_stats":0===e.keys(t.agg.meta).length&&(t.agg.meta.std_deviation_bounds_lower=!0,t.agg.meta.std_deviation_bounds_upper=!0);var a=e.reduce(t.agg.meta,function(n,r,i){if(r){var a=e.find(t.extendedStats,{value:i});n.push(a.text)}return n},[]);t.settingsLinkText="Stats: "+a.join(", ");break;case"moving_avg":t.movingAvgModelTypes=n.movingAvgModelOptions,t.modelSettings=n.getMovingAvgSettings(t.agg.settings.model,!0),t.updateMovingAvgModelSettings();break;case"raw_document":t.agg.settings.size=t.agg.settings.size||500,t.settingsLinkText="Size: "+t.agg.settings.size,t.target.metrics.splice(0,t.target.metrics.length,t.agg),t.target.bucketAggs=[]}if(t.aggDef.supportsInlineScript){var s=t.agg.inlineScript;s?t.agg.settings.script={inline:s}:delete t.agg.settings.script,""===t.settingsLinkText&&(t.settingsLinkText="Options")}},t.toggleOptions=function(){t.showOptions=!t.showOptions,t.updatePipelineAggOptions()},t.onChangeInternal=function(){t.onChange()},t.updateMovingAvgModelSettings=function(){for(var e=[],r=n.getMovingAvgSettings(t.agg.settings.model,!1),i=0;i<r.length;i++)e.push(r[i].value);for(var a in t.agg.settings.settings)null!==t.agg.settings.settings[a]&&-1!==e.indexOf(a)||delete t.agg.settings.settings[a]},t.onChangeClearInternal=function(){delete t.agg.settings.minimize,t.onChange()},t.onTypeChange=function(){t.agg.settings={},t.agg.meta={},t.showOptions=!1,t.updatePipelineAggOptions(),t.onChange()},t.getFieldsInternal=function(){return"cardinality"===t.agg.type?t.getFields():t.getFields({$fieldType:"number"})},t.addMetricAgg=function(){var n=o.length,r=e.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id)>t?parseInt(e.id):t},0);o.splice(n,0,{type:"count",field:"select field",id:(r+1).toString()}),t.onChange()},t.removeMetricAgg=function(){o.splice(t.index,1),t.onChange()},t.toggleShowMetric=function(){t.agg.hide=!t.agg.hide,t.agg.hide||delete t.agg.hide,t.onChange()},t.init()}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(4),i=n.n(r),a=function(){function t(t){this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.esVersions=[{name:"2.x",value:2},{name:"5.x",value:5}],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp"}return t.$inject=["$scope"],t.prototype.indexPatternTypeChanged=function(){var t=i.a.find(this.indexPatternTypes,{value:this.current.jsonData.interval});this.current.database=t.example||"es-index-name"},t.templateUrl="public/app/plugins/datasource/elasticsearch/partials/config.html",t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(945),i=n.n(r),a=n(946),o=n(947);n.d(e,"Datasource",function(){return i.a}),n.d(e,"QueryCtrl",function(){return a.a}),n.d(e,"ConfigCtrl",function(){return o.a});var s=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){var r,i;r=[n(8),n(4),n(292),n(1)],void 0!==(i=function(t,e,n){"use strict";function r(r,i,a,o){function s(t,n,r,i,a){var o=l(t,r,n,i),s=[];return e.each(t.dps,function(t,e){2===a?s.push([t,1*e]):s.push([t,1e3*e])}),{target:o,datapoints:s}}function l(t,n,r,i){if(n.alias){var a=e.clone(i.scopedVars||{});return e.each(t.tags,function(t,e){a["tag_"+e]={value:t}}),o.replace(n.alias,a)}var s=t.metric,l=[];return e.isEmpty(t.tags)||e.each(e.toPairs(t.tags),function(t){e.has(r,t[0])&&l.push(t[0]+"="+t[1])}),e.isEmpty(l)||(s+="{"+l.join(", ")+"}"),s}function u(e,n,r){if(!e.metric||e.hide)return null;var i={metric:o.replace(e.metric,n.scopedVars,"pipe"),aggregator:"avg"};if(e.aggregator&&(i.aggregator=o.replace(e.aggregator)),e.shouldComputeRate&&(i.rate=!0,i.rateOptions={counter:!!e.isCounter},e.counterMax&&e.counterMax.length&&(i.rateOptions.counterMax=parseInt(e.counterMax)),e.counterResetValue&&e.counterResetValue.length&&(i.rateOptions.resetValue=parseInt(e.counterResetValue)),r>=2&&(i.rateOptions.dropResets=!(i.rateOptions.counterMax||i.rateOptions.ResetValue&&0!==i.rateOptions.ResetValue))),!e.disableDownsampling){var a=o.replace(e.downsampleInterval||n.interval);a.match(/\.[0-9]+s/)&&(a=1e3*parseFloat(a)+"ms"),i.downsample=a+"-"+e.downsampleAggregator,e.downsampleFillPolicy&&"none"!==e.downsampleFillPolicy&&(i.downsample+="-"+e.downsampleFillPolicy)}if(e.filters&&e.filters.length>0){if(i.filters=t.copy(e.filters),i.filters)for(var s in i.filters)i.filters[s].filter=o.replace(i.filters[s].filter,n.scopedVars,"pipe")}else if(i.tags=t.copy(e.tags),i.tags)for(var l in i.tags)i.tags[l]=o.replace(i.tags[l],n.scopedVars,"pipe");return e.explicitTags&&(i.explicitTags=!0),i}function c(t,n,r){var i;return e.map(t,function(t){return 3===r?t.query.index:e.findIndex(n.targets,function(r){return r.filters&&r.filters.length>0?r.metric===t.metric:r.metric===t.metric&&e.every(r.tags,function(e,r){return i=o.replace(e,n.scopedVars,"pipe"),t.tags[r]===i||"*"===i})})})}function h(t,e){return"now"===t?null:(t=n.parse(t,e),t.valueOf())}this.type="opentsdb",this.url=r.url,this.name=r.name,this.withCredentials=r.withCredentials,this.basicAuth=r.basicAuth,r.jsonData=r.jsonData||{},this.tsdbVersion=r.jsonData.tsdbVersion||1,this.tsdbResolution=r.jsonData.tsdbResolution||1,this.supportMetrics=!0,this.tagKeys={},this.query=function(t){var n=h(t.rangeRaw.from,!1),r=h(t.rangeRaw.to,!0),a=[];e.each(t.targets,function(e){e.metric&&a.push(u(e,t,this.tsdbVersion))}.bind(this));var o=e.compact(a);if(e.isEmpty(o)){var l=i.defer();return l.resolve({data:[]}),l.promise}var f={};return e.each(o,function(t){t.filters&&t.filters.length>0?e.each(t.filters,function(t){f[t.tagk]=!0}):e.each(t.tags,function(t,e){f[e]=!0})}),t.targets=e.filter(t.targets,function(t){return!0!==t.hide}),this.performTimeSeriesQuery(o,n,r).then(function(n){var r=c(n.data,t,this.tsdbVersion);return{data:e.map(n.data,function(e,n){return n=r[n],-1===n&&(n=0),this._saveTagKeys(e),s(e,f,t.targets[n],t,this.tsdbResolution)}.bind(this))}}.bind(this))},this.annotationQuery=function(t){var n=h(t.rangeRaw.from,!1),r=h(t.rangeRaw.to,!0),i=[],a=[];i.push({aggregator:"sum",metric:t.annotation.target});var o=e.compact(i);return this.performTimeSeriesQuery(o,n,r).then(function(n){if(n.data[0]){var r=n.data[0].annotations;t.annotation.isGlobal&&(r=n.data[0].globalAnnotations),r&&e.each(r,function(e){var n={text:e.description,time:1e3*Math.floor(e.startTime),annotation:t.annotation};a.push(n)})}return a}.bind(this))},this.targetContainsTemplate=function(t){if(t.filters&&t.filters.length>0)for(var e=0;e<t.filters.length;e++)if(o.variableExists(t.filters[e].filter))return!0;if(t.tags&&Object.keys(t.tags).length>0)for(var n in t.tags)if(o.variableExists(t.tags[n]))return!0;return!1},this.performTimeSeriesQuery=function(t,e,n){var r=!1;2===this.tsdbResolution&&(r=!0);var i={start:e,queries:t,msResolution:r,globalAnnotations:!0};3===this.tsdbVersion&&(i.showQuery=!0),n&&(i.end=n);var o={method:"POST",url:this.url+"/api/query",data:i};return this._addCredentialOptions(o),a.datasourceRequest(o)},this.suggestTagKeys=function(t){return i.when(this.tagKeys[t]||[])},this._saveTagKeys=function(t){var n=Object.keys(t.tags);e.each(t.aggregateTags,function(t){n.push(t)}),this.tagKeys[t.metric]=n},this._performSuggestQuery=function(t,e){return this._get("/api/suggest",{type:e,q:t,max:1e3}).then(function(t){return t.data})},this._performMetricKeyValueLookup=function(t,n){if(!t||!n)return i.when([]);var r=n.split(",").map(function(t){return t.trim()}),a=r[0],o=a+"=*";r.length>1&&(o+=","+r.splice(1).join(","));var s=t+"{"+o+"}";return this._get("/api/search/lookup",{m:s,limit:3e3}).then(function(t){t=t.data.results;var n=[];return e.each(t,function(t){-1===n.indexOf(t.tags[a])&&n.push(t.tags[a])}),n})},this._performMetricKeyLookup=function(t){return t?this._get("/api/search/lookup",{m:t,limit:1e3}).then(function(t){t=t.data.results;var n=[];return e.each(t,function(t){e.each(t.tags,function(t,e){-1===n.indexOf(e)&&n.push(e)})}),n}):i.when([])},this._get=function(t,e){var n={method:"GET",url:this.url+t,params:e};return this._addCredentialOptions(n),a.datasourceRequest(n)},this._addCredentialOptions=function(t){(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers={Authorization:this.basicAuth})},this.metricFindQuery=function(t){if(!t)return i.when([]);var n;try{n=o.replace(t,{},"distributed")}catch(t){return i.reject(t)}var r=function(t){return e.map(t,function(t){return{text:t}})},a=/metrics\((.*)\)/,s=/tag_names\((.*)\)/,l=/tag_values\((.*?),\s?(.*)\)/,u=/suggest_tagk\((.*)\)/,c=/suggest_tagv\((.*)\)/,h=n.match(a);if(h)return this._performSuggestQuery(h[1],"metrics").then(r);var f=n.match(s);if(f)return this._performMetricKeyLookup(f[1]).then(r);var d=n.match(l);if(d)return this._performMetricKeyValueLookup(d[1],d[2]).then(r);var p=n.match(u);if(p)return this._performSuggestQuery(p[1],"tagk").then(r);var m=n.match(c);return m?this._performSuggestQuery(m[1],"tagv").then(r):i.when([])},this.testDatasource=function(){return this._performSuggestQuery("cpu","metrics").then(function(){return{status:"success",message:"Data source is working"}})};var f=null;this.getAggregators=function(){return f||(f=this._get("/api/aggregators").then(function(t){return t.data&&e.isArray(t.data)?t.data.sort():[]}))};var d=null;this.getFilterTypes=function(){return d||(d=this._get("/api/config/filters").then(function(t){return t.data?Object.keys(t.data).sort():[]}))}}return r.$inject=["instanceSettings","$q","backendSrv","templateSrv"],r}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(4),i=n.n(r),a=n(109),o=n.n(a),s=n(797),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.errors=r.validateTarget(),r.aggregators=["avg","sum","min","max","dev","zimsum","mimmin","mimmax"],r.fillPolicies=["none","nan","null","zero"],r.filterTypes=["wildcard","iliteral_or","not_iliteral_or","not_literal_or","iwildcard","literal_or","regexp"],r.tsdbVersion=r.datasource.tsdbVersion,r.target.aggregator||(r.target.aggregator="sum"),r.target.downsampleAggregator||(r.target.downsampleAggregator="avg"),r.target.downsampleFillPolicy||(r.target.downsampleFillPolicy="none"),r.datasource.getAggregators().then(function(t){0!==t.length&&(r.aggregators=t)}),r.datasource.getFilterTypes().then(function(t){0!==t.length&&(r.filterTypes=t)}),r.suggestMetrics=function(t,e){r.datasource.metricFindQuery("metrics("+t+")").then(r.getTextValues).then(e)},r.suggestTagKeys=function(t,e){r.datasource.suggestTagKeys(r.target.metric).then(e)},r.suggestTagValues=function(t,e){r.datasource.metricFindQuery("suggest_tagv("+t+")").then(r.getTextValues).then(e)},r}return l(e,t),e.$inject=["$scope","$injector"],e.prototype.targetBlur=function(){this.errors=this.validateTarget(),this.refresh()},e.prototype.getTextValues=function(t){return i.a.map(t,function(t){return t.text})},e.prototype.addTag=function(){if(this.target.filters&&this.target.filters.length>0&&(this.errors.tags="Please remove filters to use tags, tags and filters are mutually exclusive."),!this.addTagMode)return void(this.addTagMode=!0);this.target.tags||(this.target.tags={}),this.errors=this.validateTarget(),this.errors.tags||(this.target.tags[this.target.currentTagKey]=this.target.currentTagValue,this.target.currentTagKey="",this.target.currentTagValue="",this.targetBlur()),this.addTagMode=!1},e.prototype.removeTag=function(t){delete this.target.tags[t],this.targetBlur()},e.prototype.editTag=function(t,e){this.removeTag(t),this.target.currentTagKey=t,this.target.currentTagValue=e,this.addTag()},e.prototype.closeAddTagMode=function(){this.addTagMode=!1},e.prototype.addFilter=function(){if(this.target.tags&&i.a.size(this.target.tags)>0&&(this.errors.filters="Please remove tags to use filters, tags and filters are mutually exclusive."),!this.addFilterMode)return void(this.addFilterMode=!0);if(this.target.filters||(this.target.filters=[]),this.target.currentFilterType||(this.target.currentFilterType="iliteral_or"),this.target.currentFilterGroupBy||(this.target.currentFilterGroupBy=!1),this.errors=this.validateTarget(),!this.errors.filters){var t={type:this.target.currentFilterType,tagk:this.target.currentFilterKey,filter:this.target.currentFilterValue,groupBy:this.target.currentFilterGroupBy};this.target.filters.push(t),this.target.currentFilterType="literal_or",this.target.currentFilterKey="",this.target.currentFilterValue="",this.target.currentFilterGroupBy=!1,this.targetBlur()}this.addFilterMode=!1},e.prototype.removeFilter=function(t){this.target.filters.splice(t,1),this.targetBlur()},e.prototype.editFilter=function(t,e){this.removeFilter(e),this.target.currentFilterKey=t.tagk,this.target.currentFilterValue=t.filter,this.target.currentFilterType=t.type,this.target.currentFilterGroupBy=t.groupBy,this.addFilter()},e.prototype.closeAddFilterMode=function(){this.addFilterMode=!1},e.prototype.validateTarget=function(){var t={};if(this.target.shouldDownsample)try{this.target.downsampleInterval?o.a.describe_interval(this.target.downsampleInterval):t.downsampleInterval="You must supply a downsample interval (e.g. '1m' or '1h')."}catch(e){t.downsampleInterval=e.message}return this.target.tags&&i.a.has(this.target.tags,this.target.currentTagKey)&&(t.tags="Duplicate tag key '"+this.target.currentTagKey+"'."),t},e.templateUrl="partials/query.editor.html",e}(s.QueryCtrl)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.tsdbVersions=[{name:"<=2.1",value:1},{name:"==2.2",value:2},{name:"==2.3",value:3}],this.tsdbResolutions=[{name:"second",value:1},{name:"millisecond",value:2}],this.current.jsonData=this.current.jsonData||{},this.current.jsonData.tsdbVersion=this.current.jsonData.tsdbVersion||1,this.current.jsonData.tsdbResolution=this.current.jsonData.tsdbResolution||1}return t.$inject=["$scope"],t.templateUrl="public/app/plugins/datasource/opentsdb/partials/config.html",t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryCtrl",function(){return o}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(949),i=n(797);n.d(e,"GrafanaDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a});var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.templateUrl="partials/query.editor.html",e}(i.QueryCtrl),s=function(){function t(){this.types=[{text:"Dashboard",value:"dashboard"},{text:"Tags",value:"tags"}],this.annotation.type=this.annotation.type||"tags",this.annotation.limit=this.annotation.limit||100}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(4),i=n.n(r),a=function(){function t(t,e){this.backendSrv=t,this.$q=e}return t.$inject=["backendSrv","$q"],t.prototype.query=function(t){return this.backendSrv.get("/api/tsdb/testdata/random-walk",{from:t.range.from.valueOf(),to:t.range.to.valueOf(),intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints}).then(function(t){var e=[];return t.results&&i.a.forEach(t.results,function(t){for(var n=0,r=t.series;n<r.length;n++){var i=r[n];e.push({target:i.name,datapoints:i.points})}}),{data:e}})},t.prototype.metricFindQuery=function(t){return this.$q.when({data:[]})},t.prototype.annotationQuery=function(t){var e={from:t.range.from.valueOf(),to:t.range.to.valueOf(),limit:t.annotation.limit,tags:t.annotation.tags};if("dashboard"===t.annotation.type){if(!t.dashboard.id)return this.$q.when([]);e.dashboardId=t.dashboard.id,delete e.tags}else if(!i.a.isArray(t.annotation.tags)||0===t.annotation.tags.length)return this.$q.when([]);return this.backendSrv.get("/api/annotations",e)},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return a}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(951),i=n(954);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a});var a=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=n(292),o=n(952),s=n.n(o),l=n(823),u=n(953),c=n(825),h=n.n(c),f=function(){function t(t,e,n,r){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.type="influxdb",this.urls=i.a.map(t.url.split(","),function(t){return t.trim()}),this.username=t.username,this.password=t.password,this.name=t.name,this.database=t.database,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=(t.jsonData||{}).timeInterval,this.supportAnnotations=!0,this.supportMetrics=!0,this.responseParser=new u.a}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv"],t.prototype.query=function(t){var e,n,r,a=this,o=this.getTimeFilter(t),u=t.scopedVars,c=i.a.cloneDeep(t.targets),h=[],f=i.a.map(c,function(t){return t.hide?"":(h.push(t),u.interval=u.__interval,e=new l.a(t,a.templateSrv,u),e.render(!0))}).reduce(function(t,e){return""!==e&&(t+=";"+e),t});if(""===f)return this.$q.when({data:[]});var d=this.templateSrv.getAdhocFilters(this.name);return d.length>0&&(o+=" AND "+e.renderAdhocFilters(d)),u.timeFilter={value:o},f=this.templateSrv.replace(f,u),this._seriesQuery(f).then(function(e){if(!e||!e.results)return[];var i=[];for(n=0;n<e.results.length;n++){var o=e.results[n];if(o&&o.series){var l=h[n],u=l.alias;u&&(u=a.templateSrv.replace(l.alias,t.scopedVars));var c=new s.a({series:e.results[n].series,alias:u});switch(l.resultFormat){case"table":i.push(c.getTable());break;default:var f=c.getTimeSeries();for(r=0;r<f.length;r++)i.push(f[r])}}}return{data:i}})},t.prototype.annotationQuery=function(t){if(!t.annotation.query)return this.$q.reject({message:"Query missing in annotation definition"});var e=this.getTimeFilter({rangeRaw:t.rangeRaw}),n=t.annotation.query.replace("$timeFilter",e);return n=this.templateSrv.replace(n,null,"regex"),this._seriesQuery(n).then(function(e){if(!e||!e.results||!e.results[0])throw{message:"No results in response from InfluxDB"};return new s.a({series:e.results[0].series,annotation:t.annotation}).getAnnotations()})},t.prototype.targetContainsTemplate=function(t){for(var e=0,n=t.groupBy;e<n.length;e++)for(var r=n[e],i=0,a=r.params;i<a.length;i++){var o=a[i];if(this.templateSrv.variableExists(o))return!0}for(var s in t.tags)if(this.templateSrv.variableExists(t.tags[s].value))return!0;return!1},t.prototype.metricFindQuery=function(t){var e=this.templateSrv.replace(t,null,"regex");return this._seriesQuery(e).then(i.a.curry(this.responseParser.parse)(t))},t.prototype.getTagKeys=function(t){var e=new h.a({measurement:"",tags:[]},this.database),n=e.buildExploreQuery("TAG_KEYS");return this.metricFindQuery(n)},t.prototype.getTagValues=function(t){var e=new h.a({measurement:"",tags:[]},this.database),n=e.buildExploreQuery("TAG_VALUES",t.key);return this.metricFindQuery(n)},t.prototype._seriesQuery=function(t){return t?this._influxRequest("GET","/query",{q:t,epoch:"ms"}):this.$q.when({results:[]})},t.prototype.serializeParams=function(t){return t?i.a.reduce(t,function(t,e,n){return null===e||void 0===e?t:(t.push(encodeURIComponent(n)+"="+encodeURIComponent(e)),t)},[]).join("&"):""},t.prototype.testDatasource=function(){var t=this;return this.metricFindQuery("SHOW DATABASES").then(function(e){return i.a.find(e,{text:t.database})?{status:"success",message:"Data source is working"}:{status:"error",message:"Could not find the specified database name."}}).catch(function(t){return{status:"error",message:t.message}})},t.prototype._influxRequest=function(t,e,n){var r=this,a=r.urls.shift();r.urls.push(a);var o={};r.username&&(o.u=r.username,o.p=r.password),r.database&&(o.db=r.database),"GET"===t&&(i.a.extend(o,n),n=null);var s={method:t,url:a+e,params:o,data:n,precision:"ms",inspect:{type:"influxdb"},paramSerializer:this.serializeParams};return s.headers=s.headers||{},(this.basicAuth||this.withCredentials)&&(s.withCredentials=!0),r.basicAuth&&(s.headers.Authorization=r.basicAuth),this.backendSrv.datasourceRequest(s).then(function(t){return t.data},function(t){if(0!==t.status||t.status>=300)throw t.data&&t.data.error?{message:"InfluxDB Error: "+t.data.error,data:t.data,config:t.config}:{message:"Network Error: "+t.statusText+"("+t.status+")",data:t.data,config:t.config}})},t.prototype.getTimeFilter=function(t){var e=this.getInfluxTime(t.rangeRaw.from,!1),n=this.getInfluxTime(t.rangeRaw.to,!0),r="ms"===e[e.length-1];return"now()"!==n||r?"time >= "+e+" and time <= "+n:"time >= "+e},t.prototype.getInfluxTime=function(t,e){if(i.a.isString(t)){if("now"===t)return"now()";var n=/^now-(\d+)([d|h|m|s])$/.exec(t);if(n){return"now() - "+parseInt(n[1])+n[2]}t=a.parse(t,e)}return t.valueOf()+"ms"},t}();e.a=f},function(t,e,n){var r,i;r=[n(4),n(802)],void 0!==(i=function(t,e){"use strict";function n(t){this.series=t.series,this.alias=t.alias,this.annotation=t.annotation}var r=n.prototype;return r.getTimeSeries=function(){var e,n,r=[],i=this;return 0===i.series.length?r:(t.each(i.series,function(a){var o=a.columns.length,s=t.map(a.tags,function(t,e){return e+": "+t});for(n=1;n<o;n++){var l=a.name,u=a.columns[n];"value"!==u&&(l=l+"."+u),i.alias?l=i._getSeriesName(a,n):a.tags&&(l=l+" {"+s.join(", ")+"}");var c=[];if(a.values)for(e=0;e<a.values.length;e++)c[e]=[a.values[e][n],a.values[e][0]];r.push({target:l,datapoints:c})}}),r)},r._getSeriesName=function(t,e){var n=/\$(\w+)|\[\[([\s\S]+?)\]\]/g,r=t.name.split(".");return this.alias.replace(n,function(n,i,a){var o=i||a,s=parseInt(o,10);if("m"===o||"measurement"===o)return t.name;if("col"===o)return t.columns[e];if(!isNaN(s))return r[s];if(0!==o.indexOf("tag_"))return n;var l=o.replace("tag_","");return t.tags?t.tags[l]:n})},r.getAnnotations=function(){var e=[],n=this;return t.each(this.series,function(r){var i=null,a=null,o=[],s=null;t.each(r.columns,function(e,r){if("time"===e)return void(a=r);if("sequence_number"!==e)return i||(i=r),e===n.annotation.titleColumn?void(i=r):t.includes((n.annotation.tagsColumn||"").replace(" ","").split(","),e)?void o.push(r):e===n.annotation.textColumn?void(s=r):void 0}),t.each(r.values,function(r){var l={annotation:n.annotation,time:+new Date(r[a]),title:r[i],tags:t.flatten(o.filter(function(t){return r[t]}).map(function(t){return r[t].split(",")})),text:r[s]};e.push(l)})}),e},r.getTable=function(){var n,r,i=new e.default,a=this;return 0===a.series.length?i:(t.each(a.series,function(e,a){if(0===a)for(i.columns.push({text:"Time",type:"time"}),t.each(t.keys(e.tags),function(t){i.columns.push({text:t})}),r=1;r<e.columns.length;r++)i.columns.push({text:e.columns[r]});if(e.values)for(n=0;n<e.values.length;n++){var o=e.values[n],s=[o[0]];if(e.tags)for(var l in e.tags)e.tags.hasOwnProperty(l)&&s.push(e.tags[l]);for(r=1;r<o.length;r++)s.push(o[r]);i.rows.push(s)}}),i)},n}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";function r(t,e){t[e]=e}var i=n(4),a=n.n(i),o=function(){function t(){}return t.prototype.parse=function(t,e){if(!e||0===e.results.length)return[];var n=e.results[0];if(!n.series)return[];var i=t.toLowerCase().indexOf("show tag values")>=0,o={};return a.a.each(n.series,function(t){a.a.each(t.values,function(t){a.a.isArray(t)?i?r(o,t[1]||t[0]):r(o,t[0]):r(o,t)})}),a.a.map(o,function(t){return{text:t}})},t}();e.a=o},function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(825),l=n.n(s),u=n(823),c=n(824),h=n(797),f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n)||this;o.templateSrv=r,o.$q=i,o.uiSegmentSrv=a,o.target=o.target,o.queryModel=new u.a(o.target,r,o.panel.scopedVars),o.queryBuilder=new l.a(o.target,o.datasource.database),o.groupBySegment=o.uiSegmentSrv.newPlusButton(),o.resultFormats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],o.policySegment=a.newSegment(o.target.policy),o.target.measurement?o.measurementSegment=a.newSegment(o.target.measurement):o.measurementSegment=a.newSelectMeasurement(),o.tagSegments=[];for(var s=0,c=o.target.tags;s<c.length;s++){var h=c[s];h.operator||(/^\/.*\/$/.test(h.value)?h.operator="=~":h.operator="="),h.condition&&o.tagSegments.push(a.newCondition(h.condition)),o.tagSegments.push(a.newKey(h.key)),o.tagSegments.push(a.newOperator(h.operator)),o.tagSegments.push(a.newKeyValue(h.value))}return o.fixTagSegments(),o.buildSelectMenu(),o.removeTagFilterSegment=a.newSegment({fake:!0,value:"-- remove tag filter --"}),o}return f(e,t),e.$inject=["$scope","$injector","templateSrv","$q","uiSegmentSrv"],e.prototype.removeOrderByTime=function(){this.target.orderByTime="ASC"},e.prototype.buildSelectMenu=function(){var t=c.a.getCategories();this.selectMenu=o.a.reduce(t,function(t,e,n){var r={text:n,submenu:e.map(function(t){return{text:t.type,value:t.type}})};return t.push(r),t},[])},e.prototype.getGroupByOptions=function(){var t=this,e=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(e).then(function(e){var n=[];t.queryModel.hasFill()||n.push(t.uiSegmentSrv.newSegment({value:"fill(null)"})),t.target.limit||n.push(t.uiSegmentSrv.newSegment({value:"LIMIT"})),t.target.slimit||n.push(t.uiSegmentSrv.newSegment({value:"SLIMIT"})),"ASC"===t.target.orderByTime&&n.push(t.uiSegmentSrv.newSegment({value:"ORDER BY time DESC"})),t.queryModel.hasGroupByTime()||n.push(t.uiSegmentSrv.newSegment({value:"time($interval)"}));for(var r=0,i=e;r<i.length;r++){var a=i[r];n.push(t.uiSegmentSrv.newSegment({value:"tag("+a.text+")"}))}return n}).catch(this.handleQueryError.bind(this))},e.prototype.groupByAction=function(){switch(this.groupBySegment.value){case"LIMIT":this.target.limit=10;break;case"SLIMIT":this.target.slimit=10;break;case"ORDER BY time DESC":this.target.orderByTime="DESC";break;default:this.queryModel.addGroupBy(this.groupBySegment.value)}var t=this.uiSegmentSrv.newPlusButton();this.groupBySegment.value=t.value,this.groupBySegment.html=t.html,this.panelCtrl.refresh()},e.prototype.addSelectPart=function(t,e,n){this.queryModel.addSelectPart(t,n.value),this.panelCtrl.refresh()},e.prototype.handleSelectPartEvent=function(t,e,n){switch(n.name){case"get-param-options":var r=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(r).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeSelectPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.handleGroupByPartEvent=function(t,e,n){switch(n.name){case"get-param-options":var r=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(r).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeGroupByPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.fixTagSegments=function(){var t=this.tagSegments.length,e=this.tagSegments[Math.max(t-1,0)];e&&"plus-button"===e.type||this.tagSegments.push(this.uiSegmentSrv.newPlusButton())},e.prototype.measurementChanged=function(){this.target.measurement=this.measurementSegment.value,this.panelCtrl.refresh()},e.prototype.getPolicySegments=function(){var t=this.queryBuilder.buildExploreQuery("RETENTION POLICIES");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.policyChanged=function(){this.target.policy=this.policySegment.value,this.panelCtrl.refresh()},e.prototype.toggleEditorMode=function(){try{this.target.query=this.queryModel.render(!1)}catch(t){console.log("query render error")}this.target.rawQuery=!this.target.rawQuery},e.prototype.getMeasurements=function(t){var e=this.queryBuilder.buildExploreQuery("MEASUREMENTS",void 0,t);return this.datasource.metricFindQuery(e).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this))},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.prototype.transformToSegments=function(t){var e=this;return function(n){var r=o.a.map(n,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});if(t)for(var i=0,a=e.templateSrv.variables;i<a.length;i++){var s=a[i];r.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"/^$"+s.name+"$/",expandable:!0}))}return r}},e.prototype.getTagsOrValues=function(t,e){var n=this;if("condition"===t.type)return this.$q.when([this.uiSegmentSrv.newSegment("AND"),this.uiSegmentSrv.newSegment("OR")]);if("operator"===t.type){return/^\/.*\/$/.test(this.tagSegments[e+1].value)?this.$q.when(this.uiSegmentSrv.newOperators(["=~","!~"])):this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<>","<",">"]))}var r,a;return"key"===t.type||"plus-button"===t.type?(r=this.queryBuilder.buildExploreQuery("TAG_KEYS"),a=!1):"value"===t.type&&(r=this.queryBuilder.buildExploreQuery("TAG_VALUES",this.tagSegments[e-2].value),a=!0),this.datasource.metricFindQuery(r).then(this.transformToSegments(a)).then(function(e){return"key"===t.type&&e.splice(0,0,i.a.copy(n.removeTagFilterSegment)),e}).catch(this.handleQueryError.bind(this))},e.prototype.getFieldSegments=function(){var t=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError)},e.prototype.tagSegmentUpdated=function(t,e){this.tagSegments[e]=t,t.value===this.removeTagFilterSegment.value?(this.tagSegments.splice(e,3),0===this.tagSegments.length?this.tagSegments.push(this.uiSegmentSrv.newPlusButton()):this.tagSegments.length>2&&(this.tagSegments.splice(Math.max(e-1,0),1),"plus-button"!==this.tagSegments[this.tagSegments.length-1].type&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.tagSegments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.tagSegments.push(this.uiSegmentSrv.newOperator("=")),this.tagSegments.push(this.uiSegmentSrv.newFake("select tag value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.tagSegments.length&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton())),this.rebuildTargetTagConditions()},e.prototype.rebuildTargetTagConditions=function(){var t=this,e=[],n=0,r="";o.a.each(this.tagSegments,function(i,a){"key"===i.type?(0===e.length&&e.push({}),e[n].key=i.value):"value"===i.type?(r=t.getTagValueOperator(i.value,e[n].operator),r&&(t.tagSegments[a-1]=t.uiSegmentSrv.newOperator(r),e[n].operator=r),e[n].value=i.value):"condition"===i.type?(e.push({condition:i.value}),n+=1):"operator"===i.type&&(e[n].operator=i.value)}),this.target.tags=e,this.panelCtrl.refresh()},e.prototype.getTagValueOperator=function(t,e){return"=~"!==e&&"!~"!==e&&/^\/.*\/$/.test(t)?"=~":"=~"!==e&&"!~"!==e||!/^(?!\/.*\/$)/.test(t)?null:"="},e.prototype.getCollapsedText=function(){return this.queryModel.render(!1)},e.templateUrl="partials/query.editor.html",e}(h.QueryCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(956);n.d(e,"MixedDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a})},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=function(){function t(t,e){this.$q=t,this.datasourceSrv=e}return t.$inject=["$q","datasourceSrv"],t.prototype.query=function(t){var e=this,n=o.a.groupBy(t.targets,"datasource"),r=o.a.map(n,function(n){var r=n[0].datasource;return"-- Mixed --"===r?e.$q([]):e.datasourceSrv.get(r).then(function(e){var r=i.a.copy(t);return r.targets=n,e.query(r)})});return this.$q.all(r).then(function(t){return{data:o.a.flatten(o.a.map(t,"data"))}})},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return a}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(958),i=n(960);n.d(e,"MysqlDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a});var a=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o="SELECT\n    UNIX_TIMESTAMP(<time_column>) as time_sec,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM <table name>\n  WHERE $__timeFilter(time_column)\n  ORDER BY <time_column> ASC\n  LIMIT 100\n  ",s=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||o}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4),i=n.n(r),a=n(959),o=function(){function t(t,e,n,r){this.backendSrv=e,this.$q=n,this.templateSrv=r,this.name=t.name,this.id=t.id,this.responseParser=new a.a(this.$q)}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv"],t.prototype.interpolateVariable=function(t){return"string"==typeof t?"'"+t+"'":"number"==typeof t?t:i.a.map(t,function(e){return"number"==typeof t?t:"'"+e+"'"}).join(",")},t.prototype.query=function(t){var e=this,n=i.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:e.templateSrv.replace(n.rawSql,t.scopedVars,e.interpolateVariable),format:n.format}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var n={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[n]}}).then(function(n){return e.responseParser.transformAnnotationResponse(t,n)})},t.prototype.metricFindQuery=function(t,e){var n=this,r="tempvar";e&&e.variable&&e.variable.name&&(r=e.variable.name);var i={refId:r,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[i]}}).then(function(t){return n.responseParser.parseMetricFindQueryResult(r,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}()},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var n in t.data.results){var r=t.data.results[n];if(r.series)for(var i=0,a=r.series;i<a.length;i++){var o=a[i];e.push({target:o.name,datapoints:o.points,refId:r.refId,meta:r.meta})}if(r.tables)for(var s=0,l=r.tables;s<l.length;s++){var u=l[s];u.type="table",u.refId=r.refId,u.meta=r.meta,e.push(u)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var n=e.data.results[t].tables[0].columns,r=e.data.results[t].tables[0].rows,i=this.findColIndex(n,"__text"),a=this.findColIndex(n,"__value");return 2===n.length&&-1!==i&&-1!==a?this.transformToKeyValueList(r,i,a):this.transformToSimpleList(r)},t.prototype.transformToKeyValueList=function(t,e,n){for(var r=[],i=0;i<t.length;i++)this.containsKey(r,t[i][e])||r.push({text:t[i][e],value:t[i][n]});return r},t.prototype.transformToSimpleList=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var a=t[n][r];-1===e.indexOf(a)&&e.push(a)}return i.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return n;return-1},t.prototype.containsKey=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var n=e.data.results[t.annotation.name].tables[0],r=-1,i=-1,a=-1,o=0;o<n.columns.length;o++)if("time_sec"===n.columns[o].text)r=o;else{if("title"===n.columns[o].text)return this.$q.reject({message:"The title column for annotations is deprecated, now only a column named text is returned"});"text"===n.columns[o].text?i=o:"tags"===n.columns[o].text&&(a=o)}if(-1===r)return this.$q.reject({message:"Missing mandatory time column (with time_sec column alias) in annotation query."});for(var s=[],o=0;o<n.rows.length;o++){var l=n.rows[o];s.push({annotation:t.annotation,time:1e3*Math.floor(l[r]),text:l[i],tags:l[a]?l[a].trim().split(/\s*,\s*/):[]})}return s},t}();e.a=a},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(4),i=n.n(r),a=n(797),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s="SELECT\n  UNIX_TIMESTAMP(<time_column>) as time_sec,\n  <value column> as value,\n  <series name column> as metric\nFROM <table name>\nWHERE $__timeFilter(time_column)\nORDER BY <time_column> ASC\n",l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.target.format=r.target.format||"time_series",r.target.alias="",r.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],r.target.rawSql||("table"===r.panelCtrl.panel.type?(r.target.format="table",r.target.rawSql="SELECT 1"):r.target.rawSql=s),r.panelCtrl.events.on("data-received",r.onDataReceived.bind(r),e),r.panelCtrl.events.on("data-error",r.onDataError.bind(r),e),r}return o(e,t),e.$inject=["$scope","$injector"],e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=i.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.templateUrl="partials/query.editor.html",e}(a.QueryCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return a}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(962),i=n(964);n.d(e,"PostgresDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a});var a=function(){function t(t){this.current.jsonData.sslmode=this.current.jsonData.sslmode||"require"}return t.$inject=["$scope"],t.templateUrl="partials/config.html",t}(),o="SELECT\n  extract(epoch from time_column) AS time,\n  title_column as title,\n  description_column as text\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",s=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||o}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(4),i=n.n(r),a=n(963),o=function(){function t(t,e,n,r){this.backendSrv=e,this.$q=n,this.templateSrv=r,this.name=t.name,this.id=t.id,this.responseParser=new a.a(this.$q)}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv"],t.prototype.interpolateVariable=function(t){return"string"==typeof t?"'"+t+"'":i.a.map(t,function(t){return"'"+t+"'"}).join(",")},t.prototype.query=function(t){var e=this,n=i.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:e.templateSrv.replace(n.rawSql,t.scopedVars,e.interpolateVariable),format:n.format}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var n={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[n]}}).then(function(n){return e.responseParser.transformAnnotationResponse(t,n)})},t.prototype.metricFindQuery=function(t,e){var n=this,r="tempvar";e&&e.variable&&e.variable.name&&(r=e.variable.name);var i={refId:r,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[i]}}).then(function(t){return n.responseParser.parseMetricFindQueryResult(r,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}()},function(t,e,n){"use strict";var r=n(4),i=n.n(r),a=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var n in t.data.results){var r=t.data.results[n];if(r.series)for(var i=0,a=r.series;i<a.length;i++){var o=a[i];e.push({target:o.name,datapoints:o.points,refId:r.refId,meta:r.meta})}if(r.tables)for(var s=0,l=r.tables;s<l.length;s++){var u=l[s];u.type="table",u.refId=r.refId,u.meta=r.meta,e.push(u)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var n=e.data.results[t].tables[0].columns,r=e.data.results[t].tables[0].rows,i=this.findColIndex(n,"__text"),a=this.findColIndex(n,"__value");return 2===n.length&&-1!==i&&-1!==a?this.transformToKeyValueList(r,i,a):this.transformToSimpleList(r)},t.prototype.transformToKeyValueList=function(t,e,n){for(var r=[],i=0;i<t.length;i++)this.containsKey(r,t[i][e])||r.push({text:t[i][e],value:t[i][n]});return r},t.prototype.transformToSimpleList=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var a=t[n][r];-1===e.indexOf(a)&&e.push(a)}return i.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return n;return-1},t.prototype.containsKey=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var n=e.data.results[t.annotation.name].tables[0],r=-1,i=-1,a=-1,o=0;o<n.columns.length;o++)"time"===n.columns[o].text?r=o:"text"===n.columns[o].text?i=o:"tags"===n.columns[o].text&&(a=o);if(-1===r)return this.$q.reject({message:"Missing mandatory time column in annotation query."});for(var s=[],o=0;o<n.rows.length;o++){var l=n.rows[o];s.push({annotation:t.annotation,time:1e3*Math.floor(l[r]),title:l[-1],text:l[i],tags:l[a]?l[a].trim().split(/\s*,\s*/):[]})}return s},t}();e.a=a},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(4),i=n.n(r),a=n(797),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s="SELECT\n  $__time(time_column),\n  value1\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.target.format=r.target.format||"time_series",r.target.alias="",r.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],r.target.rawSql||("table"===r.panelCtrl.panel.type?(r.target.format="table",r.target.rawSql="SELECT 1"):r.target.rawSql=s),r.panelCtrl.events.on("data-received",r.onDataReceived.bind(r),e),r.panelCtrl.events.on("data-error",r.onDataError.bind(r),e),r}return o(e,t),e.$inject=["$scope","$injector"],e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=i.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.templateUrl="partials/query.editor.html",e}(a.QueryCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return a}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(966),i=n(968);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a});var a=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},function(t,e,n){"use strict";function r(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\\\$&")}n.d(e,"a",function(){return f});var i=n(4),a=n.n(i),o=n(109),s=n.n(o),l=n(292),u=n(967),c=n.n(u),h=n(802),f=function(){function t(t,e,n,r,i){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.timeSrv=i,this.type="prometheus",this.editorSrc="app/features/prometheus/partials/query.editor.html",this.name=t.name,this.supportMetrics=!0,this.url=t.url,this.directUrl=t.directUrl,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype._request=function(t,e,n){var r={url:this.url+e,method:t,requestId:n};return(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(r)},t.prototype.interpolateQueryExpr=function(t,e,n){return e.multi||e.includeAll?"string"==typeof t?r(t):a.a.map(t,r).join("|"):t},t.prototype.targetContainsTemplate=function(t){return this.templateSrv.variableExists(t.expr)},t.prototype.query=function(t){var e=this,n=this,r=this.getPrometheusTime(t.range.from,!1),i=this.getPrometheusTime(t.range.to,!0),o=Math.ceil(i-r),s=[],l=[];t=a.a.clone(t);for(var u=0,c=t.targets;u<c.length;u++){var h=c[u];h.expr&&!h.hide&&(l.push(h),s.push(this.createQuery(h,t,o)))}if(a.a.isEmpty(s))return this.$q.when({data:[]});var f=a.a.map(s,function(t){return t.instant?e.performInstantQuery(t,i):e.performTimeSeriesQuery(t,r,i)});return this.$q.all(f).then(function(t){var e=[];return a.a.each(t,function(t,a){if("error"===t.status)throw t.error;if("table"===l[a].format)e.push(n.transformMetricDataToTable(t.data.data.result));else for(var o=0,s=t.data.data.result;o<s.length;o++){var u=s[o];"matrix"===t.data.data.resultType?e.push(n.transformMetricData(u,l[a],r,i)):"vector"===t.data.data.resultType&&e.push(n.transformInstantMetricData(u,l[a]))}}),{data:e}})},t.prototype.createQuery=function(t,e,n){var r={};r.instant=t.instant;var i=s.a.interval_to_seconds(e.interval),a=s.a.interval_to_seconds(this.templateSrv.replace(t.interval,e.scopedVars)||e.interval),o=t.intervalFactor||1,l=this.adjustInterval(i,a,n,o),u=e.scopedVars;return i!==l&&(i=l,u=Object.assign({},e.scopedVars,{__interval:{text:i+"s",value:i+"s"},__interval_ms:{text:1e3*i,value:1e3*i}})),t.step=r.step=i,r.expr=this.templateSrv.replace(t.expr,u,this.interpolateQueryExpr),r.requestId=e.panelId+t.refId,r},t.prototype.adjustInterval=function(t,e,n,r){return 0!==t&&n/r/t>11e3&&(t=Math.ceil(n/r/11e3)),Math.max(t*r,e)},t.prototype.performTimeSeriesQuery=function(t,e,n){if(e>n)throw{message:"Invalid time range"};var r="/api/v1/query_range?query="+encodeURIComponent(t.expr)+"&start="+e+"&end="+n+"&step="+t.step;return this._request("GET",r,t.requestId)},t.prototype.performInstantQuery=function(t,e){var n="/api/v1/query?query="+encodeURIComponent(t.expr)+"&time="+e;return this._request("GET",n,t.requestId)},t.prototype.performSuggestQuery=function(t,e){var n=this;void 0===e&&(e=!1);return e&&this.metricsNameCache&&this.metricsNameCache.expire>Date.now()?this.$q.when(a.a.filter(this.metricsNameCache.data,function(e){return 1!==e.indexOf(t)})):this._request("GET","/api/v1/label/__name__/values").then(function(e){return n.metricsNameCache={data:e.data.data,expire:Date.now()+6e4},a.a.filter(e.data.data,function(e){return 1!==e.indexOf(t)})})},t.prototype.metricFindQuery=function(t){if(!t)return this.$q.when([]);var e=this.templateSrv.replace(t,{},this.interpolateQueryExpr);return new c.a(this,e,this.timeSrv).process()},t.prototype.annotationQuery=function(t){var e=t.annotation,n=e.expr||"",r=e.tagKeys||"",i=e.titleFormat||"",o=e.textFormat||"";if(!n)return this.$q.when([]);var l=this.templateSrv.replace(n,{},this.interpolateQueryExpr),u="60s";e.step&&(u=this.templateSrv.replace(e.step));var c=this.getPrometheusTime(t.range.from,!1),h=this.getPrometheusTime(t.range.to,!0),f={expr:l,step:this.adjustInterval(s.a.interval_to_seconds(u),0,Math.ceil(h-c),1)+"s"},d=this;return this.performTimeSeriesQuery(f,c,h).then(function(t){var n=[];return r=r.split(","),a.a.each(t.data.data.result,function(t){for(var s=a.a.chain(t.metric).filter(function(t,e){return a.a.includes(r,e)}).value(),l=0,u=t.values;l<u.length;l++){var c=u[l];if("1"===c[1]){var h={annotation:e,time:1e3*Math.floor(parseFloat(c[0])),title:d.renderTemplate(i,t.metric),tags:s,text:d.renderTemplate(o,t.metric)};n.push(h)}}}),n})},t.prototype.testDatasource=function(){return this.metricFindQuery("metrics(.*)").then(function(){return{status:"success",message:"Data source is working"}})},t.prototype.transformMetricData=function(t,e,n,r){var i=[],o=null;o=this.createMetricLabel(t.metric,e);for(var s=1e3*parseInt(e.step),l=1e3*n,u=0,c=t.values;u<c.length;u++){var h=c[u],f=parseFloat(h[1]);a.a.isNaN(f)&&(f=null);for(var d=1e3*parseFloat(h[0]),p=l;p<d;p+=s)i.push([null,p]);l=d+s,i.push([f,d])}for(var m=1e3*r,p=l;p<=m;p+=s)i.push([null,p]);return{target:o,datapoints:i}},t.prototype.transformMetricDataToTable=function(t){var e,n,r=new h.default,i={};if(0===t.length)return r;a.a.each(t,function(t){for(var e in t.metric)i.hasOwnProperty(e)||(i[e]=1)});var o=a.a.keys(i).sort();return r.columns.push({text:"Time",type:"time"}),a.a.each(o,function(t,e){i[t]=e+1,r.columns.push({text:t})}),r.columns.push({text:"Value"}),a.a.each(t,function(t){if(t.value&&(t.values=[t.value]),t.values)for(e=0;e<t.values.length;e++){var i=t.values[e],a=[1e3*i[0]];if(t.metric)for(n=0;n<o.length;n++){var s=o[n];t.metric.hasOwnProperty(s)?a.push(t.metric[s]):a.push("")}a.push(parseFloat(i[1])),r.rows.push(a)}}),r},t.prototype.transformInstantMetricData=function(t,e){var n=[],r=null;return r=this.createMetricLabel(t.metric,e),n.push([parseFloat(t.value[1]),1e3*t.value[0]]),{target:r,datapoints:n}},t.prototype.createMetricLabel=function(t,e){return a.a.isUndefined(e)||a.a.isEmpty(e.legendFormat)?this.getOriginalMetricName(t):this.renderTemplate(this.templateSrv.replace(e.legendFormat),t)||"{}"},t.prototype.renderTemplate=function(t,e){var n=/\{\{\s*(.+?)\s*\}\}/g;return t.replace(n,function(t,n){return e[n]?e[n]:n})},t.prototype.getOriginalMetricName=function(t){var e=t.__name__||"";return delete t.__name__,e+"{"+a.a.map(a.a.toPairs(t),function(t){return t[0]+'="'+t[1]+'"'}).join(",")+"}"},t.prototype.getPrometheusTime=function(t,e){return a.a.isString(t)&&(t=l.parse(t,e)),Math.ceil(t.valueOf()/1e3)},t}()},function(t,e,n){var r,i;r=[n(4)],void 0!==(i=function(t){"use strict";function e(t,e,n){this.datasource=t,this.query=e,this.range=n.timeRange()}return e.prototype.process=function(){var t=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]+)\)$/,e=/^metrics\((.+)\)$/,n=/^query_result\((.+)\)$/,r=this.query.match(t);if(r)return r[1]?this.labelValuesQuery(r[2],r[1]):this.labelValuesQuery(r[2],null);var i=this.query.match(e);if(i)return this.metricNameQuery(i[1]);var a=this.query.match(n);return a?this.queryResultQuery(a[1]):this.metricNameAndLabelsQuery(this.query)},e.prototype.labelValuesQuery=function(e,n){var r;if(n){var i=this.datasource.getPrometheusTime(this.range.from,!1),a=this.datasource.getPrometheusTime(this.range.to,!0);return r="/api/v1/series?match[]="+encodeURIComponent(n)+"&start="+i+"&end="+a,this.datasource._request("GET",r).then(function(n){var r=t.map(n.data.data,function(t){return t[e]});return t.uniq(r).map(function(t){return{text:t,expandable:!0}})})}return r="/api/v1/label/"+e+"/values",this.datasource._request("GET",r).then(function(e){return t.map(e.data.data,function(t){return{text:t}})})},e.prototype.metricNameQuery=function(e){return this.datasource._request("GET","/api/v1/label/__name__/values").then(function(n){return t.chain(n.data.data).filter(function(t){return new RegExp(e).test(t)}).map(function(t){return{text:t,expandable:!0}}).value()})},e.prototype.queryResultQuery=function(e){var n=this.datasource.getPrometheusTime(this.range.to,!0);return this.datasource.performInstantQuery({expr:e},n).then(function(e){return t.map(e.data.data.result,function(e){var n=e.metric.__name__||"";return delete e.metric.__name__,n+="{"+t.map(e.metric,function(t,e){return e+'="'+t+'"'}).join(",")+"}",n+=" "+e.value[1]+" "+1e3*e.value[0],{text:n,expandable:!0}})})},e.prototype.metricNameAndLabelsQuery=function(e){var n=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),i="/api/v1/series?match[]="+encodeURIComponent(e)+"&start="+n+"&end="+r,a=this;return this.datasource._request("GET",i).then(function(e){return t.map(e.data.data,function(t){return{text:a.datasource.getOriginalMetricName(t),expandable:!0}})})},e}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=n(797),l=n(969),u=n(970),c=(n.n(u),n(971)),h=(n.n(c),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;i.templateSrv=r;var a=i.target;return a.expr=a.expr||"",a.intervalFactor=a.intervalFactor||2,a.format=a.format||i.getDefaultFormat(),i.metric="",i.resolutions=o.a.map([1,2,3,4,5,10],function(t){return{factor:t,label:"1/"+t}}),i.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],i.instant=!1,i.updateLink(),i}return h(e,t),e.$inject=["$scope","$injector","templateSrv"],e.prototype.getCompleter=function(t){return new l.a(this.datasource)},e.prototype.getDefaultFormat=function(){return"table"===this.panelCtrl.panel.type?"table":"time_series"},e.prototype.refreshMetricData=function(){o.a.isEqual(this.oldTarget,this.target)||(this.oldTarget=i.a.copy(this.target),this.panelCtrl.refresh(),this.updateLink())},e.prototype.updateLink=function(){var t=this.panelCtrl.range;if(t){var e=Math.ceil((t.to.valueOf()-t.from.valueOf())/1e3),n=t.to.utc().format("YYYY-MM-DD HH:mm"),r={"g0.expr":this.templateSrv.replace(this.target.expr,this.panelCtrl.panel.scopedVars,this.datasource.interpolateQueryExpr),"g0.range_input":e+"s","g0.end_input":n,"g0.step_input":this.target.step,"g0.stacked":this.panelCtrl.panel.stack?1:0,"g0.tab":0},i=o.a.map(r,function(t,e){return e+"="+encodeURIComponent(t)}).join("&");this.linkToPrometheus=this.datasource.directUrl+"/graph?"+i}},e.prototype.getCollapsedText=function(){return this.target.expr},e.templateUrl="partials/query.editor.html",e}(s.QueryCtrl)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(4),i=n.n(r),a=function(){function t(t){this.datasource=t,this.identifierRegexps=[/[\[\]a-zA-Z_0-9=]/],this.labelQueryCache={},this.labelNameCache={},this.labelValueCache={}}return t.prototype.getCompletions=function(t,e,n,r,a){var o,s=this,l=e.getTokenAt(n.row,n.column);switch(l.type){case"entity.name.tag":return o=this.findMetricName(e,n.row,n.column),o?this.labelNameCache[o]?void a(null,this.labelNameCache[o]):this.getLabelNameAndValueForMetric(o).then(function(t){var e=s.transformToCompletions(i.a.uniq(i.a.flatten(t.map(function(t){return Object.keys(t.metric)}))),"label name");s.labelNameCache[o]=e,a(null,e)}):void a(null,this.transformToCompletions(["__name__","instance","job"],"label name"));case"string.quoted":if(!(o=this.findMetricName(e,n.row,n.column)))return void a(null,[]);var u=this.findToken(e,n.row,n.column,"entity.name.tag",null,"paren.lparen");if(!u)return void a(null,[]);var c=u.value;return this.labelValueCache[o]&&this.labelValueCache[o][c]?void a(null,this.labelValueCache[o][c]):this.getLabelNameAndValueForMetric(o).then(function(t){var e=s.transformToCompletions(i.a.uniq(t.map(function(t){return t.metric[c]})),"label value");s.labelValueCache[o]=s.labelValueCache[o]||{},s.labelValueCache[o][c]=e,a(null,e)})}if("["===r){for(var h=[],f=0,d=["s","m","h"];f<d.length;f++)for(var p=d[f],m=0,g=[1,5,10,30];m<g.length;m++){var v=g[m];h.push({caption:v+p,value:"["+v+p,meta:"range vector"})}return void a(null,h)}var y=r;return this.datasource.performSuggestQuery(y,!0).then(function(t){a(null,t.map(function(t){var e=t;return"("===r&&(e="("+t),{caption:t,value:e,meta:"metric"}}))})},t.prototype.getLabelNameAndValueForMetric=function(t){var e=this;if(this.labelQueryCache[t])return Promise.resolve(this.labelQueryCache[t]);var n="=~";/[a-zA-Z_:][a-zA-Z0-9_:]*/.test(t)&&(n="=");var r="{__name__"+n+'"'+t+'"}';return this.datasource.performInstantQuery({expr:r},(new Date).getTime()/1e3).then(function(n){return e.labelQueryCache[t]=n.data.data.result,n.data.data.result})},t.prototype.transformToCompletions=function(t,e){return t.map(function(t){return{caption:t,value:t,meta:e,score:Number.MAX_VALUE}})},t.prototype.findMetricName=function(t,e,n){var r,i="",a=this.findToken(t,e,n,"entity.name.tag","__name__","paren.lparen");if(a){r=t.getTokens(a.row);var o=r[a.index+2];o&&"string.quoted"===o.type&&(i=o.value.slice(1,-1))}else{var s=this.findToken(t,e,n,"identifier",null,null);s&&(r=t.getTokens(s.row),"paren.lparen"===r[s.index+1].type&&(i=s.value))}return i},t.prototype.findToken=function(t,e,n,r,i,a){for(var o,s,l=e;l>=0;l--){if(o=t.getTokens(l),l===e){var u=0;for(s=0;s<o.length&&!((u+=o[s].value.length)>=n);s++);}else s=o.length-1;for(;s>=0;s--){if(o[s].type===a)return null;if(o[s].type===r&&(!i||o[s].value===i))return o[s].row=l,o[s].index=s,o[s]}}return null},t}()},function(t,e){ace.define("ace/mode/prometheus_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(t,e,n){"use strict";var r=t("../lib/oop"),i=t("./text_highlight_rules").TextHighlightRules,a=function(){var t=this.createKeywordMapper({"support.function":"abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv|drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2|log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time|min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time",keyword:"by|without|keep_common|offset|bool|and|or|unless|ignoring|on|group_left|group_right|count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile","constant.language":"true|false|null|__name__|job"},"identifier",!0);this.$rules={start:[{token:"string",regex:/"(?:[^"\\]|\\.)*?"/},{token:"string",regex:"'.*?'"},{token:"constant.numeric",regex:"[-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language",regex:"\\d+[smhdwy]"},{token:t,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"\\+|\\-|\\*|\\/|%|\\^|=|==|!=|<=|>=|<|>|=\\~|!\\~"},{token:"paren.lparen",regex:"[[(]"},{token:"paren.lparen",regex:"{",next:"start-label-matcher"},{token:"paren.rparen",regex:"[\\])]"},{token:"paren.rparen",regex:"}"},{token:"text",regex:"\\s+"}],"start-label-matcher":[{token:"entity.name.tag",regex:"[a-zA-Z_][a-zA-Z0-9_]*"},{token:"keyword.operator",regex:"=~|=|!~|!="},{token:"string.quoted",regex:"\"[^\"]*\"|'[^']*'"},{token:"punctuation.operator",regex:",",push:"start-label-matcher"},{token:"paren.rparen",regex:"}",next:"start"}]},this.normalizeRules()};r.inherits(a,i),e.PrometheusHighlightRules=a}),ace.define("ace/mode/prometheus_completions",["require","exports","module","ace/token_iterator","ace/lib/lang"],function(t,e,n){"use strict";function r(t,e){e=e||60;for(var n=[],r=0,i=0,a=e,o="",s=0;s<t.length;s++)" "===t[s]?r=s:s>=a&&0!=r&&(o=t.slice(i,r),n.push(o),i=r+1,a=s+e,r=0);return o=t.slice(i),n.push(o),n.join("&nbsp<br>")}function i(t){return t=t.replace(/```(.+)```/,"<pre>$1</pre>"),t=t.replace(/`([^`]+)`/,"<code>$1</code>")}function a(t){var e=o.escapeHTML(t.docText);return e=i(r(e,40)),["<b>",o.escapeHTML(t.def),"</b>","<hr></hr>",e,"<br>&nbsp"].join("")}var o=t("../lib/lang"),s=["by","without","keep_common","offset","bool","and","or","unless","ignoring","on","group_left","group_right","count","count_values","min","max","avg","sum","stddev","stdvar","bottomk","topk","quantile"],l=s.map(function(t){return{caption:t,value:t,meta:"keyword",score:Number.MAX_VALUE}}),u=[{name:"abs()",value:"abs",def:"abs(v instant-vector)",docText:"Returns the input vector with all sample values converted to their absolute value."},{name:"abs()",value:"abs",def:"abs(v instant-vector)",docText:"Returns the input vector with all sample values converted to their absolute value."},{name:"absent()",value:"absent",def:"absent(v instant-vector)",docText:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{name:"ceil()",value:"ceil",def:"ceil(v instant-vector)",docText:"Rounds the sample values of all elements in `v` up to the nearest integer."},{name:"changes()",value:"changes",def:"changes(v range-vector)",docText:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{name:"clamp_max()",value:"clamp_max",def:"clamp_max(v instant-vector, max scalar)",docText:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{name:"clamp_min()",value:"clamp_min",def:"clamp_min(v instant-vector, min scalar)",docText:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{name:"count_scalar()",value:"count_scalar",def:"count_scalar(v instant-vector)",docText:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{name:"day_of_month()",value:"day_of_month",def:"day_of_month(v=vector(time()) instant-vector)",docText:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{name:"day_of_week()",value:"day_of_week",def:"day_of_week(v=vector(time()) instant-vector)",docText:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{name:"days_in_month()",value:"days_in_month",def:"days_in_month(v=vector(time()) instant-vector)",docText:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{name:"delta()",value:"delta",def:"delta(v range-vector)",docText:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{name:"deriv()",value:"deriv",def:"deriv(v range-vector)",docText:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{name:"drop_common_labels()",value:"drop_common_labels",def:"drop_common_labels(instant-vector)",docText:"Drops all labels that have the same name and value across all series in the input vector."},{name:"exp()",value:"exp",def:"exp(v instant-vector)",docText:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{name:"floor()",value:"floor",def:"floor(v instant-vector)",docText:"Rounds the sample values of all elements in `v` down to the nearest integer."},{name:"histogram_quantile()",value:"histogram_quantile",def:"histogram_quantile(φ float, b instant-vector)",docText:"Calculates the φ-quantile (0 ≤ φ ≤ 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{name:"holt_winters()",value:"holt_winters",def:"holt_winters(v range-vector, sf scalar, tf scalar)",docText:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{name:"hour()",value:"hour",def:"hour(v=vector(time()) instant-vector)",docText:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{name:"idelta()",value:"idelta",def:"idelta(v range-vector)",docText:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{name:"increase()",value:"increase",def:"increase(v range-vector)",docText:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{name:"irate()",value:"irate",def:"irate(v range-vector)",docText:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{name:"label_replace()",value:"label_replace",def:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",docText:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{name:"ln()",value:"ln",def:"ln(v instant-vector)",docText:"calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{name:"log2()",value:"log2",def:"log2(v instant-vector)",docText:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"log10()",value:"log10",def:"log10(v instant-vector)",docText:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"minute()",value:"minute",def:"minute(v=vector(time()) instant-vector)",docText:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{name:"month()",value:"month",def:"month(v=vector(time()) instant-vector)",docText:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{name:"predict_linear()",value:"predict_linear",def:"predict_linear(v range-vector, t scalar)",docText:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{name:"rate()",value:"rate",def:"rate(v range-vector)",docText:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{name:"resets()",value:"resets",def:"resets(v range-vector)",docText:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{name:"round()",value:"round",def:"round(v instant-vector, to_nearest=1 scalar)",docText:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{name:"scalar()",value:"scalar",def:"scalar(v instant-vector)",docText:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{name:"sort()",value:"sort",def:"sort(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in ascending order."},{name:"sort_desc()",value:"sort_desc",def:"sort_desc(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in descending order."},{name:"sqrt()",value:"sqrt",def:"sqrt(v instant-vector)",docText:"Calculates the square root of all elements in `v`."},{name:"time()",value:"time",def:"time()",docText:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{name:"vector()",value:"vector",def:"vector(s scalar)",docText:"Returns the scalar `s` as a vector with no labels."},{name:"year()",value:"year",def:"year(v=vector(time()) instant-vector)",docText:"Returns the year for each of the given times in UTC."},{name:"avg_over_time()",value:"avg_over_time",def:"avg_over_time(range-vector)",docText:"The average value of all points in the specified interval."},{name:"min_over_time()",value:"min_over_time",def:"min_over_time(range-vector)",docText:"The minimum value of all points in the specified interval."},{name:"max_over_time()",value:"max_over_time",def:"max_over_time(range-vector)",docText:"The maximum value of all points in the specified interval."},{name:"sum_over_time()",value:"sum_over_time",def:"sum_over_time(range-vector)",docText:"The sum of all values in the specified interval."},{name:"count_over_time()",value:"count_over_time",def:"count_over_time(range-vector)",docText:"The count of all values in the specified interval."},{name:"quantile_over_time()",value:"quantile_over_time",def:"quantile_over_time(scalar, range-vector)",docText:"The φ-quantile (0 ≤ φ ≤ 1) of the values in the specified interval."},{name:"stddev_over_time()",value:"stddev_over_time",def:"stddev_over_time(range-vector)",docText:"The population standard deviation of the values in the specified interval."},{name:"stdvar_over_time()",value:"stdvar_over_time",def:"stdvar_over_time(range-vector)",docText:"The population standard variance of the values in the specified interval."}],c=u.map(function(t){return{caption:t.name,value:t.value,docHTML:a(t),meta:"function",score:Number.MAX_VALUE}}),h=function(){};(function(){this.getCompletions=function(t,e,n,r,i){var a=e.getTokenAt(n.row,n.column);if("entity.name.tag"===a.type||"string.quoted"===a.type)return i(null,[]);i(null,l.concat(c))}}).call(h.prototype),e.PrometheusCompletions=h}),ace.define("ace/mode/behaviour/prometheus",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(t,e,n){"use strict";function r(t,e,n,r){var i=t.end.row-t.start.row;return{text:n+e+r,selection:[0,t.start.column+1,i,t.end.column+(i?0:1)]}}var i=t("../../lib/oop"),a=(t("../behaviour").Behaviour,t("./cstyle").CstyleBehaviour),o=(t("../../token_iterator").TokenIterator,function(){this.inherit(a),this.add("braces","insertion",function(t,e,n,i,o){if("{"==o){var s=n.getSelectionRange(),l=i.doc.getTextRange(s);if(""!==l&&n.getWrapBehavioursEnabled())return r(s,l,"{","}");if(a.isSaneInsertion(n,i))return{text:"{}",selection:[1,1]}}else if("}"==o){var u=n.getCursorPosition(),c=i.doc.getLine(u.row),h=c.substring(u.column,u.column+1);if("}"==h){var f=i.$findOpeningBracket("}",{column:u.column+1,row:u.row});if(null!==f&&a.isAutoInsertedClosing(u,c,o))return{text:"",selection:[1,1]}}}}),this.add("braces","deletion",function(t,e,n,r,i){var a=r.doc.getTextRange(i);if(!i.isMultiLine()&&"{"==a){if("}"==r.doc.getLine(i.start.row).substring(i.start.column+1,i.start.column+2))return i.end.column++,i}})});i.inherits(o,a),e.PrometheusBehaviour=o}),ace.define("ace/mode/prometheus",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/prometheus_highlight_rules"],function(t,e,n){"use strict";var r=t("../lib/oop"),i=t("./text").Mode,a=t("./prometheus_highlight_rules").PrometheusHighlightRules,o=t("./prometheus_completions").PrometheusCompletions,s=t("./behaviour/prometheus").PrometheusBehaviour,l=function(){this.HighlightRules=a,this.$behaviour=new s,this.$completer=new o,this.completer=this.$completer};r.inherits(l,i),function(){this.$id="ace/mode/prometheus"}.call(l.prototype),e.Mode=l})},function(t,e){ace.define("ace/snippets/prometheus",["require","exports","module"],function(t,e,n){"use strict";e.snippets=[{content:"rate(${1:metric}[${2:range}])",name:"rate()",scope:"prometheus",tabTrigger:"r"}],e.scope="prometheus"})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TextPanelCtrl",function(){return s}),n.d(e,"PanelCtrl",function(){return s});var r=n(4),i=n.n(r),a=n(797),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r,a){var o=t.call(this,e,n)||this;return o.templateSrv=r,o.$sce=a,o.panelDefaults={mode:"markdown",content:"# title"},i.a.defaults(o.panel,o.panelDefaults),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.events.on("refresh",o.onRefresh.bind(o)),o.events.on("render",o.onRender.bind(o)),o}return o(e,t),e.$inject=["$scope","$injector","templateSrv","$sce"],e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/text/editor.html"),this.editorTabIndex=1,"text"===this.panel.mode&&(this.panel.mode="markdown")},e.prototype.onRefresh=function(){this.render()},e.prototype.onRender=function(){"markdown"===this.panel.mode?this.renderMarkdown(this.panel.content):"html"===this.panel.mode&&this.updateContent(this.panel.content),this.renderingCompleted()},e.prototype.renderText=function(t){t=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br/>"),this.updateContent(t)},e.prototype.renderMarkdown=function(t){var e=this;if(!this.remarkable)return new Promise(function(t){t()}).then(n.bind(null,294)).then(function(n){e.remarkable=new n,e.$scope.$apply(function(){e.updateContent(e.remarkable.render(t))})});this.updateContent(this.remarkable.render(t))},e.prototype.updateContent=function(t){try{this.content=this.$sce.trustAsHtml(this.templateSrv.replace(t,this.panel.scopedVars))}catch(e){console.log("Text panel error: ",e),this.content=this.$sce.trustAsHtml(t)}},e.templateUrl="public/app/plugins/panel/text/module.html",e}(a.PanelCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"GraphCtrl",function(){return p}),n.d(e,"PanelCtrl",function(){return p});var r=(n(974),n(979)),i=(n.n(r),n(980)),a=(n.n(i),n(981),n(982)),o=n(4),s=n.n(o),l=n(21),u=n.n(l),c=n(797),h=n(983),f=n(984),d=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.annotationsSrv=r,i.hiddenSeries={},i.seriesList=[],i.dataList=[],i.annotations=[],i.colors=[],i.panelDefaults={datasource:null,renderer:"flot",yaxes:[{label:null,show:!0,logBase:1,min:null,max:null,format:"short"},{label:null,show:!0,logBase:1,min:null,max:null,format:"short"}],xaxis:{show:!0,mode:"time",name:null,values:[],buckets:null},lines:!0,fill:1,linewidth:1,dashes:!1,dashLength:10,spaceLength:10,points:!1,pointradius:5,bars:!1,stack:!1,percentage:!1,legend:{show:!0,values:!1,min:!1,max:!1,current:!1,total:!1,avg:!1},nullPointMode:"null",steppedLine:!1,tooltip:{value_type:"individual",shared:!0,sort:0},timeFrom:null,timeShift:null,targets:[{}],aliasColors:{},seriesOverrides:[],thresholds:[]},s.a.defaults(i.panel,i.panelDefaults),s.a.defaults(i.panel.tooltip,i.panelDefaults.tooltip),s.a.defaults(i.panel.legend,i.panelDefaults.legend),s.a.defaults(i.panel.xaxis,i.panelDefaults.xaxis),i.processor=new h.a(i.panel),i.events.on("render",i.onRender.bind(i)),i.events.on("data-received",i.onDataReceived.bind(i)),i.events.on("data-error",i.onDataError.bind(i)),i.events.on("data-snapshot-load",i.onDataSnapshotLoad.bind(i)),i.events.on("init-edit-mode",i.onInitEditMode.bind(i)),i.events.on("init-panel-actions",i.onInitPanelActions.bind(i)),i}return d(e,t),e.$inject=["$scope","$injector","annotationsSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",f.a,2),this.addEditorTab("Legend","public/app/plugins/panel/graph/tab_legend.html",3),this.addEditorTab("Display","public/app/plugins/panel/graph/tab_display.html",4),u.a.alertingEnabled&&this.addEditorTab("Alert",c.alertTab,5),this.subTabIndex=0},e.prototype.onInitPanelActions=function(t){t.push({text:"Export CSV",click:"ctrl.exportCsv()"}),t.push({text:"Toggle legend",click:"ctrl.toggleLegend()"})},e.prototype.issueQueries=function(e){return this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),t.prototype.issueQueries.call(this,e)},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onDataSnapshotLoad=function(t){this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),this.onDataReceived(t)},e.prototype.onDataError=function(t){this.seriesList=[],this.annotations=[],this.render([])},e.prototype.onDataReceived=function(t){var e=this;if(this.dataList=t,this.seriesList=this.processor.getSeriesList({dataList:t,range:this.range}),this.dataWarning=null,0===this.seriesList.reduce(function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"No data points",tip:"No datapoints returned from data query"};else for(var n=0,r=this.seriesList;n<r.length;n++){var i=r[n];if(i.isOutsideRange){this.dataWarning={title:"Data points outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"};break}}this.annotationsPromise.then(function(t){e.loading=!1,e.alertState=t.alertState,e.annotations=t.annotations,e.render(e.seriesList)},function(){e.loading=!1,e.render(e.seriesList)})},e.prototype.onRender=function(){if(this.seriesList)for(var t=0,e=this.seriesList;t<e.length;t++){var n=e[t];n.applySeriesOverrides(this.panel.seriesOverrides),n.unit&&(this.panel.yaxes[n.yaxis-1].format=n.unit)}},e.prototype.changeSeriesColor=function(t,e){t.color=e,this.panel.aliasColors[t.alias]=t.color,this.render()},e.prototype.toggleSeries=function(t,e){e.ctrlKey||e.metaKey||e.shiftKey?this.hiddenSeries[t.alias]?delete this.hiddenSeries[t.alias]:this.hiddenSeries[t.alias]=!0:this.toggleSeriesExclusiveMode(t),this.render()},e.prototype.toggleSeriesExclusiveMode=function(t){var e=this,n=this.hiddenSeries;n[t.alias]&&delete n[t.alias],s.a.every(this.seriesList,function(e){return e.alias===t.alias||n[e.alias]})?s.a.each(this.seriesList,function(t){delete e.hiddenSeries[t.alias]}):s.a.each(this.seriesList,function(n){n.alias!==t.alias&&(e.hiddenSeries[n.alias]=!0)})},e.prototype.toggleAxis=function(t){var e=s.a.find(this.panel.seriesOverrides,{alias:t.alias});e||(e={alias:t.alias},this.panel.seriesOverrides.push(e)),t.yaxis=e.yaxis=2===t.yaxis?1:2,this.render()},e.prototype.addSeriesOverride=function(t){this.panel.seriesOverrides.push(t||{})},e.prototype.removeSeriesOverride=function(t){this.panel.seriesOverrides=s.a.without(this.panel.seriesOverrides,t),this.render()},e.prototype.toggleLegend=function(){this.panel.legend.show=!this.panel.legend.show,this.refresh()},e.prototype.legendValuesOptionChanged=function(){var t=this.panel.legend;t.values=t.min||t.max||t.avg||t.current||t.total,this.render()},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.seriesList=this.seriesList,this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal data="seriesList"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.template=a.a,e}(c.MetricsPanelCtrl)},function(t,e,n){"use strict";function r(t,e,n,r){return{restrict:"A",template:"",link:function(t,n){function i(t){if(!q.legend.show||q.legend.rightSide)return 0;if(q.legend.alignAsTable){var e=g.a.filter($,function(t){return!1===t.hideFromLegend(q.legend)}),n=23+21*e.length;return Math.min(n,Math.floor(t/2))}return 26}function a(){try{var t=F.height-i(F.height);return n.css("height",t+"px"),!0}catch(t){return console.log(t),!1}}function o(){return!$||(!a()||0===z)}function s(e){for(var r=e.getYAxes(),i=0;i<$.length;i++){var a=$[i],o=r[a.yaxis-1],s=x.a.valueFormats[q.yaxes[a.yaxis-1].format];if(g.a.isNumber(q.decimals))a.updateLegendValues(s,q.decimals,null);else{var l=(o.tickDecimals||-1)+1;a.updateLegendValues(s,l,o.scaledDecimals+2)}U.$$phase||t.$digest()}q.yaxes[0].label&&q.yaxes[0].show&&p()("<div class='axisLabel left-yaxis-label flot-temp-elem'></div>").text(q.yaxes[0].label).appendTo(n),q.yaxes[1].label&&q.yaxes[1].show&&p()("<div class='axisLabel right-yaxis-label flot-temp-elem'></div>").text(q.yaxes[1].label).appendTo(n),B.draw(e)}function l(t,e){var n=q.yaxes[0],r=q.yaxes[1];n.show&&n.label&&(e.left=20),r.show&&r.label&&(e.right=20);for(var i=t.getYAxes(),a=0;a<i.length;a++){var o=i[a],s=q.yaxes[a];o.options.max=null!==o.options.max?o.options.max:s.max,o.options.min=null!==o.options.min?o.options.min:s.min}}function u(t){for(var e=Number.MAX_VALUE,n=0;n<t.length;n++)if(t[n].stats.timeStep){if(q.bars){if(t[n].bars&&!1===t[n].bars.show)continue}else if(void 0===t[n].bars||void 0===t[n].bars.show||!t[n].bars.show)continue;t[n].stats.timeStep<e&&(e=t[n].stats.timeStep)}return e}function c(){function t(t){try{I=p.a.plot(n,R,r),F.renderError&&(delete F.error,delete F.inspector)}catch(t){console.log("flotcharts error",t),F.error=t.message||"Render Error",F.renderError=!0,F.inspector={error:t}}t&&F.renderingCompleted()}if(z=n.width(),!o()){B.prepare(n,$),q.dashes=!!q.lines&&q.dashes;for(var e=!!q.stack||null,r={hooks:{draw:[s],processOffset:[l]},legend:{show:!1},series:{stackpercent:!!q.stack&&q.percentage,stack:q.percentage?null:e,lines:{show:q.lines,zero:!1,fill:h(q.fill),lineWidth:q.dashes?0:q.linewidth,steps:q.steppedLine},dashes:{show:q.dashes,lineWidth:q.linewidth,dashLength:[q.dashLength,q.spaceLength]},bars:{show:q.bars,fill:1,barWidth:1,zero:!1,lineWidth:0},points:{show:q.points,fill:1,fillColor:!1,radius:q.points?q.pointradius:2},shadowSize:0},yaxes:[],xaxis:{},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#c8c8c8",margin:{left:0,right:0},labelMarginX:0},selection:{mode:"x",color:"#666"},crosshair:{mode:"x"}},i=0;i<$.length;i++){var a=$[i];a.data=a.getFlotPairs(a.nullPointMode||q.nullPointMode),F.hiddenSeries[a.alias]&&(a.data=[],a.stack=!1)}switch(q.xaxis.mode){case"series":r.series.bars.barWidth=.7,r.series.bars.align="center";for(var i=0;i<$.length;i++){var a=$[i];a.data=[[i+1,a.stats[q.xaxis.values[0]]]]}m(r);break;case"histogram":var c=void 0,y=Object(C.b)($);if($.length&&y.length){var x=g.a.min(g.a.map($,function(t){return t.stats.min})),w=g.a.max(g.a.map($,function(t){return t.stats.max})),k=q.xaxis.buckets||z/50;c=Object(_.tickStep)(x,w,k);var M=Object(C.a)(y,c);$[0].data=M,$[0].alias=$[0].label=$[0].id="count",$=[$[0]],r.series.bars.barWidth=.8*c}else c=0;v(r,c);break;case"table":r.series.bars.barWidth=.7,r.series.bars.align="center",b(r);break;default:r.series.bars.barWidth=u($)/1.5,d(r)}B.addFlotOptions(r,q),V.addFlotEvents(j,r),S($,r),R=g.a.sortBy($,function(t){return t.zindex}),f(q)?(t(!1),setTimeout(function(){t(!0)},50),L=q.legend.rightSide):t(!0)}}function h(t){return q.percentage&&q.stack&&0===t?.001:t/10}function f(t){return!!t.legend.rightSide||null!==L&&t.legend.rightSide!==L}function d(t){var e=z/100,n=g.a.isUndefined(F.range.from)?null:F.range.from.valueOf(),r=g.a.isUndefined(F.range.to)?null:F.range.to.valueOf();t.xaxis={timezone:N.getTimezone(),show:q.xaxis.show,mode:"time",min:n,max:r,label:"Datetime",ticks:e,timeformat:D(e,n,r)}}function m(t){var e=g.a.map($,function(t,e){return[e+1,t.alias]});t.xaxis={timezone:N.getTimezone(),show:q.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}}function v(t,e){var n,r,i,a=z/50;if($.length&&e){n=g.a.map($[0].data,function(t){return t[0]}),r=g.a.min(n),i=g.a.max(n);for(var o=e,s=Math.floor((i-r)/o);s>a;)o*=2,s=Math.ceil((i-r)/o);r=Math.floor(r/o)*o,i=Math.ceil(i/o)*o,n=[];for(var l=r;l<=i;l+=o)n.push(l)}else n=a/2,r=0,i=1;t.xaxis={timezone:N.getTimezone(),show:q.xaxis.show,mode:null,min:r,max:i,label:"Histogram",ticks:n},O(t.xaxis,"short")}function b(t){var e=g.a.map($,function(t,e){return g.a.map(t.datapoints,function(n,r){return[e*t.datapoints.length+r+1,n[1]]})});e=g.a.flatten(e,!0),t.xaxis={timezone:N.getTimezone(),show:q.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}}function S(t,e){var n={position:"left",show:q.yaxes[0].show,index:1,logBase:q.yaxes[0].logBase||1,min:A(q.yaxes[0].min),max:A(q.yaxes[0].max),tickDecimals:q.yaxes[0].decimals};if(e.yaxes.push(n),g.a.find(t,{yaxis:2})){var r=g.a.clone(n);r.index=2,r.show=q.yaxes[1].show,r.logBase=q.yaxes[1].logBase||1,r.position="right",r.min=A(q.yaxes[1].min),r.max=A(q.yaxes[1].max),r.tickDecimals=q.yaxes[1].decimals,e.yaxes.push(r),P(e.yaxes[1],t),O(e.yaxes[1],q.percentage&&q.stack?"percent":q.yaxes[1].format)}P(e.yaxes[0],t),O(e.yaxes[0],q.percentage&&q.stack?"percent":q.yaxes[0].format)}function A(t){return null===t||void 0===t?null:g.a.toNumber(t)}function P(t,e){if(1!==t.logBase){var n=0===t.min;t.min<Number.MIN_VALUE&&(t.min=null),t.max<Number.MIN_VALUE&&(t.max=null);var r,i,a=t.max,o=t.min;for(i=0;i<e.length;i++)r=e[i],r.yaxis===t.index&&((!a||a<r.stats.max)&&(a=r.stats.max),(!o||o>r.stats.logmin)&&(o=r.stats.logmin));t.transform=function(e){return e<Number.MIN_VALUE?null:Math.log(e)/Math.log(t.logBase)},t.inverseTransform=function(e){return Math.pow(t.logBase,e)},a||o?a?o||(o=a*t.inverseTransform(-4)):a=o*t.inverseTransform(4):(a=t.inverseTransform(2),o=t.inverseTransform(-2)),o=t.min?t.inverseTransform(Math.ceil(t.transform(t.min))):t.min=t.inverseTransform(Math.floor(t.transform(o))),a=t.max?t.inverseTransform(Math.floor(t.transform(t.max))):t.max=t.inverseTransform(Math.ceil(t.transform(a))),!o||o<Number.MIN_VALUE||!a||a<Number.MIN_VALUE||(Number.isFinite(o)&&Number.isFinite(a)?(n&&(t.min=.1,o=1),t.ticks=E(o,a,t.logBase),n&&t.ticks.unshift(.1),t.ticks[t.ticks.length-1]>t.max&&(t.max=t.ticks[t.ticks.length-1])):(t.ticks=[1,2],delete t.min,delete t.max))}}function E(t,e,n){var r,i=[];for(r=t;r<=e;r*=n)i.push(r);var a=Math.ceil(F.height/25),o=i.length;if(o>a){var s=Math.ceil(o/a)*n;for(i=[],r=t;r<=e*s;r*=s)i.push(r)}return i}function O(t,e){t.tickFormatter=function(t,n){return x.a.valueFormats[e](t,n.tickDecimals,n.scaledDecimals)}}function D(t,e,n){if(e&&n&&t){var r=n-e,i=r/t/1e3;return i<=45?"%H:%M:%S":i<=7200||r<=864e5?"%H:%M":i<=8e4?"%m/%d %H:%M":i<=2419200||r<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}var $,I,R,F=t.ctrl,N=F.dashboard,q=F.panel,j=[],L=null,U=t.$root,z=0,V=new T.EventManager(F),B=new M.a(F),Y=new k.a(n,N,t,function(){return R});F.events.on("panel-teardown",function(){B=null,I&&(I.destroy(),I=null)}),F.events.on("render",function(t){($=t||$)&&(j=F.annotations||[],c())}),w.appEvents.on("graph-hover",function(t){N.sharedTooltipModeEnabled()&&I&&t.panel.id!==q.id&&!F.otherPanelInFullscreenMode()&&Y.show(t.pos)},t),w.appEvents.on("graph-hover-clear",function(t,e){I&&Y.clear(I)},t),n.bind("plotselected",function(n,i){(i.ctrlKey||i.metaKey)&&r.isEditor?setTimeout(function(){V.updateTime(i.xaxis)},100):t.$apply(function(){e.setTime({from:y.a.utc(i.xaxis.from),to:y.a.utc(i.xaxis.to)})})}),n.bind("plotclick",function(t,e,n){if((e.ctrlKey||e.metaKey)&&r.isEditor){e.x!==e.x1||setTimeout(function(){V.updateTime({from:e.x,to:null})},100)}}),t.$on("$destroy",function(){Y.destroy(),n.off(),n.remove()})}}}r.$inject=["$rootScope","timeSrv","popoverSrv","contextSrv"];var i=n(806),a=(n.n(i),n(826)),o=(n.n(a),n(827)),s=(n.n(o),n(828)),l=(n.n(s),n(829)),u=(n.n(l),n(830)),c=(n.n(u),n(831)),h=(n.n(c),n(832)),f=(n.n(h),n(975)),d=(n.n(f),n(10)),p=n.n(d),m=n(4),g=n.n(m),v=n(1),y=n.n(v),b=n(109),x=n.n(b),_=n(805),w=n(290),S=n(976),k=n.n(S),M=n(977),T=n(817),C=n(978);w.coreModule.directive("grafanaGraph",r)},function(t,e,n){var r,i;r=[n(10),n(4),n(8),n(56)],void 0!==(i=function(t,e,n,r){"use strict";function i(t,e,i){var a=n.element(document).injector(),o=document.createElement("div");o.innerHTML='<annotation-tooltip event="event" on-edit="onEdit()"></annotation-tooltip>',a.invoke(["$compile","$rootScope",function(n,a){var s=i.getOptions().events.manager,l=a.$new(!0);l.event=e,l.onEdit=function(){s.editEvent(e)},n(o)(l),l.$digest(),l.$destroy();var u=new r({target:t[0],content:o,position:"bottom center",classes:"drop-popover drop-popover--annotation",openOn:"hover",hoverCloseDelay:200,tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}});u.open(),u.on("close",function(){setTimeout(function(){u.destroy()})})}])}function a(t,e,i){var a=i.getOptions().events.manager;if(a.editorOpen)return void(s=t);a.editorOpened(),s=t,setTimeout(function(){var t=n.element(document).injector(),i=document.createElement("div");i.innerHTML='<event-editor panel-ctrl="panelCtrl" event="event" close="close()"></event-editor>',t.invoke(["$compile","$rootScope",function(t,n){var o,l=n.$new(!0);l.event=e,l.panelCtrl=a.panelCtrl,l.close=function(){o.close()},t(i)(l),l.$digest(),o=new r({target:s[0],content:i,position:"bottom center",classes:"drop-popover drop-popover--form",openOn:"click",tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}}),o.open(),a.editorOpened(),o.on("close",function(){setTimeout(function(){a.editorClosed(),l.$destroy(),o.destroy()})})}])},100)}function o(e){var n=this,r=new c(e);e.getEvents=function(){return r._events},e.hideEvents=function(){t.each(r._events,function(t,e){e.visual().getObject().hide()})},e.showEvents=function(){e.hideEvents(),t.each(r._events,function(t,e){e.hide()}),n.eventMarkers.drawEvents()},e.setEvents=function(t){r.eventsEnabled&&r.setupEvents(t)},e.hooks.processOptions.push(function(t,e){null!=e.events.data&&(r.eventsEnabled=!0)}),e.hooks.draw.push(function(t){var e=t.getOptions();r.eventsEnabled&&(r.getEvents().length<1?(r.setTypes(e.events.types),r.setupEvents(e.events.data)):r.updateEvents()),r.drawEvents()})}var s=null,l=function(t,e,n,r,i,a,o,s){var l=t,u=e,c=n,h=r,f={left:i,top:a},d=o,p=s;this.width=function(){return d},this.height=function(){return p},this.position=function(){return f},this.draw=function(){u(l)},this.clear=function(){c(l)},this.getObject=function(){return l},this.moveTo=function(t){f=t,h(l,f)}},u=function(t,e){var n=t,r=e,i=!1;this.visual=function(){return r},this.getOptions=function(){return n},this.getParent=function(){},this.isHidden=function(){return i},this.hide=function(){i=!0},this.unhide=function(){i=!1}},c=function(n){var r=[];this._types=[],this._plot=n,this.eventsEnabled=!1,this.getEvents=function(){return r},this.setTypes=function(t){return this._types=t},this.setupEvents=function(n){var i=this,a=e.partition(n,"isRegion"),o=a[0];n=a[1],t.each(n,function(t,e){var n=new u(e,i._buildDiv(e));r.push(n)}),t.each(o,function(t,e){var n=new u(e,i._buildRegDiv(e));r.push(n)}),r.sort(function(t,e){var n=t.getOptions(),r=e.getOptions();return n.min>r.min?1:n.min<r.min?-1:0})},this.drawEvents=function(){var e=this;t.each(r,function(t,n){e._insidePlot(n.getOptions().min)&&!n.isHidden()?n.visual().draw():n.visual().getObject().hide()})},this.updateEvents=function(){var e,n,i=this,a=this._plot.getPlotOffset(),o=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];t.each(r,function(t,r){n=a.top+i._plot.height()-r.visual().height(),e=o.p2c(r.getOptions().min)+a.left-r.visual().width()/2,r.visual().moveTo({top:n,left:e})})},this._clearEvents=function(){t.each(r,function(t,e){e.visual().clear()}),r=[]},this._buildDiv=function(e){var n,r,o,s,u,c,h,f,d=this,p=this._plot.getPlaceholder(),m=this._plot.getPlotOffset(),g=this._plot.getAxes(),v=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];g.yaxis&&g.yaxis.used&&g.yaxis,g.yaxis2&&g.yaxis2.used&&g.yaxis2;var y=e.eventType;o=null!==this._types&&this._types[y]&&this._types[y].color?this._types[y].color:"#666",s=null!==this._types&&this._types[y]&&this._types[y].markerSize?this._types[y].markerSize:8,u=null===this._types||!this._types[y]||void 0===this._types[y].markerShow||this._types[y].markerShow,f=null===this._types||!this._types[y]||void 0===this._types[y].markerTooltip||this._types[y].markerTooltip,c=null!=this._types&&this._types[y]&&this._types[y].lineStyle?this._types[y].lineStyle.toLowerCase():"dashed",h=null!=this._types&&this._types[y]&&void 0!==this._types[y].lineWidth?this._types[y].lineWidth:1;var b=v.options.eventSectionHeight||0;b/=3,n=m.top+this._plot.height()+b,r=v.p2c(e.min)+m.left;var x=t('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:r+"px",top:8,width:h+"px",height:this._plot.height()+.8*b,"border-left-width":h+"px","border-left-style":c,"border-left-color":o,color:o}).appendTo(p);if(u){var _=t('<div class="events_marker"></div>').css({position:"absolute",left:-s-Math.round(h/2)+"px","font-size":0,"line-height":0,width:0,height:0,"border-left":s+"px solid transparent","border-right":s+"px solid transparent"});_.appendTo(x),this._types[y]&&this._types[y].position&&"BOTTOM"===this._types[y].position.toUpperCase()?_.css({top:n-s-8+"px","border-top":"none","border-bottom":s+"px solid "+o}):_.css({top:"0px","border-top":s+"px solid "+o,"border-bottom":"none"}),_.data({event:e});var w=function(){i(_,t(this).data("event"),d._plot)};e.editModel&&a(_,e.editModel,d._plot);var S=function(){d._plot.clearSelection()};f&&(_.css({cursor:"help"}),_.hover(w,S))}return new l(x,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},r,n,x.width(),x.height())},this._buildRegDiv=function(n){var r,o,s,u,c,h,f,d=this,p=this._plot.getPlaceholder(),m=this._plot.getPlotOffset(),g=this._plot.getAxes(),v=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];g.yaxis&&g.yaxis.used&&g.yaxis,g.yaxis2&&g.yaxis2.used&&g.yaxis2;var y=n.eventType;h=null!==this._types&&this._types[y]&&this._types[y].color?this._types[y].color:"#666",f=null===this._types||!this._types[y]||void 0===this._types[y].markerTooltip||this._types[y].markerTooltip,s=null!=this._types&&this._types[y]&&void 0!==this._types[y].lineWidth?this._types[y].lineWidth:1,c=null!=this._types&&this._types[y]&&this._types[y].lineStyle?this._types[y].lineStyle.toLowerCase():"dashed";r=m.top+this._plot.height()+2;var b=Math.min(n.min,n.timeEnd),x=Math.max(n.min,n.timeEnd);o=v.p2c(b)+m.left;var _=v.p2c(x)+m.left;u=_-o,e.each([o,_],function(e){t('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:e+"px",top:8,width:s+"px",height:d._plot.height()+2,"border-left-width":s+"px","border-left-style":c,"border-left-color":h,color:h}).appendTo(p)});var w=t('<div class="events_marker region_marker flot-temp-elem"></div>').css({position:"absolute",opacity:.5,left:o+"px",top:r,width:Math.round(u+s)+"px",height:"0.5rem","border-left-color":h,color:h,"background-color":h});w.appendTo(p),w.data({event:n});var S=function(){i(w,t(this).data("event"),d._plot)};n.editModel&&a(w,n.editModel,d._plot);var k=function(){d._plot.clearSelection()};return f&&(w.css({cursor:"help"}),w.hover(S,k)),new l(w,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},o,r,w.width(),w.height())},this._insidePlot=function(t){var e=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],n=e.p2c(t);return n>0&&n<e.p2c(e.max)}},h={events:{data:null,types:null,xaxis:1,position:"BOTTOM"}};t.plot.plugins.push({init:o,options:h,name:"events",version:"0.2.5"})}.apply(e,r))&&(t.exports=i)},function(t,e,n){var r,i;r=[n(10),n(290)],void 0!==(i=function(t,e){"use strict";function n(e,n,i,a){var o=this,s=i.ctrl,l=s.panel,u=t('<div class="graph-tooltip">');this.destroy=function(){u.remove()},this.findHoverIndexFromDataPoints=function(t,e,n){for(var r=e.datapoints.pointsize,i=n*r,a=e.datapoints.points.length,o=i;o<a;o+=r)if(!e.lines.steps&&null!=e.datapoints.points[i]&&null==e.datapoints.points[o]||e.datapoints.points[o]>t)return Math.max(o-r,0)/r;return o/r-1},this.findHoverIndexFromData=function(t,e){for(var n,r=0,i=e.data.length-1;;){if(r>i)return Math.max(i,0);if(n=Math.floor((r+i)/2),e.data[n][0]===t)return n;e.data[n][0]<t?r=n+1:i=n-1}},this.renderAndShow=function(t,e,n,r){"time"===r&&(e='<div class="graph-tooltip-time">'+t+"</div>"+e),u.html(e).place_tt(n.pageX+20,n.pageY)},this.getMultiSeriesPlotHoverInfo=function(t,e){var n,r,i,a,o,s,u,c,h,f=[[],[],[]],d=0;for(r=0;r<t.length;r++)i=t[r],!i.data.length||l.legend.hideEmpty&&i.allIsNull?f[0].push({hidden:!0,value:0}):!i.data.length||l.legend.hideZero&&i.allIsZero?f[0].push({hidden:!0,value:0}):(a=this.findHoverIndexFromData(e.x,i),o=e.x-i.data[a][0],s=i.data[a][0],(!c||o>=0&&(o<c||c<0)||o<0&&o>c)&&(c=o,h=s),i.stack?"individual"===l.tooltip.value_type?n=i.data[a][1]:i.stack?(d+=i.data[a][1],n=d):n=i.data[a][1]:n=i.data[a][1],(i.lines.steps||i.stack)&&(a=this.findHoverIndexFromDataPoints(e.x,i,a)),u=0,i.yaxis&&(u=i.yaxis.n),f[u].push({value:n,hoverIndex:a,color:i.color,label:i.label,time:s,distance:o,index:r}));return f=f[0].concat(f[1],f[2]),f.time=h,f},e.mouseleave(function(){if(l.tooltip.shared){var t=e.data().plot;t&&(u.detach(),t.unhighlight())}r.emit("graph-hover-clear")}),e.bind("plothover",function(t,n,i){o.show(n,i),n.panelRelY=(n.pageY-e.offset().top)/e.height(),r.emit("graph-hover",{pos:n,panel:l})}),e.bind("plotclick",function(t,e,n){r.emit("graph-click",{pos:e,panel:l,item:n})}),this.clear=function(t){u.detach(),t.clearCrosshair(),t.unhighlight()},this.show=function(r,i){var s,c,h,f,d,p,m,g,v=e.data().plot,y=v.getData(),b=v.getXAxes(),x=b[0].options.mode,_=a(),w=l.tooltip.shared;if(r.panelRelY){var S=v.pointOffset({x:r.x});if(Number.isNaN(S.left)||S.left<0||S.left>e.width())return void o.clear(v);r.pageX=e.offset().left+S.left,r.pageY=e.offset().top+e.height()*r.panelRelY;if(!(r.pageY>=t(window).scrollTop()&&r.pageY<=t(window).innerHeight()+t(window).scrollTop()))return void o.clear(v);if(v.setCrosshair(r),w=!0,n.sharedCrosshairModeOnly())return}if(0!==_.length)if(g=_[0].hasMsResolution?"YYYY-MM-DD HH:mm:ss.SSS":"YYYY-MM-DD HH:mm:ss",w){v.unhighlight();var k=o.getMultiSeriesPlotHoverInfo(y,r);for(m="",h=n.formatDate(k.time,g),2===l.tooltip.sort?k.sort(function(t,e){return e.value-t.value}):1===l.tooltip.sort&&k.sort(function(t,e){return t.value-e.value}),d=0;d<k.length;d++)if(f=k[d],!f.hidden){var M="";i&&f.index===i.seriesIndex&&(M="graph-tooltip-list-item--highlight"),p=_[f.index],c=p.formatValue(f.value),m+='<div class="graph-tooltip-list-item '+M+'"><div class="graph-tooltip-series-name">',m+='<i class="fa fa-minus" style="color:'+f.color+';"></i> '+f.label+":</div>",m+='<div class="graph-tooltip-value">'+c+"</div></div>",v.highlight(f.index,f.hoverIndex)}o.renderAndShow(h,m,r,x)}else i?(p=_[i.seriesIndex],s='<div class="graph-tooltip-list-item"><div class="graph-tooltip-series-name">',s+='<i class="fa fa-minus" style="color:'+i.series.color+';"></i> '+p.label+":</div>",c=l.stack&&"individual"===l.tooltip.value_type?i.datapoint[1]-i.datapoint[2]:i.datapoint[1],c=p.formatValue(c),h=n.formatDate(i.datapoint[0],g),s+='<div class="graph-tooltip-value">'+c+"</div>",o.renderAndShow(h,s,r,x)):u.detach()}}var r=e.appEvents;return n}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(806),i=(n.n(r),n(10)),a=n.n(i),o=n(4),s=n.n(o),l=function(){function t(t){this.panelCtrl=t}return t.prototype.getHandleHtml=function(t,e,n){var r=e.colorMode;return"custom"===e.colorMode&&(r="critical"),'\n    <div class="alert-handle-wrapper alert-handle-wrapper--T'+t+'">\n      <div class="alert-handle-line alert-handle-line--'+r+'">\n      </div>\n      <div class="alert-handle" data-handle-index="'+t+'">\n        <i class="icon-gf icon-gf-'+r+" alert-state-"+r+'"></i>\n        <span class="alert-handle-value">'+n+'<i class="alert-handle-grip"></i></span>\n      </div>\n    </div>'},t.prototype.initDragging=function(t){function e(t){if(null===l)l=t.clientY;else{var e=t.clientY-l;r+=e,l=t.clientY,i.css({top:r+e})}}function n(){s=!1;var t=u.c2p({left:0,top:r}).y;t=parseInt(t.toFixed(0)),h.value=t,i.off("mousemove",e),i.off("mouseup",e),i.off("mouseleave",e),c.$scope.$apply(function(){c.render(),c.events.emit("threshold-changed",{threshold:h,handleIndex:o})})}var r,i=a()(t.currentTarget).parents(".alert-handle-wrapper"),o=a()(t.currentTarget).data("handleIndex"),s=!1,l=null,u=this.plot,c=this.panelCtrl,h=this.thresholds[o];s=!0,l=null,r=i.position().top,i.on("mousemove",e),i.on("mouseup",n),i.on("mouseleave",n)},t.prototype.cleanUp=function(){this.placeholder.find(".alert-handle-wrapper").remove(),this.needsCleanup=!1},t.prototype.renderHandle=function(t,e){var n=this.thresholds[t],r=n.value,i=r,o=0;if(s.a.isNumber(r)){var l=this.plot.p2c({x:0,y:r});o=Math.round(Math.min(Math.max(l.top,0),this.height)-6)}else i="",o=e;var u=a()(this.getHandleHtml(t,n,i));this.placeholder.append(u),u.toggleClass("alert-handle-wrapper--no-value",""===i),u.css({top:o})},t.prototype.shouldDrawHandles=function(){return!this.hasSecondYAxis&&this.panelCtrl.editingThresholds&&this.panelCtrl.panel.thresholds.length>0},t.prototype.prepare=function(t,e){this.hasSecondYAxis=!1;for(var n=0;n<e.length;n++)if(e[n].yaxis>1){this.hasSecondYAxis=!0;break}if(this.shouldDrawHandles()){var r=this.panelCtrl.panel.thresholds.length>1?"220px":"110px";t.css("margin-right",r)}else this.needsCleanup&&t.css("margin-right","0")},t.prototype.draw=function(t){this.thresholds=this.panelCtrl.panel.thresholds,this.plot=t,this.placeholder=t.getPlaceholder(),this.needsCleanup&&this.cleanUp(),this.shouldDrawHandles()&&(this.height=t.height(),this.thresholds.length>0&&this.renderHandle(0,10),this.thresholds.length>1&&this.renderHandle(1,this.height-30),this.placeholder.off("mousedown",".alert-handle"),this.placeholder.on("mousedown",".alert-handle",this.initDragging.bind(this)),this.needsCleanup=!0)},t.prototype.addFlotOptions=function(t,e){if(e.thresholds&&0!==e.thresholds.length){var n,r,i,a=1/0,o=-1/0;for(n=0;n<e.thresholds.length;n++)if(r=e.thresholds[n],s.a.isNumber(r.value)){var l;switch(r.op){case"gt":l=a,e.thresholds.length>n+1&&(i=e.thresholds[n+1],i.value>r.value&&(l=i.value,o=l));break;case"lt":l=o,e.thresholds.length>n+1&&(i=e.thresholds[n+1],i.value<r.value&&(l=i.value,a=l))}var u,c;switch(r.colorMode){case"critical":u="rgba(234, 112, 112, 0.12)",c="rgba(237, 46, 24, 0.60)";break;case"warning":u="rgba(235, 138, 14, 0.12)",c="rgba(247, 149, 32, 0.60)";break;case"ok":u="rgba(11, 237, 50, 0.090)",c="rgba(6,163,69, 0.60)";break;case"custom":u=r.fillColor,c=r.lineColor}r.fill&&t.grid.markings.push({yaxis:{from:r.value,to:l},color:u}),r.line&&t.grid.markings.push({yaxis:{from:r.value,to:r.value},color:c})}}},t}()},function(t,e,n){"use strict";function r(t){for(var e=[],n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.data.length;i++)null!==r.data[i][1]&&e.push(r.data[i][1]);return e}function i(t,e){for(var n={},r=0;r<t.length;r++){var i=a(t[r],e);n[i]?n[i]=n[i]+1:n[i]=1}var o=s.a.map(n,function(t,e){return[Number(e),t]});return s.a.sortBy(o,function(t){return t[0]})}function a(t,e){return Math.floor(t/e)*e}e.b=r,e.a=i;var o=n(4),s=n.n(o)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4),n(10)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.directives").directive("graphLegend",["popoverSrv","$timeout",function(t,r){return{link:function(i,a){function o(t){return t.parents("[data-series-index]").data("series-index")}function s(e){if(!n(e.target).parents(".popover").length){var i=n(e.currentTarget).find(".fa-minus"),a=o(i),s=d[a];r(function(){t.show({element:i[0],position:"bottom center",template:'<series-color-picker series="series" onToggleAxis="toggleAxis" onColorChange="colorSelected"></series-color-picker>',openOn:"hover",model:{series:s,toggleAxis:function(){v.toggleAxis(s)},colorSelected:function(t){v.changeSeriesColor(s,t)}}})})}}function l(t){var e=n(t.currentTarget),r=o(e),i=d[r],a=n(m.children("tbody")).scrollTop();v.toggleSeries(i,t),n(m.children("tbody")).scrollTop(a)}function u(t){var e=n(t.currentTarget),r=e.data("stat");if(r!==y.legend.sort&&(y.legend.sortDesc=null),!1===y.legend.sortDesc)return y.legend.sort=null,y.legend.sortDesc=null,void h();y.legend.sortDesc=!y.legend.sortDesc,y.legend.sort=r,h()}function c(t){if(!y.legend[t])return"";var e='<th class="pointer" data-stat="'+t+'">'+t;return y.legend.sort===t&&(e+=' <span class="'+(y.legend.sortDesc?"fa fa-caret-down":"fa fa-caret-up")+'"></span>'),e+"</th>"}function h(){if(!v.panel.legend.show)return a.empty(),void(g=!0);g&&(a.append(m),m.on("click",".graph-legend-icon",s),m.on("click",".graph-legend-alias",l),m.on("click","th",u),g=!1),d=f,m.empty();var t=y.legend.rightSide&&y.legend.sideWidth?y.legend.sideWidth+"px":"";m.css("min-width",t),m.toggleClass("graph-legend-table",!0===y.legend.alignAsTable);var r;if(y.legend.alignAsTable){var i="<tr>";i+='<th colspan="2" style="text-align:left"></th>',y.legend.values&&(i+=c("min"),i+=c("max"),i+=c("avg"),i+=c("current"),i+=c("total")),i+="</tr>",r=n(i)}y.legend.sort&&(d=e.sortBy(d,function(t){return t.stats[y.legend.sort]}),y.legend.sortDesc&&(d=d.reverse()));var o=0,h=[];for(p=0;p<d.length;p++){var b=d[p];if(!b.hideFromLegend(y.legend)){var x='<div class="graph-legend-series';if(2===b.yaxis&&(x+=" graph-legend-series--right-y"),v.hiddenSeries[b.alias]&&(x+=" graph-legend-series-hidden"),x+='" data-series-index="'+p+'">',x+='<div class="graph-legend-icon">',x+='<i class="fa fa-minus pointer" style="color:'+b.color+'"></i>',x+="</div>",x+='<a class="graph-legend-alias pointer" title="'+e.escape(b.label)+'">'+e.escape(b.label)+"</a>",y.legend.values){var _=b.formatValue(b.stats.avg),w=b.formatValue(b.stats.current),S=b.formatValue(b.stats.min),k=b.formatValue(b.stats.max),M=b.formatValue(b.stats.total);y.legend.min&&(x+='<div class="graph-legend-value min">'+S+"</div>"),y.legend.max&&(x+='<div class="graph-legend-value max">'+k+"</div>"),y.legend.avg&&(x+='<div class="graph-legend-value avg">'+_+"</div>"),y.legend.current&&(x+='<div class="graph-legend-value current">'+w+"</div>"),y.legend.total&&(x+='<div class="graph-legend-value total">'+M+"</div>")}x+="</div>",h.push(n(x)),o++}}if(y.legend.alignAsTable){var T=v.height;y.legend.rightSide||(T/=2);var C=n("<tbody></tbody>");C.css("max-height",T-6),C.append(r),C.append(h),m.append(C)}else m.append(h)}var f,d,p,m=n('<section class="graph-legend"></section>'),g=!0,v=i.ctrl,y=v.panel;v.events.on("render",function(){(f=v.seriesList)&&h()})}}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){(function(t){var r,i;r=[n(8),n(10),n(4)],void 0!==(i=function(t,e,n){"use strict";t.module("grafana.controllers").controller("SeriesOverridesCtrl",["$scope","$element","popoverSrv",function(t,e,r){t.overrideMenu=[],t.currentOverrides=[],t.override=t.override||{},t.addOverrideOption=function(e,r,i){var a={};a.text=e,a.propertyName=r,a.index=t.overrideMenu.length,a.values=i,a.submenu=n.map(i,function(t){return{text:String(t),value:t}}),t.overrideMenu.push(a)},t.setOverride=function(e,n){if("color"===e.propertyName)return void t.openColorSelector();t.override[e.propertyName]=n.value,"fillBelowTo"===e.propertyName&&(t.override.lines=!1,t.ctrl.addSeriesOverride({alias:n.value,lines:!1})),t.updateCurrentOverrides(),t.ctrl.render()},t.colorSelected=function(e){t.override.color=e,t.updateCurrentOverrides(),t.ctrl.render()},t.openColorSelector=function(){r.show({element:e.find(".dropdown")[0],position:"top center",openOn:"click",template:'<series-color-picker onColorChange="colorSelected" />',model:{autoClose:!0,colorSelected:t.colorSelected},onClose:function(){t.ctrl.render()}})},t.removeOverride=function(e){delete t.override[e.propertyName],t.updateCurrentOverrides(),t.ctrl.refresh()},t.getSeriesNames=function(){return n.map(t.ctrl.seriesList,function(t){return t.alias})},t.updateCurrentOverrides=function(){t.currentOverrides=[],n.each(t.overrideMenu,function(e){var r=t.override[e.propertyName];n.isUndefined(r)||t.currentOverrides.push({name:e.text,propertyName:e.propertyName,value:String(r)})})},t.addOverrideOption("Bars","bars",[!0,!1]),t.addOverrideOption("Lines","lines",[!0,!1]),t.addOverrideOption("Line fill","fill",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Line width","linewidth",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Null point mode","nullPointMode",["connected","null","null as zero"]),t.addOverrideOption("Fill below to","fillBelowTo",t.getSeriesNames()),t.addOverrideOption("Staircase line","steppedLine",[!0,!1]),t.addOverrideOption("Dashes","dashes",[!0,!1]),t.addOverrideOption("Dash Length","dashLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Dash Space","spaceLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Points","points",[!0,!1]),t.addOverrideOption("Points Radius","pointradius",[1,2,3,4,5]),t.addOverrideOption("Stack","stack",[!0,!1,"A","B","C","D"]),t.addOverrideOption("Color","color",["change"]),t.addOverrideOption("Y-axis","yaxis",[1,2]),t.addOverrideOption("Z-index","zindex",[-3,-2,-1,0,1,2,3]),t.addOverrideOption("Transform","transform",["negative-Y"]),t.addOverrideOption("Legend","legend",[!0,!1]),t.updateCurrentOverrides()}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";var r=n(2),i=function(){function t(t){var e=this;this.panel=this.panelCtrl.panel,this.panel.alert&&(this.disabled=!0);var n=t.$on("$destroy",function(){e.panelCtrl.editingThresholds=!1,e.panelCtrl.render(),n()});this.panelCtrl.editingThresholds=!0}return t.$inject=["$scope"],t.prototype.addThreshold=function(){this.panel.thresholds.push({value:void 0,colorMode:"critical",op:"gt",fill:!0,line:!0}),this.panelCtrl.render()},t.prototype.removeThreshold=function(t){this.panel.thresholds.splice(t,1),this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.onFillColorChange=function(t){var e=this;return function(n){e.panel.thresholds[t].fillColor=n,e.render()}},t.prototype.onLineColorChange=function(t){var e=this;return function(n){e.panel.thresholds[t].lineColor=n,e.render()}},t}();r.default.directive("graphThresholdForm",function(){return{restrict:"E",template:'\n<div class="gf-form-group">\n  <h5>Thresholds</h5>\n  <p class="muted" ng-show="ctrl.disabled">\n    Visual thresholds options <strong>disabled.</strong>\n    Visit the Alert tab update your thresholds. <br>\n    To re-enable thresholds, the alert rule must be deleted from this panel.\n  </p>\n  <div ng-class="{\'thresholds-form-disabled\': ctrl.disabled}">\n    <div class="gf-form-inline" ng-repeat="threshold in ctrl.panel.thresholds">\n      <div class="gf-form">\n        <label class="gf-form-label">T{{$index+1}}</label>\n      </div>\n\n      <div class="gf-form">\n        <div class="gf-form-select-wrapper">\n          <select class="gf-form-input" ng-model="threshold.op"\n                  ng-options="f for f in [\'gt\', \'lt\']" ng-change="ctrl.render()" ng-disabled="ctrl.disabled"></select>\n        </div>\n        <input type="number" ng-model="threshold.value" class="gf-form-input width-8"\n               ng-change="ctrl.render()" placeholder="value" ng-disabled="ctrl.disabled">\n      </div>\n\n      <div class="gf-form">\n        <label class="gf-form-label">Color</label>\n        <div class="gf-form-select-wrapper">\n          <select class="gf-form-input" ng-model="threshold.colorMode"\n                  ng-options="f for f in [\'custom\', \'critical\', \'warning\', \'ok\']" ng-change="ctrl.render()" ng-disabled="ctrl.disabled">\n          </select>\n        </div>\n      </div>\n\n      <gf-form-switch class="gf-form" label="Fill" checked="threshold.fill"\n                      on-change="ctrl.render()" ng-disabled="ctrl.disabled"></gf-form-switch>\n\n      <div class="gf-form" ng-if="threshold.fill && threshold.colorMode === \'custom\'">\n        <label class="gf-form-label">Fill color</label>\n        <span class="gf-form-label">\n          <color-picker color="threshold.fillColor" onChange="ctrl.onFillColorChange($index)"></color-picker>\n        </span>\n      </div>\n\n      <gf-form-switch class="gf-form" label="Line" checked="threshold.line"\n                      on-change="ctrl.render()" ng-disabled="ctrl.disabled"></gf-form-switch>\n\n      <div class="gf-form" ng-if="threshold.line && threshold.colorMode === \'custom\'">\n        <label class="gf-form-label">Line color</label>\n        <span class="gf-form-label">\n          <color-picker color="threshold.lineColor" onChange="ctrl.onLineColorChange($index)"></color-picker>\n        </span>\n      </div>\n\n      <div class="gf-form">\n        <label class="gf-form-label">\n          <a class="pointer" ng-click="ctrl.removeThreshold($index)" ng-disabled="ctrl.disabled">\n            <i class="fa fa-trash"></i>\n          </a>\n        </label>\n      </div>\n    </div>\n\n    <div class="gf-form-button-row">\n      <button class="btn btn-inverse" ng-click="ctrl.addThreshold()" ng-disabled="ctrl.disabled">\n        <i class="fa fa-plus"></i>&nbsp;Add Threshold\n      </button>\n    </div>\n  </div>\n</div>\n',controller:i,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}}})},function(t,e,n){"use strict";e.a='\n<div class="graph-wrapper" ng-class="{\'graph-legend-rightside\': ctrl.panel.legend.rightSide}">\n  <div class="graph-canvas-wrapper">\n\n    <div class="datapoints-warning" ng-if="ctrl.dataWarning">\n      <span class="small" bs-tooltip="ctrl.dataWarning.tip">{{ctrl.dataWarning.title}}</span>\n    </div>\n\n    <div grafana-graph class="histogram-chart" ng-dblclick="ctrl.zoomOut()">\n    </div>\n\n  </div>\n\n  <div class="graph-legend-wrapper" graph-legend></div>\n  </div>\n\n<div class="clearfix"></div>\n'},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(4),i=n.n(r),a=n(801),o=n(290),s=function(){function t(t){this.panel=t}return t.prototype.getSeriesList=function(t){var e=this;if(!t.dataList||0===t.dataList.length)return[];var n;if(t.dataList&&t.dataList.length>0){n=t.dataList[0];var r=this.getAutoDetectXAxisMode(n);this.panel.xaxis.mode!==r&&(this.panel.xaxis.mode=r,this.setPanelDefaultsForNewXAxisMode())}switch(this.panel.xaxis.mode){case"series":case"histogram":case"time":return t.dataList.map(function(n,r){return e.timeSeriesHandler(n,r,t)});case"field":return this.customHandler(n)}},t.prototype.getAutoDetectXAxisMode=function(t){switch(t.type){case"docs":case"table":return"field";default:return"series"===this.panel.xaxis.mode?"series":"histogram"===this.panel.xaxis.mode?"histogram":"time"}},t.prototype.setPanelDefaultsForNewXAxisMode=function(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}},t.prototype.timeSeriesHandler=function(t,e,n){var r=t.datapoints||[],i=t.target,s=e%o.colors.length,l=this.panel.aliasColors[i]||o.colors[s],u=new a.default({datapoints:r,alias:i,color:l,unit:t.unit});if(r&&r.length>0){r[r.length-1][1]-n.range.from<-1e4&&(u.isOutsideRange=!0)}return u},t.prototype.customHandler=function(t){if(!this.panel.xaxis.name)throw{message:"No field name specified to use for x-axis, check your axes settings"};return[]},t.prototype.validateXAxisSeriesValue=function(){switch(this.panel.xaxis.mode){case"series":if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);var t=this.getXAxisValueOptions({});return void(i.a.find(t,{value:this.panel.xaxis.values[0]})||(this.panel.xaxis.values=["total"]))}},t.prototype.getDataFieldNames=function(t,e){function n(t){i.a.forEach(t,function(t,a){if(i.a.isObject(t))o.push(a),n(t);else if(!e||i.a.isNumber(t)){var s=o.concat(a).join(".");r.push(s)}}),o.pop()}if(0===t.length)return[];var r=[],a=t[0],o=[];if("docs"===a.type){if(0===a.datapoints.length)return[];n(a.datapoints[0])}return r},t.prototype.getXAxisValueOptions=function(t){switch(this.panel.xaxis.mode){case"series":return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]}return[]},t.prototype.pluckDeep=function(t,e){for(var n=e.split("."),r=t,i=0;i<n.length;++i){if(!r[n[i]])return;r=r[n[i]]}return r},t}()},function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/graph/axes_editor.html",controller:o}}e.a=r;var i=n(109),a=n.n(i),o=function(){function t(t,e){this.$scope=t,this.$q=e,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.unitFormats=a.a.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.xAxisModes={Time:"time",Series:"series",Histogram:"histogram"},this.xAxisStatOptions=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"},{text:"Current",value:"current"}],"custom"===this.panel.xaxis.mode&&(this.panel.xaxis.name||(this.panel.xaxis.name="specify field"))}return t.$inject=["$scope","$q"],t.prototype.setUnitFormat=function(t,e){t.format=e.value,this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.xAxisModeChanged=function(){this.panelCtrl.processor.setPanelDefaultsForNewXAxisMode(),this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.xAxisValueChanged=function(){this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.getDataFieldNames=function(t){var e=this.panelCtrl.processor.getDataFieldNames(this.panelCtrl.dataList,t),n=e.map(function(t){return{text:t,value:t}});return this.$q.when(n)},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashListCtrl",function(){return l}),n.d(e,"PanelCtrl",function(){return l});var r=n(4),i=n.n(r),a=n(797),o=n(808),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;return a.backendSrv=r,a.panelDefaults={query:"",limit:10,tags:[],recent:!1,search:!1,starred:!0,headings:!0},i.a.defaults(a.panel,a.panelDefaults),a.panel.tag&&(a.panel.tags=[a.panel.tag],delete a.panel.tag),a.events.on("refresh",a.onRefresh.bind(a)),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.groups=[{list:[],show:!1,header:"Starred dashboards"},{list:[],show:!1,header:"Recently viewed dashboards"},{list:[],show:!1,header:"Search"}],a.panel.mode&&("starred"===a.panel.mode&&(a.panel.starred=!0,a.panel.headings=!1),"recently viewed"===a.panel.mode&&(a.panel.recent=!0,a.panel.starred=!1,a.panel.headings=!1),"search"===a.panel.mode&&(a.panel.search=!0,a.panel.starred=!1,a.panel.headings=!1),delete a.panel.mode),a}return s(e,t),e.$inject=["$scope","$injector","backendSrv"],e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.modes=["starred","search","recently viewed"],this.addEditorTab("Options","public/app/plugins/panel/dashlist/editor.html")},e.prototype.onRefresh=function(){var t=[];return t.push(this.getRecentDashboards()),t.push(this.getStarred()),t.push(this.getSearch()),Promise.all(t).then(this.renderingCompleted.bind(this))},e.prototype.getSearch=function(){var t=this;if(this.groups[2].show=this.panel.search,!this.panel.search)return Promise.resolve();var e={limit:this.panel.limit,query:this.panel.query,tag:this.panel.tags};return this.backendSrv.search(e).then(function(e){t.groups[2].list=e})},e.prototype.getStarred=function(){var t=this;if(this.groups[0].show=this.panel.starred,!this.panel.starred)return Promise.resolve();var e={limit:this.panel.limit,starred:"true"};return this.backendSrv.search(e).then(function(e){t.groups[0].list=e})},e.prototype.getRecentDashboards=function(){var t=this;if(this.groups[1].show=this.panel.recent,!this.panel.recent)return Promise.resolve();var e=i.a.take(o.impressions.getDashboardOpened(),this.panel.limit);return this.backendSrv.search({dashboardIds:e,limit:this.panel.limit}).then(function(n){t.groups[1].list=e.map(function(t){return i.a.find(n,function(e){return e.id===t})}).filter(function(t){return void 0!==t})})},e.templateUrl="module.html",e}(a.PanelCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PluginListCtrl",function(){return s}),n.d(e,"PanelCtrl",function(){return s});var r=n(4),i=n.n(r),a=n(804),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r,a){var o=t.call(this,e,n)||this;return o.backendSrv=r,o.$location=a,o.panelDefaults={},i.a.defaults(o.panel,o.panelDefaults),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.pluginList=[],o.viewModel=[{header:"Installed Apps",list:[],type:"app"},{header:"Installed Panels",list:[],type:"panel"},{header:"Installed Datasources",list:[],type:"datasource"}],o.update(),o}return o(e,t),e.$inject=["$scope","$injector","backendSrv","$location"],e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.addEditorTab("Options","public/app/plugins/panel/pluginlist/editor.html")},e.prototype.gotoPlugin=function(t,e){e&&e.stopPropagation(),this.$location.url("plugins/"+t.id+"/edit")},e.prototype.updateAvailable=function(t,e){e.stopPropagation(),e.preventDefault();var n=this.$scope.$new(!0);n.plugin=t,this.publishAppEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:n})},e.prototype.update=function(){var t=this;this.backendSrv.get("api/plugins",{embedded:0,core:0}).then(function(e){t.pluginList=e,t.viewModel[0].list=i.a.filter(e,{type:"app"}),t.viewModel[1].list=i.a.filter(e,{type:"panel"}),t.viewModel[2].list=i.a.filter(e,{type:"datasource"});for(var n=0,r=t.pluginList;n<r.length;n++){var a=r[n];a.hasUpdate?a.state="has-update":a.enabled||(a.state="not-enabled")}})},e.templateUrl="module.html",e}(a.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AlertListPanel",function(){return h}),n.d(e,"PanelCtrl",function(){return h});var r=n(4),i=n.n(r),a=n(1),o=n.n(a),s=n(799),l=n(797),u=n(292),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;a.backendSrv=r,a.showOptions=[{text:"Current state",value:"current"},{text:"Recent state changes",value:"changes"}],a.sortOrderOptions=[{text:"Alphabetical (asc)",value:1},{text:"Alphabetical (desc)",value:2},{text:"Importance",value:3}],a.stateFilter={},a.currentAlerts=[],a.alertHistory=[],a.panelDefaults={show:"current",limit:10,stateFilter:[],onlyAlertsOnDashboard:!1,sortOrder:1},i.a.defaults(a.panel,a.panelDefaults),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.events.on("render",a.onRender.bind(a)),a.events.on("refresh",a.onRender.bind(a));for(var o in a.panel.stateFilter)a.stateFilter[a.panel.stateFilter[o]]=!0;return a}return c(e,t),e.$inject=["$scope","$injector","backendSrv"],e.prototype.sortResult=function(t){if(3===this.panel.sortOrder)return i.a.sortBy(t,function(t){return s.a.alertStateSortScore[t.state]});var e=i.a.sortBy(t,function(t){return t.name.toLowerCase()});return 2===this.panel.sortOrder&&e.reverse(),e},e.prototype.updateStateFilter=function(){var t=[];for(var e in this.stateFilter)this.stateFilter[e]&&t.push(e);this.panel.stateFilter=t,this.onRender()},e.prototype.onRender=function(){this.contentHeight="max-height: "+this.height+"px;","current"===this.panel.show&&this.getCurrentAlertState(),"changes"===this.panel.show&&this.getStateChanges()},e.prototype.getStateChanges=function(){var t=this,e={limit:this.panel.limit,type:"alert",newState:this.panel.stateFilter};this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),e.from=1e3*u.parse(this.dashboard.time.from).unix(),e.to=1e3*u.parse(this.dashboard.time.to).unix(),this.backendSrv.get("/api/annotations",e).then(function(e){t.alertHistory=i.a.map(e,function(e){return e.time=t.dashboard.formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=s.a.getStateDisplayModel(e.newState),e.info=s.a.getAlertAnnotationInfo(e),e})})},e.prototype.getCurrentAlertState=function(){var t=this,e={state:this.panel.stateFilter};this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),this.backendSrv.get("/api/alerts",e).then(function(e){t.currentAlerts=t.sortResult(i.a.map(e,function(t){return t.stateModel=s.a.getStateDisplayModel(t.state),t.newStateDateAgo=o()(t.newStateDate).locale("en").fromNow(!0),t}))})},e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/alertlist/editor.html")},e.templateUrl="module.html",e}(l.PanelCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n(989),n(991));n.d(e,"PanelCtrl",function(){return r.a})},function(t,e,n){"use strict";function r(t,e,n,r,i,o){var s=b()(t).find("svg"),c=_.a.select(s.get(0));l(t);var h=Math.floor(s.outerWidth())-30,f=s.attr("height"),d=1;r-n>h&&(d=Math.floor((r-n)/h));var p=h/(r-n),m=_.a.range(n,r,d),g=u(e,i,o);c.selectAll(".heatmap-color-legend-rect").data(m).enter().append("rect").attr("x",function(t){return t*p}).attr("y",0).attr("width",d*p+1).attr("height",f).attr("stroke-width",0).attr("fill",function(t){return g(t)}),a(t,g,n,r,i,o,h)}function i(t,e,n,r,i,o){var s=b()(t).find("svg"),u=_.a.select(s.get(0));l(t);var h=Math.floor(s.outerWidth())-30,f=s.attr("height"),d=h/(r-n),p=_.a.range(n,r,10),m=c(e,i,o);u.selectAll(".heatmap-opacity-legend-rect").data(p).enter().append("rect").attr("x",function(t){return t*d}).attr("y",0).attr("width",10*d).attr("height",f).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return m(t)}),a(t,m,n,r,i,o,h)}function a(t,e,n,r,i,a,o){var s=b()(t).find("svg"),l=_.a.select(s.get(0));if(!(o<=0||0===s.get(0).childNodes.length)){var u=_.a.scaleLinear().domain([0,r]).range([0,o]),c=f(0,r,i,a),d=_.a.axisBottom(u).tickValues(c).tickSize(2),p=s.find(":first-child"),m=p.height()+2,g=h(p);_.a.select(s.get(0)).append("g").attr("class","axis").attr("transform","translate("+g+","+m+")").call(d),l.select(".axis").select(".domain").remove()}}function o(t,e){var n=b()(t).find("svg");l(t);var r=Math.floor(n.outerWidth()),i=n.attr("height");if(r){var a=Math.floor(r/2),o=Math.floor(r/a),s=_.a.range(0,r,o);_.a.select(n.get(0)).selectAll(".heatmap-color-legend-rect").data(s).enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",o+1).attr("height",i).attr("stroke-width",0).attr("fill",function(t){return e(t)})}}function s(t,e){var n=b()(t).find("svg");l(t);var r=_.a.select(n.get(0)),i=Math.floor(n.outerWidth()),a=n.attr("height");if(i){var o;"linear"===e.colorScale?o=_.a.scaleLinear().domain([0,i]).range([0,1]):"sqrt"===e.colorScale&&(o=_.a.scalePow().exponent(e.exponent).domain([0,i]).range([0,1]));var s=_.a.range(0,i,10);r.selectAll(".heatmap-opacity-legend-rect").data(s).enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",10).attr("height",a).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return o(t)})}}function l(t){b()(t).find("svg").empty()}function u(t,e,n){void 0===n&&(n=0);var r=_.a[t.value],i="always"===t.invert||"dark"===t.invert&&!w.contextSrv.user.lightTheme,a=i?e:n,o=i?n:e;return _.a.scaleSequential(r).domain([a,o])}function c(t,e,n){void 0===n&&(n=0);var r;return"linear"===t.colorScale?r=_.a.scaleLinear().domain([n,e]).range([0,1]):"sqrt"===t.colorScale&&(r=_.a.scalePow().exponent(t.exponent).domain([n,e]).range([0,1])),r}function h(t){var e=t.get(0);return e&&e.x&&e.x.baseVal?t.get(0).x.baseVal.value:0}function f(t,e,n,r){for(var i=e-t,a=Object(S.tickStep)(t,e,3),o=Math.round(i/a),s=[],l=0;l<o;l++){var u=a*l;d(r,u,a)?s.push(r):(r<u&&s.push(r),d(n,u,a)?s.push(n):(n<u&&s.push(n),s.push(a*l)))}return d(n,e,a)||s.push(n),s.push(e),s=v.a.sortBy(v.a.uniq(s))}function d(t,e,n){return Math.abs(t-e)<.3*n}var p=n(8),m=n.n(p),g=n(4),v=n.n(g),y=n(10),b=n.n(y),x=n(807),_=n.n(x),w=n(290),S=n(805),t=m.a.module("grafana.directives");t.directive("colorLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="16.8rem" height="24px"></svg></div>',link:function(t,e,n){function r(){var t=b()(e).find("svg"),n=Math.floor(t.outerWidth());if("spectrum"===a.color.mode){var r=v.a.find(i.colorSchemes,{value:a.color.colorScheme}),l=u(r,n);o(e,l)}else if("opacity"===a.color.mode){var c=a.color;s(e,c)}}var i=t.ctrl,a=t.ctrl.panel;r(),i.events.on("render",function(){r()})}}}),t.directive("heatmapLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="100px" height="14px"></svg></div>',link:function(t,e,n){function a(){if(l(e),!v.a.isEmpty(o.data)&&!v.a.isEmpty(o.data.cards)){var t=o.data.cardStats.max,n=s.color.max||t,a=s.color.min||0;if("spectrum"===s.color.mode){var u=v.a.find(o.colorSchemes,{value:s.color.colorScheme});r(e,u,0,t,n,a)}else if("opacity"===s.color.mode){var c=s.color;i(e,c,0,t,n,a)}}}var o=t.ctrl,s=t.ctrl.panel;a(),o.events.on("render",function(){a()})}}})},function(t,e,n){!function(t,r){r(e,n(833))}(0,function(t,e){"use strict";var n=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},r=n("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),i=n("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),a=n("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),o=n("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),s=n("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),l=n("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),u=n("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),c=n("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),h=function(t){return e.interpolateRgbBasis(t[t.length-1])},f=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(n),d=h(f),p=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(n),m=h(p),g=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(n),v=h(g),y=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(n),b=h(y),x=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(n),_=h(x),w=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(n),S=h(w),k=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(n),M=h(k),T=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(n),C=h(T),A=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(n),P=h(A),E=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(n),O=h(E),D=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(n),$=h(D),I=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(n),R=h(I),F=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(n),N=h(F),q=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(n),j=h(q),L=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(n),U=h(L),z=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(n),V=h(z),B=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(n),Y=h(B),H=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(n),Q=h(H),W=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(n),G=h(W),K=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(n),X=h(K),J=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(n),Z=h(J),tt=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(n),et=h(tt),nt=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(n),rt=h(nt),it=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(n),at=h(it),ot=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(n),st=h(ot),lt=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(n),ut=h(lt),ct=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(n),ht=h(ct);t.schemeAccent=r,t.schemeDark2=i,t.schemePaired=a,t.schemePastel1=o,t.schemePastel2=s,t.schemeSet1=l,t.schemeSet2=u,t.schemeSet3=c,t.interpolateBrBG=d,t.schemeBrBG=f,t.interpolatePRGn=m,t.schemePRGn=p,t.interpolatePiYG=v,t.schemePiYG=g,t.interpolatePuOr=b,t.schemePuOr=y,t.interpolateRdBu=_,t.schemeRdBu=x,t.interpolateRdGy=S,t.schemeRdGy=w,t.interpolateRdYlBu=M,t.schemeRdYlBu=k,t.interpolateRdYlGn=C,t.schemeRdYlGn=T,t.interpolateSpectral=P,t.schemeSpectral=A,t.interpolateBuGn=O,t.schemeBuGn=E,t.interpolateBuPu=$,t.schemeBuPu=D,t.interpolateGnBu=R,t.schemeGnBu=I,t.interpolateOrRd=N,t.schemeOrRd=F,t.interpolatePuBuGn=j,t.schemePuBuGn=q,t.interpolatePuBu=U,t.schemePuBu=L,t.interpolatePuRd=V,t.schemePuRd=z,t.interpolateRdPu=Y,t.schemeRdPu=B,t.interpolateYlGnBu=Q,t.schemeYlGnBu=H,t.interpolateYlGn=G,t.schemeYlGn=W,t.interpolateYlOrBr=X,t.schemeYlOrBr=K,t.interpolateYlOrRd=Z,t.schemeYlOrRd=J,t.interpolateBlues=et,t.schemeBlues=tt,t.interpolateGreens=rt,t.schemeGreens=nt,t.interpolateGreys=at,t.schemeGreys=it,t.interpolatePurples=st,t.schemePurples=ot,t.interpolateReds=ut,t.schemeReds=lt,t.interpolateOranges=ht,t.schemeOranges=ct,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){"use strict";n.d(e,"a",function(){return b});var r=n(797),i=n(4),a=n.n(i),o=n(109),s=n.n(o),l=n(992),u=n.n(l),c=n(993),h=n(994),f=n(995),d=n(810),p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m={heatmap:{},cards:{cardPadding:null,cardRound:null},color:{mode:"spectrum",cardColor:"#b4ff00",colorScale:"sqrt",exponent:.5,colorScheme:"interpolateOranges"},legend:{show:!1},dataFormat:"timeseries",xAxis:{show:!0},yAxis:{show:!0,format:"short",decimals:null,logBase:1,splitFactor:null,min:null,max:null},xBucketSize:null,xBucketNumber:null,yBucketSize:null,yBucketNumber:null,tooltip:{show:!0,showHistogram:!1},highlightCards:!0},g=["opacity","spectrum"],v=["linear","sqrt"],y=[{name:"Spectral",value:"interpolateSpectral",invert:"always"},{name:"RdYlGn",value:"interpolateRdYlGn",invert:"always"},{name:"Blues",value:"interpolateBlues",invert:"dark"},{name:"Greens",value:"interpolateGreens",invert:"dark"},{name:"Greys",value:"interpolateGreys",invert:"dark"},{name:"Oranges",value:"interpolateOranges",invert:"dark"},{name:"Purples",value:"interpolatePurples",invert:"dark"},{name:"Reds",value:"interpolateReds",invert:"dark"},{name:"BuGn",value:"interpolateBuGn",invert:"dark"},{name:"BuPu",value:"interpolateBuPu",invert:"dark"},{name:"GnBu",value:"interpolateGnBu",invert:"dark"},{name:"OrRd",value:"interpolateOrRd",invert:"dark"},{name:"PuBuGn",value:"interpolatePuBuGn",invert:"dark"},{name:"PuBu",value:"interpolatePuBu",invert:"dark"},{name:"PuRd",value:"interpolatePuRd",invert:"dark"},{name:"RdPu",value:"interpolateRdPu",invert:"dark"},{name:"YlGnBu",value:"interpolateYlGnBu",invert:"dark"},{name:"YlGn",value:"interpolateYlGn",invert:"dark"},{name:"YlOrBr",value:"interpolateYlOrBr",invert:"dark"},{name:"YlOrRd",value:"interpolateYlOrRd",invert:"darm"}],b=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.$rootScope=r,o.opacityScales=[],o.colorModes=[],o.colorSchemes=[],o.$rootScope=r,o.timeSrv=i,o.selectionActivated=!1,a.a.defaultsDeep(o.panel,m),o.opacityScales=v,o.colorModes=g,o.colorSchemes=y,o.events.on("render",o.onRender.bind(o)),o.events.on("data-received",o.onDataReceived.bind(o)),o.events.on("data-error",o.onDataError.bind(o)),o.events.on("data-snapshot-load",o.onDataReceived.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.onCardColorChange=o.onCardColorChange.bind(o),o}return p(e,t),e.$inject=["$scope","$injector","$rootScope","timeSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",c.a,2),this.addEditorTab("Display",h.a,3),this.unitFormats=s.a.getUnitFormats()},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onRender=function(){if(this.range){var t,e,n,r,i=this.panel.yAxis.logBase;if("tsbuckets"===this.panel.dataFormat){n=this.parseHistogramSeries(this.series),r=Object(d.d)(this.series);var o=a.a.map(a.a.keys(r),function(t){return Number(t)}),l=a.a.map(this.series,function(t){return Number(t.alias)});t=Object(d.a)(o),e=Object(d.a)(l,i),1!==i&&(e=1/e)}else{var u=this.panel.xBucketNumber||30,c=Math.floor((this.range.to-this.range.from)/u);t=s.a.interval_regex.test(this.panel.xBucketSize)?s.a.interval_to_ms(this.panel.xBucketSize):isNaN(Number(this.panel.xBucketSize))||""===this.panel.xBucketSize||null===this.panel.xBucketSize?c:Number(this.panel.xBucketSize),n=this.parseSeries(this.series);var h=this.panel.yBucketNumber||10;1!==i?e=this.panel.yAxis.splitFactor:(e=n.max===n.min?n.max?n.max/10:1:(n.max-n.min)/h,e=this.panel.yBucketSize||e),r=Object(d.c)(this.series,e,t,i)}n.min||n.max||(n={min:-1,max:1,minLog:1},e=1);var f=Object(d.b)(r),p=f.cards,m=f.cardStats;this.data={buckets:r,heatmapStats:n,xBucketSize:t,yBucketSize:e,cards:p,cardStats:m}}},e.prototype.onDataReceived=function(t){if(this.series=t.map(this.seriesHandler.bind(this)),this.dataWarning=null,0===a.a.reduce(this.series,function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"No data points",tip:"No datapoints returned from data query"};else for(var e=0,n=this.series;e<n.length;e++){var r=n[e];if(r.isOutsideRange){this.dataWarning={title:"Data points outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"};break}}this.render()},e.prototype.onDataError=function(){this.series=[],this.render()},e.prototype.onCardColorChange=function(t){this.panel.color.cardColor=t,this.render()},e.prototype.seriesHandler=function(t){var e=new u.a({datapoints:t.datapoints,alias:t.target});e.flotpairs=e.getFlotPairs(this.panel.nullPointMode),e.minLog=Object(d.e)(e);var n=t.datapoints||[];if(n&&n.length>0){n[n.length-1][1]-this.range.from<-1e4&&(e.isOutsideRange=!0)}return e},e.prototype.parseSeries=function(t){var e=a.a.min(a.a.map(t,function(t){return t.stats.min})),n=a.a.min(a.a.map(t,function(t){return t.minLog}));return{max:a.a.max(a.a.map(t,function(t){return t.stats.max})),min:e,minLog:n}},e.prototype.parseHistogramSeries=function(t){var e=a.a.map(t,function(t){return Number(t.alias)}),n=a.a.min(e),r=a.a.min(e);return{max:a.a.max(e),min:n,minLog:r}},e.prototype.link=function(t,e,n,r){Object(f.a)(t,e,n,r)},e.templateUrl="module.html",e}(r.MetricsPanelCtrl)},function(t,e,n){var r,i;r=[n(801)],void 0!==(i=function(t){"use strict";return t.default}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/axes_editor.html",controller:o}}e.a=r;var i=n(109),a=n.n(i),o=function(){function t(t,e){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=a.a.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.dataFormats={"Time series":"timeseries","Time series buckets":"tsbuckets"}}return t.$inject=["$scope","uiSegmentSrv"],t.prototype.setUnitFormat=function(t){this.panel.yAxis.format=t.value,this.panelCtrl.render()},t}()},function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/display_editor.html",controller:i}}e.a=r;var i=function(){function t(t){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.panelCtrl.render()}return t.$inject=["$scope"],t}()},function(t,e,n){"use strict";function r(t,e,n,r){function s(){try{var t=r.height||ft.height||r.row.height;return l.a.isString(t)&&(t=parseInt(t.replace("px",""),10)),t-=5,t-=ft.title?24:9,Ot.css("height",t+"px"),!0}catch(t){return!1}}function u(t){var e=t.selectAll(".axis-y text").nodes();return l.a.max(l.a.map(e,function(t){return c()(t).outerWidth()}))}function h(t){if(t.select(".axis-x line").empty())return 30;var e=parseFloat(t.select(".axis-x line").attr("y2"));return parseFloat(t.attr("height"))-e}function d(){t.xScale=vt=y.a.scaleTime().domain([ht.from,ht.to]).range([0,yt]);var e,n=yt/M,a=i(n,ht.from,ht.to);e="utc"===r.dashboard.getTimezone()?y.a.utcFormat(a):y.a.timeFormat(a);var o=y.a.axisBottom(vt).ticks(n).tickFormat(e).tickPadding(C).tickSize(bt),s=Rt.top,l=wt;dt.append("g").attr("class","axis axis-x").attr("transform","translate("+l+","+s+")").call(o),dt.select(".axis-x").select(".domain").remove()}function v(){var e=Math.ceil(bt/T),n=Object(g.tickStep)(ct.heatmapStats.min,ct.heatmapStats.max,e),i=E(ct.heatmapStats.min,ct.heatmapStats.max,n),a=i.y_min,s=i.y_max;a=null!==ft.yAxis.min?ft.yAxis.min:a,s=null!==ft.yAxis.max?ft.yAxis.max:s,n=Object(g.tickStep)(a,s,e),e=Math.ceil((s-a)/n);var c=o(n),h=null===ft.yAxis.decimals?c:ft.yAxis.decimals,f=Object(g.getFlotTickSize)(a,s,e,c),d=Object(g.getScaledDecimals)(h,f);r.decimals=h,r.scaledDecimals=d,l.a.isEmpty(ct.buckets)&&(s=1,a=-1,e=3,h=1),ct.yAxis={min:a,max:s,ticks:e},t.yScale=gt=y.a.scaleLinear().domain([a,s]).range([bt,0]);var p=y.a.axisLeft(gt).ticks(e).tickFormat(F(h,d)).tickSizeInner(0-pt).tickSizeOuter(0).tickPadding(A);dt.append("g").attr("class","axis axis-y").call(p);var m=Rt.top,v=u(dt)+A;dt.select(".axis-y").attr("transform","translate("+v+","+m+")"),dt.select(".axis-y").select(".domain").remove()}function E(t,e,n){var r,i,a=(e*(Ft-1)-t*(Ft-1))/2;return 0===n?(i=e*Ft,r=t-t*(Ft-1),n=(i-r)/2):(i=Math.ceil((e+a)/n)*n,r=Math.floor((t-a)/n)*n),t>=0&&r<0&&(r=0),{y_min:r,y_max:i}}function O(){var e=ft.yAxis.logBase,n=D(ct.heatmapStats.minLog,ct.heatmapStats.max,e),i=n.y_min,a=n.y_max;i=ft.yAxis.min&&"0"!==ft.yAxis.min?I(ft.yAxis.min,e):i,a=null!==ft.yAxis.max?$(ft.yAxis.max,e):a,l.a.isEmpty(ct.buckets)&&(a=Math.pow(e,2),i=1),t.yScale=gt=y.a.scaleLog().base(ft.yAxis.logBase).domain([i,a]).range([bt,0]);var s=gt.domain(),c=R(s,e),h=o(i),f=ft.yAxis.decimals||h,d=Object(g.getFlotTickSize)(i,a,c.length,h),p=Object(g.getScaledDecimals)(f,d);r.decimals=f,r.scaledDecimals=p,ct.yAxis={min:i,max:a,ticks:c.length};var m=y.a.axisLeft(gt).tickValues(c).tickFormat(F(f,p)).tickSizeInner(0-pt).tickSizeOuter(0).tickPadding(A);dt.append("g").attr("class","axis axis-y").call(m);var v=Rt.top,b=u(dt)+A;dt.select(".axis-y").attr("transform","translate("+b+","+v+")"),i<1&&dt.select(".axis-y").select(".tick text").text("0"),dt.select(".axis-y").select(".domain").remove()}function D(t,e,n){var r,i;return r=ct.heatmapStats.minLog,r=ct.heatmapStats.minLog>1||!ct.heatmapStats.minLog?1:I(ct.heatmapStats.minLog,n),i=$(ct.heatmapStats.max,n),{y_min:r,y_max:i}}function $(t,e){return Math.pow(e,Math.ceil(a(t,e)))}function I(t,e){return Math.pow(e,Math.floor(a(t,e)))}function R(t,e){var n=t[0],r=t[1],i=[];if(n<1)for(var o=Math.floor(a(n,e)),s=o;s<0;s++){var l=Math.pow(e,s);i.push(l)}for(var u=Math.ceil(a(r,e)),s=0;s<=u;s++){var l=Math.pow(e,s);i.push(l)}return i}function F(t,e){void 0===e&&(e=null);var n=ft.yAxis.format;return function(r){return p.a.valueFormats[n](r,t,e)}}function N(){dt.select(".axis-y").selectAll(".tick line").attr("x2",yt)}function q(){bt=mt-Rt.top-Rt.bottom,xt=Rt.top,_t=xt+bt,1===ft.yAxis.logBase?v():O(),wt=u(dt)+A,yt=pt-wt-Rt.right,N(),d(),St=h(dt),ft.yAxis.show||dt.select(".axis-y").selectAll("line").style("opacity",0),ft.xAxis.show||dt.select(".axis-x").selectAll("line").style("opacity",0)}function j(){var t=Ot[0];pt=Math.floor(Ot.width())-It.right,mt=Math.floor(Ot.height())-It.bottom,kt=null!==ft.cards.cardPadding?ft.cards.cardPadding:w,Mt=null!==ft.cards.cardRound?ft.cards.cardRound:S,dt&&dt.remove(),dt=y.a.select(t).append("svg").attr("width",pt).attr("height",mt)}function L(){if(j(),q(),1!==ft.yAxis.logBase){var t=ft.yAxis.logBase,e=gt.domain(),n=R(e,t);ct.buckets=Object(x.g)(ct.buckets,l.a.min(n))}var r=ct.cards,i=ct.cardStats.max,a=ft.color.max||i,o=ft.color.min||0;At=V(a,o),B(a),Y();var s=dt.selectAll(".heatmap-card").data(r);s.append("title"),s=s.enter().append("rect").attr("x",H).attr("width",Q).attr("y",W).attr("height",G).attr("rx",Mt).attr("ry",Mt).attr("class","bordered heatmap-card").style("fill",K).style("stroke",K).style("stroke-width",0).style("opacity",X),Ot.find(".heatmap-card").on("mouseenter",function(t){Dt.mouseOverBucket=!0,U(t)}).on("mouseleave",function(t){Dt.mouseOverBucket=!1,z(t)})}function U(t){var e=y.a.select(t.target).style("fill"),n=y.a.color(e).darker(2),r=y.a.color(e).brighter(4),i=y.a.select(t.target);Dt.originalFillColor=e,i.style("fill",n).style("stroke",r).style("stroke-width",1)}function z(t){y.a.select(t.target).style("fill",Dt.originalFillColor).style("stroke",Dt.originalFillColor).style("stroke-width",0)}function V(t,e){void 0===e&&(e=0);var n=l.a.find(r.colorSchemes,{value:ft.color.colorScheme}),i=y.a[n.value],a="always"===n.invert||"dark"===n.invert&&!m.contextSrv.user.lightTheme,o=a?t:e,s=a?e:t;return y.a.scaleSequential(i).domain([o,s])}function B(t){"linear"===ft.color.colorScale?Pt=y.a.scaleLinear().domain([0,t]).range([0,1]):"sqrt"===ft.color.colorScale&&(Pt=y.a.scalePow().exponent(ft.color.exponent).domain([0,t]).range([0,1]))}function Y(){var t=Math.floor(vt(ct.xBucketSize)-vt(0)),e=Math.floor(gt(gt.invert(0)-ct.yBucketSize));if(1!==ft.yAxis.logBase){var n=ft.yAxis.logBase,r=ct.yBucketSize||1;e=Math.floor((gt(1)-gt(n))/r)}Tt=t-2*kt,Ct=e?e-2*kt:0}function H(t){return vt(t.x)<0?wt+kt:vt(t.x)+wt+kt}function Q(t){var e;if(vt(t.x)<0){var n=vt(t.x)+Tt;e=n>0?n:0}else e=vt(t.x)+Tt>yt?yt-vt(t.x)-kt:Tt;return e=Math.max(e,_)}function W(t){var e=gt(t.y)+xt-Ct-kt;return 1!==ft.yAxis.logBase&&0===t.y?e=_t-Ct-kt:e<xt&&(e=xt),e}function G(t){var e=gt(t.y)+xt-Ct-kt,n=Ct;return 1!==ft.yAxis.logBase&&0===t.y?Ct:(e<xt?n=gt(t.y)-kt:gt(t.y)>_t?n=_t-e:e+Ct>_t&&(n=_t-e),n=Math.min(n,bt),n=Math.max(n,_))}function K(t){return"opacity"===ft.color.mode?ft.color.cardColor:At(t.count)}function X(t){return"opacity"===ft.color.mode?Pt(t.count):1}function J(t){$t.active=!0,$t.x1=t.offsetX,Et=function(){Z()},c()(document).one("mouseup",Et)}function Z(){c()(document).unbind("mouseup",Et),Et=null,$t.active=!1;var t=Math.abs($t.x2-$t.x1);if($t.x2>=0&&t>P){var e=vt.invert(Math.min($t.x1,$t.x2)-wt),n=vt.invert(Math.max($t.x1,$t.x2)-wt);r.timeSrv.setTime({from:f.a.utc(e),to:f.a.utc(n)})}at()}function tt(){m.appEvents.emit("graph-hover-clear"),lt()}function et(t){dt&&($t.active?(lt(),Dt.destroy(),$t.x2=rt(t.offsetX),it($t.x1,$t.x2)):(nt(t),ot(t.offsetX),Dt.show(t,ct)))}function nt(t){var e=vt.invert(t.offsetX-wt).valueOf(),n=gt.invert(t.offsetY),r={pageX:t.pageX,pageY:t.pageY,x:e,x1:e,y:n,y1:n,panelRelY:null};r.panelRelY=Math.max(t.offsetY/mt,.001),m.appEvents.emit("graph-hover",{pos:r,panel:ft})}function rt(t){return t=Math.max(t,wt),t=Math.min(t,yt+wt)}function it(t,e){if(dt){dt.selectAll(".heatmap-selection").remove();var n=Math.min(t,e),r=Math.abs(t-e);r>P&&dt.append("rect").attr("class","heatmap-selection").attr("x",n).attr("width",r).attr("y",xt).attr("height",bt)}}function at(){$t.x1=-1,$t.x2=-1,dt&&dt.selectAll(".heatmap-selection").remove()}function ot(t){if(dt){dt.selectAll(".heatmap-crosshair").remove();var e=t;e=Math.max(e,wt),e=Math.min(e,yt+wt),dt.append("g").attr("class","heatmap-crosshair").attr("transform","translate("+e+",0)").append("line").attr("x1",1).attr("y1",xt).attr("x2",1).attr("y2",_t).attr("stroke-width",1)}}function st(t){if(dt&&0!==r.dashboard.graphTooltip){ot(vt(t.x)+wt)}}function lt(){dt&&dt.selectAll(".heatmap-crosshair").remove()}function ut(){if(ct=r.data,ft=r.panel,ht=r.range,s()&&ct){if(l.a.isEmpty(ct.buckets))return j(),void q();L(),t.yAxisWidth=wt,t.xAxisHeight=St,t.chartHeight=bt,t.chartWidth=yt,t.chartTop=xt}}var ct,ht,ft,dt,pt,mt,gt,vt,yt,bt,xt,_t,wt,St,kt,Mt,Tt,Ct,At,Pt,Et,Ot=e.find(".heatmap-panel"),Dt=new b.a(Ot,t),$t={active:!1,x1:-1,x2:-1},It={left:0,right:0,top:0,bottom:0},Rt={left:25,right:15,top:10,bottom:20},Ft=k;r.events.on("render",function(){ut(),r.renderingCompleted()}),m.appEvents.on("graph-hover",function(t){st(t.pos)},t),m.appEvents.on("graph-hover-clear",function(){lt()},t),Ot.on("mousedown",J),Ot.on("mousemove",et),Ot.on("mouseleave",tt)}function i(t,e,n){if(e&&n&&t){var r=n-e,i=r/t/1e3;return i<=45?"%H:%M:%S":i<=7200||r<=864e5?"%H:%M":i<=8e4?"%m/%d %H:%M":i<=2419200||r<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}function a(t,e){return Math.log(t)/Math.log(e)}function o(t){var e=t.toString(),n=e.indexOf(".");return-1===n?0:e.length-n-1}e.a=r;var s=n(4),l=n.n(s),u=n(10),c=n.n(u),h=n(1),f=n.n(h),d=n(109),p=n.n(d),m=n(290),g=n(805),v=n(807),y=n.n(v),b=n(996),x=n(810),_=1,w=1,S=0,k=1.2,M=100,T=50,C=10,A=5,P=2},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(807),i=n.n(r),a=n(10),o=n.n(a),s=n(4),l=n.n(s),u=n(109),c=n.n(u),h=n(810),f=function(){function t(t,e){this.scope=e,this.dashboard=e.ctrl.dashboard,this.panelCtrl=e.ctrl,this.panel=e.ctrl.panel,this.heatmapPanel=t,this.mouseOverBucket=!1,this.originalFillColor=null,t.on("mouseover",this.onMouseOver.bind(this)),t.on("mouseleave",this.onMouseLeave.bind(this))}return t.prototype.onMouseOver=function(t){this.panel.tooltip.show&&this.scope.ctrl.data&&!l.a.isEmpty(this.scope.ctrl.data.buckets)&&(this.tooltip||(this.add(),this.move(t)))},t.prototype.onMouseLeave=function(){this.destroy()},t.prototype.onMouseMove=function(t){this.panel.tooltip.show&&this.move(t)},t.prototype.add=function(){this.tooltip=i.a.select("body").append("div").attr("class","heatmap-tooltip graph-tooltip grafana-tooltip")},t.prototype.destroy=function(){this.tooltip&&this.tooltip.remove(),this.tooltip=null},t.prototype.show=function(t,e){if(this.panel.tooltip.show&&e&&!t.panelRelY){var n=this.getBucketIndexes(t,e),r=n.xBucketIndex,i=n.yBucketIndex;if(!e.buckets[r]||!this.tooltip)return void this.destroy();var a,o,s,u,c=e.buckets[r],h=l.a.find(c.buckets,function(t,e){return t.bounds.bottom===i||e===i}),f=this.dashboard.formatDate(c.x,"YYYY-MM-DD HH:mm:ss");if(l.a.isNumber(this.panel.tooltipDecimals))u=this.valueFormatter(this.panel.tooltipDecimals,null);else{var d=(this.panelCtrl.decimals||-1)+1;u=this.valueFormatter(d,this.panelCtrl.scaledDecimals+2)}var p='<div class="graph-tooltip-time">'+f+'</div>\n      <div class="heatmap-histogram"></div>';if(h)if(h.bounds){var m=h.y?h.bounds.bottom:0;a=u(m),o=u(h.bounds.top),s=h.count,p+="<div>\n          bucket: <b>"+a+" - "+o+"</b> <br>\n          count: <b>"+s+"</b> <br>\n        </div>"}else p+="<div>count: <b>"+h.count+"</b><br></div>";else{if(!this.panel.tooltip.showHistogram)return void this.destroy();a=i,o="",s=0}this.tooltip.html(p),this.panel.tooltip.showHistogram&&this.addHistogram(c),this.move(t)}},t.prototype.getBucketIndexes=function(t,e){return{xBucketIndex:this.getXBucketIndex(t.offsetX,e),yBucketIndex:this.getYBucketIndex(t.offsetY,e)}},t.prototype.getXBucketIndex=function(t,e){var n=this.scope.xScale.invert(t-this.scope.yAxisWidth).valueOf();return Object(h.f)(n,e.xBucketSize,1)},t.prototype.getYBucketIndex=function(t,e){var n=this.scope.yScale.invert(t-this.scope.chartTop);return Object(h.f)(n,e.yBucketSize,this.panel.yAxis.logBase)},t.prototype.getSharedTooltipPos=function(t){return t.pageX=this.heatmapPanel.offset().left+this.scope.xScale(t.x),t.pageY=this.heatmapPanel.offset().top+this.scope.chartHeight*t.panelRelY,t},t.prototype.addHistogram=function(t){var e=this.scope.ctrl.data.buckets[t.x],n=this.scope.ctrl.data.yBucketSize,r=this.scope.ctrl.data.yAxis,a=r.min,o=r.max,s=r.ticks,u=l.a.map(e.buckets,function(t){return[t.bounds.bottom,t.values.length]});u=l.a.filter(u,function(t){return t[0]>=a&&t[0]<=o});var c,h=this.scope.yScale.copy(),f=h.domain([a,o]).range([0,160]);if(1===this.panel.yAxis.logBase)c=Math.floor(160/(o-a)*n*.9);else{var d=n||1;c=Math.floor(160/s/d*.9)}c=Math.max(c,1);var p=l.a.reduce(l.a.map(u,function(t){return t[1]}),function(t,e){return t+e},0),m=i.a.scaleLinear().domain([0,p]).range([0,40]);this.tooltip.select(".heatmap-histogram").append("svg").attr("width",160).attr("height",40).selectAll(".bar").data(u).enter().append("rect").attr("x",function(t){return f(t[0])}).attr("width",c).attr("y",function(t){return 40-m(t[1])}).attr("height",function(t){return m(t[1])})},t.prototype.move=function(t){if(this.tooltip){var e=o()(this.tooltip.node())[0],n=e.clientWidth,r=e.clientHeight,i=t.pageX+30,a=t.pageY+5;return t.pageX+n+40>window.innerWidth&&(i=t.pageX-n-30),t.pageY-window.pageYOffset+r+20>window.innerHeight&&(a=t.pageY-r-5),this.tooltip.style("left",i+"px").style("top",a+"px")}},t.prototype.valueFormatter=function(t,e){void 0===e&&(e=null);var n=this.panel.yAxis.format;return function(r){return c.a.valueFormats[n](r,t,e)}},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TablePanelCtrl",function(){return d}),n.d(e,"PanelCtrl",function(){return d});var r=n(4),i=n.n(r),a=n(10),o=n.n(a),s=n(797),l=n(834),u=n(998),c=n(999),h=n(1e3),f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r,a,o,s){var l=t.call(this,e,n)||this;return l.annotationsSrv=a,l.$sanitize=o,l.variableSrv=s,l.panelDefaults={targets:[{}],transform:"timeseries_to_columns",pageSize:null,showHeader:!0,styles:[{type:"date",pattern:"Time",alias:"Time",dateFormat:"YYYY-MM-DD HH:mm:ss"},{unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"/.*/",thresholds:[]}],columns:[],scroll:!0,fontSize:"100%",sort:{col:0,desc:!0}},l.pageIndex=0,void 0===l.panel.styles&&(l.panel.styles=l.panel.columns,l.panel.columns=l.panel.fields,delete l.panel.columns,delete l.panel.fields),i.a.defaults(l.panel,l.panelDefaults),l.events.on("data-received",l.onDataReceived.bind(l)),l.events.on("data-error",l.onDataError.bind(l)),l.events.on("data-snapshot-load",l.onDataReceived.bind(l)),l.events.on("init-edit-mode",l.onInitEditMode.bind(l)),l.events.on("init-panel-actions",l.onInitPanelActions.bind(l)),l}return f(e,t),e.$inject=["$scope","$injector","templateSrv","annotationsSrv","$sanitize","variableSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Options",u.a,2),this.addEditorTab("Column Styles",c.a,3)},e.prototype.onInitPanelActions=function(t){t.push({text:"Export CSV",click:"ctrl.exportCsv()"})},e.prototype.issueQueries=function(e){return this.pageIndex=0,"annotations"===this.panel.transform?(this.setTimeQueryStart(),this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}).then(function(t){return{data:t}})):t.prototype.issueQueries.call(this,e)},e.prototype.onDataError=function(t){this.dataRaw=[],this.render()},e.prototype.onDataReceived=function(t){this.dataRaw=t,this.pageIndex=0,this.dataRaw&&this.dataRaw.length&&("table"===this.dataRaw[0].type?this.panel.transform="table":"docs"===this.dataRaw[0].type?this.panel.transform="json":"table"!==this.panel.transform&&"json"!==this.panel.transform||(this.panel.transform="timeseries_to_rows")),this.render()},e.prototype.render=function(){return this.table=Object(l.a)(this.dataRaw,this.panel),this.table.sort(this.panel.sort),this.renderer=new h.a(this.panel,this.table,this.dashboard.isTimezoneUtc(),this.$sanitize,this.templateSrv),t.prototype.render.call(this,this.table)},e.prototype.toggleColumnSort=function(t,e){this.table.columns[this.panel.sort.col]&&(this.table.columns[this.panel.sort.col].sort=!1),this.panel.sort.col===e?this.panel.sort.desc?this.panel.sort.desc=!1:this.panel.sort.col=null:(this.panel.sort.col=e,this.panel.sort.desc=!0),this.render()},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.tableData=this.renderer.render_values(),t.panel="table",this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal panel="panel" data="tableData"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.prototype.link=function(t,e,n,r){function i(){var t=r.height;return d>1&&(t-=26),t-31+"px"}function a(t){r.renderer.setTable(h),t.empty(),t.html(r.renderer.render(r.pageIndex))}function s(t){var e=o()(t.currentTarget);r.pageIndex=parseInt(e.text(),10)-1,u()}function l(t){t.empty();var e=f.pageSize||100;if(1!==(d=Math.ceil(h.rows.length/e))){for(var n=Math.max(r.pageIndex-3,0),i=Math.min(d,n+9),a=o()("<ul></ul>"),s=n;s<i;s++){var l=s===r.pageIndex?"active":"",u=o()('<li><a class="table-panel-page-link pointer '+l+'">'+(s+1)+"</a></li>");a.append(u)}t.append(a)}}function u(){var t=e.parents(".panel"),n=e.find(".table-panel-scroll"),r=e.find("tbody"),o=e.find(".table-panel-footer");e.css({"font-size":f.fontSize}),t.addClass("table-panel-wrapper"),a(r),l(o),n.css({"max-height":f.scroll?i():""})}function c(t){var e=o()(t.currentTarget).data(),n={datasource:f.datasource,key:h.columns[e.column].text,value:h.rows[e.row][e.column],operator:e.operator};r.variableSrv.setAdhocFilter(n)}var h,f=r.panel,d=0;e.tooltip({selector:"[data-link-tooltip]"}),e.on("click",".table-panel-page-link",s),e.on("click",".table-panel-filter-link",c);var p=t.$on("$destroy",function(){e.off("click",".table-panel-page-link"),e.off("click",".table-panel-filter-link"),p()});r.events.on("render",function(t){h=t||h,h&&u(),r.renderingCompleted()})},e.templateUrl="module.html",e}(s.MetricsPanelCtrl)},function(t,e,n){"use strict";function r(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/editor.html",controller:s}}r.$inject=["$q","uiSegmentSrv"],e.a=r;var i=n(4),a=n.n(i),o=n(834),s=function(){function t(t,e,n){this.$q=e,this.uiSegmentSrv=n,t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.transformers=o.b,this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.addColumnSegment=n.newPlusButton(),this.updateTransformHints()}return t.$inject=["$scope","$q","uiSegmentSrv"],t.prototype.updateTransformHints=function(){switch(this.canSetColumns=!1,this.columnsHelpMessage="",this.panel.transform){case"timeseries_aggregations":case"json":this.canSetColumns=!0;break;case"table":this.columnsHelpMessage="Columns and their order are determined by the data query"}},t.prototype.getColumnOptions=function(){var t=this;if(!this.panelCtrl.dataRaw)return this.$q.when([]);var e=this.transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw),n=a.a.map(e,function(e){return t.uiSegmentSrv.newSegment({value:e.text})});return this.$q.when(n)},t.prototype.addColumn=function(){var t=o.b[this.panel.transform].getColumns(this.panelCtrl.dataRaw),e=a.a.find(t,{text:this.addColumnSegment.value});e&&(this.panel.columns.push(e),this.render());var n=this.uiSegmentSrv.newPlusButton();this.addColumnSegment.html=n.html,this.addColumnSegment.value=n.value},t.prototype.transformChanged=function(){this.panel.columns=[],"timeseries_aggregations"===this.panel.transform&&this.panel.columns.push({text:"Avg",value:"avg"}),this.updateTransformHints(),this.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.removeColumn=function(t){this.panel.columns=a.a.without(this.panel.columns,t),this.panelCtrl.render()},t}()},function(t,e,n){"use strict";function r(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/column_options.html",controller:l}}r.$inject=["$q","uiSegmentSrv"],e.a=r;var i=n(4),a=n.n(i),o=n(109),s=n.n(o),l=function(){function t(t){var e=this;t.editor=this,this.activeStyleIndex=0,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=s.a.getUnitFormats(),this.colorModes=[{text:"Disabled",value:null},{text:"Cell",value:"cell"},{text:"Value",value:"value"},{text:"Row",value:"row"}],this.columnTypes=[{text:"Number",value:"number"},{text:"String",value:"string"},{text:"Date",value:"date"},{text:"Hidden",value:"hidden"}],this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.dateFormats=[{text:"YYYY-MM-DD HH:mm:ss",value:"YYYY-MM-DD HH:mm:ss"},{text:"YYYY-MM-DD HH:mm:ss.SSS",value:"YYYY-MM-DD HH:mm:ss.SSS"},{text:"MM/DD/YY h:mm:ss a",value:"MM/DD/YY h:mm:ss a"},{text:"MMMM D, YYYY LT",value:"MMMM D, YYYY LT"}],this.getColumnNames=function(){return e.panelCtrl.table?a.a.map(e.panelCtrl.table.columns,function(t){return t.text}):[]},this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope"],t.prototype.render=function(){this.panelCtrl.render()},t.prototype.setUnitFormat=function(t,e){t.unit=e.value,this.panelCtrl.render()},t.prototype.addColumnStyle=function(){var t={unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"",dateFormat:"YYYY-MM-DD HH:mm:ss",thresholds:[]},e=this.panel.styles,n=e.length,r=n;if(n>0){"/.*/"===e[n-1].pattern&&(r=n-1)}e.splice(r,0,t),this.activeStyleIndex=r},t.prototype.removeColumnStyle=function(t){this.panel.styles=a.a.without(this.panel.styles,t)},t.prototype.invertColorOrder=function(t){var e=this.panel.styles[t].colors,n=e[0];e[0]=e[2],e[2]=n,this.panelCtrl.render()},t.prototype.onColorChange=function(t,e){var n=this;return function(r){n.panel.styles[t].colors[e]=r,n.render()}},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(4),i=n.n(r),a=n(1),o=n.n(a),s=n(109),l=n.n(s),u=function(){function t(t,e,n,r,i){this.panel=t,this.table=e,this.isUtc=n,this.sanitize=r,this.templateSrv=i,this.initColumns()}return t.prototype.setTable=function(t){this.table=t,this.initColumns()},t.prototype.initColumns=function(){this.formatters=[],this.colorState={};for(var t=0;t<this.table.columns.length;t++){var e=this.table.columns[t];e.title=e.text;for(var n=0;n<this.panel.styles.length;n++){var r=this.panel.styles[n],i=l.a.stringToJsRegex(r.pattern);if(e.text.match(i)){e.style=r,r.alias&&(e.title=e.text.replace(i,r.alias));break}}this.formatters[t]=this.createColumnFormatter(e)}},t.prototype.getColorForValue=function(t,e){if(!e.thresholds)return null;for(var n=e.thresholds.length;n>0;n--)if(t>=e.thresholds[n-1])return e.colors[n];return i.a.first(e.colors)},t.prototype.defaultCellFormatter=function(t,e){return null===t||void 0===t||void 0===t?"":(i.a.isArray(t)&&(t=t.join(", ")),e&&e.sanitize?this.sanitize(t):i.a.escape(t))},t.prototype.createColumnFormatter=function(t){var e=this;if(!t.style)return this.defaultCellFormatter;if("hidden"===t.style.type)return function(t){};if("date"===t.style.type)return function(n){if(void 0===n||null===n)return"-";i.a.isArray(n)&&(n=n[0]);var r=o()(n);return e.isUtc&&(r=r.utc()),r.format(t.style.dateFormat)};if("number"===t.style.type){var n=l.a.valueFormats[t.unit||t.style.unit];return function(r){return null===r||void 0===r?"-":i.a.isString(r)?e.defaultCellFormatter(r,t.style):(t.style.colorMode&&(e.colorState[t.style.colorMode]=e.getColorForValue(r,t.style)),n(r,t.style.decimals,null))}}return function(n){return e.defaultCellFormatter(n,t.style)}},t.prototype.renderRowVariables=function(t){for(var e,n={},r=this.table.rows[t],i=0;i<r.length;i++)e="__cell_"+i,n[e]={value:r[i]};return n},t.prototype.formatColumnValue=function(t,e){return this.formatters[t]?this.formatters[t](e):e},t.prototype.renderCell=function(t,e,n,r){void 0===r&&(r=!1),n=this.formatColumnValue(t,n);var i=this.table.columns[t],a="",o=[],s="";this.colorState.cell?(a=' style="background-color:'+this.colorState.cell+';color: white"',this.colorState.cell=null):this.colorState.value&&(a=' style="color:'+this.colorState.value+'"',this.colorState.value=null);var l="";if(r&&(l='<div class="table-panel-width-hack">'+this.table.columns[t].title+"</div>"),void 0===n?(a=' style="display:none;"',i.hidden=!0):i.hidden=!1,i.style&&i.style.preserveFormat&&o.push("table-panel-cell-pre"),i.style&&i.style.link){var u=this.renderRowVariables(e);u.__cell={value:n};var c=this.templateSrv.replace(i.style.linkUrl,u),h=this.templateSrv.replace(i.style.linkTooltip,u),f=i.style.linkTargetBlank?"_blank":"";o.push("table-panel-cell-link"),l+='\n        <a href="'+c+'" target="'+f+'" data-link-tooltip data-original-title="'+h+'" data-placement="right">\n          '+n+"\n        </a>\n      "}else l+=n;return i.filterable&&(o.push("table-panel-cell-filterable"),l+='\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter out value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="!=">\n          <i class="fa fa-search-minus"></i>\n        </a>\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter for value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="=">\n          <i class="fa fa-search-plus"></i>\n        </a>'),o.length&&(s=' class="'+o.join(" ")+'"'),l="<td"+s+a+">"+l+"</td>"},t.prototype.render=function(t){for(var e=this.panel.pageSize||100,n=t*e,r=Math.min(n+e,this.table.rows.length),i="",a=n;a<r;a++){for(var o=this.table.rows[a],s="",l="",u=0;u<this.table.columns.length;u++)s+=this.renderCell(u,a,o[u],a===n);this.colorState.row&&(l=' style="background-color:'+this.colorState.row+';color: white"',this.colorState.row=null),i+="<tr "+l+">"+s+"</tr>"}return i},t.prototype.render_values=function(){for(var t=[],e=0;e<this.table.rows.length;e++){for(var n=this.table.rows[e],r=[],i=0;i<this.table.columns.length;i++)r.push(this.formatColumnValue(i,n[i]));t.push(r)}return{columns:this.table.columns,rows:t}},t}()},function(t,e,n){"use strict";function r(t,e){if(!a.a.isFinite(e))return null;for(var n=t.thresholds.length;n>0;n--)if(e>=t.thresholds[n-1])return t.colorMap[n];return a.a.first(t.colorMap)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SingleStatCtrl",function(){return y}),n.d(e,"PanelCtrl",function(){return y}),n.d(e,"getColorForValue",function(){return r});var i=n(4),a=n.n(i),o=n(10),s=n.n(o),l=n(806),u=(n.n(l),n(1002)),c=(n.n(u),n(816)),h=(n.n(c),n(109)),f=n.n(h),d=n(21),p=n.n(d),m=n(801),g=n(797),v=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.$location=r,o.linkSrv=i,o.dataType="timeseries",o.valueNameOptions=[{value:"min",text:"Min"},{value:"max",text:"Max"},{value:"avg",text:"Average"},{value:"current",text:"Current"},{value:"total",text:"Total"},{value:"name",text:"Name"},{value:"first",text:"First"},{value:"delta",text:"Delta"},{value:"diff",text:"Difference"},{value:"range",text:"Range"},{value:"last_time",text:"Time of last point"}],o.panelDefaults={links:[],datasource:null,maxDataPoints:100,interval:null,targets:[{}],cacheTimeout:null,format:"none",prefix:"",postfix:"",nullText:null,valueMaps:[{value:"null",op:"=",text:"N/A"}],mappingTypes:[{name:"value to text",value:1},{name:"range to text",value:2}],rangeMaps:[{from:"null",to:"null",text:"N/A"}],mappingType:1,nullPointMode:"connected",valueName:"avg",prefixFontSize:"50%",valueFontSize:"80%",postfixFontSize:"50%",thresholds:"",colorBackground:!1,colorValue:!1,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],sparkline:{show:!1,full:!1,lineColor:"rgb(31, 120, 193)",fillColor:"rgba(31, 118, 189, 0.18)"},gauge:{show:!1,minValue:0,maxValue:100,thresholdMarkers:!0,thresholdLabels:!1},tableColumn:""},a.a.defaults(o.panel,o.panelDefaults),o.events.on("data-received",o.onDataReceived.bind(o)),o.events.on("data-error",o.onDataError.bind(o)),o.events.on("data-snapshot-load",o.onDataReceived.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.onSparklineColorChange=o.onSparklineColorChange.bind(o),o.onSparklineFillChange=o.onSparklineFillChange.bind(o),o}return v(e,t),e.$inject=["$scope","$injector","$location","linkSrv"],e.prototype.onInitEditMode=function(){this.fontSizes=["20%","30%","50%","70%","80%","100%","110%","120%","150%","170%","200%"],this.addEditorTab("Options","public/app/plugins/panel/singlestat/editor.html",2),this.addEditorTab("Value Mappings","public/app/plugins/panel/singlestat/mappings.html",3),this.unitFormats=f.a.getUnitFormats()},e.prototype.setUnitFormat=function(t){this.panel.format=t.value,this.refresh()},e.prototype.onDataError=function(t){this.onDataReceived([])},e.prototype.onDataReceived=function(t){var e={};if(t.length>0&&"table"===t[0].type){this.dataType="table";var n=t.map(this.tableHandler.bind(this));this.setTableValues(n,e)}else this.dataType="timeseries",this.series=t.map(this.seriesHandler.bind(this)),this.setValues(e);this.data=e,this.render()},e.prototype.seriesHandler=function(t){var e=new m.default({datapoints:t.datapoints,alias:t.target});return e.flotpairs=e.getFlotPairs(this.panel.nullPointMode),e},e.prototype.tableHandler=function(t){var e=[],n={};return t.columns.forEach(function(t,e){n[e]=t.text}),this.tableColumnOptions=n,a.a.find(t.columns,["text",this.panel.tableColumn])||this.setTableColumnToSensibleDefault(t),t.rows.forEach(function(t){var r={};t.forEach(function(t,e){var i=n[e];r[i]=t}),e.push(r)}),e},e.prototype.setTableColumnToSensibleDefault=function(t){1===this.tableColumnOptions.length?this.panel.tableColumn=this.tableColumnOptions[0]:this.panel.tableColumn=a.a.find(t.columns,function(t){return"time"!==t.type}).text},e.prototype.setTableValues=function(t,e){if(t&&0!==t.length&&0!==t[0].length&&void 0!==t[0][0][this.panel.tableColumn]){var n=t[0][0];if(e.value=n[this.panel.tableColumn],a.a.isString(e.value))e.valueFormatted=a.a.escape(e.value),e.value=0,e.valueRounded=0;else{var r=this.getDecimalsForValue(e.value),i=f.a.valueFormats[this.panel.format];e.valueFormatted=i(n[this.panel.tableColumn],r.decimals,r.scaledDecimals),e.valueRounded=f.a.roundValue(e.value,this.panel.decimals||0)}this.setValueMapping(e)}},e.prototype.setColoring=function(t){t.background?(this.panel.colorValue=!1,this.panel.colors=["rgba(71, 212, 59, 0.4)","rgba(245, 150, 40, 0.73)","rgba(225, 40, 40, 0.59)"]):(this.panel.colorBackground=!1,this.panel.colors=["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"]),this.render()},e.prototype.invertColorOrder=function(){var t=this.panel.colors[0];this.panel.colors[0]=this.panel.colors[2],this.panel.colors[2]=t,this.render()},e.prototype.onColorChange=function(t){var e=this;return function(n){e.panel.colors[t]=n,e.render()}},e.prototype.onSparklineColorChange=function(t){this.panel.sparkline.lineColor=t,this.render()},e.prototype.onSparklineFillChange=function(t){this.panel.sparkline.fillColor=t,this.render()},e.prototype.getDecimalsForValue=function(t){if(a.a.isNumber(this.panel.decimals))return{decimals:this.panel.decimals,scaledDecimals:null};var e,n=t/2,r=-Math.floor(Math.log(n)/Math.LN10),i=Math.pow(10,-r),o=n/i;o<1.5?e=1:o<3?(e=2,o>2.25&&(e=2.5,++r)):e=o<7.5?5:10,e*=i,Math.floor(t)===t&&(r=0);var s={};return s.decimals=Math.max(0,r),s.scaledDecimals=s.decimals-Math.floor(Math.log(e)/Math.LN10)+2,s},e.prototype.setValues=function(t){if(t.flotpairs=[],this.series.length>1){var e=new Error;throw e.message="Multiple Series Error",e.data="Metric query returns "+this.series.length+" series. Single Stat Panel expects a single series.\n\nResponse:\n"+JSON.stringify(this.series),e}if(this.series&&this.series.length>0){var n=a.a.last(this.series[0].datapoints),r=a.a.isArray(n)?n[0]:null;if("name"===this.panel.valueName)t.value=0,t.valueRounded=0,t.valueFormatted=this.series[0].alias;else if(a.a.isString(r))t.value=0,t.valueFormatted=a.a.escape(r),t.valueRounded=0;else if("last_time"===this.panel.valueName){var i=f.a.valueFormats[this.panel.format];t.value=n[1],t.valueRounded=t.value,t.valueFormatted=i(t.value,0,0)}else{t.value=this.series[0].stats[this.panel.valueName],t.flotpairs=this.series[0].flotpairs;var o=this.getDecimalsForValue(t.value),i=f.a.valueFormats[this.panel.format];t.valueFormatted=i(t.value,o.decimals,o.scaledDecimals),t.valueRounded=f.a.roundValue(t.value,o.decimals)}t.scopedVars=a.a.extend({},this.panel.scopedVars),t.scopedVars.__name={value:this.series[0].label}}this.setValueMapping(t)},e.prototype.setValueMapping=function(t){if(1===this.panel.mappingType)for(var e=0;e<this.panel.valueMaps.length;e++){var n=this.panel.valueMaps[e];if("null"!==n.value){var r=parseFloat(n.value);if(r===t.valueRounded)return void(t.valueFormatted=n.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=n.text)}else if(2===this.panel.mappingType)for(var e=0;e<this.panel.rangeMaps.length;e++){var n=this.panel.rangeMaps[e];if("null"!==n.from||"null"!==n.to){var i=parseFloat(n.from),a=parseFloat(n.to);if(a>=t.valueRounded&&i<=t.valueRounded)return void(t.valueFormatted=n.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=n.text)}null!==t.value&&void 0!==t.value||(t.valueFormatted="no value")},e.prototype.removeValueMap=function(t){var e=a.a.indexOf(this.panel.valueMaps,t);this.panel.valueMaps.splice(e,1),this.render()},e.prototype.addValueMap=function(){this.panel.valueMaps.push({value:"",op:"=",text:""})},e.prototype.removeRangeMap=function(t){var e=a.a.indexOf(this.panel.rangeMaps,t);this.panel.rangeMaps.splice(e,1),this.render()},e.prototype.addRangeMap=function(){this.panel.rangeMaps.push({from:"",to:"",text:""})},e.prototype.link=function(t,e,n,i){function a(){e.css("height",i.height+"px")}function o(t,e){if(!x.colorValue)return e;var n=r(m,t);return n?'<span style="color:'+n+'">'+e+"</span>":e}function l(t,e,n){return n=_.replace(n,m.scopedVars),'<span class="'+t+'" style="font-size:'+e+'">'+n+"</span>"}function u(){var t='<div class="singlestat-panel-value-container">';x.prefix&&(t+=l("singlestat-panel-prefix",x.prefixFontSize,x.prefix));var e=o(m.value,m.valueFormatted);return t+=l("singlestat-panel-value",x.valueFontSize,e),x.postfix&&(t+=l("singlestat-panel-postfix",x.postfixFontSize,x.postfix)),t+="</div>"}function c(){var t=x.prefix?_.replace(x.prefix,m.scopedVars):"";return t+=m.valueFormatted,t+=x.postfix?_.replace(x.postfix,m.scopedVars):""}function h(){var t=e.width(),n=e.height(),a=Math.min(t,1.3*n);if(i.invalidGaugeRange=!1,x.gauge.minValue>x.gauge.maxValue)return void(i.invalidGaugeRange=!0);var o=s()("<div></div>"),l={top:"10px",margin:"auto",position:"relative",height:.9*n+"px",width:a+"px"};o.css(l);for(var u=[],h=0;h<m.thresholds.length;h++)u.push({value:m.thresholds[h],color:m.colorMap[h]});u.push({value:x.gauge.maxValue,color:m.colorMap[m.colorMap.length-1]});var f=p.a.bootData.user.lightTheme?"rgb(230,230,230)":"rgb(38,38,38)",d=parseInt(x.valueFontSize)/100,g=Math.min(a/5,100)*d,v=x.gauge.thresholdLabels?1.5:1,y=Math.min(a/6,60)/v,b=y/5,_=g/2.5,w={series:{gauges:{gauge:{min:x.gauge.minValue,max:x.gauge.maxValue,background:{color:f},border:{color:null},shadow:{show:!1},width:y},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0},cell:{border:{width:0}},threshold:{values:u,label:{show:x.gauge.thresholdLabels,margin:b+1,font:{size:_}},show:x.gauge.thresholdMarkers,width:b},value:{color:x.colorValue?r(m,m.valueRounded):null,formatter:function(){return c()},font:{size:g,family:'"Helvetica Neue", Helvetica, Arial, sans-serif'}},show:!0}}};e.append(o);var S={data:[[0,m.valueRounded]]};s.a.plot(o,[S],w)}function f(){var t=e.width()+20;if(t<30)return void setTimeout(f,30);var n=i.height,r=s()("<div></div>"),a={};if(a.position="absolute",x.sparkline.full){a.bottom="5px",a.left="-5px",a.width=t-10+"px";var o=n<=100?5:15*Math.round(n/100)+5;a.height=n-o+"px"}else a.bottom="0px",a.left="-5px",a.width=t-10+"px",a.height=Math.floor(.25*n)+"px";r.css(a);var l={legend:{show:!1},series:{lines:{show:!0,fill:1,lineWidth:1,fillColor:x.sparkline.fillColor}},yaxes:{show:!1},xaxis:{show:!1,mode:"time",min:i.range.from.valueOf(),max:i.range.to.valueOf()},grid:{hoverable:!1,show:!1}};e.append(r);var u={data:m.flotpairs,color:x.sparkline.lineColor};s.a.plot(r,[u],l)}function d(){if(i.data){m=i.data,m.thresholds=x.thresholds.split(",").map(function(t){return Number(t.trim())}),m.colorMap=x.colors,a();var n=x.gauge.show?"":u();if(x.colorBackground){var o=r(m,m.value);o&&(w.css("background-color",o),t.fullscreen?e.css("background-color",o):e.css("background-color",""))}else w.css("background-color",""),e.css("background-color","");e.html(n),x.sparkline.show&&f(),x.gauge.show&&h(),e.toggleClass("pointer",x.links.length>0),g=x.links.length>0?y.getPanelLinkAnchorInfo(x.links[0],m.scopedVars):null}}var m,g,v=this.$location,y=this.linkSrv,b=this.$timeout,x=i.panel,_=this.templateSrv,w=e.find(".panel-container");e=e.find(".singlestat-panel"),function(){var t=s()('<div id="tooltip" class="">hello</div>"');e.mouseleave(function(){0!==x.links.length&&b(function(){t.detach()})}),e.click(function(e){if(g&&!(s()(e).parents(".panel-header").length>0)){if("_blank"===g.target)return void window.open(g.href,"_blank");0===g.href.indexOf("http")?window.location.href=g.href:b(function(){v.url(g.href)}),t.detach()}}),e.mousemove(function(e){g&&(t.text("click to go to: "+g.title),t.place_tt(e.pageX,e.pageY-50))})}(),this.events.on("render",function(){d(),i.renderingCompleted()})},e.templateUrl="module.html",e}(g.MetricsPanelCtrl)},function(t,e){/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */
!function(t){function e(t){return"undefined"!=typeof Logger?new Logger(t):null}function n(t,e){return e%t}function r(t,e){return Math.floor(e/t)}function i(t){return t*Math.PI}function a(t,e,n,r,i,a,o,s,l,u){if(a!==o){t.save(),t.beginPath(),t.arc(e,n,r,a,o,!1),t.lineTo(e+(r-i)*Math.cos(o),n+(r-i)*Math.sin(o)),t.arc(e,n,r-i,o,a,!0),t.closePath(),l&&(t.lineWidth=l),s&&(t.strokeStyle=s,t.stroke()),u&&(t.fillStyle=u,t.fill()),t.restore()}}function o(n){n.hooks.processOptions.push(function(t,n){e(n.series.gauges.debug);n.series.gauges.show&&(n.grid.show=!1,n.legend.show=!1),n.series.gauges.threshold.values.sort(function(t,e){return t.value<e.value?-1:t.value>e.value?1:0})}),n.hooks.draw.push(function(n,r){var i=n.getOptions(),a=i.series.gauges;e(a.debug);if(a.show){var o=n.getData();if(o&&o.length){var l=new s(n,r),u=l.calculateLayout();a.debug.layout,l.drawBackground(u);for(var c=0;c<o.length;c++){var h=o[c],f=t.extend({},a,h.gauges);h.gauges&&l.calculateAutoValues(f,u.cellWidth);var d=l.calculateCellLayout(f,u,c);l.drawCellBackground(f,d),f.debug.layout,f.label.show&&l.drawLable(f,u,d,c,h),l.drawGauge(f,u,d,h.label,h.data[0][1]),f.threshold.show&&l.drawThreshold(f,u,d),f.threshold.label.show&&l.drawThresholdValues(f,u,d,c),f.value.show&&l.drawValue(f,u,d,c,h)}}}})}var s=function(){function o(t,e){"auto"===t.gauge.width&&(t.gauge.width=Math.max(5,e/8)),"auto"===t.label.margin&&(t.label.margin=Math.max(1,e/20)),"auto"===t.label.font.size&&(t.label.font.size=Math.max(5,e/8)),"auto"===t.value.margin&&(t.value.margin=Math.max(1,e/30)),"auto"===t.value.font.size&&(t.value.font.size=Math.max(5,e/9)),"auto"===t.threshold.width&&(t.threshold.width=Math.max(3,e/100)),"auto"===t.threshold.label.margin&&(t.threshold.label.margin=Math.max(3,e/40)),"auto"===t.threshold.label.font.size&&(t.threshold.label.font.size=Math.max(5,e/15))}function s(t,e){for(var n,r=0;r<t.threshold.values.length;r++){var i=t.threshold.values[r];if(n=i.color,e<i.value)break}return n}function l(t,e,n){var r=t.gauge.startAngle+(t.gauge.endAngle-t.gauge.startAngle)*((n-t.gauge.min)/(t.gauge.max-t.gauge.min));return r<t.gauge.startAngle?r=t.gauge.startAngle:r>t.gauge.endAngle&&(r=t.gauge.endAngle),r}function u(t,e,n,r,i,o,s,l,u,c){i!==o&&(f.save(),a(f,t,e,n,r,i,o,s,l,u),c&&(a(f,t,e,n,r,i,o),f.clip(),f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=10,f.shadowColor="gray",a(f,t,e,n+1,r+2,i,o,s,1)),f.restore())}function c(t,e,n,r,a,o){h(n.cx+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.cos(i(o)),n.cy+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.sin(i(o)),"flotGagueThresholdValue"+r,t.threshold.label.formatter?t.threshold.label.formatter(a):a,t.threshold.label,o)}function h(e,n,r,i,a,o){var s=t("."+r,d),l=s.length;l||(s=t("<span></span>"),s.attr("id",r),s.css("position","absolute"),s.css("top",n+"px"),a.font.size&&s.css("font-size",a.font.size+"px"),a.font.family&&s.css("font-family",a.font.family),a.color&&s.css("color",a.color),a.background.color&&s.css("background-color",a.background.color),a.background.opacity&&s.css("opacity",a.background.opacity),d.append(s)),s.text(i),s.css("left",e+"px"),s.css("left",parseInt(s.css("left"))-s.width()/2+"px"),!l&&o&&(s.css("top",parseInt(s.css("top"))-s.height()/2+"px"),s.css("transform","rotate("+(180*o+90)+"deg)"))}var f,d,p,m,g,v,y=function(t,n){f=n,d=t.getPlaceholder(),p=t.getOptions(),m=p.series.gauges,g=t.getData(),v=e(m.debug)};return y.prototype.calculateLayout=function(){var t=d.width(),e=d.height(),n=Math.min(g.length,m.layout.columns),r=Math.ceil(g.length/n),a=m.layout.margin,s=m.layout.hMargin,l=m.layout.vMargin,u=(t-2*a-s*(n-1))/n,c=(e-2*a-l*(r-1))/r;if(m.layout.square){var h=Math.min(u,c);u=h,c=h}o(m,u);var f=m.cell.margin,p=0,v=0;m.label.show&&(p=m.label.margin,v=m.label.font.size);var y=0,b=0;m.value.show&&(y=m.value.margin,b=m.value.font.size);var x=0;m.threshold.show&&(x=m.threshold.width);var _=0,w=0;m.threshold.label.show&&(_=m.threshold.label.margin,w=m.threshold.label.font.size);for(var S=u/2-f-x-2*_-w,k=m.gauge.startAngle,M=m.gauge.endAngle,T=(M-k)/100,C=-1,A=k;A<M;A+=T)C=Math.max(C,Math.sin(i(A)));C=Math.max(C,Math.sin(i(M)));var P=(c-2*f-2*p-v)/(1+C);P*C<y+b/2&&(P=c-2*f-2*p-v-y-b/2);var E=P-2*_-w-x,O=Math.min(S,E),D=m.gauge.width;D>=O&&(D=Math.max(3,O/3));var $=2*_+w+x+O;return{canvasWidth:t,canvasHeight:e,margin:a,hMargin:s,vMargin:l,columns:n,rows:r,cellWidth:u,cellHeight:c,cellMargin:f,labelMargin:p,labelFontSize:v,valueMargin:y,valueFontSize:b,width:D,radius:O,thresholdWidth:x,thresholdLabelMargin:_,thresholdLabelFontSize:w,gaugeOuterHeight:Math.max($*(1+C),$+y+b/2)}},y.prototype.calculateAutoValues=o,y.prototype.calculateCellLayout=function(t,e,i){var a=n(e.columns,i),o=r(e.columns,i),s=e.margin+(e.cellWidth+e.hMargin)*a,l=e.margin+(e.cellHeight+e.vMargin)*o,u=s+e.cellWidth/2,c=l+e.cellMargin+2*e.labelMargin+e.labelFontSize+e.thresholdWidth+e.thresholdLabelFontSize+2*e.thresholdLabelMargin+e.radius,h=e.cellHeight-2*e.cellMargin-2*e.labelMargin-e.labelFontSize-e.gaugeOuterHeight,f=0;return"middle"===t.cell.vAlign?f=h/2:"bottom"===t.cell.vAlign&&(f=h),c+=f,{col:a,row:o,x:s,y:l,offsetY:f,cellWidth:e.cellWidth,cellHeight:e.cellHeight,cellMargin:e.cellMargin,cx:u,cy:c}},y.prototype.drawBackground=function(t){m.frame.show&&(f.save(),f.strokeStyle=p.grid.borderColor,f.lineWidth=p.grid.borderWidth,f.strokeRect(0,0,t.canvasWidth,t.canvasHeight),p.grid.backgroundColor&&(f.fillStyle=p.grid.backgroundColor,f.fillRect(0,0,t.canvasWidth,t.canvasHeight)),f.restore())},y.prototype.drawCellBackground=function(t,e){f.save(),t.cell.border&&t.cell.border.show&&t.cell.border.color&&t.cell.border.width&&(f.strokeStyle=t.cell.border.color,f.lineWidth=t.cell.border.width,f.strokeRect(e.x,e.y,e.cellWidth,e.cellHeight)),t.cell.background&&t.cell.background.color&&(f.fillStyle=t.cell.background.color,f.fillRect(e.x,e.y,e.cellWidth,e.cellHeight)),f.restore()},y.prototype.drawGauge=function(t,e,n,r,a){var o=t.gauge.shadow.show?t.gauge.shadow.blur:0;u(n.cx,n.cy,e.radius,e.width,i(t.gauge.startAngle),i(t.gauge.endAngle),t.gauge.border.color,t.gauge.border.width,t.gauge.background.color,o);var c=s(t,a),h=l(t,e,a);u(n.cx,n.cy,e.radius-1,e.width-2,i(t.gauge.startAngle),i(h),c,1,c,o)},y.prototype.drawThreshold=function(t,e,n){for(var r=t.gauge.startAngle,o=0;o<t.threshold.values.length;o++){var s=t.threshold.values[o];c1=s.color,a2=l(t,e,s.value),a(f,n.cx,n.cy,e.radius+e.thresholdWidth,e.thresholdWidth-2,i(r),i(a2),c1,1,c1),r=a2}},y.prototype.drawLable=function(t,e,n,r,i){h(n.cx,n.y+n.cellMargin+e.labelMargin+n.offsetY,"flotGagueLabel"+r,t.label.formatter?t.label.formatter(i.label,i.data[0][1]):text,t.label)},y.prototype.drawValue=function(t,e,n,r,i){h(n.cx,n.cy-t.value.font.size/2,"flotGagueValue"+r,t.value.formatter?t.value.formatter(i.label,i.data[0][1]):text,t.value)},y.prototype.drawThresholdValues=function(t,e,n,r){c(t,e,n,"Min"+r,t.gauge.min,t.gauge.startAngle),c(t,e,n,"Max"+r,t.gauge.max,t.gauge.endAngle);for(var i=0;i<t.threshold.values.length;i++){var a=t.threshold.values[i];if(a.value>t.gauge.min&&a.value<t.gauge.max){var o=l(t,e,a.value);c(t,e,n,r+"_"+i,a.value,o)}}},y}(),l={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return t}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return parseInt(e)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(t){return t}},values:[{value:50,color:"lightgreen"},{value:80,color:"yellow"},{value:100,color:"red"}]}}}};t.plot.plugins.push({init:o,options:l,name:"gauge",version:"1.1.0"})}(jQuery)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"GettingStartedPanelCtrl",function(){return o}),n.d(e,"PanelCtrl",function(){return o});var r=n(797),i=n(290),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n)||this;return o.backendSrv=r,o.$q=a,o.stepIndex=0,o.steps=[],o.steps.push({title:"Install Grafana",icon:"icon-gf icon-gf-check",href:"http://docs.grafana.org/",target:"_blank",note:"Review the installation docs",check:function(){return a.when(!0)}}),o.steps.push({title:"Create your first data source",cta:"Add data source",icon:"icon-gf icon-gf-datasources",href:"datasources/new?gettingstarted",check:function(){return a.when(i.getMetricSources().filter(function(t){return!1===t.meta.builtIn}).length>0)}}),o.steps.push({title:"Create your first dashboard",cta:"New dashboard",icon:"icon-gf icon-gf-dashboard",href:"dashboard/new?gettingstarted",check:function(){return o.backendSrv.search({limit:1}).then(function(t){return t.length>0})}}),o.steps.push({title:"Invite your team",cta:"Add Users",icon:"icon-gf icon-gf-users",href:"org/users?gettingstarted",check:function(){return o.backendSrv.get("/api/org/users").then(function(t){return t.length>1})}}),o.steps.push({title:"Install apps & plugins",cta:"Explore plugin repository",icon:"icon-gf icon-gf-apps",href:"https://grafana.com/plugins?utm_source=grafana_getting_started",check:function(){return o.backendSrv.get("/api/plugins",{embedded:0,core:0}).then(function(t){return t.length>0})}}),o}return a(e,t),e.$inject=["$scope","$injector","backendSrv","datasourceSrv","$q"],e.prototype.$onInit=function(){var t=this;return this.stepIndex=-1,this.nextStep().then(function(e){t.checksDone=!0})},e.prototype.nextStep=function(){var t=this;if(this.stepIndex===this.steps.length-1)return this.$q.when();this.stepIndex+=1;var e=this.steps[this.stepIndex];return e.check().then(function(n){return n?(e.cssClass="completed",t.nextStep()):(e.cssClass="active",t.$q.when())})},e.prototype.dismiss=function(){this.row.removePanel(this.panel,!1),this.backendSrv.request({method:"PUT",url:"/api/user/helpflags/1",showSuccessAlert:!1}).then(function(t){i.contextSrv.user.helpFlags1=t.helpFlags1})},e.templateUrl="public/app/plugins/panel/gettingstarted/module.html",e}(r.PanelCtrl)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return r});var r=function(){function t(t){this.backendSrv=t,this.appEditCtrl.setPreUpdateHook(this.initDatasource.bind(this))}return t.$inject=["backendSrv"],t.prototype.initDatasource=function(){var t=this;return this.backendSrv.get("/api/datasources").then(function(e){for(var n=!1,r=0,i=e;r<i.length;r++){"grafana-testdata-datasource"===i[r].type&&(n=!0)}if(!n){var a={name:"Grafana TestData",type:"grafana-testdata-datasource",access:"direct",jsonData:{}};return t.backendSrv.post("/api/datasources",a)}return Promise.resolve()})},t.template="",t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return a});var r=n(1006),i=n(1007);n.d(e,"TestDataDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return i.a});var a=function(){function t(){}return t.template="<h2>test data</h2>",t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(4),i=n.n(r),a=n(8),o=n.n(a),s=function(){function t(t,e,n){this.backendSrv=e,this.$q=n,this.id=t.id}return t.$inject=["instanceSettings","backendSrv","$q"],t.prototype.query=function(t){var e=this,n=i.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,scenarioId:n.scenarioId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,stringInput:n.stringInput,jsonInput:o.a.fromJson(n.jsonInput),datasourceId:e.id}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.post("/api/tsdb/query",{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}).then(function(t){var e=[];return t.results&&i.a.forEach(t.results,function(t){for(var n=0,r=t.series;n<r.length;n++){var i=r[n];e.push({target:i.name,datapoints:i.points})}}),{data:e}})},t.prototype.annotationQuery=function(t){return this.backendSrv.get("/api/annotations",{from:t.range.from.valueOf(),to:t.range.to.valueOf(),limit:t.limit,type:t.type})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(4),i=n.n(r),a=n(797),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.backendSrv=r,i.target.scenarioId=i.target.scenarioId||"random_walk",i.scenarioList=[],i}return o(e,t),e.$inject=["$scope","$injector","backendSrv"],e.prototype.$onInit=function(){var t=this;return this.backendSrv.get("/api/tsdb/testdata/scenarios").then(function(e){t.scenarioList=e,t.scenario=i.a.find(t.scenarioList,{id:t.target.scenarioId})})},e.prototype.scenarioChanged=function(){this.scenario=i.a.find(this.scenarioList,{id:this.target.scenarioId}),this.target.stringInput=this.scenario.stringInput,this.refresh()},e.templateUrl="partials/query.editor.html",e}(a.QueryCtrl)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(291),a=n(293),o=n(296),s=n(1009),l=n(1010),u=n(114),c=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(a.Subscriber);e.SubjectSubscriber=c;var h=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[u.rxSubscriber]=function(){return new c(this)},e.prototype.lift=function(t){var e=new f(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new s.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),o.Subscription.EMPTY):this.isStopped?(t.complete(),o.Subscription.EMPTY):(this.observers.push(t),new l.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new i.Observable;return t.source=this,t},e.create=function(t,e){return new f(t,e)},e}(i.Observable);e.Subject=h;var f=function(t){function e(e,n){t.call(this),this.destination=e,this.source=n}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):o.Subscription.EMPTY},e}(h);e.AnonymousSubject=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(296),a=function(t){function e(e,n){t.call(this),this.subject=e,this.subscriber=n,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(i.Subscription);e.SubjectSubscription=a},function(t,e,n){"use strict";var r=n(291),i=n(1012);r.Observable.empty=i.empty},function(t,e,n){"use strict";var r=n(811);e.empty=r.EmptyObservable.create},function(t,e,n){"use strict";var r=n(291),i=n(1014);r.Observable.from=i.from},function(t,e,n){"use strict";var r=n(1015);e.from=r.FromObservable.create},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(297),a=n(835),o=n(836),s=n(1016),l=n(1017),u=n(837),c=n(1019),h=n(812),f=n(291),d=n(1020),p=n(298),m=function(t){function e(e,n){t.call(this,null),this.ish=e,this.scheduler=n}return r(e,t),e.create=function(t,n){if(null!=t){if("function"==typeof t[p.observable])return t instanceof f.Observable&&!n?t:new e(t,n);if(i.isArray(t))return new u.ArrayObservable(t,n);if(o.isPromise(t))return new s.PromiseObservable(t,n);if("function"==typeof t[h.iterator]||"string"==typeof t)return new l.IteratorObservable(t,n);if(a.isArrayLike(t))return new c.ArrayLikeObservable(t,n)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},e.prototype._subscribe=function(t){var e=this.ish,n=this.scheduler;return null==n?e[p.observable]().subscribe(t):e[p.observable]().subscribe(new d.ObserveOnSubscriber(t,n,0))},e}(f.Observable);e.FromObservable=m},function(t,e,n){"use strict";function r(t){var e=t.value,n=t.subscriber;n.closed||(n.next(e),n.complete())}function i(t){var e=t.err,n=t.subscriber;n.closed||n.error(e)}var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(77),s=n(291),l=function(t){function e(e,n){t.call(this),this.promise=e,this.scheduler=n}return a(e,t),e.create=function(t,n){return new e(t,n)},e.prototype._subscribe=function(t){var e=this,n=this.promise,a=this.scheduler;if(null==a)this._isScalar?t.closed||(t.next(this.value),t.complete()):n.then(function(n){e.value=n,e._isScalar=!0,t.closed||(t.next(n),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){o.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return a.schedule(r,0,{value:this.value,subscriber:t})}else n.then(function(n){e.value=n,e._isScalar=!0,t.closed||t.add(a.schedule(r,0,{value:n,subscriber:t}))},function(e){t.closed||t.add(a.schedule(i,0,{err:e,subscriber:t}))}).then(null,function(t){o.root.setTimeout(function(){throw t})})},e}(s.Observable);e.PromiseObservable=l},function(t,e,n){"use strict";function r(t){var e=t[c.iterator];if(!e&&"string"==typeof t)return new f(t);if(!e&&void 0!==t.length)return new d(t);if(!e)throw new TypeError("object is not iterable");return t[c.iterator]()}function i(t){var e=+t.length;return isNaN(e)?0:0!==e&&a(e)?(e=o(e)*Math.floor(Math.abs(e)),e<=0?0:e>p?p:e):e}function a(t){return"number"==typeof t&&l.root.isFinite(t)}function o(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}var s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},l=n(77),u=n(291),c=n(812),h=function(t){function e(e,n){if(t.call(this),this.scheduler=n,null==e)throw new Error("iterator cannot be null.");this.iterator=r(e)}return s(e,t),e.create=function(t,n){return new e(t,n)},e.dispatch=function(t){var e=t.index,n=t.hasError,r=t.iterator,i=t.subscriber;if(n)return void i.error(t.error);var a=r.next();return a.done?void i.complete():(i.next(a.value),t.index=e+1,i.closed?void("function"==typeof r.return&&r.return()):void this.schedule(t))},e.prototype._subscribe=function(t){var n=this,r=n.iterator,i=n.scheduler;if(i)return i.schedule(e.dispatch,0,{index:0,iterator:r,subscriber:t});for(;;){var a=r.next();if(a.done){t.complete();break}if(t.next(a.value),t.closed){"function"==typeof r.return&&r.return();break}}},e}(u.Observable);e.IteratorObservable=h;var f=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length),this.str=t,this.idx=e,this.len=n}return t.prototype[c.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),d=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=i(t)),this.arr=t,this.idx=e,this.len=n}return t.prototype[c.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}(),p=Math.pow(2,53)-1},function(t,e,n){"use strict";function r(t){return t&&"function"==typeof t.schedule}e.isScheduler=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(291),a=n(838),o=n(811),s=function(t){function e(e,n){t.call(this),this.arrayLike=e,this.scheduler=n,n||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,n){var r=t.length;return 0===r?new o.EmptyObservable:1===r?new a.ScalarObservable(t[0],n):new e(t,n)},e.dispatch=function(t){var e=t.arrayLike,n=t.index,r=t.length,i=t.subscriber;if(!i.closed){if(n>=r)return void i.complete();i.next(e[n]),t.index=n+1,this.schedule(t)}},e.prototype._subscribe=function(t){var n=this,r=n.arrayLike,i=n.scheduler,a=r.length;if(i)return i.schedule(e.dispatch,0,{arrayLike:r,index:0,length:a,subscriber:t});for(var o=0;o<a&&!t.closed;o++)t.next(r[o]);t.complete()},e}(i.Observable);e.ArrayLikeObservable=s},function(t,e,n){"use strict";function r(t,e){return void 0===e&&(e=0),this.lift(new s(t,e))}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(293),o=n(1021);e.observeOn=r;var s=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.scheduler,this.delay))},t}();e.ObserveOnOperator=s;var l=function(t){function e(e,n,r){void 0===r&&(r=0),t.call(this,e),this.scheduler=n,this.delay=r}return i(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new u(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(o.Notification.createComplete())},e}(a.Subscriber);e.ObserveOnSubscriber=l;var u=function(){function t(t,e){this.notification=t,this.destination=e}return t}();e.ObserveOnMessage=u},function(t,e,n){"use strict";var r=n(291),i=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return r.Observable.of(this.value);case"E":return r.Observable.throw(this.error);case"C":return r.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();e.Notification=i},function(t,e,n){"use strict";var r=n(291),i=n(1023);r.Observable.prototype.map=i.map},function(t,e,n){"use strict";function r(t,e){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return this.lift(new o(t,e))}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(293);e.map=r;var o=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.thisArg))},t}();e.MapOperator=o;var s=function(t){function e(e,n,r){t.call(this,e),this.project=n,this.count=0,this.thisArg=r||this}return i(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(a.Subscriber)},function(t,e,n){"use strict";var r=n(291),i=n(1025);r.Observable.prototype.combineAll=i.combineAll},function(t,e,n){"use strict";function r(t){return this.lift(new i.CombineLatestOperator(t))}var i=n(1026);e.combineAll=r},function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&o.isArray(t[0])&&(t=t[0].slice()),t.unshift(this),this.lift.call(new a.ArrayObservable(t),new c(n))}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(837),o=n(297),s=n(1027),l=n(1028),u={};e.combineLatest=r;var c=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.project))},t}();e.CombineLatestOperator=c;var h=function(t){function e(e,n){t.call(this,e),this.project=n,this.active=0,this.values=[],this.observables=[]}return i(e,t),e.prototype._next=function(t){this.values.push(u),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(l.subscribeToResult(this,r,r,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){var a=this.values,o=a[n],s=this.toRespond?o===u?--this.toRespond:this.toRespond:0;a[n]=e,0===s&&(this.project?this._tryProject(a):this.destination.next(a.slice()))},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.OuterSubscriber);e.CombineLatestSubscriber=h},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(293),a=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(i.Subscriber);e.OuterSubscriber=a},function(t,e,n){"use strict";function r(t,e,n,r){var f=new c.InnerSubscriber(t,n,r);if(f.closed)return null;if(e instanceof l.Observable)return e._isScalar?(f.next(e.value),f.complete(),null):e.subscribe(f);if(a.isArrayLike(e)){for(var d=0,p=e.length;d<p&&!f.closed;d++)f.next(e[d]);f.closed||f.complete()}else{if(o.isPromise(e))return e.then(function(t){f.closed||(f.next(t),f.complete())},function(t){return f.error(t)}).then(null,function(t){i.root.setTimeout(function(){throw t})}),f;if(e&&"function"==typeof e[u.iterator])for(var m=e[u.iterator]();;){var g=m.next();if(g.done){f.complete();break}if(f.next(g.value),f.closed)break}else if(e&&"function"==typeof e[h.observable]){var v=e[h.observable]();if("function"==typeof v.subscribe)return v.subscribe(new c.InnerSubscriber(t,n,r));f.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var y=s.isObject(e)?"an invalid object":"'"+e+"'",b="You provided "+y+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";f.error(new TypeError(b))}}return null}var i=n(77),a=n(835),o=n(836),s=n(300),l=n(291),u=n(812),c=n(1029),h=n(298);e.subscribeToResult=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(293),a=function(t){function e(e,n,r){t.call(this),this.parent=e,this.outerValue=n,this.outerIndex=r,this.index=0}return r(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(i.Subscriber);e.InnerSubscriber=a},function(t,e){!function(t){function e(e){function a(e,n,r){S||(S=!0,y=e.getCanvas(),b=t(y).parent(),i=e.getOptions(),e.setData(o(e.getData())))}function o(e){for(var n=0,r=0,a=0,o=i.series.pie.combine.color,s=[],l=0;l<e.length;++l){var u=e[l].data;t.isArray(u)&&1==u.length&&(u=u[0]),t.isArray(u)?!isNaN(parseFloat(u[1]))&&isFinite(u[1])?u[1]=+u[1]:u[1]=0:u=!isNaN(parseFloat(u))&&isFinite(u)?[1,+u]:[1,0],e[l].data=[u]}for(var l=0;l<e.length;++l)n+=e[l].data[0][1];for(var l=0;l<e.length;++l){var u=e[l].data[0][1];u/n<=i.series.pie.combine.threshold&&(r+=u,a++,o||(o=e[l].color))}for(var l=0;l<e.length;++l){var u=e[l].data[0][1];(a<2||u/n>i.series.pie.combine.threshold)&&s.push({data:[[1,u]],color:e[l].color,label:e[l].label,angle:u*Math.PI*2/n,percent:u/(n/100)})}return a>1&&s.push({data:[[1,r]],color:o,label:i.series.pie.combine.label,angle:r*Math.PI*2/n,percent:r/(n/100)}),s}function s(e,a){function o(){k.clearRect(0,0,s,u),b.children().filter(".pieLabel, .pieLabelBackground").remove()}if(b){var s=e.getPlaceholder().width(),u=e.getPlaceholder().height(),c=b.children().filter(".legend").children().width()||0;k=a,S=!1,x=Math.min(s,u/i.series.pie.tilt)/2,w=u/2+i.series.pie.offset.top,_=s/2,"auto"==i.series.pie.offset.left?i.legend.position.match("w")?_+=c/2:_-=c/2:_+=i.series.pie.offset.left,_<x?_=x:_>s-x&&(_=s-x);var h=e.getData(),f=0;do{f>0&&(x*=r),f+=1,o(),i.series.pie.tilt<=.8&&function(){var t=i.series.pie.shadow.left,e=i.series.pie.shadow.top,n=i.series.pie.shadow.alpha,r=i.series.pie.radius>1?i.series.pie.radius:x*i.series.pie.radius;if(!(r>=s/2-t||r*i.series.pie.tilt>=u/2-e||r<=10)){k.save(),k.translate(t,e),k.globalAlpha=n,k.fillStyle="#000",k.translate(_,w),k.scale(1,i.series.pie.tilt);for(var a=1;a<=10;a++)k.beginPath(),k.arc(0,0,r,0,2*Math.PI,!1),k.fill(),r-=a;k.restore()}}()}while(!function(){function e(t,e,n){t<=0||isNaN(t)||(n?k.fillStyle=e:(k.strokeStyle=e,k.lineJoin="round"),k.beginPath(),Math.abs(t-2*Math.PI)>1e-9&&k.moveTo(0,0),k.arc(0,0,r,a,a+t/2,!1),k.arc(0,0,r,a+t/2,a+t,!1),k.closePath(),a+=t,n?k.fill():k.stroke())}var n=Math.PI*i.series.pie.startAngle,r=i.series.pie.radius>1?i.series.pie.radius:x*i.series.pie.radius;k.save(),k.translate(_,w),k.scale(1,i.series.pie.tilt),k.save();for(var a=n,o=0;o<h.length;++o)h[o].startAngle=a,e(h[o].angle,h[o].color,!0);if(k.restore(),i.series.pie.stroke.width>0){k.save(),k.lineWidth=i.series.pie.stroke.width,a=n;for(var o=0;o<h.length;++o)e(h[o].angle,i.series.pie.stroke.color,!1);k.restore()}return l(k),k.restore(),!i.series.pie.label.show||function(){for(var e=n,r=i.series.pie.label.radius>1?i.series.pie.label.radius:x*i.series.pie.label.radius,a=0;a<h.length;++a){if(h[a].percent>=100*i.series.pie.label.threshold&&!function(e,n,a){if(0==e.data[0][1])return!0;var o,l=i.legend.labelFormatter,c=i.series.pie.label.formatter;o=l?l(e.label,e):e.label,c&&(o=c(o,e));var h=(n+e.angle+n)/2,f=_+Math.round(Math.cos(h)*r),d=w+Math.round(Math.sin(h)*r)*i.series.pie.tilt,p="<span class='pieLabel' id='pieLabel"+a+"' style='position:absolute;top:"+d+"px;left:"+f+"px;'>"+o+"</span>";b.append(p);var m=b.children("#pieLabel"+a),g=d-m.height()/2,v=f-m.width()/2;if(m.css("top",g),m.css("left",v),0-g>0||0-v>0||u-(g+m.height())<0||s-(v+m.width())<0)return!1;if(0!=i.series.pie.label.background.opacity){var y=i.series.pie.label.background.color;null==y&&(y=e.color);var x="top:"+g+"px;left:"+v+"px;";t("<div class='pieLabelBackground' style='position:absolute;width:"+m.width()+"px;height:"+m.height()+"px;"+x+"background-color:"+y+";'></div>").css("opacity",i.series.pie.label.background.opacity).insertBefore(m)}return!0}(h[a],e,a))return!1;e+=h[a].angle}return!0}()}()&&f<n);f>=n&&(o(),b.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),e.setSeries&&e.insertLegend&&(e.setSeries(h),e.insertLegend())}}function l(t){if(i.series.pie.innerRadius>0){t.save();var e=i.series.pie.innerRadius>1?i.series.pie.innerRadius:x*i.series.pie.innerRadius;t.globalCompositeOperation="destination-out",t.beginPath(),t.fillStyle=i.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.fill(),t.closePath(),t.restore(),t.save(),t.beginPath(),t.strokeStyle=i.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.restore()}}function u(t,e){for(var n=!1,r=-1,i=t.length,a=i-1;++r<i;a=r)(t[r][1]<=e[1]&&e[1]<t[a][1]||t[a][1]<=e[1]&&e[1]<t[r][1])&&e[0]<(t[a][0]-t[r][0])*(e[1]-t[r][1])/(t[a][1]-t[r][1])+t[r][0]&&(n=!n);return n}function c(t,n){for(var r,i,a=e.getData(),o=e.getOptions(),s=o.series.pie.radius>1?o.series.pie.radius:x*o.series.pie.radius,l=0;l<a.length;++l){var c=a[l];if(c.pie.show){if(k.save(),k.beginPath(),k.moveTo(0,0),k.arc(0,0,s,c.startAngle,c.startAngle+c.angle/2,!1),k.arc(0,0,s,c.startAngle+c.angle/2,c.startAngle+c.angle,!1),k.closePath(),r=t-_,i=n-w,k.isPointInPath){if(k.isPointInPath(t-_,n-w))return k.restore(),{datapoint:[c.percent,c.data],dataIndex:0,series:c,seriesIndex:l}}else{if(u([[0,0],[s*Math.cos(c.startAngle),s*Math.sin(c.startAngle)],[s*Math.cos(c.startAngle+c.angle/4),s*Math.sin(c.startAngle+c.angle/4)],[s*Math.cos(c.startAngle+c.angle/2),s*Math.sin(c.startAngle+c.angle/2)],[s*Math.cos(c.startAngle+c.angle/1.5),s*Math.sin(c.startAngle+c.angle/1.5)],[s*Math.cos(c.startAngle+c.angle),s*Math.sin(c.startAngle+c.angle)]],[r,i]))return k.restore(),{datapoint:[c.percent,c.data],dataIndex:0,series:c,seriesIndex:l}}k.restore()}}return null}function h(t){d("plothover",t)}function f(t){d("plotclick",t)}function d(t,n){var r=e.offset(),a=parseInt(n.pageX-r.left),o=parseInt(n.pageY-r.top),s=c(a,o);if(i.grid.autoHighlight)for(var l=0;l<M.length;++l){var u=M[l];u.auto!=t||s&&u.series==s.series||m(u.series)}s&&p(s.series,t);var h={pageX:n.pageX,pageY:n.pageY};b.trigger(t,[h,s])}function p(t,n){var r=g(t);-1==r?(M.push({series:t,auto:n}),e.triggerRedrawOverlay()):n||(M[r].auto=!1)}function m(t){null==t&&(M=[],e.triggerRedrawOverlay());var n=g(t);-1!=n&&(M.splice(n,1),e.triggerRedrawOverlay())}function g(t){for(var e=0;e<M.length;++e){if(M[e].series==t)return e}return-1}function v(t,e){var n=t.getOptions(),r=n.series.pie.radius>1?n.series.pie.radius:x*n.series.pie.radius;e.save(),e.translate(_,w),e.scale(1,n.series.pie.tilt);for(var i=0;i<M.length;++i)!function(t){t.angle<=0||isNaN(t.angle)||(e.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",e.beginPath(),Math.abs(t.angle-2*Math.PI)>1e-9&&e.moveTo(0,0),e.arc(0,0,r,t.startAngle,t.startAngle+t.angle/2,!1),e.arc(0,0,r,t.startAngle+t.angle/2,t.startAngle+t.angle,!1),e.closePath(),e.fill())}(M[i].series);l(e),e.restore()}var y=null,b=null,x=null,_=null,w=null,S=!1,k=null,M=[];e.hooks.processOptions.push(function(t,e){e.series.pie.show&&(e.grid.show=!1,"auto"==e.series.pie.label.show&&(e.legend.show?e.series.pie.label.show=!1:e.series.pie.label.show=!0),"auto"==e.series.pie.radius&&(e.series.pie.label.show?e.series.pie.radius=.75:e.series.pie.radius=1),e.series.pie.tilt>1?e.series.pie.tilt=1:e.series.pie.tilt<0&&(e.series.pie.tilt=0))}),e.hooks.bindEvents.push(function(t,e){var n=t.getOptions();n.series.pie.show&&(n.grid.hoverable&&e.unbind("mousemove").mousemove(h),n.grid.clickable&&e.unbind("click").click(f))}),e.hooks.processDatapoints.push(function(t,e,n,r){t.getOptions().series.pie.show&&a(t,e,n)}),e.hooks.drawOverlay.push(function(t,e){t.getOptions().series.pie.show&&v(t,e)}),e.hooks.draw.push(function(t,e){t.getOptions().series.pie.show&&s(t,e)})}var n=10,r=.95,i={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(t,e){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+e.color+";'>"+t+"<br/>"+Math.round(e.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};t.plot.plugins.push({init:e,options:i,name:"pie",version:"1.1"})}(jQuery)},function(t,e,n){"use strict";function r(t,e,n,r,i,o){function l(t){if(t.template)return r.when(t.template);var e=o.get(t.templateUrl);return e?r.when(e):i.get(t.templateUrl).then(function(t){return t.data})}function d(t,e){if(t)return 0===t.indexOf("public")?t:e+"/"+t}function p(t){return t.Component.templateUrl=d(t.Component.templateUrl,t.baseUrl),function(){return{templateUrl:t.Component.templateUrl,template:t.Component.template,restrict:"E",controller:t.Component,controllerAs:"ctrl",bindToController:!0,scope:t.bindings,link:function(t,e,n,r){r.link&&r.link(t,e,n,r),r.init&&r.init()}}}}function m(t,e){var n={name:"panel-plugin-"+t.panel.type,bindings:{dashboard:"=",panel:"=",row:"="},attrs:{dashboard:"ctrl.dashboard",panel:"panel",row:"ctrl.row"}},r=u.a.panels[t.panel.type],i=Promise.resolve(f.a);return r&&(i=Object(h.importPluginModule)(r.module).then(function(t){return t.PanelCtrl})),i.then(function(t){return n.Component=t,!t||t.registered?n:t.templatePromise?t.templatePromise.then(function(t){return n}):(r&&(t.templateUrl=d(t.templateUrl,r.baseUrl)),t.templatePromise=l(t).then(function(e){return t.templateUrl=null,t.template='<grafana-panel ctrl="ctrl">'+e+"</grafana-panel>",n}),t.templatePromise)})}function g(t,n){switch(n.type){case"query-ctrl":var i=t.target.datasource||t.ctrl.panel.datasource;return e.get(i).then(function(e){return t.datasource=e,Object(h.importPluginModule)(e.meta.module).then(function(t){return{baseUrl:e.meta.baseUrl,name:"query-ctrl-"+e.meta.id,bindings:{target:"=",panelCtrl:"=",datasource:"="},attrs:{target:"target","panel-ctrl":"ctrl.panelCtrl",datasource:"datasource"},Component:t.QueryCtrl}})});case"query-options-ctrl":return e.get(t.ctrl.panel.datasource).then(function(t){return Object(h.importPluginModule)(t.meta.module).then(function(e){return e.QueryOptionsCtrl?{baseUrl:t.meta.baseUrl,name:"query-options-ctrl-"+t.meta.id,bindings:{panelCtrl:"="},attrs:{"panel-ctrl":"ctrl.panelCtrl"},Component:e.QueryOptionsCtrl}:{notFound:!0}})});case"annotations-query-ctrl":return Object(h.importPluginModule)(t.ctrl.currentDatasource.meta.module).then(function(e){return{baseUrl:t.ctrl.currentDatasource.meta.baseUrl,name:"annotations-query-ctrl-"+t.ctrl.currentDatasource.meta.id,bindings:{annotation:"=",datasource:"="},attrs:{annotation:"ctrl.currentAnnotation",datasource:"ctrl.currentDatasource"},Component:e.AnnotationsQueryCtrl}});case"datasource-config-ctrl":var a=t.ctrl.datasourceMeta;return Object(h.importPluginModule)(a.module).then(function(t){return t.ConfigCtrl?{baseUrl:a.baseUrl,name:"ds-config-"+a.id,bindings:{meta:"=",current:"="},attrs:{meta:"ctrl.datasourceMeta",current:"ctrl.current"},Component:t.ConfigCtrl}:{notFound:!0}});case"app-config-ctrl":var o=t.ctrl.model;return Object(h.importPluginModule)(o.module).then(function(t){return{baseUrl:o.baseUrl,name:"app-config-"+o.id,bindings:{appModel:"=",appEditCtrl:"="},attrs:{"app-model":"ctrl.model","app-edit-ctrl":"ctrl"},Component:t.ConfigCtrl}});case"app-page":var s=t.ctrl.appModel;return Object(h.importPluginModule)(s.module).then(function(e){return{baseUrl:s.baseUrl,name:"app-page-"+s.id+"-"+t.ctrl.page.slug,bindings:{appModel:"="},attrs:{"app-model":"ctrl.appModel"},Component:e[t.ctrl.page.component]}});case"panel":return m(t,n);default:return r.reject({message:"Could not find component type: "+n.type})}}function v(e,n,r){var i=a.a.element(document.createElement(r.name));s.a.each(r.attrs,function(t,e){i.attr(e,t)}),t(i)(e),n.empty(),setTimeout(function(){n.append(i),e.$applyAsync(function(){e.$broadcast("refresh")})})}function y(t,e,n,r){if(r.notFound)return void e.empty();if(!r.Component)throw{message:"Failed to find exported plugin component for "+r.name};if(!r.Component.registered){var i=n.$normalize(r.name),a=p(r);c.default.directive(i,a),r.Component.registered=!0}v(t,e,r)}return{restrict:"E",link:function(t,e,r){g(t,r).then(function(n){y(t,e,r,n)}).catch(function(t){n.appEvent("alert-error",["Plugin Error",t.message||t]),console.log("Plugin component error",t)})}}}r.$inject=["$compile","datasourceSrv","$rootScope","$q","$http","$templateCache"];var i=n(8),a=n.n(i),o=n(4),s=n.n(o),l=n(21),u=n.n(l),c=n(2),h=n(809),f=n(1032);c.default.directive("pluginComponent",r)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(804),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.$inject=["$scope","$injector"],e.templateUrl="public/app/plugins/panel/unknown/module.html",e}(r.a)},function(t,e,n){(function(t){var r,i;r=[n(8),n(4)],void 0!==(i=function(t,e){"use strict";var n=t.module("grafana.directives"),r={"external link":"fa-external-link",dashboard:"fa-th-large",question:"fa-question",info:"fa-info",bolt:"fa-bolt",doc:"fa-file-text-o",cloud:"fa-cloud"};n.directive("dashLinksEditor",function(){return{restrict:"E",controller:"DashLinkEditorCtrl",templateUrl:"public/app/features/dashlinks/editor.html",link:function(){}}}),n.directive("dashLinksContainer",function(){return{scope:{links:"="},restrict:"E",controller:"DashLinksContainerCtrl",template:'<dash-link ng-repeat="link in generatedLinks" link="link"></dash-link>',link:function(){}}}),n.directive("dashLink",["$compile","linkSrv",function(t,e){return{restrict:"E",link:function(n,r){function i(){var t=e.getAnchorInfo(a);u.text(t.title),s.attr("href",t.href)}var a=n.link,o='<div class="gf-form"><a class="pointer gf-form-label" data-placement="bottom"'+(a.asDropdown?' ng-click="fillDropdown(link)" data-toggle="dropdown"':"")+"><i></i> <span></span></a>";a.asDropdown&&(o+='<ul class="dropdown-menu" role="menu"><li ng-repeat="dash in link.searchHits"><a href="{{dash.url}}">{{dash.title}}</a></li></ul>'),o+="</div>",r.html(o),t(r.contents())(n);var s=r.find("a"),l=r.find("i"),u=r.find("span");r.find("a").tooltip({title:n.link.tooltip,html:!0,container:"body"}),l.attr("class","fa fa-fw "+n.link.icon),s.attr("target",n.link.target),a.asDropdown&&n.$last&&r.find(".dropdown-menu").addClass("pull-right"),i(),n.$on("refresh",i)}}}]),n.controller("DashLinksContainerCtrl",["$scope","$rootScope","$q","backendSrv","dashboardSrv","linkSrv",function(t,n,i,a,o,s){function l(e){return"dashboards"===e.type?e.tags?e.asDropdown?i.when([{title:e.title,tags:e.tags,keepTime:e.keepTime,includeVars:e.includeVars,icon:"fa fa-bars",asDropdown:!0}]):t.searchDashboards(e,7):(console.log("Dashboard link missing tag"),i.when([])):"link"===e.type?i.when([{url:e.url,title:e.title,icon:r[e.icon],tooltip:e.tooltip,target:e.targetBlank?"_blank":"_self",keepTime:e.keepTime,includeVars:e.includeVars}]):i.when([])}function u(){var n=e.map(t.links,l);i.all(n).then(function(n){t.generatedLinks=e.flatten(n)})}var c=o.getCurrent().id;t.searchDashboards=function(t,n){return a.search({tag:t.tags,limit:n}).then(function(n){return e.reduce(n,function(e,n){return n.id!==c&&e.push({title:n.title,url:"dashboard/"+n.uri,icon:"fa fa-th-large",keepTime:t.keepTime,includeVars:t.includeVars}),e},[])})},t.fillDropdown=function(n){t.searchDashboards(n,100).then(function(t){e.each(t,function(t){t.url=s.getLinkUrl(t)}),n.searchHits=t})},u(),n.onAppEvent("dash-links-updated",u,t)}]),n.controller("DashLinkEditorCtrl",["$scope","$rootScope",function(t,n){t.iconMap=r,t.dashboard.links=t.dashboard.links||[],t.addLink=function(){t.dashboard.links.push({type:"dashboards",icon:"external link"}),t.dashboard.updateSubmenuVisibility(),t.updated()},t.moveLink=function(n,r){e.move(t.dashboard.links,n,n+r),t.updated()},t.updated=function(){n.appEvent("dash-links-updated")},t.deleteLink=function(e){t.dashboard.links.splice(e,1),t.dashboard.updateSubmenuVisibility(),t.updated()}}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){var r,i;r=[n(1035),n(1036),n(1037),n(1038),n(1039)],void 0!==(i=function(){}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistsCtrl",function(){return o});var r=n(4),i=n.n(r),a=n(2),o=function(){function t(t,e,n){var r=this;this.$scope=t,this.backendSrv=e,this.navModel=n.getPlaylistsNav(0),e.get("/api/playlists").then(function(t){r.playlists=t})}return t.$inject=["$scope","backendSrv","navModelSrv"],t.prototype.removePlaylistConfirmed=function(t){var e=this;i.a.remove(this.playlists,{id:t.id}),this.backendSrv.delete("/api/playlists/"+t.id).then(function(){e.$scope.appEvent("alert-success",["Playlist deleted",""])},function(){e.$scope.appEvent("alert-error",["Unable to delete playlist",""]),e.playlists.push(t)})},t.prototype.removePlaylist=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete playlist "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removePlaylistConfirmed(t)}})},t}();a.default.controller("PlaylistsCtrl",o)},function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/playlist/partials/playlist_search.html",controller:a,bindToController:!0,controllerAs:"ctrl",scope:{searchStarted:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistSearchCtrl",function(){return a}),e.playlistSearchDirective=r;var i=n(2),a=function(){function t(t,e){var n=this;this.backendSrv=e,this.query={query:"",tag:[],starred:!1,limit:30},t(function(){n.query.query="",n.searchDashboards()},100)}return t.$inject=["$timeout","backendSrv"],t.prototype.searchDashboards=function(){this.tagsMode=!1;var t={};t.promise=this.backendSrv.search(this.query).then(function(t){return{dashboardResult:t,tagResult:[]}}),this.searchStarted(t)},t.prototype.showStarred=function(){this.query.starred=!this.query.starred,this.searchDashboards()},t.prototype.queryHasNoFilters=function(){return""===this.query.query&&!1===this.query.starred&&0===this.query.tag.length},t.prototype.filterByTag=function(t,e){this.query.tag.push(t),this.searchDashboards(),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.getTags=function(){var t={};t.promise=this.backendSrv.get("/api/dashboards/tags").then(function(t){return{dashboardResult:[],tagResult:t}}),this.searchStarted(t)},t}();i.default.directive("playlistSearch",r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(109),a=n.n(i),o=n(39),s=function(){function t(t,e,n,r){this.$location=t,this.$timeout=e,this.backendSrv=n,this.$routeParams=r}return t.$inject=["$location","$timeout","backendSrv","$routeParams"],t.prototype.next=function(){var t=this;if(this.$timeout.cancel(this.cancelPromise),this.index>this.dashboards.length-1)return void(window.location.href=this.getUrlWithKioskMode());var e=this.dashboards[this.index];this.$location.url("dashboard/"+e.uri),this.index++,this.cancelPromise=this.$timeout(function(){return t.next()},this.interval)},t.prototype.getUrlWithKioskMode=function(){var t=document.body.classList.contains("page-kiosk-mode");return t&&-1===this.startUrl.indexOf("kiosk")?this.startUrl+"?kiosk=true":t?this.startUrl:this.startUrl.split("?")[0]},t.prototype.prev=function(){this.index=Math.max(this.index-2,0),this.next()},t.prototype.start=function(t){var e=this;this.stop(),this.startUrl=window.location.href,this.index=0,this.playlistId=t,this.isPlaying=!0,this.$routeParams.kiosk&&o.a.emit("toggle-kiosk-mode"),this.backendSrv.get("/api/playlists/"+t).then(function(n){e.backendSrv.get("/api/playlists/"+t+"/dashboards").then(function(t){e.dashboards=t,e.interval=a.a.interval_to_ms(n.interval),e.next()})})},t.prototype.stop=function(){this.index=0,this.isPlaying=!1,this.playlistId=0,this.cancelPromise&&this.$timeout.cancel(this.cancelPromise)},t}();r.default.service("playlistSrv",s)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistEditCtrl",function(){return o});var r=n(4),i=n.n(r),a=n(2),o=function(){function t(t,e,n,r,i){var a=this;if(this.$scope=t,this.backendSrv=e,this.$location=n,this.filteredDashboards=[],this.filteredTags=[],this.searchQuery="",this.loading=!1,this.playlist={interval:"5m"},this.playlistItems=[],this.dashboardresult=[],this.tagresult=[],this.navModel=i.getPlaylistsNav(0),r.current.params.id){var o=r.current.params.id;e.get("/api/playlists/"+o).then(function(t){a.playlist=t}),e.get("/api/playlists/"+o+"/items").then(function(t){a.playlistItems=t})}}return t.$inject=["$scope","backendSrv","$location","$route","navModelSrv"],t.prototype.filterFoundPlaylistItems=function(){var t=this;this.filteredDashboards=i.a.reject(this.dashboardresult,function(e){return i.a.find(t.playlistItems,function(t){return parseInt(t.value)===e.id})}),this.filteredTags=i.a.reject(this.tagresult,function(e){return i.a.find(t.playlistItems,function(t){return t.value===e.term})})},t.prototype.addPlaylistItem=function(t){t.value=t.id.toString(),t.type="dashboard_by_id",t.order=this.playlistItems.length+1,this.playlistItems.push(t),this.filterFoundPlaylistItems()},t.prototype.addTagPlaylistItem=function(t){var e={value:t.term,type:"dashboard_by_tag",order:this.playlistItems.length+1,title:t.term};this.playlistItems.push(e),this.filterFoundPlaylistItems()},t.prototype.removePlaylistItem=function(t){i.a.remove(this.playlistItems,function(e){return t===e}),this.filterFoundPlaylistItems()},t.prototype.savePlaylist=function(t,e){var n,r=this;t.items=e,n=t.id?this.backendSrv.put("/api/playlists/"+t.id,t):this.backendSrv.post("/api/playlists",t),n.then(function(){r.$scope.appEvent("alert-success",["Playlist saved",""]),r.$location.path("/playlists")},function(){r.$scope.appEvent("alert-error",["Unable to save playlist",""])})},t.prototype.isNew=function(){return!this.playlist.id},t.prototype.isPlaylistEmpty=function(){return!this.playlistItems.length},t.prototype.backToList=function(){this.$location.path("/playlists")},t.prototype.searchStarted=function(t){var e=this;t.then(function(t){e.dashboardresult=t.dashboardResult,e.tagresult=t.tagResult,e.filterFoundPlaylistItems()})},t.prototype.movePlaylistItem=function(t,e){var n=this.playlistItems.indexOf(t),r=n+e;r>=0&&r<this.playlistItems.length&&(this.playlistItems.splice(n,1),this.playlistItems.splice(r,0,t))},t.prototype.movePlaylistItemUp=function(t){this.movePlaylistItem(t,-1)},t.prototype.movePlaylistItemDown=function(t){this.movePlaylistItem(t,1)},t}();a.default.controller("PlaylistEditCtrl",o)},function(t,e,n){(function(t){var r,i;r=[n(8),n(21),n(4)],void 0!==(i=function(t){"use strict";t.module("grafana.routes").config(["$routeProvider",function(t){t.when("/playlists",{templateUrl:"public/app/features/playlist/partials/playlists.html",controllerAs:"ctrl",controller:"PlaylistsCtrl"}).when("/playlists/create",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/edit/:id",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/play/:id",{templateUrl:"public/app/features/playlist/partials/playlists.html",controllerAs:"ctrl",controller:"PlaylistsCtrl",resolve:{init:["playlistSrv","$route",function(t,e){var n=e.current.params.id;t.start(n)}]}})}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n(1041)},function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=n(4),o=n.n(a),s=function(){function t(t,e){var n=this;this.$rootScope=t,this.backendSrv=e,this.navModel={section:{title:"Snapshots",icon:"icon-gf icon-gf-snapshot",url:"dashboard/snapshots"},menu:[]},this.backendSrv.get("/api/dashboard/snapshots").then(function(t){n.snapshots=t})}return t.$inject=["$rootScope","backendSrv"],t.prototype.removeSnapshotConfirmed=function(t){var e=this;o.a.remove(this.snapshots,{key:t.key}),this.backendSrv.get("/api/snapshots-delete/"+t.deleteKey).then(function(){e.$rootScope.appEvent("alert-success",["Snapshot deleted",""])},function(){e.$rootScope.appEvent("alert-error",["Unable to delete snapshot",""]),e.snapshots.push(t)})},t.prototype.removeSnapshot=function(t){var e=this;this.$rootScope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete snapshot "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removeSnapshotConfirmed(t)}})},t}();i.a.module("grafana.controllers").controller("SnapshotsCtrl",s)},function(t,e,n){var r,i;r=[n(1043),n(1044),n(1045),n(819),n(1046),n(1047),n(1048)],void 0!==(i=function(){}.apply(e,r))&&(t.exports=i)},function(t,e,n){var r,i;r=[n(8),n(10),n(4),n(113)],void 0!==(i=function(t,e,n,r){"use strict";t.module("grafana.directives").directive("panelMenu",["$compile",function(t){function i(t){var e='<div class="panel-menu small">';return t.dashboard.meta.canEdit&&(e+='<div class="panel-menu-inner">',e+='<div class="panel-menu-row">',t.dashboard.meta.fullscreen||(e+='<a class="panel-menu-icon pull-left" ng-click="ctrl.updateColumnSpan(-1)"><i class="fa fa-minus"></i></a>',e+='<a class="panel-menu-icon pull-left" ng-click="ctrl.updateColumnSpan(1)"><i class="fa fa-plus"></i></a>'),e+='<a class="panel-menu-icon pull-right" ng-click="ctrl.removePanel()"><i class="fa fa-trash"></i></a>',e+='<div class="clearfix"></div>',e+="</div>"),e+='<div class="panel-menu-row">',e+='<a class="panel-menu-link" gf-dropdown="extendedMenu"><i class="fa fa-bars"></i></a>',n.each(t.getMenu(),function(n){("Editor"!==n.role||t.dashboard.meta.canEdit)&&(e+='<a class="panel-menu-link" ',n.click&&(e+=' ng-click="'+n.click+'"'),n.href&&(e+=' href="'+n.href+'"'),e+=">",e+=n.text+"</a>")}),e+="</div>",e+="</div>",e+="</div>"}function a(t){return t.getExtendedMenu()}return{restrict:"A",link:function(n,o){function s(t,e){return clearTimeout(d),d=null,t?void(d=setTimeout(s,t)):!0!==e&&(p.is(":hover")||n.ctrl.dashboard.$$panelDragging)?void s(2200):void(h&&(l.destroy(),p.unbind(),p.remove(),h.$destroy(),h=null,p=null,c.removeClass("panel-highlight")))}var l,u=e('<span class="panel-title drag-handle pointer"><span class="icon-gf panel-alert-icon"></span><span class="panel-title-text drag-handle">{{ctrl.panel.title | interpolateTemplateVars:this}}</span><span class="panel-time-info" ng-show="ctrl.timeInfo"><i class="fa fa-clock-o"></i> {{ctrl.timeInfo}}</span></span>'),c=o.parents(".panel-container"),h=null,f=n.ctrl,d=null,p=null;o.append(u);var m=function(u){if(e.contains(document,u.target)){if(p)return void s();var d;d=i(f),p=e(d),p.mouseleave(function(){s(1e3)}),h=n.$new(),h.extendedMenu=a(f),h.dismiss=function(){s(null,!0)},e(".panel-container").removeClass("panel-highlight"),c.toggleClass("panel-highlight"),e(".panel-menu").remove(),o.append(p),n.$apply(function(){t(p.contents())(h),l=new r({element:p,target:c,attachment:"bottom center",targetAttachment:"top center",constraints:[{to:"window",attachment:"together",pin:!0}]})}),s(2200)}};o.click(m),t(o.contents())(n)}}}])}.apply(e,r))&&(t.exports=i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n.n(r),a=n(10),o=n.n(a),s=n(56),l=n.n(s),t=i.a.module("grafana.directives");t.directive("grafanaPanel",["$rootScope","$document",function(t,e){return{restrict:"E",template:'\n  <div class="panel-container">\n    <div class="panel-header">\n      <span class="panel-info-corner">\n        <i class="fa"></i>\n        <span class="panel-info-corner-inner"></span>\n      </span>\n\n      <span class="panel-loading" ng-show="ctrl.loading">\n        <i class="fa fa-spinner fa-spin"></i>\n      </span>\n\n      <div class="panel-title-container drag-handle" panel-menu></div>\n    </div>\n\n    <div class="panel-content">\n      <ng-transclude></ng-transclude>\n    </div>\n    <panel-resizer></panel-resizer>\n  </div>\n\n  <div class="panel-full-edit" ng-if="ctrl.editMode">\n    <div class="tabbed-view tabbed-view--panel-edit">\n      <div class="tabbed-view-header">\n        <h2 class="tabbed-view-title">\n          {{ctrl.pluginName}}\n        </h2>\n\n        <ul class="gf-tabs">\n          <li class="gf-tabs-item" ng-repeat="tab in ::ctrl.editorTabs">\n            <a class="gf-tabs-link" ng-click="ctrl.changeTab($index)" ng-class="{active: ctrl.editorTabIndex === $index}">\n              {{::tab.title}}\n            </a>\n          </li>\n        </ul>\n\n        <button class="tabbed-view-close-btn" ng-click="ctrl.exitFullscreen();">\n          <i class="fa fa-remove"></i>\n        </button>\n      </div>\n\n      <div class="tabbed-view-body">\n        <div ng-repeat="tab in ctrl.editorTabs" ng-if="ctrl.editorTabIndex === $index">\n          <panel-editor-tab editor-tab="tab" ctrl="ctrl" index="$index"></panel-editor-tab>\n        </div>\n      </div>\n    </div>\n  </div>\n',transclude:!0,scope:{ctrl:"="},link:function(e,n){function r(){c.toggleClass("panel-hover-highlight",!0),f.dashboard.setPanelFocus(f.panel.id)}function i(){c.toggleClass("panel-hover-highlight",!1),f.dashboard.setPanelFocus(0)}function a(){var t=f.getInfoMode();h[0].className="panel-info-corner panel-info-corner--"+t,t&&(o&&o.destroy(),o=new l.a({target:h[0],content:function(){return f.getInfoContent({mode:"tooltip"})},classes:f.error?"drop-error":"drop-help",openOn:"hover",hoverOpenDelay:100,tetherOptions:{attachment:"bottom left",targetAttachment:"top left",constraints:[{to:"window",attachment:"together",pin:!0}]}}))}var o,s,u,c=n.find(".panel-container"),h=n.find(".panel-info-corner"),f=e.ctrl,d=!1,p=!1,m=0;f.containerHeight||(f.calculatePanelHeight(),c.css({minHeight:f.containerHeight}),m=f.containerHeight),f.panel.transparent&&(d=!0,c.addClass("panel-transparent",!0)),f.events.on("render",function(){m!==f.containerHeight&&(c.css({minHeight:f.containerHeight}),m=f.containerHeight),d!==f.panel.transparent&&(c.toggleClass("panel-transparent",!0===f.panel.transparent),d=f.panel.transparent),u=void 0!==f.panel.alert,p!==u&&(c.toggleClass("panel-has-alert",u),p=u),f.alertState?(s&&c.removeClass("panel-alert-state--"+s),"ok"!==f.alertState.state&&"alerting"!==f.alertState.state||c.addClass("panel-alert-state--"+f.alertState.state),s=f.alertState.state):s&&(c.removeClass("panel-alert-state--"+s),s=null)});var g;t.onAppEvent("panel-change-view",function(t,e){g!==f.fullscreen&&(n.toggleClass("panel-fullscreen",!!f.fullscreen),g=f.fullscreen)},e),e.$watchGroup(["ctrl.error","ctrl.panel.description"],a),e.$watchCollection("ctrl.panel.links",a),h.on("click",function(){o.close(),e.$apply(f.openInspector.bind(f))}),n.on("mouseenter",r),n.on("mouseleave",i),e.$on("$destroy",function(){n.off(),h.off(),o&&o.destroy()})}}}]),t.directive("panelResizer",["$rootScope",function(t){return{restrict:"E",template:'<span class="resize-panel-handle icon-gf icon-gf-grabber"></span>',link:function(e,n){function r(t){t.preventDefault(),f=!0,l=o()(t.target).offset(),u=parseInt(d.row.height),c=d.panel.span,h=o()(document).width(),s=d.row.panels[d.row.panels.length-1],o()("body").on("mousemove",i),o()("body").on("mouseup",a)}function i(t){d.row.height=Math.round(u+(t.pageY-l.top)),d.panel.span=c+(t.pageX-l.left)/h*12,d.panel.span=Math.min(Math.max(d.panel.span,1),12),d.row.updateRowSpan();var n=d.row.span;Math.floor(n)<14&&(s===d.panel&&n>12?s.span-=n-12:s!==d.panel&&(s.span=s.span-(n-12),s.span=Math.min(Math.max(s.span,1),12))),d.row.panelSpanChanged(!0),e.$apply(function(){d.render()})}function a(){d.panel.span=Math.round(d.panel.span),s&&(s.span=Math.round(s.span)),t.$apply(function(){d.row.panelSpanChanged(),setTimeout(function(){t.$broadcast("render")})}),o()("body").off("mousemove",i),o()("body").off("mouseup",a)}var s,l,u,c,h,f=!1,d=e.ctrl;n.on("mousedown",r);var p=e.$on("$destroy",function(){n.off("mousedown",r),p()})}}}]),t.directive("panelHelpCorner",["$rootScope",function(t){return{restrict:"E",template:'\n      <span class="alert-error panel-error small pointer" ng-if="ctrl.error" ng-click="ctrl.openInspector()">\n        <span data-placement="top" bs-tooltip="ctrl.error">\n          <i class="fa fa-exclamation"></i><span class="panel-error-arrow"></span>\n        </span>\n      </span>\n    ',link:function(t,e){}}}])},function(t,e,n){(function(t){var r,i;r=[n(8),n(10)],void 0!==(i=function(t,e){"use strict";t.module("grafana.routes").controller("SoloPanelCtrl",["$scope","$routeParams","$location","dashboardLoaderSrv","contextSrv",function(t,n,r,i,a){var o;t.init=function(){a.sidemenu=!1;var e=r.search();o=parseInt(e.panelId),t.onAppEvent("dashboard-initialized",t.initPanelScope),i.loadDashboard(n.type,n.slug).then(function(e){e.meta.soloMode=!0,t.initDashboard(e,t)})},t.initPanelScope=function(){var n=t.dashboard.getPanelInfoById(o);if(t.ctrl={row:n.row,dashboard:t.dashboard},t.ctrl.row.height=e(window).height(),t.panel=n.panel,t.$index=0,!t.panel)return void t.appEvent("alert-error",["Panel not found",""]);t.panel.span=12},t.init()}])}.apply(e,r))&&(t.exports=i)}).call(e,n(110)(t))},function(t,e,n){"use strict";function r(t){return t.create({scope:{ctrl:"=",editorTab:"=",index:"="},directive:function(t){var e=t.ctrl.pluginId,n=t.index,r=function(){return t.editorTab.directiveFn()};return Promise.resolve({name:"panel-editor-tab-"+e+n,fn:r})}})}r.$inject=["dynamicDirectiveSrv"],Object.defineProperty(e,"__esModule",{value:!0});var i=n(8);n.n(i).a.module("grafana.directives").directive("panelEditorTab",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",controller:o,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/panel/partials/query_editor_row.html",transclude:!0,scope:{queryCtrl:"=",canCollapse:"=",hasTextEditMode:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryRowCtrl",function(){return o});var i=n(8),a=n.n(i),t=a.a.module("grafana.directives"),o=function(){function t(){this.panelCtrl=this.queryCtrl.panelCtrl,this.target=this.queryCtrl.target,this.panel=this.panelCtrl.panel,this.target.refId||(this.target.refId=this.panelCtrl.dashboard.getNextQueryLetter(this.panel)),this.toggleCollapse(!0),this.target.isNew&&(delete this.target.isNew,this.toggleCollapse(!1)),this.panel.targets.length<4&&(this.collapsed=!1)}return t.prototype.toggleHideQuery=function(){this.target.hide=!this.target.hide,this.panelCtrl.refresh()},t.prototype.toggleCollapse=function(t){if(this.canCollapse){this.panelCtrl.__collapsedQueryCache||(this.panelCtrl.__collapsedQueryCache={}),t?this.collapsed=!1!==this.panelCtrl.__collapsedQueryCache[this.target.refId]:(this.collapsed=!this.collapsed,this.panelCtrl.__collapsedQueryCache[this.target.refId]=this.collapsed);try{this.collapsedText=this.queryCtrl.getCollapsedText()}catch(t){var e=t.message||t.toString();this.collapsedText="Error: "+e}}},t.prototype.toggleEditorMode=function(){this.canCollapse&&this.collapsed&&(this.collapsed=!1),this.queryCtrl.toggleEditorMode()},t.prototype.removeQuery=function(){this.panelCtrl.__collapsedQueryCache&&delete this.panelCtrl.__collapsedQueryCache[this.target.refId],this.panelCtrl.removeQuery(this.target)},t.prototype.duplicateQuery=function(){var t=a.a.copy(this.target);this.panelCtrl.addQuery(t)},t.prototype.moveQuery=function(t){this.panelCtrl.moveQuery(this.target,t)},t}();t.directive("queryEditorRow",r)},function(t,e,n){"use strict";function r(){return{restrict:"E",template:l,controller:u,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"=",isOpen:"="},link:function(t,e,n,r){r.renderJsonExplorer=function(t){var n=e.find(".query-troubleshooter-json");r.jsonExplorer=new s.JsonExplorer(t,3,{animateOpen:!0});var i=r.jsonExplorer.render(!0);n.html(i)}}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryTroubleshooterCtrl",function(){return u}),e.queryTroubleshooter=r;var i=n(4),a=n.n(i),o=n(39),s=n(290),l='\n<div class="query-troubleshooter" ng-if="ctrl.isOpen">\n  <div class="query-troubleshooter__header">\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-hide="ctrl.allNodesExpanded">\n      <i class="fa fa-plus-square-o"></i> Expand All\n    </a>\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-show="ctrl.allNodesExpanded">\n      <i class="fa fa-minus-square-o"></i> Collapse All\n    </a>\n    <a class="pointer" clipboard-button="ctrl.getClipboardText()"><i class="fa fa-clipboard"></i> Copy to Clipboard</a>\n  </div>\n  <div class="query-troubleshooter__body">\n    <i class="fa fa-spinner fa-spin" ng-show="ctrl.isLoading"></i>\n    <div class="query-troubleshooter-json"></div>\n  </div>\n</div>\n',u=function(){function t(t,e){this.$timeout=e,this.onRequestErrorEventListener=this.onRequestError.bind(this),this.onRequestResponseEventListener=this.onRequestResponse.bind(this),o.a.on("ds-request-response",this.onRequestResponseEventListener),o.a.on("ds-request-error",this.onRequestErrorEventListener),t.$on("$destroy",this.removeEventsListeners.bind(this)),t.$watch("ctrl.isOpen",this.stateChanged.bind(this))}return t.$inject=["$scope","$timeout"],t.prototype.removeEventsListeners=function(){o.a.off("ds-request-response",this.onRequestResponseEventListener),o.a.off("ds-request-error",this.onRequestErrorEventListener)},t.prototype.onRequestError=function(t){this.isOpen&&(this.isOpen=!0,this.hasError=!0,this.onRequestResponse(t))},t.prototype.stateChanged=function(){this.isOpen&&(this.panelCtrl.refresh(),this.isLoading=!0)},t.prototype.getClipboardText=function(){return this.jsonExplorer?JSON.stringify(this.jsonExplorer.json,null,2):""},t.prototype.onRequestResponse=function(t){this.isOpen&&(this.isLoading=!1,t=a.a.cloneDeep(t),t.headers&&delete t.headers,t.config&&(t.request=t.config,delete t.config,delete t.request.transformRequest,delete t.request.transformResponse,delete t.request.paramSerializer,delete t.request.jsonpCallbackParam,delete t.request.headers,delete t.request.requestId,delete t.request.inspect,delete t.request.retry,delete t.request.timeout),t.data&&(t.response=t.data,200===t.status&&this.hasError&&(this.hasError=!1,this.isOpen=!1),delete t.data,delete t.status,delete t.statusText,delete t.$$config),this.$timeout(a.a.partial(this.renderJsonExplorer,t)))},t.prototype.toggleExpand=function(t){this.jsonExplorer&&(this.allNodesExpanded=!this.allNodesExpanded,this.jsonExplorer.openAtDepth(this.allNodesExpanded?20:1))},t}();s.coreModule.directive("queryTroubleshooter",r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(21),a=n.n(i),o=n(4),s=n.n(o),l=function(){function t(t,e,n,r){this.$http=t,this.$routeParams=e,this.backendSrv=n,this.colors=[],this.buttonNames=["primary","secondary","inverse","success","warning","danger"],this.buttonSizes=["btn-small","","btn-large"],this.buttonVariants=["-","-outline-"],this.icons=[],this.pages=["colors","buttons","icons","plugins"],this.navModel=r.getAdminNav(),this.theme=a.a.bootData.user.lightTheme?"light":"dark",this.page={},e.page?this.page[e.page]=1:this.page.colors=!0,this.page.colors&&this.loadColors(),this.page.icons&&this.loadIcons()}return t.$inject=["$http","$routeParams","backendSrv","navModelSrv"],t.prototype.loadColors=function(){var t=this;this.$http.get("public/build/styleguide.json").then(function(e){t.colors=s.a.map(e.data[t.theme],function(t,e){return{name:e,value:t}})})},t.prototype.loadIcons=function(){var t=this;this.$http.get("public/sass/icons.json").then(function(e){t.icons=e.data})},t.prototype.switchTheme=function(){this.$routeParams.theme="dark"===this.theme?"light":"dark";var t={theme:this.$routeParams.theme};this.backendSrv.put("/api/user/preferences",t).then(function(){window.location.href=window.location.href})},t}();r.default.controller("StyleGuideCtrl",l)}]));
//# sourceMappingURL=0.f26a6d0245b482a353c3.js.map